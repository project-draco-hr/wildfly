{
  ModelNode deployment=context.readResource(PathAddress.EMPTY_ADDRESS).getModel();
  if (ENABLED.resolveModelAttribute(context,deployment).asBoolean()) {
    Resource root=context.readResourceFromRoot(PathAddress.EMPTY_ADDRESS);
    ModelNode domainDeployment=root.getChild(PathElement.pathElement(DEPLOYMENT,deploymentName)).getModel();
    String runtimeName=getRuntimeName(deploymentName,deployment,domainDeployment);
    PathAddress sgAddress=address.subAddress(0,address.size() - 1);
    Resource serverGroup=root.navigate(sgAddress);
    for (    Resource.ResourceEntry re : serverGroup.getChildren(DEPLOYMENT)) {
      String reName=re.getName();
      if (!deploymentName.equals(reName)) {
        ModelNode otherDepl=re.getModel();
        if (ENABLED.resolveModelAttribute(context,otherDepl).asBoolean()) {
          domainDeployment=root.getChild(PathElement.pathElement(DEPLOYMENT,reName)).getModel();
          String otherRuntimeName=getRuntimeName(reName,otherDepl,domainDeployment);
          if (runtimeName.equals(otherRuntimeName)) {
            throw DomainControllerMessages.MESSAGES.runtimeNameMustBeUnique(reName,runtimeName,sgAddress.getLastElement().getValue());
          }
        }
      }
    }
  }
  context.stepCompleted();
}
