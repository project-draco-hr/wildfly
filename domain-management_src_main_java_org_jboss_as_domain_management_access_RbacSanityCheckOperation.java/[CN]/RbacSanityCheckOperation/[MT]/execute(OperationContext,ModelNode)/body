{
  try {
    AccessController.doPrivileged(new PrivilegedExceptionAction<Void>(){
      @Override public Void run() throws OperationFailedException {
        final ModelChecker checker=new ModelChecker(context,context.readResource(PathAddress.EMPTY_ADDRESS));
        if (checker.isRbacEnabled() && (checker.canRealmRolesBeUsed() == false) && (checker.doRoleMappingsExist() == false)) {
          throw MESSAGES.inconsistentRbacConfiguration();
        }
        context.stepCompleted();
        return null;
      }
    }
);
  }
 catch (  PrivilegedActionException e) {
    Exception cause=e.getException();
    if (cause instanceof OperationFailedException) {
      throw (OperationFailedException)cause;
    }
 else {
      throw new OperationFailedException(cause);
    }
  }
}
