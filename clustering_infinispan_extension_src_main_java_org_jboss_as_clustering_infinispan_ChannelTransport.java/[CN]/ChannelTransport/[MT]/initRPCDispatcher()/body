{
  this.dispatcher=new CommandAwareRpcDispatcher(this.channel,this,this.globalHandler,this.getTimeoutExecutor(),this.timeService){
    @Override public void stop(){
      super.stop();
      this.channel.removeChannelListener(this);
    }
  }
;
  MarshallerAdapter adapter=new MarshallerAdapter(this.marshaller){
    @Override public Object objectFromBuffer(    byte[] buffer,    int offset,    int length) throws Exception {
      return ChannelTransport.this.isUnknownForkResponse(ByteBuffer.wrap(buffer,offset,length)) ? CacheNotFoundResponse.INSTANCE : super.objectFromBuffer(buffer,offset,length);
    }
  }
;
  this.dispatcher.setRequestMarshaller(adapter);
  this.dispatcher.setResponseMarshaller(adapter);
  this.dispatcher.start();
}
