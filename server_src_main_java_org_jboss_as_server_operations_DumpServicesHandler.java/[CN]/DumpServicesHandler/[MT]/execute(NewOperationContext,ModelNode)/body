{
  context.addStep(new NewStepHandler(){
    @Override public void execute(    NewOperationContext context,    ModelNode operation) throws OperationFailedException {
      ServiceController<?> service=context.getServiceRegistry(true).getRequiredService(Services.JBOSS_AS);
      ByteArrayOutputStream out=new ByteArrayOutputStream();
      PrintStream print=new PrintStream(out);
      service.getServiceContainer().dumpServices(print);
      print.flush();
      context.getResult().set(new String(out.toByteArray()));
      context.completeStep();
    }
  }
,NewOperationContext.Stage.RUNTIME);
  context.completeStep();
}
