{
  if (!node.isDefined()) {
    return node;
  }
  ModelType type=node.getType();
  ModelNode resolved;
  if (type == ModelType.EXPRESSION) {
    resolved=resolveExpressionType(node,false);
  }
 else   if (type == ModelType.OBJECT) {
    resolved=node.clone();
    for (    Property prop : resolved.asPropertyList()) {
      resolved.get(prop.getName()).set(resolveExpressionsRecursively(prop.getValue()));
    }
  }
 else   if (type == ModelType.LIST) {
    resolved=node.clone();
    ModelNode list=new ModelNode();
    for (    ModelNode current : resolved.asList()) {
      list.add(resolveExpressionsRecursively(current));
    }
    resolved=list;
  }
 else   if (type == ModelType.PROPERTY) {
    resolved=node.clone();
    resolved.set(resolved.asProperty().getName(),resolveExpressionsRecursively(resolved.asProperty().getValue()));
  }
 else {
    resolved=node;
  }
  return resolved;
}
