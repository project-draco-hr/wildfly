{
  CountDownLatch processLatch=null;
synchronized (this) {
    ListenerSocketThread thread=listenerThreadsByProcessName.get(name);
    if (thread != null)     return thread;
    processLatch=new CountDownLatch(1);
    startProcessLatches.put(name,processLatch);
  }
  try {
    System.err.println("Starting " + name + " "+ processLatch);
    controller.startProcess(name);
    processLatch.await(TIMEOUT_MILLISECONDS,TimeUnit.SECONDS);
  }
 catch (  InterruptedException e) {
    throw new RuntimeException(e);
  }
  System.err.println("Started " + name);
synchronized (this) {
    ListenerSocketThread thread=listenerThreadsByProcessName.get(name);
    if (thread == null)     throw new IllegalStateException("No process called " + name);
    return thread;
  }
}
