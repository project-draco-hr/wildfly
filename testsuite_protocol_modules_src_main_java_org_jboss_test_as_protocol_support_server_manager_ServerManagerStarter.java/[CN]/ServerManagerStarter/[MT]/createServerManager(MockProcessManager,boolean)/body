{
  String[] args=new String[]{CommandLineConstants.INTERPROCESS_NAME,"ServerManager",CommandLineConstants.INTERPROCESS_PM_ADDRESS,InetAddress.getLocalHost().getHostAddress(),CommandLineConstants.INTERPROCESS_PM_PORT,String.valueOf(pm.getPort()),CommandLineConstants.INTERPROCESS_SM_ADDRESS,InetAddress.getLocalHost().getHostAddress(),CommandLineConstants.INTERPROCESS_SM_PORT,"0"};
  if (restart) {
    int length=args.length;
    args=Arrays.copyOf(args,length + 1);
    args[length]=CommandLineConstants.RESTART_SERVER_MANAGER;
  }
  ServerManager manager=Main.create(args,System.in,System.out,System.err,new NoopExiter());
  DomainModel domain=ConfigParser.parseDomain(new File(System.getProperty(ServerManagerEnvironment.DOMAIN_CONFIG_DIR)));
  manager.setDomain(domain);
  return manager;
}
