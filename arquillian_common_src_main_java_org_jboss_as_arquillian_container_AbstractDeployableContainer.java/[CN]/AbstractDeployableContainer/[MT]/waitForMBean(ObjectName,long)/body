{
  boolean mbeanAvailable=false;
  MBeanServerConnection mbeanServer=null;
  while (timeout > 0 && mbeanAvailable == false) {
    if (mbeanServer == null) {
      try {
        mbeanServer=getMBeanServerConnection();
      }
 catch (      Exception ex) {
      }
    }
    mbeanAvailable=(mbeanServer != null && mbeanServer.isRegistered(objectName));
    Thread.sleep(100);
    timeout-=100;
  }
  if (mbeanAvailable == false)   throw new IllegalStateException("MBean not available: " + objectName);
}
