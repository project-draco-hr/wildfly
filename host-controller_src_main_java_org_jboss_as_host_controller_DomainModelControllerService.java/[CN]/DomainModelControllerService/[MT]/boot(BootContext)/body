{
  final ServiceTarget serviceTarget=context.getServiceTarget();
  try {
    super.boot(configurationPersister.load());
    NetworkInterfaceBinding nativeManagementInterfaceBinding=getNativeManagementNetworkInterfaceBinding();
    Future<NewServerInventory> inventoryFuture=NewServerInventoryService.install(serviceTarget,this,environment,nativeManagementInterfaceBinding,hostControllerInfo.getNativeManagementPort());
    RemotingServices.installRemotingEndpoint(serviceTarget);
    if (!hostControllerInfo.isMasterDomainController()) {
      serverInventory=getFuture(inventoryFuture);
      Future<NewMasterDomainControllerClient> clientFuture=NewRemoteDomainConnectionService.install(serviceTarget,getValue(),hostControllerInfo.getLocalHostName(),hostControllerInfo.getRemoteDomainControllerHost(),hostControllerInfo.getRemoteDomainControllertPort(),remoteFileRepository);
      masterDomainControllerClient=getFuture(clientFuture);
      masterDomainControllerClient.register();
    }
 else {
      ConfigurationPersister domainPersister=configurationPersister.getDomainPersister();
      super.boot(domainPersister.load());
      RemotingServices.installChannelServices(serviceTarget,new NewMasterDomainControllerOperationHandlerService(this,this),DomainModelControllerService.SERVICE_NAME,RemotingServices.DOMAIN_CHANNEL,null,null);
      serverInventory=getFuture(inventoryFuture);
    }
    ServiceName realmSvcName=null;
    String nativeSecurityRealm=hostControllerInfo.getNativeManagementSecurityRealm();
    if (nativeSecurityRealm != null) {
      realmSvcName=SecurityRealmService.BASE_SERVICE_NAME.append(nativeSecurityRealm);
    }
    RemotingServices.installDomainConnectorServices(serviceTarget,nativeManagementInterfaceBinding,hostControllerInfo.getNativeManagementPort(),realmSvcName);
    ServerToHostOperationHandlerFactoryService.install(serviceTarget,NewServerInventoryService.SERVICE_NAME);
    RemotingServices.installChannelOpenListenerService(serviceTarget,RemotingServices.SERVER_CHANNEL,ServerToHostOperationHandlerFactoryService.SERVICE_NAME,null,null);
    RemotingServices.installChannelServices(serviceTarget,new NewModelControllerClientOperationHandlerFactoryService(),DomainModelControllerService.SERVICE_NAME,RemotingServices.MANAGEMENT_CHANNEL,null,null);
    if (hostControllerInfo.getHttpManagementInterface() != null) {
      installHttpManagementServices(serviceTarget);
    }
    startServers();
  }
  finally {
    finishBoot();
  }
}
