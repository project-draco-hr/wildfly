{
  final ServiceName endpointName=ManagementRemotingServices.MANAGEMENT_ENDPOINT;
  final ServiceTarget serviceTarget=context.getServiceTarget();
  try {
    super.boot(configurationPersister.load());
    NetworkInterfaceBinding nativeManagementInterfaceBinding=getNativeManagementNetworkInterfaceBinding();
    Future<ServerInventory> inventoryFuture=NewServerInventoryService.install(serviceTarget,this,environment,nativeManagementInterfaceBinding,hostControllerInfo.getNativeManagementPort());
    ManagementRemotingServices.installManagementRemotingEndpoint(serviceTarget,hostControllerInfo.getLocalHostName());
    if (!hostControllerInfo.isMasterDomainController()) {
      serverInventory=getFuture(inventoryFuture);
      Future<MasterDomainControllerClient> clientFuture=RemoteDomainConnectionService.install(serviceTarget,getValue(),hostControllerInfo.getLocalHostName(),hostControllerInfo.getRemoteDomainControllerHost(),hostControllerInfo.getRemoteDomainControllertPort(),hostControllerInfo.getRemoteDomainControllerSecurityRealm(),remoteFileRepository);
      masterDomainControllerClient=getFuture(clientFuture);
      masterDomainControllerClient.register();
    }
 else {
      ConfigurationPersister domainPersister=configurationPersister.getDomainPersister();
      super.boot(domainPersister.load());
      ManagementRemotingServices.installManagementChannelServices(serviceTarget,endpointName,new MasterDomainControllerOperationHandlerService(this,this),DomainModelControllerService.SERVICE_NAME,ManagementRemotingServices.DOMAIN_CHANNEL,null,null);
      serverInventory=getFuture(inventoryFuture);
    }
    ServiceName realmSvcName=null;
    String nativeSecurityRealm=hostControllerInfo.getNativeManagementSecurityRealm();
    if (nativeSecurityRealm != null) {
      realmSvcName=SecurityRealmService.BASE_SERVICE_NAME.append(nativeSecurityRealm);
    }
    ManagementRemotingServices.installDomainConnectorServices(serviceTarget,endpointName,nativeManagementInterfaceBinding,hostControllerInfo.getNativeManagementPort(),realmSvcName,null,null);
    ServerToHostOperationHandlerFactoryService.install(serviceTarget,NewServerInventoryService.SERVICE_NAME);
    ManagementRemotingServices.installManagementChannelOpenListenerService(serviceTarget,endpointName,ManagementRemotingServices.SERVER_CHANNEL,ServerToHostOperationHandlerFactoryService.SERVICE_NAME,null,null);
    ManagementRemotingServices.installManagementChannelServices(serviceTarget,endpointName,new ModelControllerClientOperationHandlerFactoryService(),DomainModelControllerService.SERVICE_NAME,ManagementRemotingServices.MANAGEMENT_CHANNEL,null,null);
    if (hostControllerInfo.getHttpManagementInterface() != null) {
      installHttpManagementServices(serviceTarget);
    }
    startServers();
  }
  finally {
    finishBoot();
  }
}
