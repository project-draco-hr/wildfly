{
  if (this.noMoreTimeouts(currentCal)) {
    return null;
  }
  Integer nextDayOfMonth=this.dayOfMonth.getNextMatch(currentCal);
  if (nextDayOfMonth == null) {
    return null;
  }
  int currentDayOfMonth=currentCal.get(Calendar.DAY_OF_MONTH);
  if (currentDayOfMonth == nextDayOfMonth) {
    return currentCal;
  }
  Calendar nextCal=this.truncate(currentCal,Calendar.MONTH);
  if (nextDayOfMonth > currentDayOfMonth) {
    if (this.monthHasDate(nextCal,nextDayOfMonth)) {
      nextCal.set(Calendar.DAY_OF_MONTH,nextDayOfMonth);
      nextCal.set(Calendar.SECOND,this.second.getFirst());
      nextCal.set(Calendar.MINUTE,this.minute.getFirst());
      nextCal.set(Calendar.HOUR_OF_DAY,this.hour.getFirst());
    }
 else {
      nextCal=this.advanceTillMonthHasDate(nextCal,nextDayOfMonth);
    }
  }
 else   if (nextDayOfMonth < currentDayOfMonth) {
    nextCal.add(Calendar.MONTH,1);
    nextCal.set(Calendar.SECOND,this.second.getFirst());
    nextCal.set(Calendar.MINUTE,this.minute.getFirst());
    nextCal.set(Calendar.HOUR_OF_DAY,this.hour.getFirst());
    nextCal=this.computeNextMonth(nextCal);
    if (nextCal == null) {
      return null;
    }
    nextDayOfMonth=this.dayOfMonth.getFirstMatch(nextCal);
    if (nextDayOfMonth == null) {
      return null;
    }
    nextCal=this.advanceTillMonthHasDate(nextCal,nextDayOfMonth);
  }
  return nextCal;
}
