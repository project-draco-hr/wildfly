{
  OutputStream dataOutput=null;
  ByteDataOutput output=null;
  try {
    dataOutput=connection.writeMessage();
    output=new SimpleByteDataOutput(dataOutput);
    final ManagementRequestHeader managementRequestHeader=new ManagementRequestHeader(ManagementProtocol.VERSION,requestId,getHandlerId());
    managementRequestHeader.write(output);
    connection.setMessageHandler(initiatingMessageHandler);
    output.close();
    dataOutput.close();
  }
  finally {
    safeClose(output);
    safeClose(dataOutput);
  }
  return future;
}
