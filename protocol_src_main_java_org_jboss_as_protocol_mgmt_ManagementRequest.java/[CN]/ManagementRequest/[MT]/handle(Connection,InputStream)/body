{
  try {
    connection.setMessageHandler(responseBodyHandler);
    byte header=StreamUtils.readByte(input);
    if (header == ManagementProtocol.REMOTE_EXCEPTION) {
      throw new IOException("Remote side caught an (unknown) exception and cannot process the request");
    }
    expectHeader(header,ManagementProtocol.RESPONSE_START);
    byte responseCode=StreamUtils.readByte(input);
    if (responseCode != getResponseCode()) {
      throw new IOException("Invalid response code.  Expecting '" + getResponseCode() + "' received '"+ responseCode+ "'");
    }
  }
 catch (  Exception e) {
    future.setException(e);
  }
}
