{
  ROOT_LOGGER.tracef("Begin run");
  try {
    CommandType cmdType=progress.getDeploymentStatus().getCommand();
    TargetModuleID[] modules=progress.getResultTargetModuleIDs();
    for (int i=0; i < modules.length; i++) {
      TargetModuleID moduleid=modules[i];
      JBossTarget target=(JBossTarget)moduleid.getTarget();
      try {
        progress.sendProgressEvent(StateType.RUNNING,MESSAGES.operationStarted(cmdType),moduleid);
        if (cmdType == CommandType.DISTRIBUTE) {
          target.deploy(moduleid);
        }
 else         if (cmdType == CommandType.START) {
          target.start(moduleid);
        }
 else         if (cmdType == CommandType.STOP) {
          target.stop(moduleid);
        }
 else         if (cmdType == CommandType.UNDEPLOY) {
          target.undeploy(moduleid);
        }
        progress.sendProgressEvent(StateType.COMPLETED,MESSAGES.operationCompleted(cmdType),moduleid);
      }
 catch (      Exception e) {
        String message=MESSAGES.operationFailedOnTarget(cmdType,target);
        progress.sendProgressEvent(StateType.FAILED,message,moduleid);
        ROOT_LOGGER.errorf(e,message);
      }
    }
  }
  finally {
    if (managerState != null)     managerState.cleanup();
  }
  ROOT_LOGGER.tracef("End run");
}
