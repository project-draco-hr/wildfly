{
  final DeploymentUnit deploymentUnit=phaseContext.getDeploymentUnit();
  final DeploymentModuleLoader deploymentModuleLoader=deploymentUnit.getAttachment(Attachments.DEPLOYMENT_MODULE_LOADER);
  if (deploymentModuleLoader == null) {
    return;
  }
  final ModuleIdentifier moduleIdentifier=deploymentUnit.getAttachment(Attachments.MODULE_IDENTIFIER);
  if (moduleIdentifier == null) {
    return;
  }
  try {
    final Module module=deploymentModuleLoader.loadModule(moduleIdentifier);
    deploymentModuleLoader.relinkModule(module);
    deploymentUnit.putAttachment(Attachments.MODULE,module);
  }
 catch (  ModuleLoadException e) {
    throw new DeploymentUnitProcessingException("Failed to load module: " + moduleIdentifier,e);
  }
}
