{
  final ModelNode add=new ModelNode();
  add.get(OP).set(ADD);
  add.get(OP_ADDR).set(address);
  ModelNode connector=new ModelNode();
  connector.get("in-vm").set(new ModelNode());
  add.get(CommonAttributes.CONNECTOR).set(connector);
  ModelNode entries=new ModelNode();
  entries.add("java:/jms/" + CF_NAME);
  add.get(CommonAttributes.ENTRIES).set(entries);
  executeOperation(add);
  final ModelNode writeAttribute=new ModelNode();
  writeAttribute.get(OP).set(WRITE_ATTRIBUTE_OPERATION);
  writeAttribute.get(OP_ADDR).set(address);
  writeAttribute.get(NAME).set(CommonAttributes.DISCOVERY_GROUP_NAME);
  writeAttribute.get(VALUE).set(randomUUID().toString());
  try {
    executeOperation(writeAttribute);
    fail("it is not possible to define a discovery group when the connector attribute is already defined");
  }
 catch (  MgmtOperationException e) {
    assertEquals(FAILED,e.getResult().get(OUTCOME).asString());
    assertEquals(true,e.getResult().get(ROLLED_BACK).asBoolean());
    assertTrue(e.getResult().get(FAILURE_DESCRIPTION).asString().contains("JBAS011630"));
  }
  final ModelNode remove=new ModelNode();
  remove.get(OP).set(REMOVE);
  remove.get(OP_ADDR).set(address);
  executeOperation(remove);
}
