{
  if (addSecureInterface) {
    addSecureInterface();
  }
  reload();
  DefaultHttpClient httpClient=new DefaultHttpClient();
  URL mgmtURL=new URL("http",DomainTestSupport.masterAddress,MANAGEMENT_HTTP_PORT,MGMT_CTX);
  try {
    String responseBody=makeCallWithHttpClient(mgmtURL,httpClient,401);
    assertThat("Management index page was reached",responseBody,not(containsString("management-major-version")));
    fail("Untrusted client should not be authenticated.");
  }
 catch (  SSLPeerUnverifiedException e) {
  }
  final HttpClient trustedHttpClient=getHttpClient(CLIENT_KEYSTORE_FILE);
  String responseBody=makeCallWithHttpClient(mgmtURL,trustedHttpClient,200);
  assertTrue("Management index page was not reached",responseBody.contains("management-major-version"));
}
