{
  final PatchBuilderWrapper wrapper=new PatchBuilderWrapper(){
    @Override PatchElementBuilder modifyLayer(    String name,    boolean addOn){
      if (addOn) {
        throw processingError("does not support add-ons %s",name);
      }
      final PatchElementConfigBuilder config=PatchConfigBuilder.this.elements.get(name);
      if (config == null) {
        throw processingError("missing patch-config for layer %s",name);
      }
      final PatchElementBuilder builder;
      if (config.getPatchType() == null) {
        config.setPatchType(patchType);
      }
      if (patchType == Patch.PatchType.CUMULATIVE) {
        builder=upgradeElement(config.getPatchId(),name,false);
      }
 else {
        builder=oneOffPatchElement(config.getPatchId(),name,false);
      }
      if (config.getDescription() != null) {
        builder.setDescription(config.getDescription());
      }
      builder.setContentItemFilter(config);
      return builder;
    }
  }
;
  wrapper.setDescription(description);
  wrapper.setPatchId(patchId);
  wrapper.setContentItemFilter(PatchConfigBuilder.this);
  return wrapper;
}
