{
  String id="sso";
  Batcher batcher=mock(Batcher.class);
  Batch batch=mock(Batch.class);
  Account account=mock(Account.class);
  SSO<Account,String,Void> sso=mock(SSO.class);
  Authentication<Account> authentication=mock(Authentication.class);
  String authenticationType=HttpServletRequest.BASIC_AUTH;
  when(this.manager.createIdentifier()).thenReturn(id);
  when(this.manager.getBatcher()).thenReturn(batcher);
  when(batcher.startBatch()).thenReturn(batch);
  when(this.manager.createSSO(id)).thenReturn(sso);
  when(sso.getAuthentication()).thenReturn(authentication);
  SingleSignOn result=this.subject.createSingleSignOn(account,authenticationType);
  assertNotNull(result);
  verify(authentication).setIdentity(account);
  verify(authentication).setType(AuthenticationType.BASIC);
  verify(batch).close();
}
