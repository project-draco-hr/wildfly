{
  String id="sso";
  Batcher<Batch> batcher=mock(Batcher.class);
  Batch batch=mock(Batch.class);
  when(this.manager.getBatcher()).thenReturn(batcher);
  when(batcher.createBatch()).thenReturn(batch);
  when(this.manager.findSSO(id)).thenReturn(null);
  when(batch.isActive()).thenReturn(false);
  SingleSignOn result=this.subject.findSingleSignOn(id);
  assertNull(result);
  verify(batch).close();
  verify(batcher,never()).suspendBatch();
  reset(batch);
  SSO<AuthenticatedSession,String,Void> sso=mock(SSO.class);
  when(this.manager.findSSO(id)).thenReturn(sso);
  when(batch.isActive()).thenReturn(true);
  result=this.subject.findSingleSignOn(id);
  assertNotNull(result);
  verify(batcher).suspendBatch();
}
