{
  final Headers headers=exchange.getRequestHeaders();
  String host=headers.getFirst(HOST);
  String protocol=exchange.getHttpContext().getServer() instanceof HttpsServer ? HTTPS : HTTP;
  String redirectUrl=protocol + "://" + host+ redirectTo;
  ModelNode rejection=new ModelNode();
  rejection.get(OUTCOME).set(FAILED);
  rejection.get(FAILURE_DESCRIPTION).set(MESSAGES.realmNotReadyMessage(redirectUrl));
  rejection.get(ROLLED_BACK).set(Boolean.TRUE.toString());
  writeResponse(exchange,false,true,rejection,FORBIDDEN,false);
}
