{
  TestParser testParser;
  String root;
  if (type == ModelType.STANDALONE) {
    StandaloneXml standaloneXml=new StandaloneXml(null,Executors.newCachedThreadPool(),null);
    testParser=new TestParser(type,standaloneXml,standaloneXml);
    root="server";
  }
 else   if (type == ModelType.DOMAIN) {
    DomainXml domainXml=new DomainXml(null,Executors.newCachedThreadPool(),null);
    testParser=new TestParser(type,domainXml,domainXml);
    root="domain";
  }
 else   if (type == ModelType.HOST) {
    HostXml hostXml=new HostXml("master");
    testParser=new TestParser(type,hostXml,hostXml);
    root="host";
  }
 else {
    throw new IllegalArgumentException("Unknown type " + type);
  }
  for (  Namespace ns : Namespace.ALL_NAMESPACES) {
    xmlMapper.registerRootElement(new QName(ns.getUriString(),root),testParser);
  }
  return testParser;
}
