{
  if (userPrincipal != null && !disableAudit) {
    if (auditManager != null) {
      AuditEvent auditEvent=new AuditEvent(AuditLevel.SUCCESS);
      Map<String,Object> ctxMap=new HashMap<String,Object>();
      ctxMap.put("principal",userPrincipal);
      HttpServletRequest hsr=getServletRequest();
      if (hsr != null) {
        ctxMap.put("request",WebUtil.deriveUsefulInfo(hsr));
      }
      ctxMap.put("Source",getClass().getCanonicalName());
      if (entries != null) {
        ctxMap.putAll(entries);
      }
      auditEvent.setContextMap(ctxMap);
      auditManager.audit(auditEvent);
    }
  }
}
