{
  List<String> roles=null;
  Principal principal=request.getPrincipal();
  if (principal != null) {
    if (principal instanceof GenericPrincipal) {
      GenericPrincipal gc=GenericPrincipal.class.cast(principal);
      roles=Arrays.asList(gc.getRoles());
    }
  }
  return roles;
}
