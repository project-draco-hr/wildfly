{
  InfinispanConfiguration config=load(this.resource);
  Defaults defaults=new Defaults(config.parseGlobalConfiguration());
  Configuration defaultConfig=config.parseDefaultConfiguration();
  Map<String,Configuration> namedConfigs=config.parseNamedConfigurations();
  for (  Configuration.CacheMode mode : Configuration.CacheMode.values()) {
    Configuration configuration=defaultConfig.clone();
    Configuration overrides=namedConfigs.get(mode.name());
    if (overrides != null) {
      configuration.applyOverrides(overrides);
    }
    configuration.setCacheMode(mode);
    defaults.add(mode,configuration);
  }
  this.defaults=defaults;
}
