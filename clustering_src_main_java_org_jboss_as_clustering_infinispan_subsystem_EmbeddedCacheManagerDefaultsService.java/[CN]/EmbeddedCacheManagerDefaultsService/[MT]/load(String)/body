{
  URL url=find(resource,Thread.currentThread().getContextClassLoader(),InfinispanExtension.class.getClassLoader());
  try {
    InputStream input=url.openStream();
    SwitchContext context=switcher.getSwitchContext(InfinispanConfiguration.class.getClassLoader());
    try {
      return InfinispanConfiguration.newInfinispanConfiguration(input);
    }
  finally {
      context.reset();
      try {
        input.close();
      }
 catch (      IOException e) {
        log.warn(e.getMessage(),e);
      }
    }
  }
 catch (  IOException e) {
    throw new StartException(String.format("Failed to parse %s",url),e);
  }
}
