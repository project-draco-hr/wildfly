{
  final Index index=resourceRoot.getAttachment(Attachments.ANNOTATION_INDEX);
  for (  PersistenceUnitMetadata pu : puHolder.getPersistenceUnits()) {
    List<URL> jarfilesUrls=new ArrayList<URL>();
    if (pu.getJarFiles() != null) {
      for (      String jar : pu.getJarFiles()) {
        jarfilesUrls.add(getRelativeURL(persistence_xml,jar));
      }
    }
    pu.setJarFileUrls(jarfilesUrls);
    URL url=getPersistenceUnitURL(persistence_xml);
    pu.setPersistenceUnitRootUrl(url);
    pu.setScopedPersistenceUnitName(createBeanName(deploymentUnit,pu.getPersistenceUnitName()));
    pu.setAnnotationIndex(index);
  }
}
