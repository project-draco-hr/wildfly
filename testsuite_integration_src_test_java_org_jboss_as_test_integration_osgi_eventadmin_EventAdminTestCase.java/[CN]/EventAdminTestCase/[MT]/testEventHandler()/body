{
  changeStartLevel(context,3,10,TimeUnit.SECONDS);
  bundle.start();
  assertEquals("Bundle ACTIVE",Bundle.ACTIVE,bundle.getState());
  BundleContext context=bundle.getBundleContext();
  Dictionary param=new Hashtable();
  param.put(EventConstants.EVENT_TOPIC,new String[]{TOPIC});
  TestEventHandler eventHandler=new TestEventHandler();
  context.registerService(EventHandler.class.getName(),eventHandler,param);
  ServiceReference sref=context.getServiceReference(EventAdmin.class.getName());
  EventAdmin eventAdmin=(EventAdmin)context.getService(sref);
  eventAdmin.sendEvent(new Event(TOPIC,(Dictionary)null));
  assertEquals("Event received",1,eventHandler.received.size());
  assertEquals(TOPIC,eventHandler.received.get(0).getTopic());
}
