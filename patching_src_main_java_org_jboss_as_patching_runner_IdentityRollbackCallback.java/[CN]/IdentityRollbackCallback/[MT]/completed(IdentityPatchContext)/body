{
  final InstalledImage installedImage=directoryStructure.getInstalledImage();
  final File history=installedImage.getPatchHistoryDir(patch.getPatchId());
  if (!recursiveDelete(history)) {
    PatchLogger.ROOT_LOGGER.cannotDeleteFile(history.getAbsolutePath());
  }
  cleanupEntry(context.getLayers());
  cleanupEntry(context.getAddOns());
  cleanupEntry(Collections.singleton(context.getIdentityEntry()));
}
