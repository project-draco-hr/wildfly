{
  final InstalledImage installedImage=directoryStructure.getInstalledImage();
  final File history=installedImage.getPatchHistoryDir(patch.getPatchId());
  if (!recursiveDelete(history)) {
    context.failedToCleanupDir(history);
  }
  cleanupEntry(context.getLayers());
  cleanupEntry(context.getAddOns());
  cleanupEntry(Collections.singleton(context.getIdentityEntry()));
}
