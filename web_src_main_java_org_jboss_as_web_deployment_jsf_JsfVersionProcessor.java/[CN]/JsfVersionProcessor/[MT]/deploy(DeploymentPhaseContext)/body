{
  final DeploymentUnit deploymentUnit=phaseContext.getDeploymentUnit();
  final DeploymentUnit topLevelDeployment=deploymentUnit.getParent() == null ? deploymentUnit : deploymentUnit.getParent();
  final WarMetaData metaData=deploymentUnit.getAttachment(WarMetaData.ATTACHMENT_KEY);
  if (metaData == null) {
    return;
  }
  if (metaData.getMergedJBossWebMetaData() == null) {
    return;
  }
  List<ParamValueMetaData> contextParams=metaData.getMergedJBossWebMetaData().getContextParams();
  if (contextParams == null) {
    return;
  }
  for (  final ParamValueMetaData param : contextParams) {
    if (param.getParamName().equals(CONTEXT_PARAM)) {
      JsfVersionMarker.setVersion(topLevelDeployment,param.getParamValue());
      break;
    }
  }
}
