{
  KernelServices kernelServices=createKernelServicesBuilder(TestModelType.DOMAIN).setModelInitializer(new ModelInitializer(){
    @Override public void populateModel(    Resource rootResource){
      rootResource.registerChild(PathElement.pathElement(ModelDescriptionConstants.CORE_SERVICE,ModelDescriptionConstants.ACCESS_CONTROL),AccessControlResourceDefinition.RESOURCE);
    }
  }
,null).setXmlResource("domain-all.xml").validateDescription().build();
  Assert.assertTrue(kernelServices.isSuccessfulBoot());
  String marshalled=kernelServices.getPersistedSubsystemXml();
  ModelTestUtils.compareXml(ModelTestUtils.readResource(this.getClass(),"domain-all.xml"),marshalled);
}
