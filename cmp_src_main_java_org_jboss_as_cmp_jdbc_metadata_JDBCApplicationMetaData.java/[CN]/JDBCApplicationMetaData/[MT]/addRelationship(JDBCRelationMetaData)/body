{
  final JDBCRelationMetaData oldRelation=this.relationships.put(relationMetaData.getRelationName(),relationMetaData);
  Set<JDBCRelationshipRoleMetaData> leftRoles=this.entityRoles.get(relationMetaData.getLeftRelationshipRole().getRelationshipRoleName());
  if (leftRoles == null) {
    leftRoles=new HashSet<JDBCRelationshipRoleMetaData>();
    entityRoles.put(relationMetaData.getLeftRelationshipRole().getRelationshipRoleName(),leftRoles);
  }
  Set<JDBCRelationshipRoleMetaData> rightRoles=this.entityRoles.get(relationMetaData.getRightRelationshipRole().getRelationshipRoleName());
  if (rightRoles == null) {
    rightRoles=new HashSet<JDBCRelationshipRoleMetaData>();
    entityRoles.put(relationMetaData.getRightRelationshipRole().getRelationshipRoleName(),rightRoles);
  }
  if (oldRelation != null) {
    leftRoles.remove(oldRelation.getLeftRelationshipRole());
    rightRoles.remove(oldRelation.getRightRelationshipRole());
  }
  leftRoles.add(relationMetaData.getLeftRelationshipRole());
  rightRoles.add(relationMetaData.getRightRelationshipRole());
}
