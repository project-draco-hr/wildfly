{
  Archive<?> bundleArchive=provider.getClientDeployment("test-bundle-two");
  String deploymentName=archiveDeployer.deploy(bundleArchive);
  assertNotNull("Deployment name not null",deploymentName);
  Bundle bundle=null;
  try {
    for (    Bundle aux : context.getBundles()) {
      if (aux.getSymbolicName().equals(bundleArchive.getName()))       bundle=aux;
    }
    bundle.start();
    OSGiTestHelper.assertBundleState(Bundle.ACTIVE,bundle.getState());
    bundle.stop();
    OSGiTestHelper.assertBundleState(Bundle.RESOLVED,bundle.getState());
  }
  finally {
    archiveDeployer.undeploy(deploymentName);
    OSGiTestHelper.assertBundleState(Bundle.UNINSTALLED,bundle.getState());
  }
}
