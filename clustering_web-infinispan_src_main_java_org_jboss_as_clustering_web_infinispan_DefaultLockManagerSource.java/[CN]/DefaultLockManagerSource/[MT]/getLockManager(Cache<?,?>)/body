{
  if (!cache.getConfiguration().getCacheMode().isClustered())   return null;
  EmbeddedCacheManager container=(EmbeddedCacheManager)cache.getCacheManager();
  String containerName=container.getGlobalConfiguration().getCacheManagerName();
synchronized (lockManagers) {
    LockManagerEntry entry=lockManagers.get(containerName);
    if (entry == null) {
      JGroupsTransport transport=(JGroupsTransport)cache.getAdvancedCache().getRpcManager().getTransport();
      ContextClassLoaderSwitcher.SwitchContext context=this.switcher.getSwitchContext(this.getClass().getClassLoader());
      try {
        entry=new LockManagerEntry(transport.getChannel());
      }
  finally {
        context.reset();
      }
      debug("Started lock manager for \"%s\" container",containerName);
      container.addListener(entry);
      lockManagers.put(containerName,entry);
    }
    String cacheName=cache.getName();
    debug("Registering \"%s\" cache with lock manager for \"%s\" container",cacheName,containerName);
    entry.addCache(cacheName);
    return entry.getLockManager();
  }
}
