{
  addProcess("ProcA",ProcessManagerSlaveProcess.class);
  TestProcessListenerStream listenerA=startTestProcessListenerAndWait("ProcA");
  addProcess("ProcB",ProcessManagerSlaveProcess.class);
  TestProcessListenerStream listenerB=startTestProcessListenerAndWait("ProcB");
  sendMessage("Test","ProcA","Add$slave$" + StartStopSimpleProcess.class.getName());
  assertEquals("ProcA-Add$slave$" + StartStopSimpleProcess.class.getName(),listenerA.readMessage());
  Thread.sleep(500);
  assertTrue(getProcessNames(false).contains("slave"));
  assertFalse(getProcessNames(true).contains("slave"));
  sendMessage("Test","ProcB","Start$slave");
  assertEquals("ProcB-Start$slave",listenerB.readMessage());
  TestProcessListenerStream slave=getTestProcessListener("slave",1000);
  assertNotNull(slave);
  assertTrue(getProcessNames(true).contains("slave"));
  assertEquals(StartStopSimpleProcess.STARTED,slave.readMessage());
  ProcessExitCodeAndShutDownLatch stopLatch=getStopTestProcessListenerLatch("slave");
  sendMessage("Test","ProcA","Stop$slave");
  assertEquals("ProcA-Stop$slave",listenerA.readMessage());
  assertEquals(StartStopSimpleProcess.STOPPED,slave.readMessage());
  assertTrue(stopLatch.await(500,TimeUnit.MILLISECONDS));
  assertTrue(getProcessNames(false).contains("slave"));
  assertFalse(getProcessNames(true).contains("slave"));
  sendMessage("Test","ProcB","Remove$slave");
  assertEquals("ProcB-Remove$slave",listenerB.readMessage());
  Thread.sleep(500);
  assertFalse(getProcessNames(false).contains("slave"));
}
