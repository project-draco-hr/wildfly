{
  boolean loadRequired=userProperties == null || fileUpdated != propertiesFile.lastModified();
  if (loadRequired) {
synchronized (this) {
      long fileLastModified=propertiesFile.lastModified();
      boolean loadReallyRequired=userProperties == null || fileUpdated != fileLastModified;
      if (loadReallyRequired) {
        ROOT_LOGGER.debugf("Reloading properties file '%s'",propertiesFile.getAbsolutePath());
        Properties props=new Properties();
        InputStream is=new FileInputStream(propertiesFile);
        try {
          props.load(is);
        }
  finally {
          is.close();
        }
        checkWeakPasswords(props);
        userProperties=props;
        fileUpdated=fileLastModified;
      }
    }
  }
  return userProperties;
}
