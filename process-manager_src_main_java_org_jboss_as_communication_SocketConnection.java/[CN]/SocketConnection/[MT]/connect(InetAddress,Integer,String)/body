{
  if (addr == null) {
    throw new IllegalArgumentException("addr is null");
  }
  if (port == null) {
    throw new IllegalArgumentException("port is null");
  }
  try {
    log.infof("Trying to connect to %s on port %d",addr,port);
    Socket socket=new Socket(addr,port);
    SocketConnection conn=new SocketConnection(socket);
    String request=createInitalRequest(initialRequestElements);
    log.infof("Connected to port %d on %s via local port %d. Sending initial request: %s",port,addr,socket.getLocalPort(),request.trim());
    if (request.length() > 0)     conn.sendInitialRequest(request);
    return conn;
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
