{
  deployer.deploy(BUNDLE_B);
  Bundle bundleB=context.getBundle(BUNDLE_B);
  try {
    Assert.assertEquals("Bundle ACTIVE",Bundle.ACTIVE,bundleB.getState());
    deployer.deploy(BUNDLE_A);
    Bundle bundleA=context.getBundle(BUNDLE_A);
    try {
      Assert.assertEquals("Bundle ACTIVE",Bundle.ACTIVE,bundleA.getState());
      bundleA.loadClass(TestBA.class.getName()).newInstance();
    }
  finally {
      deployer.undeploy(BUNDLE_A);
    }
  }
  finally {
    deployer.undeploy(BUNDLE_B);
  }
}
