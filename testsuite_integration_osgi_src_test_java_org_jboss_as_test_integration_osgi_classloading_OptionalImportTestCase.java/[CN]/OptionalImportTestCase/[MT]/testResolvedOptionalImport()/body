{
  deployer.deploy(BUNDLE_B);
  Bundle bundleB=packageAdmin.getBundles(BUNDLE_B,null)[0];
  try {
    Assert.assertEquals("Bundle ACTIVE",Bundle.ACTIVE,bundleB.getState());
    deployer.deploy(BUNDLE_A);
    Bundle bundleA=packageAdmin.getBundles(BUNDLE_A,null)[0];
    try {
      Assert.assertEquals("Bundle ACTIVE",Bundle.ACTIVE,bundleA.getState());
      bundleA.loadClass(TestBA.class.getName()).newInstance();
    }
  finally {
      deployer.undeploy(BUNDLE_A);
    }
  }
  finally {
    deployer.undeploy(BUNDLE_B);
  }
}
