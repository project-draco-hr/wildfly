{
  final AbstractCommonConfig commonConfig=abstractCommonConfig.getValue();
  List<UnifiedHandlerChainMetaData> handlerChains;
  if ("pre-handler-chain".equals(handlerChainType)) {
synchronized (commonConfig) {
      handlerChains=commonConfig.getPreHandlerChains();
      if (handlerChains == null) {
        handlerChains=new CopyOnWriteArrayList<UnifiedHandlerChainMetaData>();
        commonConfig.setPreHandlerChains(handlerChains);
      }
    }
  }
 else   if ("post-handler-chain".equals(handlerChainType)) {
synchronized (commonConfig) {
      handlerChains=commonConfig.getPostHandlerChains();
      if (handlerChains == null) {
        handlerChains=new CopyOnWriteArrayList<UnifiedHandlerChainMetaData>();
        commonConfig.setPostHandlerChains(handlerChains);
      }
    }
  }
 else {
    throw new StartException(MESSAGES.wrongHandlerChainType(handlerChainType,"pre-handler-chain","post-handler-chain"));
  }
  handlerChain=getChain(handlerChains,handlerChainId);
  if (handlerChain != null) {
    throw new StartException(MESSAGES.multipleHandlerChainsWithSameId(handlerChainType,handlerChainId,commonConfig.getConfigName()));
  }
  handlerChain=new UnifiedHandlerChainMetaData();
  handlerChain.setId(handlerChainId);
  handlerChain.setProtocolBindings(protocolBindings);
  handlerChains.add(handlerChain);
}
