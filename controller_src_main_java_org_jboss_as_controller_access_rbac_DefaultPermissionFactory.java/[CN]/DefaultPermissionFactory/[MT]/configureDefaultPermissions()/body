{
  Map<String,ManagementPermissionCollection> result=new HashMap<String,ManagementPermissionCollection>();
  for (  StandardRole standardRole : StandardRole.values()) {
    ManagementPermissionCollection rolePerms=new ManagementPermissionCollection(SimpleManagementPermission.class);
    for (    Action.ActionEffect actionEffect : Action.ActionEffect.values()) {
      if (standardRole.isActionEffectAllowed(actionEffect)) {
        Set<Constraint> constraints=new TreeSet<Constraint>();
        for (        ConstraintFactory factory : this.constraintFactories) {
          constraints.add(factory.getStandardUserConstraint(standardRole,actionEffect));
        }
        rolePerms.add(new SimpleManagementPermission(actionEffect,constraints.toArray(new Constraint[constraints.size()])));
      }
    }
    result.put(standardRole.toString(),rolePerms);
  }
  return result;
}
