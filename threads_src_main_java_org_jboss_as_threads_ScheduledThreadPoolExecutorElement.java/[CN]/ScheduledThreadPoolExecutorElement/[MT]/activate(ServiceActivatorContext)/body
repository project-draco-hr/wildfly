{
  final BatchBuilder batchBuilder=context.getBatchBuilder();
  final ScheduledThreadPoolService service=new ScheduledThreadPoolService();
  final ServiceName serviceName=JBOSS_THREAD_SCHEDULED_EXECUTOR.append(getName());
  final BatchServiceBuilder<ScheduledExecutorService> serviceBuilder=batchBuilder.addService(serviceName,service);
  final String threadFactory=getThreadFactory();
  final ServiceName threadFactoryName;
  if (threadFactory == null) {
    threadFactoryName=serviceName.append("thread-factory");
    batchBuilder.addService(threadFactoryName,new ThreadFactoryService());
  }
 else {
    threadFactoryName=JBOSS_THREAD_FACTORY.append(threadFactory);
  }
  serviceBuilder.addDependency(JBOSS_THREAD_FACTORY.append(threadFactory),ThreadFactory.class,service.getThreadFactoryInjector());
}
