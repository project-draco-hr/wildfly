{
  final String attributeName=definition.getName();
  final boolean has=operation.has(attributeName);
  if (!has && definition.isRequired(operation)) {
    throw new OperationFailedException(new ModelNode().set(String.format("%s is required",attributeName)));
  }
  if (has) {
    if (!definition.isAllowed(operation)) {
      throw new OperationFailedException(new ModelNode().set(String.format("%s is not allowed when [%s] are present",attributeName,definition.getAlternatives())));
    }
    definition.validateAndSet(operation,subModel);
  }
 else {
    subModel.get(definition.getName());
  }
}
