{
  String name=Operations.getPathAddress(operation).getLastElement().getValue();
  context.removeService(InfinispanBindingFactory.createCacheContainerBinding(name).getBinderServiceName());
  for (  CacheContainerServiceNameFactory factory : CacheContainerServiceName.values()) {
    context.removeService(factory.getServiceName(name));
  }
  if (model.hasDefined(TransportResourceDefinition.PATH.getKey())) {
    removeServices(context,ClusteredGroupServiceInstaller.class,name);
    context.removeService(JGroupsBindingFactory.createChannelBinding(name).getBinderServiceName());
    for (    ChannelServiceNameFactory factory : ChannelServiceName.values()) {
      context.removeService(factory.getServiceName(name));
    }
  }
 else {
    removeServices(context,LocalGroupServiceInstaller.class,name);
  }
  String defaultCache=ModelNodes.asString(CacheContainerResourceDefinition.DEFAULT_CACHE.resolveModelAttribute(context,model));
  if ((defaultCache != null) && !defaultCache.equals(CacheServiceNameFactory.DEFAULT_CACHE)) {
    Class<? extends CacheServiceInstaller> installerClass=model.hasDefined(TransportResourceDefinition.PATH.getKey()) ? ClusteredCacheServiceInstaller.class : LocalCacheServiceInstaller.class;
    for (    CacheServiceInstaller installer : ServiceLoader.load(installerClass,installerClass.getClassLoader())) {
      for (      ServiceName serviceName : installer.getServiceNames(name,CacheServiceNameFactory.DEFAULT_CACHE)) {
        context.removeService(serviceName);
      }
    }
  }
}
