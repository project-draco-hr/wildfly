{
  final PropertiesFileLoader propertiesHandler=realm == null ? new PropertiesFileLoader(file.getAbsolutePath()) : new UserPropertiesFileLoader(file.getAbsolutePath());
  try {
    propertiesHandler.start(null);
    if (realm != null) {
      ((UserPropertiesFileLoader)propertiesHandler).setRealmName(realm);
    }
    Properties prob=propertiesHandler.getProperties();
    if (value != null) {
      prob.setProperty(key,value);
    }
    if (enableDisableMode) {
      prob.setProperty(key + "!disable",String.valueOf(disable));
    }
    propertiesHandler.persistProperties();
  }
  finally {
    propertiesHandler.stop(null);
  }
}
