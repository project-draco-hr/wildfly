{
  buf.append('(');
  if (not) {
    buf.append(SQLUtil.NOT).append('(');
  }
  ASTPath fromPath=(ASTPath)fromNode;
  addLeftJoinPath(fromPath);
  String fromAlias=aliasManager.getAlias(fromPath.getPath());
  JDBCAbstractEntityBridge fromEntity=(JDBCAbstractEntityBridge)fromPath.getEntity();
  if (toNode instanceof ASTParameter) {
    ASTParameter toParam=(ASTParameter)toNode;
    verifyParameterEntityType(toParam.number,fromEntity);
    inputParameters.addAll(QueryParameter.createParameters(toParam.number - 1,fromEntity));
    SQLUtil.getWhereClause(fromEntity.getPrimaryKeyFields(),fromAlias,buf);
  }
 else {
    ASTPath toPath=(ASTPath)toNode;
    addLeftJoinPath(toPath);
    String toAlias=aliasManager.getAlias(toPath.getPath());
    JDBCAbstractEntityBridge toEntity=(JDBCAbstractEntityBridge)toPath.getEntity();
    if (!fromEntity.equals(toEntity)) {
      throw new IllegalStateException("Only like types can be " + "compared: from entity=" + fromEntity.getEntityName() + " to entity="+ toEntity.getEntityName());
    }
    SQLUtil.getSelfCompareWhereClause(fromEntity.getPrimaryKeyFields(),fromAlias,toAlias,buf);
  }
  if (not) {
    buf.append(')');
  }
  buf.append(')');
}
