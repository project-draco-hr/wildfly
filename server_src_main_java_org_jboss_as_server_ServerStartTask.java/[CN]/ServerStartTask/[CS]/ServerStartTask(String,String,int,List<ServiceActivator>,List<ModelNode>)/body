{
  if (serverName == null || serverName.length() == 0) {
    throw new IllegalArgumentException("Server name \"" + serverName + "\" is invalid; cannot be null or blank");
  }
  if (hostControllerName == null || hostControllerName.length() == 0) {
    throw new IllegalArgumentException("Host Controller name \"" + hostControllerName + "\" is invalid; cannot be null or blank");
  }
  this.serverName=serverName;
  this.portOffset=portOffset;
  this.startServices=startServices;
  this.updates=updates;
  final Properties properties=new Properties();
  properties.setProperty(ServerEnvironment.SERVER_NAME,serverName);
  String home=SecurityActions.getSystemProperty("jboss.home.dir");
  properties.setProperty(ServerEnvironment.HOME_DIR,home);
  String serverBaseDir=SecurityActions.getSystemProperty("jboss.domain.servers.dir") + File.separatorChar + serverName;
  properties.setProperty(ServerEnvironment.SERVER_BASE_DIR,serverBaseDir);
  properties.setProperty(ServerEnvironment.SERVER_DEPLOY_DIR,serverBaseDir + File.separatorChar + "content");
  properties.setProperty(ServerEnvironment.CONTROLLER_TEMP_DIR,SecurityActions.getSystemProperty("jboss.domain.temp.dir"));
  ProductConfig productConfig=new ProductConfig(Module.getBootModuleLoader(),home);
  providedEnvironment=new ServerEnvironment(hostControllerName,properties,SecurityActions.getSystemEnvironment(),null,ServerEnvironment.LaunchType.DOMAIN,RunningMode.NORMAL,productConfig);
}
