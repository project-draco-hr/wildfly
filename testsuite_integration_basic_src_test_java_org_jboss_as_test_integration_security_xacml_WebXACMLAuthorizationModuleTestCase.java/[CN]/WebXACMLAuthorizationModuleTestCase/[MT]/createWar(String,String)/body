{
  final WebArchive war=ShrinkWrap.create(WebArchive.class,warName).addClasses(SimpleSecuredServlet.class,CustomXACMLAuthorizationModule.class).addAsWebInfResource(new StringAsset("<jboss-web><security-domain>" + domainName + "</security-domain><use-jboss-authorization>true</use-jboss-authorization></jboss-web>"),"jboss-web.xml").addAsWebInfResource(WebXACMLAuthorizationModuleTestCase.class.getPackage(),XACMLTestUtils.TESTOBJECTS_CONFIG + "/web-basic-authn.xml","web.xml").addAsResource(new StringAsset("jduke=theduke\nguest=guest"),"users.properties").addAsResource(new StringAsset("jduke=AuthorizedUser,ServletUserRole\nguest=AuthorizedUser"),"roles.properties").addAsResource(WebXACMLAuthorizationModuleTestCase.class.getPackage(),XACMLTestUtils.TESTOBJECTS_CONFIG + "/jbossxacml-config.xml","jbossxacml-config.xml").addAsResource(WebXACMLAuthorizationModuleTestCase.class.getPackage(),XACMLTestUtils.TESTOBJECTS_POLICIES + "/web-xacml-policy.xml","xacml-policy.xml");
  XACMLTestUtils.addJBossDeploymentStructureToArchive(war);
  LOGGER.info(war.toString(true));
  return war;
}
