{
  if (inUse.decrementAndGet() == 0) {
    if (!cached.get()) {
      ps.close();
    }
 else {
      if (defaultMaxFieldSize != currentMaxFieldSize) {
        ps.setMaxFieldSize(defaultMaxFieldSize);
        currentMaxFieldSize=defaultMaxFieldSize;
      }
      if (defaultMaxRows != currentMaxRows) {
        ps.setMaxRows(defaultMaxRows);
        currentMaxRows=defaultMaxRows;
      }
      if (defaultQueryTimeout != currentQueryTimeout) {
        ps.setQueryTimeout(defaultQueryTimeout);
        currentQueryTimeout=defaultQueryTimeout;
      }
      if (defaultFetchDirection != currentFetchDirection) {
        ps.setFetchDirection(defaultFetchDirection);
        currentFetchDirection=defaultFetchDirection;
      }
      if (defaultFetchSize != currentFetchSize) {
        ps.setFetchSize(defaultFetchSize);
        currentFetchSize=defaultFetchSize;
      }
    }
  }
}
