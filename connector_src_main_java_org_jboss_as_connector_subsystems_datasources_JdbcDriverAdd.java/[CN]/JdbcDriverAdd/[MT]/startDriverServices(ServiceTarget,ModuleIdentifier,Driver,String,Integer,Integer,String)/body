{
  final int majorVer=driver.getMajorVersion();
  final int minorVer=driver.getMinorVersion();
  if ((majorVersion != null && majorVersion.intValue() != majorVer) || (minorVersion != null && minorVersion.intValue() != minorVer)) {
    throw new IllegalStateException("Specified driver version doesn't match with actual driver version");
  }
  final boolean compliant=driver.jdbcCompliant();
  if (compliant) {
    log.infof("Deploying JDBC-compliant driver %s (version %d.%d)",driver.getClass(),Integer.valueOf(majorVer),Integer.valueOf(minorVer));
  }
 else {
    log.infof("Deploying non-JDBC-compliant driver %s (version %d.%d)",driver.getClass(),Integer.valueOf(majorVer),Integer.valueOf(minorVer));
  }
  InstalledDriver driverMetadata=new InstalledDriver(driverName,moduleId,driver.getClass().getName(),xaDataSourceClassName,majorVer,minorVer,compliant);
  DriverService driverService=new DriverService(driverMetadata,driver);
  target.addService(ServiceName.JBOSS.append("jdbc-driver",driverName.replaceAll("\\.","_")),driverService).addDependency(ConnectorServices.JDBC_DRIVER_REGISTRY_SERVICE,DriverRegistry.class,driverService.getDriverRegistryServiceInjector()).setInitialMode(ServiceController.Mode.ACTIVE).install();
}
