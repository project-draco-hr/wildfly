{
  if (commit) {
    activeTx.commit();
  }
 else {
    activeTx.rollback();
  }
  txCompletedLatch.countDown();
  if (error != null) {
    throw new RuntimeException(error);
  }
}
