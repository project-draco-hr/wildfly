{
  LoginModuleConfiguration ldapLoginModule=new LoginModuleConfiguration(){
    public String getName(){
      return "Ldap";
    }
    public String getFlag(){
      return "sufficient";
    }
    public Map<String,String> getOptions(){
      Map<String,String> moduleOptions=new HashMap<String,String>();
      moduleOptions.put("java.naming.factory.initial",INITIAL_CONTEXT_FACTORY);
      moduleOptions.put("java.naming.provider.url",getLDAPProviderUrl(managementClient));
      moduleOptions.put("java.naming.security.authentication",SECURITY_AUTHENTICATION);
      moduleOptions.put("java.naming.security.principal",SECURITY_PRINCIPAL);
      moduleOptions.put("java.naming.security.credentials",SECURITY_CREDENTIALS);
      moduleOptions.put("principalDNPrefix","uid=");
      moduleOptions.put("principalDNSuffix",",ou=People,dc=jboss,dc=org");
      moduleOptions.put("rolesCtxDN","ou=Roles,dc=jboss,dc=org");
      moduleOptions.put("roleAttributeIsDN","false");
      moduleOptions.put("roleAttributeID","cn");
      moduleOptions.put("uidAttributeID","member");
      moduleOptions.put("matchOnUserDN","true");
      return moduleOptions;
    }
  }
;
  return new LoginModuleConfiguration[]{ldapLoginModule};
}
