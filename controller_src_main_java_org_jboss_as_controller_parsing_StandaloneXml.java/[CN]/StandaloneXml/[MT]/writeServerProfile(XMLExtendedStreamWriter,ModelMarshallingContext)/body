{
  ModelNode profileNode=context.getModelNode();
  writer.writeStartElement(Element.PROFILE.getLocalName());
  Set<String> subsystemNames=profileNode.get(SUBSYSTEM).keys();
  if (subsystemNames.size() > 0) {
    String defaultNamespace=writer.getNamespaceContext().getNamespaceURI(XMLConstants.DEFAULT_NS_PREFIX);
    for (    String subsystemName : subsystemNames) {
      try {
        ModelNode subsystem=profileNode.get(SUBSYSTEM,subsystemName);
        XMLElementWriter<SubsystemMarshallingContext> subsystemWriter=context.getSubsystemWriter(subsystemName);
        if (subsystemWriter != null) {
          subsystemWriter.writeContent(writer,new SubsystemMarshallingContext(subsystem,writer));
        }
      }
  finally {
        writer.setDefaultNamespace(defaultNamespace);
      }
    }
  }
  writer.writeEndElement();
}
