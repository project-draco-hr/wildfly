{
  if (f == null) {
    throw new CliInitializationException("The file argument is null.");
  }
  if (!f.exists()) {
    return new CliConfigImpl();
  }
  CliConfigImpl config=new CliConfigImpl();
  BufferedInputStream input=null;
  try {
    final XMLMapper mapper=XMLMapper.Factory.create();
    final XMLElementReader<CliConfigImpl> reader=new CliConfigReader();
    for (    Namespace current : Namespace.cliValues()) {
      if (current != Namespace.CURRENT) {
        mapper.registerRootElement(new QName(current.getUriString(),JBOSS_CLI),reader);
      }
    }
    FileInputStream is=new FileInputStream(f);
    input=new BufferedInputStream(is);
    XMLStreamReader streamReader=XMLInputFactory.newInstance().createXMLStreamReader(input);
    mapper.parseDocument(config,streamReader);
    streamReader.close();
  }
 catch (  Throwable t) {
    throw new CliInitializationException("Failed to parse " + f.getAbsolutePath(),t);
  }
 finally {
    StreamUtils.safeClose(input);
  }
  return config;
}
