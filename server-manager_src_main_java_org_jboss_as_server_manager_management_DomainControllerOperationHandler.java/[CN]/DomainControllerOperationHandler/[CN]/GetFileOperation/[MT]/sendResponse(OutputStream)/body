{
  ByteDataOutput output=null;
  try {
    output=new SimpleByteDataOutput(outputStream);
    output.writeByte(ManagementProtocol.PARAM_NUM_FILES);
    if (localPath == null || !localPath.exists()) {
      output.writeInt(-1);
    }
 else     if (localPath.isFile()) {
      output.writeInt(1);
      writeFile(localPath,output);
    }
 else {
      final List<File> childFiles=getChildFiles(localPath);
      output.writeInt(childFiles.size());
      for (      File child : childFiles) {
        writeFile(child,output);
      }
    }
    output.close();
  }
 catch (  Exception e) {
    throw new ManagementException("Unable to write response to server manager",e);
  }
 finally {
    safeClose(output);
  }
}
