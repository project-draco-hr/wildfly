{
  List<ModelUpdateResponse<?>> responses=new ArrayList<ModelUpdateResponse<?>>(updates.size());
  for (  AbstractDomainModelUpdate<?> update : updates) {
    responses.add(processUpdate(update));
  }
  try {
    output.writeByte(ManagementProtocol.PARAM_APPLY_UPDATES_RESULT_COUNT);
    output.writeInt(responses.size());
    for (    ModelUpdateResponse<?> response : responses) {
      output.writeByte(ManagementProtocol.PARAM_APPLY_UPDATE_RESULT);
      if (response.isSuccess()) {
        output.writeByte(ManagementProtocol.APPLY_UPDATE_RESULT_SUCCESS);
        output.writeByte(ManagementProtocol.PARAM_APPLY_UPDATE_RESULT_RETURN);
        marshal(output,response.getResult());
      }
 else {
        output.writeByte(ManagementProtocol.APPLY_UPDATE_RESULT_FAILURE);
        output.writeByte(ManagementProtocol.PARAM_APPLY_UPDATE_RESULT_EXCEPTION);
        marshal(output,response.getUpdateException());
      }
    }
  }
 catch (  Exception e) {
    throw new ManagementException("Unable to send domain model update response.",e);
  }
}
