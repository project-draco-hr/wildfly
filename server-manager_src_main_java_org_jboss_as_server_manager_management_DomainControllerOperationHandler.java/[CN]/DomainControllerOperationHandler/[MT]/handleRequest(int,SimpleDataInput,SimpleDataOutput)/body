{
  final String serverManagerId;
  try {
    expectHeader(input,ManagementProtocol.PARAM_SERVER_MANAGER_ID);
    serverManagerId=input.readUTF();
  }
 catch (  IOException e) {
    throw new ManagementOperationException("ServerManager Request failed.  Unable to read signature",e);
  }
  final byte commandCode;
  try {
    expectHeader(input,ManagementProtocol.REQUEST_OPERATION);
    commandCode=input.readByte();
  }
 catch (  IOException e) {
    throw new ManagementOperationException("ServerManager Request failed to read command code",e);
  }
  final Operation operation=operationFor(commandCode);
  if (operation == null) {
    throw new ManagementOperationException("Invalid command code " + commandCode + " received from server manager "+ serverManagerId);
  }
  try {
    log.debugf("Received DomainController operation [%s] from ServerManager [%s]",operation,serverManagerId);
    operation.handle(serverManagerId,input,output);
  }
 catch (  Exception e) {
    throw new ManagementOperationException("Failed to execute domain controller operation",e);
  }
}
