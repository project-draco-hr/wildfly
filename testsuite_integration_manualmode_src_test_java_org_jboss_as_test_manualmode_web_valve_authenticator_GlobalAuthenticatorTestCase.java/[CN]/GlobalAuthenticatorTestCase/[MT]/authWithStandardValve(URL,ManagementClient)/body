{
  ValveUtil.createValveModule(client,STANDARD_VALVE_MODULE,getBaseModulePath(STANDARD_VALVE_MODULE),STANDARD_VALVE_JAR,VALVE_CLASS);
  String classicValveName="classicValve";
  ValveUtil.addValve(client,classicValveName,STANDARD_VALVE_MODULE,VALVE_CLASS.getName(),null);
  ValveUtil.reload(client);
  try {
    String appUrl=url.toExternalForm() + WEB_APP_URL_1;
    log.debug("Testing url " + appUrl + " against two valves defined, one standard valve and one global valve authenticator named "+ CUSTOM_AUTHENTICATOR_1);
    Header[] valveHeaders=ValveUtil.hitValve(new URL(appUrl));
    assertEquals("There was one valve defined - it's missing now",2,valveHeaders.length);
    assertEquals("Standard valve with not defined param expecting default param value",DEFAULT_PARAM_VALUE,valveHeaders[0].getValue());
    assertEquals("Authenticator valve with not defined param expecting default param value",AUTH_VALVE_DEFAULT_PARAM_VALUE,valveHeaders[1].getValue());
  }
  finally {
    ValveUtil.removeValve(client,classicValveName);
  }
}
