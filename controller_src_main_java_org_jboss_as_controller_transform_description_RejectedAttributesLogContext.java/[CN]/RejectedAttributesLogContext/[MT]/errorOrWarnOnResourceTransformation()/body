{
  if (op != null) {
    throw new IllegalStateException();
  }
  if (failedAttributes == null) {
    return "";
  }
  final TransformationTarget tgt=context.getContext().getTarget();
  final String legacyHostName=tgt.getHostName();
  final ModelVersion coreVersion=tgt.getVersion();
  final String subsystemName=findSubsystemName(address);
  final ModelVersion usedVersion=subsystemName == null ? coreVersion : tgt.getSubsystemVersion(subsystemName);
  final TransformersLogger logger=context.getContext().getLogger();
  final boolean error=tgt.isIgnoredResourceListAvailableAtRegistration();
  List<String> messages=error ? new ArrayList<String>() : null;
  for (  Map.Entry<String,Map<String,ModelNode>> entry : failedAttributes.entrySet()) {
    RejectAttributeChecker checker=failedCheckers.get(entry.getKey());
    String message=checker.getRejectionLogMessage(entry.getValue());
    if (error) {
      messages.add(message);
    }
 else {
      return logger.getAttributeWarning(address,op,message,entry.getValue().keySet());
    }
  }
  if (error) {
    if (subsystemName != null) {
      throw ControllerMessages.MESSAGES.rejectAttributesSubsystemModelResourceTransformer(address,legacyHostName,subsystemName,usedVersion,messages);
    }
    throw ControllerMessages.MESSAGES.rejectAttributesCoreModelResourceTransformer(address,legacyHostName,usedVersion,messages);
  }
  return null;
}
