{
  this.nodeFactory=config.getNodeFactory();
  this.marshallingContext=config.getMarshallingContext();
  this.timeout=config.getTimeout();
  final RpcDispatcher.Marshaller marshaller=new CommandResponseMarshaller(config);
  this.dispatcher=new MessageDispatcher(){
    @Override protected RequestCorrelator createRequestCorrelator(    Protocol transport,    RequestHandler handler,    Address localAddr){
      RequestCorrelator correlator=super.createRequestCorrelator(transport,handler,localAddr);
      correlator.setMarshaller(marshaller);
      return correlator;
    }
  }
;
  this.dispatcher.setChannel(config.getChannel());
  this.dispatcher.setRequestHandler(this);
  this.dispatcher.setMembershipListener(this);
  this.dispatcher.start();
}
