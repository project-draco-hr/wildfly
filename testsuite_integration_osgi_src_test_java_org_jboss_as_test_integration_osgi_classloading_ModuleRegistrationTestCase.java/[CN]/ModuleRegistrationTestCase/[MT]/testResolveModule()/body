{
  InputStream inputA=deployer.getDeployment(BUNDLE_A);
  Bundle bundleA=context.installBundle(BUNDLE_A,inputA);
  try {
    FrameworkWiring fwkWiring=context.getBundle().adapt(FrameworkWiring.class);
    assertTrue(fwkWiring.resolveBundles(Collections.singleton(bundleA)));
    BundleWiring wiringA=bundleA.adapt(BundleWiring.class);
    List<BundleWire> wires=wiringA.getRequiredWires(PACKAGE_NAMESPACE);
    assertEquals(1,wires.size());
    BundleWire wire=wires.get(0);
    assertEquals(bundleA,wire.getRequirer().getBundle());
    XBundleRevision provider=(XBundleRevision)wire.getProvider();
    XIdentityCapability icap=provider.getIdentityCapability();
    assertEquals("deployment.example-module-reg",icap.getSymbolicName());
  }
  finally {
    bundleA.uninstall();
  }
}
