{
  controller.start(SERVER);
  try {
    ModelControllerClient client=TestSuiteEnvironment.getModelControllerClient();
    ModelNode rr=Util.createEmptyOperation(READ_RESOURCE_OPERATION,PathAddress.EMPTY_ADDRESS);
    rr.get(INCLUDE_RUNTIME).set(true);
    rr.get(RECURSIVE).set(true);
    ModelNode result=ModelTestUtils.checkResultAndGetContents(client.execute(rr));
    Assert.assertTrue(result.hasDefined(SUBSYSTEM,"messaging-activemq"));
    Assert.assertTrue(result.hasDefined(SUBSYSTEM,"jgroups"));
    ServerReload.executeReloadAndWaitForCompletion(client,true);
    result=ModelTestUtils.checkResultAndGetContents(client.execute(rr));
  }
  finally {
    if (controller.isStarted(SERVER)) {
      controller.stop(SERVER);
    }
  }
}
