{
synchronized (stateLock) {
    if (destroyed) {
      Logger log=getLog();
      if (log.isTraceEnabled())       log.trace("Not broadcasting error, already destroyed " + this,e);
      return;
    }
  }
  Exception ex=null;
  if (e instanceof Exception) {
    ex=(Exception)e;
  }
 else {
    ex=new ResourceAdapterInternalException("Unexpected error",e);
  }
  ConnectionEvent ce=new ConnectionEvent(this,ConnectionEvent.CONNECTION_ERROR_OCCURRED,ex);
  Collection<ConnectionEventListener> copy=null;
synchronized (cels) {
    copy=new ArrayList<ConnectionEventListener>(cels);
  }
  for (Iterator<ConnectionEventListener> i=copy.iterator(); i.hasNext(); ) {
    ConnectionEventListener cel=i.next();
    try {
      cel.connectionErrorOccurred(ce);
    }
 catch (    Throwable t) {
      getLog().warn("Error notifying of connection error for listener: " + cel,t);
    }
  }
}
