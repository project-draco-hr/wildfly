{
  final ComponentNamingMode namingMode=componentConfiguration.getComponentDescription().getNamingMode();
  final String lookupName;
  if (!this.lookupName.startsWith("java:")) {
    if (namingMode == ComponentNamingMode.CREATE) {
      lookupName="java:comp/env/" + this.lookupName;
    }
 else {
      lookupName="java:module/env/" + this.lookupName;
    }
  }
 else   if (this.lookupName.startsWith("java:comp/") && namingMode == ComponentNamingMode.USE_MODULE) {
    lookupName="java:module/" + this.lookupName.substring(10);
  }
 else {
    lookupName=this.lookupName;
  }
  final ServiceName serviceName=ContextNames.serviceNameOfContext(componentConfiguration.getApplicationName(),componentConfiguration.getModuleName(),componentConfiguration.getComponentName(),lookupName);
  serviceBuilder.addDependency(serviceName,ManagedReferenceFactory.class,injector);
}
