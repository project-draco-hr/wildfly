{
  final BatchBuilder batchBuilder=serviceContainer.batchBuilder();
  final CountDownLatch latch=new CountDownLatch(1);
  final AtomicBoolean completed=new AtomicBoolean(false);
  final TestBeanListener listener=new TestBeanListener(new Runnable(){
    public void run(){
      completed.set(true);
      latch.countDown();
    }
  }
);
  batchBuilder.addListener(listener);
  work.execute(batchBuilder,serviceContainer);
  batchBuilder.install();
  listener.finishBatch();
  latch.await(5L,TimeUnit.SECONDS);
  if (!completed.get())   fail("Did not install deployment within 5 seconds.");
}
