{
  try {
    Configuration configuration=new Configuration().setProperty(AvailableSettings.USE_NEW_ID_GENERATOR_MAPPINGS,"true");
    configuration.getProperties().put(AvailableSettings.JTA_PLATFORM,JBossAppServerJtaPlatform.class);
    configuration.setProperty(Environment.HBM2DDL_AUTO,"create-drop");
    configuration.setProperty(Environment.DATASOURCE,"java:jboss/datasources/ExampleDS");
    Properties properties=new Properties();
    configuration=configuration.configure("hibernate.cfg.xml");
    properties.putAll(configuration.getProperties());
    Environment.verifyProperties(properties);
    ConfigurationHelper.resolvePlaceHolders(properties);
    StandardServiceRegistryBuilder registry=new StandardServiceRegistryBuilder().applySettings(properties);
    sessionFactory=configuration.buildSessionFactory(registry.build());
    SessionFactoryImplementor sfi=(SessionFactoryImplementor)sessionFactory;
    MetamodelImpl.buildMetamodel(configuration.getClassMappings(),sfi);
    sessionFactory.getStatistics().setStatisticsEnabled(true);
  }
 catch (  Throwable ex) {
    System.err.println("Initial SessionFactory creation failed." + ex);
    throw new ExceptionInInitializerError(ex);
  }
}
