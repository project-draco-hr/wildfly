{
  final ModelNode address=operation.get(OP_ADDR);
  final String name=address.get(address.asInt() - 1).asString();
  final String bindingRef=operation.get(REQUEST_PROPERTIES).require(SOCKET_BINDING).asString();
  final ModelNode compensatingOperation=new ModelNode();
  compensatingOperation.get(OP).set(REMOVE);
  compensatingOperation.get(OP_ADDR).set(address);
  if (context instanceof NewRuntimeOperationContext) {
    final NewRuntimeOperationContext runtimeContext=(NewRuntimeOperationContext)context;
    final boolean enabled=operation.get(REQUEST_PROPERTIES).has(ENABLED) ? operation.get(REQUEST_PROPERTIES,ENABLED).asBoolean() : true;
    final WebConnectorService service=new WebConnectorService(operation.get(REQUEST_PROPERTIES).require(PROTOCOL).asString(),operation.get(REQUEST_PROPERTIES,SCHEME).asString());
    if (operation.get(REQUEST_PROPERTIES).has(SECURE))     service.setSecure(operation.get(REQUEST_PROPERTIES,SECURE).asBoolean());
    if (operation.get(ENABLE_LOOKUPS).has(ENABLE_LOOKUPS))     service.setEnableLookups(operation.get(REQUEST_PROPERTIES,ENABLE_LOOKUPS).asBoolean());
    if (operation.get(REQUEST_PROPERTIES).has(PROXY_NAME))     service.setProxyName(operation.get(REQUEST_PROPERTIES,PROXY_NAME).asString());
    if (operation.get(REQUEST_PROPERTIES).has(PROXY_PORT))     service.setProxyPort(operation.get(REQUEST_PROPERTIES,PROXY_PORT).asInt());
    if (operation.get(REQUEST_PROPERTIES).has(REDIRECT_PORT))     service.setRedirectPort(operation.get(REQUEST_PROPERTIES,REDIRECT_PORT).asInt());
    if (operation.get(REQUEST_PROPERTIES).has(MAX_POST_SIZE))     service.setMaxPostSize(operation.get(REQUEST_PROPERTIES,MAX_POST_SIZE).asInt());
    if (operation.get(REQUEST_PROPERTIES).has(MAX_SAVE_POST_SIZE))     service.setMaxSavePostSize(operation.get(REQUEST_PROPERTIES,MAX_SAVE_POST_SIZE).asInt());
    runtimeContext.getServiceTarget().addService(WebSubsystemElement.JBOSS_WEB_CONNECTOR.append(name),service).addDependency(WebSubsystemElement.JBOSS_WEB,WebServer.class,service.getServer()).addDependency(SocketBinding.JBOSS_BINDING_NAME.append(bindingRef),SocketBinding.class,service.getBinding()).setInitialMode(enabled ? Mode.ACTIVE : Mode.NEVER).install();
  }
  final ModelNode subModel=context.getSubModel();
  if (operation.get(REQUEST_PROPERTIES).has(SECURE))   subModel.get(SECURE).set(operation.get(REQUEST_PROPERTIES,SECURE).asBoolean());
  if (operation.get(ENABLE_LOOKUPS).has(ENABLE_LOOKUPS))   subModel.get(ENABLE_LOOKUPS).set(operation.get(REQUEST_PROPERTIES,ENABLE_LOOKUPS).asBoolean());
  if (operation.get(REQUEST_PROPERTIES).has(PROXY_NAME))   subModel.get(PROXY_NAME).set(operation.get(REQUEST_PROPERTIES,PROXY_NAME).asString());
  if (operation.get(REQUEST_PROPERTIES).has(PROXY_PORT))   subModel.get(PROXY_PORT).set(operation.get(REQUEST_PROPERTIES,PROXY_PORT).asInt());
  if (operation.get(REQUEST_PROPERTIES).has(REDIRECT_PORT))   subModel.get(REDIRECT_PORT).set(operation.get(REQUEST_PROPERTIES,REDIRECT_PORT).asInt());
  if (operation.get(REQUEST_PROPERTIES).has(MAX_POST_SIZE))   subModel.get(MAX_POST_SIZE).set(operation.get(REQUEST_PROPERTIES,MAX_POST_SIZE).asInt());
  if (operation.get(REQUEST_PROPERTIES).has(MAX_SAVE_POST_SIZE))   subModel.get(MAX_SAVE_POST_SIZE).set(operation.get(REQUEST_PROPERTIES,MAX_SAVE_POST_SIZE).asInt());
  resultHandler.handleResultComplete(compensatingOperation);
  return Cancellable.NULL;
}
