{
  final CompositeIndex compositeIndex=deploymentUnit.getAttachment(Attachments.COMPOSITE_ANNOTATION_INDEX);
  if (compositeIndex == null) {
    log.infof("Cannot find composite annotation index in: %s",deploymentUnit);
    return null;
  }
  final DotName runWithName=DotName.createSimple(RunWith.class.getName());
  final List<AnnotationInstance> instances=compositeIndex.getAnnotations(runWithName);
  if (instances.isEmpty()) {
    log.infof("Cannot find @RunWith annotation in: %s",deploymentUnit);
    return null;
  }
  log.infof("Arquillian test deployment detected: %s",deploymentUnit);
  ArquillianConfig arqConfig=new ArquillianConfig(serviceName,deploymentUnit);
  deploymentUnit.putAttachment(ArquillianConfig.KEY,arqConfig);
  for (  AnnotationInstance instance : instances) {
    final AnnotationTarget target=instance.target();
    if (target instanceof ClassInfo) {
      final ClassInfo classInfo=(ClassInfo)target;
      final String testClassName=classInfo.name().toString();
      arqConfig.addTestClass(testClassName);
    }
  }
  return arqConfig;
}
