{
  if (exchange instanceof HttpsExchange) {
    HttpsExchange httpsExch=(HttpsExchange)exchange;
    SSLSession session=httpsExch.getSSLSession();
    if (session != null) {
      try {
        Principal p=session.getPeerPrincipal();
        return new Success(new HttpPrincipal(p.getName(),realm));
      }
 catch (      SSLPeerUnverifiedException e) {
      }
    }
  }
  return new Failure(FORBIDDEN);
}
