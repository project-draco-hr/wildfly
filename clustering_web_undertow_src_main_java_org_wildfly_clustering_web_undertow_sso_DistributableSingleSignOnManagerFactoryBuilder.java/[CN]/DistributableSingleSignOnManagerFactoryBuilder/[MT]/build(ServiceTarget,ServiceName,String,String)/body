{
  Builder<SSOManagerFactory<AuthenticatedSession,String,Batch>> factoryBuilder=this.provider.getBuilder(hostName);
  Builder<SessionManagerRegistry> registryBuilder=new SessionManagerRegistryBuilder(serverName,hostName);
  for (  Builder<?> builder : Arrays.asList(factoryBuilder,registryBuilder)) {
    builder.build(target).install();
  }
  return target.addService(name,new ValueService<>(this)).addDependency(factoryBuilder.getServiceName(),SSOManagerFactory.class,this.manager).addDependency(registryBuilder.getServiceName(),SessionManagerRegistry.class,this.registry).setInitialMode(ServiceController.Mode.ON_DEMAND);
}
