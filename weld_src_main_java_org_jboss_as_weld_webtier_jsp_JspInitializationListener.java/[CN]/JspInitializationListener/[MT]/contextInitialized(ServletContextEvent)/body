{
  if (beanManager != null) {
    JspApplicationContext jspAppContext=JspFactory.getDefaultFactory().getJspApplicationContext(sce.getServletContext());
    jspAppContext.addELResolver(beanManager.getELResolver());
    jspAppContext.addELContextListener(Reflections.<ELContextListener>newInstance("org.jboss.weld.el.WeldELContextListener",getClass().getClassLoader()));
    JspApplicationContextImpl wrappedJspApplicationContextImpl=new WeldJspApplicationContextImpl(JspApplicationContextImpl.getInstance(sce.getServletContext()),beanManager.wrapExpressionFactory(jspAppContext.getExpressionFactory()));
    sce.getServletContext().setAttribute(JspApplicationContextImpl.class.getName(),wrappedJspApplicationContextImpl);
  }
}
