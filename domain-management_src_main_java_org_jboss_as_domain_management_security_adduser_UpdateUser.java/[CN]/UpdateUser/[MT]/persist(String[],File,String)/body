{
  final PropertiesFileLoader propertiesHandler=realm == null ? new PropertiesFileLoader(file.getAbsolutePath()) : new UserPropertiesFileLoader(file.getAbsolutePath());
  try {
    propertiesHandler.start(null);
    if (realm != null) {
      ((UserPropertiesFileLoader)propertiesHandler).setRealmName(realm);
    }
    Properties prob=propertiesHandler.getProperties();
    prob.setProperty(entry[0],entry[1]);
    if (entry.length > 2) {
      prob.setProperty(entry[0] + "!disable",entry[2]);
    }
    propertiesHandler.persistProperties();
  }
 catch (  StartException e) {
    throw new IllegalStateException(MESSAGES.unableToUpdateUser(file.getAbsolutePath(),e.getMessage()));
  }
 finally {
    propertiesHandler.stop(null);
  }
}
