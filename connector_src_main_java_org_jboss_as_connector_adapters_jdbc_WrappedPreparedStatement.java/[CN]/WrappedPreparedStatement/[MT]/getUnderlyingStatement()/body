{
  lock();
  try {
    checkState();
    if (ps instanceof CachedPreparedStatement) {
      return ((CachedPreparedStatement)ps).getUnderlyingPreparedStatement();
    }
 else {
      return ps;
    }
  }
  finally {
    unlock();
  }
}
