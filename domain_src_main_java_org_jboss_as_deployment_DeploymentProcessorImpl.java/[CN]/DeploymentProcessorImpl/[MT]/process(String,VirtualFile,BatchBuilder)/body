{
  final DeploymentUnitContextImpl context=new DeploymentUnitContextImpl(name,deploymentRoot);
  final ServiceName deploymentUnitServiceName=DeploymentUnitContext.JBOSS_DEPLOYMENT_UNIT.append(name);
  try {
    batchBuilder.addService(deploymentUnitServiceName,Service.NULL);
  }
 catch (  DuplicateServiceException e) {
    throw new DeploymentUnitProcessingException(e,new Location(e.getStackTrace()[0].getFileName(),e.getStackTrace()[0].getLineNumber(),-1,null));
  }
  final DeploymentChain deploymentChain=this.deploymentChain;
  deploymentChain.processDeployment(context);
  batchBuilder.addDependency(deploymentUnitServiceName);
  final Collection<DeploymentItem> deploymentItems=context.getDeploymentItems();
  for (  DeploymentItem deploymentItem : deploymentItems) {
    deploymentItem.install(batchBuilder);
  }
}
