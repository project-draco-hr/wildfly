{
  if (current != null) {
    return current;
  }
  final URL resourceUrl=getClass().getClassLoader().getResource("META-INF/org.jboss.as.managementConnectionProps");
  if (resourceUrl != null) {
    InputStream in=null;
    String managementPort;
    String address;
    String protocol;
    try {
      in=resourceUrl.openStream();
      ObjectInputStream inputStream=new ObjectInputStream(in);
      managementPort=(String)inputStream.readObject();
      address=(String)inputStream.readObject();
      protocol=(String)inputStream.readObject();
      if (address == null) {
        address="localhost";
      }
      if (managementPort == null) {
        managementPort="9990";
      }
      if (protocol == null) {
        protocol="http-remoting";
      }
      ModelControllerClient modelControllerClient=null;
      final int port=Integer.parseInt(managementPort);
      modelControllerClient=ModelControllerClient.Factory.create(protocol,address,port,getCallbackHandler());
      current=new ManagementClient(modelControllerClient,address,port,protocol);
    }
 catch (    IOException e) {
      throw new RuntimeException(e);
    }
catch (    ClassNotFoundException e) {
      throw new RuntimeException(e);
    }
 finally {
      if (in != null) {
        try {
          in.close();
        }
 catch (        IOException e) {
        }
      }
    }
  }
  return current;
}
