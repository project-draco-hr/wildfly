{
  final ModelNode result=new ModelNode();
  final PathAddress rootAddress=PathAddress.pathAddress(PathAddress.pathAddress(operation.require(ModelDescriptionConstants.OP_ADDR)).getLastElement());
  final ModelNode subModel=context.getSubModel();
  result.add(JGroupsSubsystemAdd.createOperation(rootAddress.toModelNode(),subModel));
  if (subModel.hasDefined(ModelKeys.STACK)) {
    for (    final Property stack : subModel.get(ModelKeys.STACK).asPropertyList()) {
      final ModelNode address=rootAddress.toModelNode();
      address.add(ModelKeys.STACK,stack.getName());
      result.add(ProtocolStackAdd.createOperation(address,stack.getValue()));
    }
  }
  resultHandler.handleResultFragment(Util.NO_LOCATION,result);
  resultHandler.handleResultComplete();
  return new BasicOperationResult();
}
