{
  Thread.sleep(1000);
  long start=System.currentTimeMillis();
  long now;
  do {
    final ModelControllerClient client=newModelControllerClient();
    ModelNode operation=new ModelNode();
    operation.get(OP_ADDR).setEmptyList();
    operation.get(OP).set(READ_ATTRIBUTE_OPERATION);
    operation.get(NAME).set("server-state");
    try {
      ModelNode result=client.execute(operation);
      boolean normal="running".equals(result.get(RESULT).asString());
      if (normal) {
        return;
      }
    }
 catch (    Exception e) {
    }
 finally {
      client.close();
    }
    try {
      Thread.sleep(500);
    }
 catch (    InterruptedException e) {
    }
    now=System.currentTimeMillis();
  }
 while (now - start < timeout);
  throw new Exception("Server did not restart!");
}
