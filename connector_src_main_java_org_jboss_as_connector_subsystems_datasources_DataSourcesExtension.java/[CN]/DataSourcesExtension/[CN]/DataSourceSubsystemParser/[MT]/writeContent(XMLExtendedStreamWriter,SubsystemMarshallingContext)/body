{
  context.startSubsystemElement(Namespace.CURRENT.getUriString(),false);
  ModelNode node=context.getModelNode();
  writer.writeStartElement(DATASOURCES);
  if (node.hasDefined(DATA_SOURCE) || node.hasDefined(XA_DATASOURCE)) {
    boolean isXADataSource=false;
    if (node.hasDefined(DATA_SOURCE)) {
      writeDS(writer,false,node.get(DATA_SOURCE).asPropertyList());
    }
    if (node.hasDefined(XA_DATASOURCE)) {
      writeDS(writer,true,node.get(XA_DATASOURCE).asPropertyList());
    }
  }
  if (node.hasDefined(JDBC_DRIVER_NAME)) {
    writer.writeStartElement(DataSources.Tag.DRIVERS.getLocalName());
    for (    Property driverProperty : node.get(JDBC_DRIVER_NAME).asPropertyList()) {
      writer.writeStartElement(DataSources.Tag.DRIVER.getLocalName());
      writer.writeAttribute(Driver.Attribute.NAME.getLocalName(),driverProperty.getValue().require(DRIVER_NAME.getName()).asString());
      if (has(driverProperty.getValue(),DRIVER_MODULE_NAME.getName())) {
        String moduleName=driverProperty.getValue().get(DRIVER_MODULE_NAME.getName()).asString();
        if (has(driverProperty.getValue(),MODULE_SLOT.getName())) {
          moduleName=moduleName + ":" + driverProperty.getValue().get(MODULE_SLOT.getName()).asString();
        }
        writer.writeAttribute(Driver.Attribute.MODULE.getLocalName(),moduleName);
      }
      writeAttributeIfHas(writer,driverProperty.getValue(),Driver.Attribute.MAJOR_VERSION,DRIVER_MAJOR_VERSION.getName());
      writeAttributeIfHas(writer,driverProperty.getValue(),Driver.Attribute.MINOR_VERSION,DRIVER_MINOR_VERSION.getName());
      writeElementIfHas(writer,driverProperty.getValue(),Driver.Tag.DRIVER_CLASS.getLocalName(),DRIVER_CLASS_NAME.getName());
      writeElementIfHas(writer,driverProperty.getValue(),Driver.Tag.XA_DATASOURCE_CLASS.getLocalName(),DRIVER_XA_DATASOURCE_CLASS_NAME.getName());
      writeElementIfHas(writer,driverProperty.getValue(),Driver.Tag.DATASOURCE_CLASS.getLocalName(),DRIVER_DATASOURCE_CLASS_NAME.getName());
      writer.writeEndElement();
    }
    writer.writeEndElement();
  }
  writer.writeEndElement();
  writer.writeEndElement();
}
