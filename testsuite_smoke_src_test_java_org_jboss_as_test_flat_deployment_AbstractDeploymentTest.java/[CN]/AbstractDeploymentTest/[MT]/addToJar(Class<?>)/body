{
  assertNotNull("managedbeans.jar exists",managedBeansJar);
  String classDir=cls.getPackage().getName().replace('.','/');
  URL classDirURL=Thread.currentThread().getContextClassLoader().getResource(classDir);
  assertNotNull("support package is built",classDirURL);
  File classFile=new File(classDirURL.getFile(),cls.getSimpleName() + ".class");
  assertTrue(cls.getName() + " is found in " + classDirURL.getFile(),classFile.exists());
  String pkg=cls.getPackage().getName();
  String path=pkg.replace('.','/');
  File targetFile=new File(managedBeansJar.getFile(),path);
  targetFile.mkdirs();
  targetFile=new File(targetFile,cls.getSimpleName() + ".class");
  FileInputStream fis=null;
  FileOutputStream fos=null;
  try {
    fis=new FileInputStream(classFile);
    fos=new FileOutputStream(targetFile);
    byte[] bytes=new byte[fis.available()];
    int read=fis.read(bytes);
    while (read > 0) {
      fos.write(bytes,0,read);
      read=fis.read(bytes);
    }
  }
 catch (  Exception e) {
    fail("Failed to copy " + classFile.getAbsolutePath() + " to "+ targetFile.getAbsolutePath()+ ": "+ e);
  }
 finally {
    if (fis != null)     try {
      fis.close();
    }
 catch (    IOException e) {
    }
    if (fos != null)     try {
      fos.close();
    }
 catch (    IOException e) {
    }
  }
  assertTrue(targetFile.getAbsoluteFile() + " exists",targetFile.exists());
}
