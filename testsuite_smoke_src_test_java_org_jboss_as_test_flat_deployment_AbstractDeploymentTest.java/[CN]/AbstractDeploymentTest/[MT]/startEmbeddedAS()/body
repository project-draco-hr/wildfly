{
  DeploymentManagerProvider service=new DeploymentManagerProvider();
  StandaloneServer server=TestServerFactory.createServer("embedded");
  try {
    server.start(Collections.<ServiceActivator>singletonList(service));
  }
 catch (  ServerStartException e) {
    e.printStackTrace();
    fail("Failed to start embedded server.");
  }
synchronized (service) {
    try {
      service.wait(5000);
    }
 catch (    InterruptedException e) {
    }
  }
  assertTrue("Deployment manager provider started.",service.isStarted());
  ServerDeploymentManager deploymentManager=service.getDeploymentManager();
  assertNotNull(deploymentManager);
  return deploymentManager;
}
