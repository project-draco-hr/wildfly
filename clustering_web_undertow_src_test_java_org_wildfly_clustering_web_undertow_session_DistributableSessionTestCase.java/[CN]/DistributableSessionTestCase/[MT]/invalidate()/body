{
  HttpServerExchange exchange=new HttpServerExchange(null);
  SessionManager<LocalSessionContext> manager=mock(SessionManager.class);
  SessionListener listener=mock(SessionListener.class);
  SessionListeners listeners=new SessionListeners();
  listeners.addSessionListener(listener);
  String sessionId="session";
  when(this.manager.getSessionListeners()).thenReturn(listeners);
  when(this.session.getId()).thenReturn(sessionId);
  when(this.manager.getSessionManager()).thenReturn(manager);
  this.adapter.invalidate(exchange);
  verify(this.session).invalidate();
  verify(this.config).clearSession(exchange,sessionId);
  verify(listener).sessionDestroyed(this.adapter,exchange,SessionDestroyedReason.INVALIDATED);
  verify(this.batch).close();
}
