{
  if (securityDomain == null) {
    return;
  }
  ApplicationPolicy applicationPolicy=SecurityConfiguration.getApplicationPolicy(this.securityDomain);
  if (applicationPolicy != null && JASPIAuthenticationInfo.class.isInstance(applicationPolicy.getAuthenticationInfo())) {
    String authMethod=null;
    LoginConfig loginConfig=deploymentInfo.getLoginConfig();
    if (loginConfig != null && loginConfig.getAuthMethods().size() > 0)     authMethod=loginConfig.getAuthMethods().get(0).getName();
    deploymentInfo.addSecurityWrapper(new HandlerWrapper(){
      @Override public HttpHandler wrap(      HttpHandler handler){
        return new JASPICInitialHandler(securityDomain,handler);
      }
    }
);
    deploymentInfo.setJaspiAuthenticationMechanism(new JASPIAuthenticationMechanism(authMethod,securityDomain));
    deploymentInfo.setSecurityContextFactory(new JASPICSecurityContextFactory(this.securityDomain));
  }
}
