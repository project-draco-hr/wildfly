{
  if (messageInputStream == null) {
    throw new IllegalArgumentException("Cannot read from null message inputstream");
  }
  final DataInputStream dataInputStream=new DataInputStream(messageInputStream);
  final short invocationId=dataInputStream.readShort();
  final String appName=dataInputStream.readUTF();
  final String moduleName=dataInputStream.readUTF();
  final String distinctName=dataInputStream.readUTF();
  final String beanName=dataInputStream.readUTF();
  final EjbDeploymentInformation ejbDeploymentInformation=this.findEJB(appName,moduleName,distinctName,beanName);
  if (ejbDeploymentInformation == null) {
    this.writeNoSuchEJBFailureMessage(channel,invocationId,appName,moduleName,distinctName,beanName,null);
    return;
  }
  final Component component=ejbDeploymentInformation.getEjbComponent();
  if (!(component instanceof StatefulSessionComponent)) {
    final String failureMessage="EJB " + beanName + " is not a Stateful Session bean in app: "+ appName+ " module: "+ moduleName+ " distinct name:"+ distinctName;
    this.writeInvocationFailure(channel,HEADER_EJB_NOT_STATEFUL,invocationId,failureMessage);
    return;
  }
  final StatefulSessionComponent statefulSessionComponent=(StatefulSessionComponent)component;
  executorService.submit(new SessionIDGeneratorTask(statefulSessionComponent,channel,invocationId));
}
