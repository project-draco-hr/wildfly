{
  DeploymentUtils utils=null;
  final ModelControllerClient client=ModelControllerClient.Factory.create(InetAddress.getByName("localhost"),9999);
  try {
    utils=new DeploymentUtils();
    utils.addWarDeployment("war-example.war",true,SimpleServlet.class.getPackage());
    utils.deploy();
    createTestConnector(client);
    URLConnection conn=null;
    InputStream in=null;
    try {
      URL url=new URL("http://localhost:8380/war-example/simple?input=Hello");
      System.out.println("Reading response from " + url + ":");
      conn=url.openConnection();
      conn.setDoInput(true);
      in=new BufferedInputStream(conn.getInputStream());
      int i=in.read();
      while (i != -1) {
        System.out.print((char)i);
        i=in.read();
      }
      System.out.println("");
    }
  finally {
      safeClose(in);
    }
    removeTestConnector(client);
  }
  finally {
    utils.undeploy();
    safeClose(utils);
    safeClose(client);
  }
}
