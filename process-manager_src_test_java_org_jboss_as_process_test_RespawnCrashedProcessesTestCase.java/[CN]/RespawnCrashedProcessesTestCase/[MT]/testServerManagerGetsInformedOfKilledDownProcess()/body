{
  addProcess("ServerManager",CaptureDownFromPmProcess.class);
  TestProcessListenerStream smListener=startTestProcessListenerAndWait("ServerManager");
  addProcess("Down",CrashingProcess.class);
  startTestProcessListenerAndWait("Down");
  ProcessExitCodeAndShutDownLatch stopLatch=getStopTestProcessListenerLatch("Down");
  detachTestProcessListener("Down");
  killProcess("Down",CrashingProcess.class);
  assertTrue(stopLatch.await(1000,TimeUnit.MILLISECONDS));
  assertTrue(0 != stopLatch.getExitCode());
  assertEquals("Down is down",smListener.readMessage());
  stopTestProcessListenerAndWait(smListener);
  removeProcess("ServerManager");
}
