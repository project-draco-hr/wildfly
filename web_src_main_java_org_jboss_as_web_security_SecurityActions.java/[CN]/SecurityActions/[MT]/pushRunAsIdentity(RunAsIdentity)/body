{
  AccessController.doPrivileged(new PrivilegedAction<Void>(){
    @Override public Void run(){
      SecurityContext sc=getSecurityContext();
      if (sc == null)       throw new IllegalStateException("SecurityContext is null");
      sc.setOutgoingRunAs(principal);
      return null;
    }
  }
);
}
