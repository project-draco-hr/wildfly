{
  return AccessController.doPrivileged(new PrivilegedAction<RunAs>(){
    @Override public RunAs run(){
      SecurityContext sc=getSecurityContext();
      if (sc == null)       throw new IllegalStateException("SecurityContext is null");
      RunAs principal=sc.getOutgoingRunAs();
      sc.setOutgoingRunAs(null);
      return principal;
    }
  }
);
}
