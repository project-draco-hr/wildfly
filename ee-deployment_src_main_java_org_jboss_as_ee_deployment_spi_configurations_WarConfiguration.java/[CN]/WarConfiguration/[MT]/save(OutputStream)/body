{
  JarOutputStream jos;
  DeploymentMetaData metaData=new DeploymentMetaData("WRONG.war");
  try {
    jos=new JarOutputStream(stream);
  }
 catch (  Exception e) {
    return;
  }
  if (jos == null)   return;
  Iterator setIterator=configBeans.keySet().iterator();
  while (setIterator.hasNext()) {
    String key=(String)setIterator.next();
    JBossConfigBeanProxy val=(JBossConfigBeanProxy)configBeans.get(key);
    val.save(jos,metaData);
  }
  String metaStr=metaData.toXMLString();
  try {
    JarUtils.addJarEntry(jos,DeploymentMetaData.ENTRY_NAME,new ByteArrayInputStream(metaStr.getBytes()));
    jos.flush();
    jos.close();
  }
 catch (  Exception e) {
    DeploymentLogger.ROOT_LOGGER.cannotSaveDeploymentPlanEntry(e,metaStr);
  }
}
