{
  boolean successExpected=isWriteAllowed(userName);
  MBeanServerConnection connection=jmx.getConnection();
  ObjectName domain=new ObjectName("java.lang:type=Memory");
  try {
    connection.setAttribute(domain,new Attribute("Verbose",true));
    connection.setAttribute(domain,new Attribute("Verbose",false));
    assertTrue("Failure was expected",successExpected);
  }
 catch (  JMRuntimeException e) {
    if (e.getMessage().contains("WFLYJMX0037")) {
      assertFalse("Success was expected but failure happened: " + e,successExpected);
    }
 else {
      throw e;
    }
  }
}
