{
  final MockModelController controller=new MockModelController(){
    @Override public ModelNode execute(    ModelNode operation,    OperationMessageHandler handler,    OperationTransactionControl control,    OperationAttachments attachments){
      ModelNode result=new ModelNode();
      result.get("testing").set(operation.get("test"));
      return result;
    }
  }
;
  final ModelControllerClient client=setupTestClient(controller);
  try {
    final ModelNode op=new ModelNode();
    final TestEntry entry=new TestEntry();
    final Operation operation=OperationBuilder.create(op).addInputStream(entry).build();
    client.execute(operation);
    entry.latch.await();
    Assert.assertTrue(entry.closed);
  }
  finally {
    IoUtils.safeClose(client);
  }
}
