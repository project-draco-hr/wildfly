{
  final int requestId=this.requestId++;
  Socket socket=null;
  try {
    socket=new Socket();
    final int timeout=(int)TimeUnit.SECONDS.toMillis(connectTimeout);
    socket.connect(new InetSocketAddress(address,port),timeout);
    socket.setSoTimeout(timeout);
    final ByteDataInput input=new SimpleByteDataInput(socket.getInputStream());
    final ByteDataOutput output=new SimpleByteDataOutput(socket.getOutputStream());
    final ManagementRequestHeader managementRequestHeader=new ManagementRequestHeader(ManagementProtocol.VERSION,requestId,getHandlerId());
    managementRequestHeader.write(output);
    output.flush();
    final ManagementResponseHeader responseHeader=new ManagementResponseHeader(input);
    if (requestId != responseHeader.getResponseId()) {
      safeClose(socket);
      return;
    }
    Future<T> resultFuture=executorService.submit(new ExecuteTask<T>(request,responseHeader.getVersion(),socket,input,output));
    initiatingFuture.set(resultFuture);
  }
 catch (  Throwable e) {
    safeClose(socket);
    if (requestId < connectionRetryLimit) {
      executorService.schedule(this,connectionRetryInterval,TimeUnit.SECONDS);
    }
 else {
      initiatingFuture.setException(new ManagementException("Failed to initiate request to remote domain controller",e));
    }
  }
}
