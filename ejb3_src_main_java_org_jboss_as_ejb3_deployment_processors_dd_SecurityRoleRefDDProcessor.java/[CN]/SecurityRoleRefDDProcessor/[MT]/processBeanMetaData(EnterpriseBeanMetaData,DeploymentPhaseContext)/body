{
  SecurityRoleRefsMetaData securityRoles=null;
  if (beanMetaData instanceof SessionBeanMetaData) {
    securityRoles=((SessionBeanMetaData)beanMetaData).getSecurityRoleRefs();
  }
 else   if (beanMetaData instanceof MessageDrivenBeanMetaData) {
    logger.warn("security-role-ref for message driven beans isn't yet implemented");
  }
  if (securityRoles == null) {
    return;
  }
  final DeploymentUnit deploymentUnit=phaseContext.getDeploymentUnit();
  final EEModuleDescription moduleDescription=deploymentUnit.getAttachment(Attachments.EE_MODULE_DESCRIPTION);
  final EJBComponentDescription ejbComponentDescription=(EJBComponentDescription)moduleDescription.getComponentByName(beanMetaData.getEjbName());
  ejbComponentDescription.setDeclaredRoles(securityRoles.keySet());
}
