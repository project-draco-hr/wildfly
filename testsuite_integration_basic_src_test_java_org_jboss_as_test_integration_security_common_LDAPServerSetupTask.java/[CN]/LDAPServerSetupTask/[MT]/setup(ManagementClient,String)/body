{
  directoryService=new DefaultDirectoryService();
  directoryService.setShutdownHookEnabled(false);
  port=getPort();
  LOGGER.info("Creating LDAP server on port " + port);
  ldapServer=new LdapServer();
  ldapServer.setTransports(new TcpTransport(port));
  ldapServer.setDirectoryService(directoryService);
  setupSaslMechanisms();
  doDelete(directoryService.getWorkingDirectory());
  configureDirectoryService();
  LOGGER.debug("Starting directory service");
  directoryService.startup();
  rootDSE=directoryService.getAdminSession();
  configureLdapServer();
  ldapServer.addExtendedOperationHandler(new StartTlsHandler());
  ldapServer.addExtendedOperationHandler(new StoredProcedureExtendedOperationHandler());
  LOGGER.debug("Starting LDAP server");
  ldapServer.start();
  setContexts(ServerDNConstants.ADMIN_SYSTEM_DN,"secret");
}
