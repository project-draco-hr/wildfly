{
  final LogContext logContext=deploymentUnit.removeAttachment(LOG_CONTEXT_KEY);
  final boolean success;
  if (WildFlySecurityManager.isChecking()) {
    success=WildFlySecurityManager.doChecked(new PrivilegedAction<Boolean>(){
      @Override public Boolean run(){
        return logContextSelector.unregisterLogContext(module.getClassLoader(),logContext);
      }
    }
);
  }
 else {
    success=logContextSelector.unregisterLogContext(module.getClassLoader(),logContext);
  }
  if (success) {
    LoggingLogger.ROOT_LOGGER.tracef("Removed LogContext '%s' from '%s'",logContext,module);
  }
 else {
    LoggingLogger.ROOT_LOGGER.logContextNotRemoved(logContext,deploymentUnit.getName());
  }
}
