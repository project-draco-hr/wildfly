{
synchronized (lock) {
    if (shutdown) {
      return;
    }
    log.info("Shutting down process manager");
    shutdown=true;
    for (    ManagedProcess process : processes.values()) {
      process.shutdown();
    }
    while (!processes.isEmpty()) {
      try {
        lock.wait();
      }
 catch (      InterruptedException e) {
      }
    }
    log.info("All processes finished; exiting");
  }
}
