{
  final File targetDir=context.getModulePatchDirectory(contentItem);
  if (!targetDir.mkdirs()) {
    throw PatchMessages.MESSAGES.cannotCreateDirectory(targetDir.getAbsolutePath());
  }
  final File moduleXml=new File(targetDir,MODULE_XML);
  final OutputStream os=new FileOutputStream(moduleXml);
  try {
    final ByteArrayInputStream is=new ByteArrayInputStream(getFileContent(contentItem));
    return PatchUtils.copyAndGetHash(is,os);
  }
  finally {
    PatchUtils.safeClose(os);
  }
}
