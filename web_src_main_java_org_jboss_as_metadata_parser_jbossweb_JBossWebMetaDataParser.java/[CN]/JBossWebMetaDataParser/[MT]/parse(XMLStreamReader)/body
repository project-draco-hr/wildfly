{
  reader.require(START_DOCUMENT,null,null);
  Version version=null;
  while (reader.hasNext() && reader.next() != START_ELEMENT) {
    if (reader.getEventType() == DTD) {
      String dtdLocation=readDTDLocation(reader);
      if (dtdLocation != null) {
        version=Location.getVersion(dtdLocation);
      }
      if (version == null) {
        version=Version.JBOSS_WEB_5_0;
      }
    }
  }
  String schemaLocation=readSchemaLocation(reader);
  if (schemaLocation != null) {
    version=Location.getVersion(schemaLocation);
  }
  if (version == null) {
    version=Version.JBOSS_WEB_6_0;
  }
  JBossWebMetaData wmd=null;
switch (version) {
case JBOSS_WEB_3_0:
    wmd=new JBoss4xDTDWebMetaData();
  break;
case JBOSS_WEB_3_2:
wmd=new JBoss4xDTDWebMetaData();
break;
case JBOSS_WEB_4_0:
wmd=new JBoss4xDTDWebMetaData();
break;
case JBOSS_WEB_4_2:
wmd=new JBoss4xDTDWebMetaData();
break;
case JBOSS_WEB_5_0:
wmd=new JBoss50DTDWebMetaData();
break;
case JBOSS_WEB_5_1:
wmd=new JBoss50WebMetaData();
break;
case JBOSS_WEB_6_0:
wmd=new JBoss60WebMetaData();
break;
}
return wmd;
}
