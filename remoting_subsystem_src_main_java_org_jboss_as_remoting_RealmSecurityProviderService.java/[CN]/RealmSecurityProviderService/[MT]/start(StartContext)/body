{
  String path=tmpDirValue.getValue();
  File authDir=new File(path,"auth");
  if (authDir.exists()) {
    if (!authDir.isDirectory()) {
      throw RemotingLogger.ROOT_LOGGER.unableToCreateTempDirForAuthTokensFileExists();
    }
  }
 else   if (!authDir.mkdirs()) {
    if (!authDir.isDirectory()) {
      throw RemotingLogger.ROOT_LOGGER.unableToCreateAuthDir(authDir.getAbsolutePath());
    }
  }
 else {
    authDir.setWritable(false,false);
    authDir.setWritable(true,true);
    authDir.setReadable(false,false);
    authDir.setReadable(true,true);
    authDir.setExecutable(false,false);
    authDir.setExecutable(true,true);
  }
  securityProvider=new RealmSecurityProvider(securityRealmInjectedValue.getOptionalValue(),serverCallbackValue.getOptionalValue(),authDir.getAbsolutePath());
}
