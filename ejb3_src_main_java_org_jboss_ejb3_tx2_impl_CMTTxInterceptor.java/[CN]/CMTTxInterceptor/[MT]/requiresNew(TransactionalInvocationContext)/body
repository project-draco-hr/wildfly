{
  int oldTimeout=getCurrentTransactionTimeout();
  int timeout=invocation.getTransactionTimeout();
  try {
    if (timeout != -1 && tm != null) {
      tm.setTransactionTimeout(timeout);
    }
    Transaction tx=tm.getTransaction();
    if (tx != null) {
      tm.suspend();
      try {
        return invokeInOurTx(invocation,tm);
      }
  finally {
        tm.resume(tx);
      }
    }
 else {
      return invokeInOurTx(invocation,tm);
    }
  }
  finally {
    if (tm != null) {
      tm.setTransactionTimeout(oldTimeout);
    }
  }
}
