{
  UUID setId=unmarshal(unmarshaller,UUID.class);
  DeploymentSetPlan setPlan=findDeploymentSet(setId);
  byte nextHeader=unmarshaller.readByte();
  expectHeader(nextHeader,DomainClientProtocol.RETURN_DEPLOYMENT_ACTION_ID);
  Map<UUID,DeploymentActionResult> actionResults=new HashMap<UUID,DeploymentActionResult>();
  do {
    nextHeader=readDeploymentActionResult(setPlan,actionResults);
  }
 while (nextHeader == DomainClientProtocol.RETURN_DEPLOYMENT_ACTION_ID);
  if (nextHeader == DomainClientProtocol.RETURN_SERVER_DEPLOYMENT) {
    do {
      nextHeader=readServerDeploymentResult(actionResults);
    }
 while (nextHeader == DomainClientProtocol.RETURN_SERVER_DEPLOYMENT);
  }
  DeploymentSetPlanResult setResult=new DeploymentSetPlanResultImpl(setPlan,actionResults);
  setResults.put(setId,setResult);
  return nextHeader;
}
