{
  try (InputStream input=new ByteArrayInputStream(message.getRawBuffer(),message.getOffset(),message.getLength())){
    int version=input.read();
    try (Unmarshaller unmarshaller=this.marshallingContext.createUnmarshaller(version)){
      unmarshaller.start(Marshalling.createByteInput(input));
      ServiceName service=ServiceName.parse(unmarshaller.readUTF());
      Command<Object,Object> command=(Command<Object,Object>)unmarshaller.readObject();
      Map.Entry<MembershipListener,Object> entry=this.services.get(service);
      if (entry == null)       return new NoSuchService();
      Object context=entry.getValue();
      return command.execute(context);
    }
   }
 }
