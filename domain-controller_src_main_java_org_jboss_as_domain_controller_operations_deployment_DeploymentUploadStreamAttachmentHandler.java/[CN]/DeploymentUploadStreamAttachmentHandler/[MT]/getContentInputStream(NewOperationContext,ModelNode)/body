{
  streamValidator.validate(operation);
  int streamIndex=operation.get(INPUT_STREAM_INDEX).asInt();
  int maxIndex=operationContext.getAttachmentStreamCount();
  if (streamIndex > maxIndex) {
    throw new OperationFailedException(new ModelNode().set(String.format("Invalid '" + INPUT_STREAM_INDEX + "' value: %d, the maximum index is %d",streamIndex,maxIndex)));
  }
  try {
    InputStream in=operationContext.getAttachmentStream(streamIndex);
    if (in == null) {
      throw new OperationFailedException(new ModelNode().set(String.format("Null stream at index %s",streamIndex)));
    }
    return in;
  }
 catch (  IOException e) {
    throw new OperationFailedException(new ModelNode().set(String.format("Failed to get attachment stream at index [%d] -- %s",streamIndex,e.toString())));
  }
}
