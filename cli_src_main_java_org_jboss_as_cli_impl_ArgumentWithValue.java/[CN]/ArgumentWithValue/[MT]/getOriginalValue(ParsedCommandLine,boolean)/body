{
  String value=null;
  if (parsedLine.hasProperties()) {
    if (index >= 0) {
      List<String> others=parsedLine.getOtherProperties();
      if (others.size() > index) {
        return others.get(index);
      }
    }
    value=parsedLine.getPropertyValue(fullName);
    if (value == null && shortName != null) {
      value=parsedLine.getPropertyValue(shortName);
    }
  }
  if (required && value == null && !isPresent(parsedLine)) {
    StringBuilder buf=new StringBuilder();
    buf.append("Required argument ");
    buf.append('\'').append(fullName).append('\'');
    buf.append(" is missing.");
    throw new CommandFormatException(buf.toString());
  }
  return value;
}
