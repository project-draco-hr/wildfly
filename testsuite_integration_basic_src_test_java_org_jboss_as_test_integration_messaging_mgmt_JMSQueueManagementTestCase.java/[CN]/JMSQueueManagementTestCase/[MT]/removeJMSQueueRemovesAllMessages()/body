{
  MessageProducer producer=session.createProducer(queue);
  producer.send(session.createTextMessage("A"));
  MessageConsumer consumer=session.createConsumer(queue);
  ModelNode result=execute(getQueueOperation("count-messages"),true);
  Assert.assertTrue(result.isDefined());
  Assert.assertEquals(1,result.asInt());
  adminSupport.removeJmsQueue(getQueueName());
  try {
    consumer.receive(5000);
    fail("consumer is not valid after the queue is removed");
  }
 catch (  javax.jms.IllegalStateException e) {
  }
  adminSupport.createJmsQueue(getQueueName(),getQueueJndiName());
  result=execute(getQueueOperation("count-messages"),true);
  Assert.assertTrue(result.isDefined());
  Assert.assertEquals(0,result.asInt());
}
