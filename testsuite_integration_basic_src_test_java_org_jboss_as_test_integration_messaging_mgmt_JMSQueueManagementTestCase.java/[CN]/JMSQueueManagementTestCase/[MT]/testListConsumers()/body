{
  HashMap<String,Object> map=new HashMap<String,Object>();
  map.put("host",TestSuiteEnvironment.getServerAddress());
  map.put("port",managementClient.getWebUri().getPort());
  map.put(TransportConstants.HTTP_UPGRADE_ENABLED_PROP_NAME,true);
  map.put(TransportConstants.HTTP_UPGRADE_ENDPOINT_PROP_NAME,"http-acceptor");
  TransportConfiguration transportConfiguration=new TransportConfiguration(NettyConnectorFactory.class.getName(),map);
  HornetQConnectionFactory cf=HornetQJMSClient.createConnectionFactoryWithoutHA(JMSFactoryType.CF,transportConfiguration);
  cf.setClientID("consumer");
  consumerConn=cf.createQueueConnection("guest","guest");
  consumerConn.start();
  consumerSession=consumerConn.createQueueSession(false,TopicSession.AUTO_ACKNOWLEDGE);
  ModelNode result=execute(getQueueOperation("list-consumers-as-json"),true);
  Assert.assertTrue(result.isDefined());
  Assert.assertEquals(ModelType.STRING,result.getType());
}
