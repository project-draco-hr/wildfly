{
  final ContextManagedReferenceFactory managedReferenceFactory=new ContextManagedReferenceFactory(name);
  final ServiceName contextServiceName;
  if (resolutionContext.isCompUsesModule()) {
    contextServiceName=ContextNames.contextServiceNameOfModule(resolutionContext.getApplicationName(),resolutionContext.getModuleName());
  }
 else {
    contextServiceName=ContextNames.contextServiceNameOfComponent(resolutionContext.getApplicationName(),resolutionContext.getModuleName(),resolutionContext.getComponentName());
  }
  serviceBuilder.addDependency(contextServiceName,NamingStore.class,managedReferenceFactory.getNamingStoreInjectedValue());
  injector.inject(managedReferenceFactory);
}
