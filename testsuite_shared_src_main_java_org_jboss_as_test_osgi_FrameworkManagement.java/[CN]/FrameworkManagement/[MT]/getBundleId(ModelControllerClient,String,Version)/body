{
  Long result=new Long(-1);
  ModelNode op=ModelUtil.createOpNode("subsystem=osgi",READ_RESOURCE_OPERATION);
  op.get(ModelDescriptionConstants.INCLUDE_RUNTIME).set("true");
  op.get(ModelDescriptionConstants.RECURSIVE).set("true");
  ModelNode bundleNode=executeOperation(client,op).get(ModelConstants.BUNDLE);
  for (  ModelNode node : bundleNode.asList()) {
    Property propNode=node.asProperty();
    ModelNode valueNode=propNode.getValue();
    ModelNode symbolicNameNode=valueNode.get(ModelConstants.SYMBOLIC_NAME);
    if (symbolicNameNode.asString().equals(symbolicName)) {
      if (version == null) {
        result=new Long(propNode.getName());
        break;
      }
      ModelNode versionNode=valueNode.get(ModelConstants.VERSION);
      if (versionNode.isDefined()) {
        Version auxver=Version.parseVersion(versionNode.asString());
        if (version.equals(auxver)) {
          result=new Long(propNode.getName());
          break;
        }
      }
    }
  }
  return result;
}
