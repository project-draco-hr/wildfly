{
  if (modelVersion.getMajor() > 1 || modelVersion.getMinor() >= 4) {
    return;
  }
  KernelServicesBuilder builder=createKernelServicesBuilder(TestModelType.DOMAIN).setXmlResource("domain-transformers-1.3.xml");
  LegacyKernelServicesInitializer legacyInit=builder.createLegacyKernelServicesBuilder(modelVersion,testControllerVersion);
  if (modelVersion.getMajor() == 1 && modelVersion.getMinor() <= 3) {
    legacyInit.setDontValidateOperations();
  }
  KernelServices mainServices=builder.build();
  Assert.assertTrue(mainServices.isSuccessfulBoot());
  KernelServices legacyServices=mainServices.getLegacyServices(modelVersion);
  Assert.assertTrue(legacyServices.isSuccessfulBoot());
  checkCoreModelTransformation(mainServices,modelVersion);
  String[] address={SOCKET_BINDING_GROUP,"standard-sockets",SOCKET_BINDING,"client-mapping"};
  testMappingsWriteAttributeTransformation(mainServices,address,CLIENT_MAPPING_SOURCE_NETWORK,"${test.exp:127.0.0.0/24}");
  testMappingsWriteAttributeTransformation(mainServices,address,CLIENT_MAPPING_DESTINATION_ADDRESS,"${test.exp:localhost}");
  testMappingsWriteAttributeTransformation(mainServices,address,CLIENT_MAPPING_DESTINATION_PORT,"${test.exp:3334}");
  String[] add1Addr={SOCKET_BINDING_GROUP,"standard-sockets",SOCKET_BINDING,"add-1"};
  testMappingsAddTransformation(mainServices,add1Addr,CLIENT_MAPPING_SOURCE_NETWORK,"${test.exp:127.0.0.0/24}");
  String[] add2Addr={SOCKET_BINDING_GROUP,"standard-sockets",SOCKET_BINDING,"add-2"};
  testMappingsAddTransformation(mainServices,add2Addr,CLIENT_MAPPING_DESTINATION_ADDRESS,"${test.exp:localhost}");
  String[] add3Addr={SOCKET_BINDING_GROUP,"standard-sockets",SOCKET_BINDING,"add-3"};
  testMappingsAddTransformation(mainServices,add3Addr,CLIENT_MAPPING_DESTINATION_PORT,"${test.exp:3334}");
}
