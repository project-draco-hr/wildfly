{
  OutputStream dataOutput=null;
  ByteDataOutput output=null;
  try {
    dataOutput=connection.writeMessage();
    output=new SimpleByteDataOutput(dataOutput);
    final ManagementResponseHeader responseHeader=new ManagementResponseHeader(version,responseId);
    responseHeader.write(output);
    output.close();
    dataOutput.close();
  }
 catch (  IOException e) {
    throw e;
  }
catch (  Throwable t) {
    throw new IOException("Failed to write management response headers",t);
  }
 finally {
    safeClose(output);
    safeClose(dataOutput);
  }
}
