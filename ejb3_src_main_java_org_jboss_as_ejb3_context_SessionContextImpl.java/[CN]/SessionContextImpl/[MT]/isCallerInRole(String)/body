{
  final InterceptorContext invocation=CurrentInvocationContext.get();
  final boolean lifecycleCallback=invocation.getMethod() == null;
  if (lifecycleCallback && (!stateful || !DependencyInjectionCompleteMarker.isDependencyInjectionComplete(invocation))) {
    throw new IllegalStateException("isCallerInRole is not allowed in lifecycle methods of stateless session beans");
  }
  return super.isCallerInRole(roleName);
}
