{
  String version=System.getProperty("jboss.as.compare.version",null);
  String fromTgt=System.getProperty("jboss.as.compare.from.target",null);
  String differentVersions=System.getProperty("jboss.as.compare.different.versions",null);
  String type=System.getProperty("jboss.as.compare.type",null);
  String runtime=System.getProperty("jboss.as.compare.runtime",null);
  if (version == null) {
    System.out.print("Enter legacy AS version: ");
    version=readInput(null);
  }
  System.out.println("Using target model: " + version);
  if (type == null) {
    System.out.print("Enter type [S](standalone)/H(host)/D(domain)/F(domain + host):");
    type=readInput("S");
  }
  final ResourceType[] resourceTypes;
  if (ResourceType.STANDALONE.toString().startsWith(type.toUpperCase())) {
    resourceTypes=new ResourceType[]{ResourceType.STANDALONE};
  }
 else   if (ResourceType.HOST.toString().startsWith(type.toUpperCase())) {
    resourceTypes=new ResourceType[]{ResourceType.HOST};
  }
 else   if (ResourceType.DOMAIN.toString().startsWith(type.toUpperCase())) {
    resourceTypes=new ResourceType[]{ResourceType.DOMAIN};
  }
 else   if (type.toUpperCase().equals("F")) {
    resourceTypes=new ResourceType[]{ResourceType.DOMAIN,ResourceType.HOST};
  }
 else {
    throw new IllegalArgumentException("Could not determine type for: '" + type + "'");
  }
  if (fromTgt == null) {
    System.out.print("Read from target directory or from the legacy-models directory - t/[l]:");
    fromTgt=readInput("l");
  }
  final File fromDirectory;
  if (fromTgt.equals("l")) {
    File projectDir=Tools.getProjectDirectory();
    File legacyModels=new File(projectDir,"target/test-classes/legacy-models".replace('/',File.separatorChar));
    if (!legacyModels.exists()) {
      legacyModels=new File(projectDir,"src/test/resources/legacy-models".replace('/',File.separatorChar));
      if (!legacyModels.exists()) {
        throw new IllegalStateException("Could not find the legacy-models directory");
      }
    }
    fromDirectory=legacyModels;
  }
 else   if (fromTgt.equals("t")) {
    fromDirectory=new File(Tools.getProjectDirectory(),"target");
  }
 else {
    throw new IllegalArgumentException("Please enter 'l' for legacy-models directory or 't' for target directory");
  }
  if (differentVersions == null) {
    System.out.print("Report on differences in the model when the management versions are different? y/[n]: ");
    differentVersions=readInput("n").toLowerCase();
  }
  boolean compareDifferentVersions;
  if (differentVersions.equals("n")) {
    System.out.println("Not reporting on differences in the model when the management versions are different");
    compareDifferentVersions=false;
  }
 else   if (differentVersions.equals("y")) {
    System.out.println("Reporting on differences in the model when the management versions are different");
    compareDifferentVersions=true;
  }
 else {
    throw new IllegalArgumentException("Please enter 'y' or 'n'");
  }
  if (runtime == null) {
    System.out.print("Report on differences in the model of runtime resources/attributes? y/[n]: ");
    runtime=readInput("n").toLowerCase();
  }
  boolean compareRuntime;
  if (runtime.equals("n")) {
    System.out.println("Not reporting on differences in the model for runtime resources/attributes.");
    compareRuntime=false;
  }
 else   if (differentVersions.equals("y")) {
    System.out.println("Reporting on differences in the model for runtime resources/attributes.");
    compareRuntime=true;
  }
 else {
    throw new IllegalArgumentException("Please enter 'y' or 'n'");
  }
  System.out.println("Loading legacy model versions for " + version + "....");
  ModelNode legacyModelVersions=Tools.loadModelNodeFromFile(new File(fromDirectory,"standalone-model-versions-" + version + ".dmr"));
  System.out.println("Loaded legacy model versions");
  System.out.println("Loading model versions for currently running server...");
  ModelNode currentModelVersions=Tools.getCurrentModelVersions();
  System.out.println("Loaded current model versions");
  for (  ResourceType resourceType : resourceTypes) {
    doCompare(resourceType,fromDirectory,compareDifferentVersions,compareRuntime,version,legacyModelVersions,currentModelVersions);
  }
}
