{
  Context ctx=null;
  try {
    ctx=new InitialContext();
    ConnectionFactory cf=(ConnectionFactory)ctx.lookup(info.connectionFactoryLookup);
    if (tx != null) {
      XAJMSContext xaContext=((XAConnectionFactory)cf).createXAContext(info.userName,info.password);
      xares=xaContext.getXAResource();
      tx.enlistResource(xares);
      return xaContext.getContext();
    }
 else {
      return cf.createContext(info.userName,info.password,info.ackMode);
    }
  }
  finally {
    if (ctx != null) {
      try {
        ctx.close();
      }
 catch (      NamingException e) {
      }
    }
  }
}
