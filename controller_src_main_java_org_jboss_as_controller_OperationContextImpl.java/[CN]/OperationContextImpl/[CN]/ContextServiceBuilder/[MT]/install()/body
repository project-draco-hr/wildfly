{
  final Map<ServiceName,ServiceController<?>> map=realRemovingControllers;
synchronized (map) {
    boolean intr=false;
    try {
      while (map.containsKey(name)) {
        try {
          map.wait();
        }
 catch (        InterruptedException e) {
          intr=true;
          if (respectInterruption) {
            cancelled=true;
            throw ControllerLogger.ROOT_LOGGER.serviceInstallCancelled();
          }
        }
      }
      removalSteps.remove(name);
      return realBuilder.install();
    }
  finally {
      if (intr) {
        Thread.currentThread().interrupt();
      }
    }
  }
}
