{
  Caller caller=getCaller();
  ImmutableManagementResourceRegistration mrr=modelController.getRootRegistration().getSubModel(opId.address);
  if (mrr == null) {
    return null;
  }
  Action action=getAuthorizationAction(mrr,opId.name,operation);
  if (action == null) {
    return null;
  }
  Resource resource=getAuthorizationResource(opId.address);
  ProcessType processType=getProcessType();
  TargetResource targetResource=(processType == ProcessType.STANDALONE_SERVER || processType == ProcessType.EMBEDDED_SERVER) ? TargetResource.forStandalone(mrr,resource) : TargetResource.forDomain(mrr,resource,getServerGroups(opId.address,resource),getHosts(opId.address,resource));
  AuthorizationResponse result=new AuthorizationResponse(action,targetResource);
  AuthorizationResult simple=modelController.getAuthorizer().authorize(caller,callEnvironment,action,targetResource);
  if (simple.getDecision() == AuthorizationResult.Decision.PERMIT) {
    for (    Action.ActionEffect actionEffect : action.getActionEffects()) {
      result.addResourceResult(actionEffect,simple);
    }
  }
  authorizations.put(opId,result);
  return result;
}
