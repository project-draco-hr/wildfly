{
  AuthorizationResult accessResult=authorize(activeStep.operationId,activeStep.operation,false,ADDRESS);
  if (accessResult.getDecision() == AuthorizationResult.Decision.DENY) {
    if (activeStep.address.size() > 0) {
      throw ControllerMessages.MESSAGES.managementResourceNotFound(activeStep.address);
    }
 else {
      throw ControllerMessages.MESSAGES.unauthorized(activeStep.operationId.name,activeStep.address,accessResult.getExplanation());
    }
  }
  AuthorizationResult authResult=authorize(activeStep.operationId,activeStep.operation,allAttributes,actionEffects);
  if (authResult.getDecision() == AuthorizationResult.Decision.DENY) {
    throw ControllerMessages.MESSAGES.unauthorized(activeStep.operationId.name,activeStep.address,authResult.getExplanation());
  }
}
