{
  Caller caller=getCaller();
  ImmutableManagementResourceRegistration mrr=modelController.getRootRegistration().getSubModel(step.address);
  if (mrr == null) {
    return null;
  }
  Action action=getAuthorizationAction(mrr,step);
  if (action == null) {
    return null;
  }
  Resource resource=getAuthorizationResource(step.address);
  ProcessType processType=getProcessType();
  TargetResource targetResource=(processType == ProcessType.STANDALONE_SERVER || processType == ProcessType.EMBEDDED_SERVER) ? TargetResource.forStandalone(mrr,resource) : TargetResource.forDomain(mrr,resource,getServerGroups(step.address,resource),getHosts(step.address,resource));
  AuthorizationResponse result=new AuthorizationResponse(action,targetResource);
  AuthorizationResult simple=modelController.getAuthorizer().authorize(caller,callEnvironment,action,targetResource);
  if (simple.getDecision() == AuthorizationResult.Decision.PERMIT) {
    for (    Action.ActionEffect actionEffect : action.getActionEffects()) {
      result.addResourceResult(actionEffect,simple);
    }
  }
  authorizations.put(step.operationId,result);
  return result;
}
