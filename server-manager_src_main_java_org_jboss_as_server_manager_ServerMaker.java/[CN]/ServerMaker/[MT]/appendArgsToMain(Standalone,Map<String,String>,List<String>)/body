{
  if (environment.getProcessManagerAddress() != null) {
    command.add(CommandLineConstants.INTERPROCESS_ADDRESS);
    command.add(environment.getProcessManagerAddress().getHostAddress());
    command.add(CommandLineConstants.INTERPROCESS_PORT);
    command.add(environment.getProcessManagerPort().toString());
    command.add(CommandLineConstants.INTERPROCESS_NAME);
    command.add(getServerProcessName(serverConfig));
  }
  Map<String,String> sysProps=null;
  PropertiesElement propsEl=serverConfig.getSystemProperties();
  if (propsEl == null) {
    sysProps=Collections.emptyMap();
  }
 else {
    sysProps=propsEl.getProperties();
  }
  StringBuilder sb=new StringBuilder("-D");
  sb.append(ServerManagerEnvironment.HOME_DIR);
  sb.append('=');
  sb.append(getPropertyValue(ServerManagerEnvironment.HOME_DIR,jvmProps,sysProps,environment.getHomeDir().getAbsolutePath()));
  command.add(sb.toString());
  String key="jboss.server.base.dir";
  sb=new StringBuilder("-D");
  sb.append(key);
  sb.append('=');
  File serverBaseDir=new File(environment.getDomainServersDir(),serverConfig.getServerName());
  sb.append(getPropertyValue(key,jvmProps,sysProps,serverBaseDir.getAbsolutePath()));
  command.add(sb.toString());
  String[] keys={"jboss.server.config.dir","jboss.server.config.dir","jboss.server.data.dir","jboss.server.log.dir","jboss.server.temp.dir"};
  for (  String propkey : keys) {
    if (sysProps.containsKey(propkey)) {
      sb=new StringBuilder("-D");
      sb.append(propkey);
      sb.append('=');
      sb.append(sysProps.get(propkey));
      command.add(sb.toString());
    }
  }
}
