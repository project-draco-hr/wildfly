{
  final String serverProcessName=server.getServerProcessName();
  String serverName=server.getServerName();
  List<String> command=server.getServerLaunchCommand();
  Map<String,String> env=getServerLaunchEnvironment(jvmElement);
  processManagerSlave.addProcess(serverProcessName,command,env,environment.getHomeDir().getAbsolutePath());
  final List<AbstractServerModelUpdate<?>> updateList=new ArrayList<AbstractServerModelUpdate<?>>();
  ServerFactory.combine(null,null,serverName,updateList);
  final ByteArrayOutputStream baos=new ByteArrayOutputStream(32768);
  final MarshallerFactory marshallerFactory=Marshalling.getMarshallerFactory("river");
  final MarshallingConfiguration configuration=new MarshallingConfiguration();
  configuration.setVersion(2);
  configuration.setClassTable(ModularClassTable.getInstance());
  final Marshaller marshaller=marshallerFactory.createMarshaller(configuration);
  marshaller.start(Marshalling.createByteOutput(baos));
  processManagerSlave.sendStdin(serverProcessName,baos.toByteArray());
}
