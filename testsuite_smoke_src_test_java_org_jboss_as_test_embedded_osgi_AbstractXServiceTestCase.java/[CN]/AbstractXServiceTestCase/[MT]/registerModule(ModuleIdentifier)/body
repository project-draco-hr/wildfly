{
  ServiceController<Framework> frameworkController=(ServiceController<Framework>)getServiceContainer().getRequiredService(ServiceNames.FRAMEWORK_ACTIVE);
  new FutureServiceValue<Framework>(frameworkController).get();
  ServiceController<BundleManagement> bundleManagerService=(ServiceController<BundleManagement>)getServiceContainer().getRequiredService(ServiceNames.BUNDLE_MANAGER);
  BundleManagement bundleManager=new FutureServiceValue<BundleManagement>(bundleManagerService).get();
  ServiceTarget serviceTarget=getServiceContainer().subTarget();
  ServiceName serviceName=bundleManager.installBundle(serviceTarget,moduleId);
  return getBundleFromService(serviceName);
}
