{
  final ServiceContainer container=context.getController().getServiceContainer();
  deploymentUnit=new DeploymentUnitImpl(parent,name,new DelegatingServiceRegistry(container));
  deploymentUnit.putAttachment(Attachments.RUNTIME_NAME,runtimeName);
  deploymentUnit.putAttachment(Attachments.DEPLOYMENT_HASH,deploymentHash);
  deploymentUnit.putAttachment(Attachments.SERVER_DEPLOYMENT_REPOSITORY,serverDeploymentRepositoryInjector.getValue());
  final ServiceName serviceName=deploymentUnit.getServiceName().append(FIRST_PHASE_NAME);
  final Phase firstPhase=Phase.values()[0];
  final DeploymentUnitPhaseService<?> phaseService=DeploymentUnitPhaseService.create(firstPhase);
  final ServiceBuilder<?> phaseServiceBuilder=container.addService(serviceName,phaseService);
  phaseServiceBuilder.addDependency(deploymentUnit.getServiceName(),DeploymentUnit.class,phaseService.getDeploymentUnitInjector());
  phaseServiceBuilder.addDependency(Services.JBOSS_DEPLOYMENT_CHAINS,DeployerChains.class,phaseService.getDeployerChainsInjector());
  phaseServiceBuilder.install();
}
