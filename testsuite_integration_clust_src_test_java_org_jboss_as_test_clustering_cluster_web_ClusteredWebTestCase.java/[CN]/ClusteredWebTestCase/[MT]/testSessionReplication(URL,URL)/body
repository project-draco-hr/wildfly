{
  DefaultHttpClient client=new DefaultHttpClient();
  String url1=baseURL1.toString() + "simple";
  String url2=baseURL2.toString() + "simple";
  try {
    HttpResponse response=client.execute(new HttpGet(url1));
    Assert.assertEquals(HttpServletResponse.SC_OK,response.getStatusLine().getStatusCode());
    Assert.assertEquals(1,Integer.parseInt(response.getFirstHeader("value").getValue()));
    response.getEntity().getContent().close();
    response=client.execute(new HttpGet(url1));
    Assert.assertEquals(HttpServletResponse.SC_OK,response.getStatusLine().getStatusCode());
    Assert.assertEquals(2,Integer.parseInt(response.getFirstHeader("value").getValue()));
    response.getEntity().getContent().close();
    Thread.sleep(GRACE_TIME_TO_REPLICATE);
    response=client.execute(new HttpGet(url2));
    Assert.assertEquals(HttpServletResponse.SC_OK,response.getStatusLine().getStatusCode());
    Assert.assertEquals(3,Integer.parseInt(response.getFirstHeader("value").getValue()));
    response.getEntity().getContent().close();
    response=client.execute(new HttpGet(url2));
    Assert.assertEquals(HttpServletResponse.SC_OK,response.getStatusLine().getStatusCode());
    Assert.assertEquals(4,Integer.parseInt(response.getFirstHeader("value").getValue()));
    response.getEntity().getContent().close();
  }
  finally {
    client.getConnectionManager().shutdown();
  }
}
