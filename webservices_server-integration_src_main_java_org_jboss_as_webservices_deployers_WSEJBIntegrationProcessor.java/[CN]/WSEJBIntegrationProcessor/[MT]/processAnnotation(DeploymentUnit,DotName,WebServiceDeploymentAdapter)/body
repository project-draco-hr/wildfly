{
  final List<AnnotationInstance> webServiceAnnotations=getAnnotations(unit,annotation);
  final List<WebServiceDeclaration> endpoints=wsDeploymentAdapter.getServiceEndpoints();
  final EEModuleDescription moduleDescription=unit.getAttachment(EE_MODULE_DESCRIPTION);
  for (  final AnnotationInstance webServiceAnnotation : webServiceAnnotations) {
    final AnnotationTarget target=webServiceAnnotation.target();
    final ClassInfo webServiceClassInfo=(ClassInfo)target;
    final String beanClassName=webServiceClassInfo.name().toString();
    final List<ComponentDescription> componentDescriptions=moduleDescription.getComponentsByClassName(beanClassName);
    final List<SessionBeanComponentDescription> sessionBeans=getSessionBeans(componentDescriptions);
    for (    SessionBeanComponentDescription sessionBean : sessionBeans) {
      if (sessionBean.isStateless() || sessionBean.isSingleton()) {
        final EJBViewDescription ejbViewDescription=sessionBean.addWebserviceEndpointView();
        final String ejbViewName=ejbViewDescription.getServiceName().getCanonicalName();
        endpoints.add(new WebServiceDeclarationAdapter(sessionBean,webServiceClassInfo,ejbViewName));
      }
    }
  }
}
