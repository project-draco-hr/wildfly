{
  final List<ServletMetaData> endpoints=new ArrayList<ServletMetaData>();
  final DotName webserviceAnnotation=DotName.createSimple(WebService.class.getName());
  final DotName webserviceProviderAnnotation=DotName.createSimple(WebServiceProvider.class.getName());
  for (  ServletMetaData servletMD : smd) {
    final String endpointClassName=ASHelper.getEndpointName(servletMD);
    if (endpointClassName != null && endpointClassName.length() > 0) {
      Map<DotName,List<AnnotationInstance>> map=null;
      if (annotationIndex != null) {
        ClassInfo ci=annotationIndex.getClassByName(DotName.createSimple(endpointClassName));
        if (ci != null) {
          map=ci.annotations();
        }
      }
      if (map == null) {
        map=new HashMap<DotName,List<AnnotationInstance>>();
      }
      final boolean isWebService=map.containsKey(webserviceAnnotation);
      final boolean isWebServiceProvider=map.containsKey(webserviceProviderAnnotation);
      final boolean isJaxwsEndpoint=jaxws && (isWebService || isWebServiceProvider);
      final boolean isJaxrpcEndpoint=!jaxws && (!isWebService && !isWebServiceProvider);
      if (isJaxwsEndpoint || isJaxrpcEndpoint) {
        endpoints.add(servletMD);
      }
    }
  }
  return endpoints;
}
