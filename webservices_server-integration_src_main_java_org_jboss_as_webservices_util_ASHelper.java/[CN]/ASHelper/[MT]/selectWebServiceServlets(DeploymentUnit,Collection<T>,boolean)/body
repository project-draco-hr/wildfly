{
  if (smd == null)   return Collections.emptyList();
  final CompositeIndex index=ASHelper.getOptionalAttachment(unit,Attachments.COMPOSITE_ANNOTATION_INDEX);
  final List<ServletMetaData> endpoints=new ArrayList<ServletMetaData>();
  for (  final ServletMetaData servletMD : smd) {
    final boolean isWebServiceEndpoint=index != null ? isWebserviceEndpoint(servletMD,index) : isWebserviceEndpoint(servletMD,unit.getAttachment(WSAttachmentKeys.CLASSLOADER_KEY));
    final boolean isJaxwsEndpoint=jaxws && isWebServiceEndpoint;
    final boolean isJaxrpcEndpoint=!jaxws && isWebServiceEndpoint;
    if (isJaxwsEndpoint || isJaxrpcEndpoint) {
      endpoints.add(servletMD);
    }
  }
  return endpoints;
}
