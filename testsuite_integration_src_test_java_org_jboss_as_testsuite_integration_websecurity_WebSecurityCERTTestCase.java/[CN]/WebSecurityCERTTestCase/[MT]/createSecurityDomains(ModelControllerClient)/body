{
  final List<ModelNode> updates=new ArrayList<ModelNode>();
  ModelNode op=new ModelNode();
  op.get(OP).set(ADD);
  op.get(OP_ADDR).add(SUBSYSTEM,"security");
  op.get(OP_ADDR).add(SECURITY_DOMAIN,"cert-test");
  ModelNode loginModule=op.get(AUTHENTICATION).add();
  loginModule.get(CODE).set("CertificateRoles");
  loginModule.get(FLAG).set("required");
  ModelNode moduleOptions=loginModule.get(MODULE_OPTIONS);
  moduleOptions.add("securityDomain","cert");
  updates.add(op);
  op=new ModelNode();
  op.get(OP).set(ADD);
  op.get(OP_ADDR).add(SUBSYSTEM,"security");
  op.get(OP_ADDR).add(SECURITY_DOMAIN,"cert");
  ModelNode jsse=op.get(JSSE);
  jsse.get(TRUSTSTORE_PASSWORD).set("changeit");
  ClassLoader tccl=Thread.currentThread().getContextClassLoader();
  URL keystore=tccl.getResource("security/jsse.keystore");
  jsse.get(TRUSTSTORE_URL).set(keystore.getPath());
  updates.add(op);
  applyUpdates(updates,client);
}
