{
  final String targetDistro=distribution.getValue(args);
  if (targetDistro != null) {
    return targetDistro;
  }
  String resolved=getSecurityManager() == null ? getenv(HOME) : doPrivileged(new ReadEnvironmentPropertyAction(HOME));
  if (resolved == null) {
    resolved=getSecurityManager() == null ? getProperty(HOME_DIR) : doPrivileged(new ReadPropertyAction(HOME_DIR));
  }
  if (resolved == null) {
    throw PatchMessages.MESSAGES.cliFailedToResolveDistribution();
  }
  final File home=new File(resolved);
  final File modules=new File(home,"modules");
  if (!modules.isDirectory()) {
    throw PatchMessages.MESSAGES.cliFailedToResolveDistribution();
  }
  return resolved;
}
