{
  final PatchOperationTarget target;
  boolean connected=ctx.getControllerHost() != null;
  if (connected) {
    if (ctx.isDomainMode()) {
      String hostName=host.getValue(ctx.getParsedCommandLine(),true);
      target=PatchOperationTarget.createHost(hostName,ctx.getModelControllerClient());
    }
 else {
      target=PatchOperationTarget.createStandalone(ctx.getModelControllerClient());
    }
  }
 else {
    final String jbossHome=getJBossHome();
    try {
      target=PatchOperationTarget.createLocal(new File(jbossHome));
    }
 catch (    Exception e) {
      throw new CommandLineException("Unable to apply patch to local JBOSS_HOME=" + jbossHome,e);
    }
  }
  return target;
}
