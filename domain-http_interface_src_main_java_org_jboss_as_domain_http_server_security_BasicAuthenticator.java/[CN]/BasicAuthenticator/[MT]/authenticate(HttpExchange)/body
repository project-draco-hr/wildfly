{
  if (httpExchange instanceof HttpsExchange) {
    HttpsExchange httpsExch=(HttpsExchange)httpExchange;
    SSLSession session=httpsExch.getSSLSession();
    if (session != null) {
      try {
        Principal p=session.getPeerPrincipal();
        return new Success(new HttpPrincipal(p.getName(),realm));
      }
 catch (      SSLPeerUnverifiedException e) {
      }
    }
  }
  return super.authenticate(httpExchange);
}
