{
  final SecurityContext securityContext=exchange.getSecurityContext();
  final Subject useSubject;
  if (securityContext != null) {
    final Account account=securityContext.getAuthenticatedAccount();
    if (account instanceof SubjectAccount) {
      useSubject=((SubjectAccount)account).getSubject();
    }
 else {
      useSubject=new Subject();
    }
  }
 else {
    useSubject=new Subject();
  }
  handleRequest(exchange,useSubject);
}
