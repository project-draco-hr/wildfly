{
  final PathAddress address=PathAddress.pathAddress(operation.require(ADDRESS));
  NewStepHandler stepHandler=rootRegistration.getOperationHandler(address,operation.require(OP).asString());
  if (stepHandler == null) {
    throw new OperationFailedException(new ModelNode().set("No handler for operation address " + address));
  }
 else {
    NewOperationContext.Stage stage=NewOperationContext.Stage.MODEL;
    if (stepHandler instanceof AbstractExtensionAddHandler) {
      stage=NewOperationContext.Stage.IMMEDIATE;
    }
    context.addStep(response,this.operation,stepHandler,stage);
  }
  context.completeStep();
}
