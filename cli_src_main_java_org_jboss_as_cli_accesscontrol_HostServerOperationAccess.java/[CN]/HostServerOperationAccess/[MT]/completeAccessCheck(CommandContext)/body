{
  final ModelControllerClient client=ctx.getModelControllerClient();
  allowed=new HashMap<String,List<String>>();
  final OperationRequestAddress hostAddress=new DefaultOperationRequestAddress();
  hostAddress.toNodeType(Util.HOST);
  final String[] parent=new String[4];
  parent[0]=Util.HOST;
  parent[2]=Util.SERVER;
  for (  Map.Entry<String,List<String>> entry : toCheck.entrySet()) {
    final String host=entry.getKey();
    hostAddress.toNode(host);
    List<String> servers=entry.getValue();
    List<String> allowedServers=null;
    int i=0;
    if (servers == null) {
      servers=Util.getNodeNames(client,hostAddress,Util.SERVER);
    }
 else {
      allowedServers=new ArrayList<String>();
      allowed.put(host,allowedServers);
      allowedServers.add(servers.get(lastCheckedServer));
      i=lastCheckedServer + 1;
    }
    parent[1]=host;
    while (i < servers.size()) {
      final String server=servers.get(i++);
      parent[3]=server;
      if (CLIAccessControl.isExecute(client,parent,address,operation)) {
        if (allowedServers == null) {
          allowedServers=new ArrayList<String>();
          allowed.put(host,allowedServers);
        }
        allowedServers.add(server);
      }
    }
  }
}
