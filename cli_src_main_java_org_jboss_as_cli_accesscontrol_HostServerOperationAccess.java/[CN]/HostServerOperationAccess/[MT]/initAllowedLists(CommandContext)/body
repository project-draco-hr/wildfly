{
  if (ctx.getConfig().isAccessControl()) {
    if (!isSatisfied(ctx)) {
      allowed=Collections.emptyMap();
    }
 else {
      completeAccessCheck(ctx);
    }
  }
 else {
    final ModelControllerClient client=ctx.getModelControllerClient();
    allowed=new HashMap<String,List<String>>();
    final OperationRequestAddress hostAddress=new DefaultOperationRequestAddress();
    hostAddress.toNodeType(Util.HOST);
    final List<String> hosts=Util.getNodeNames(client,null,Util.HOST);
    for (    String host : hosts) {
      hostAddress.toNode(host);
      final List<String> servers=Util.getNodeNames(client,hostAddress,Util.SERVER);
      if (!servers.isEmpty()) {
        allowed.put(host,servers);
      }
    }
  }
}
