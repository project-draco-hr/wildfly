{
  final DeploymentCompleteListener listener=new DeploymentCompleteListener();
  final ServiceController<?> deployment=context.getController().getServiceContainer().getRequiredService(topLevelDeploymentName);
  deployment.addListener(ServiceListener.Inheritance.ALL,listener);
  thread=new Thread(new Runnable(){
    @Override public void run(){
      try {
        listener.waitForDeploymentStart();
        mainMethod.invoke(null,new Object[]{parameters});
      }
 catch (      InvocationTargetException e) {
        logger.error(e);
      }
catch (      IllegalAccessException e) {
        logger.error(e);
      }
 finally {
        CurrentServiceContainer.getServiceContainer().shutdown();
      }
    }
  }
);
  thread.start();
}
