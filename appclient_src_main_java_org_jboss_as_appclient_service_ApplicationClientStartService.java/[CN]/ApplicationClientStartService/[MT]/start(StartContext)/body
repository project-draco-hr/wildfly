{
  thread=new Thread(new Runnable(){
    @Override public void run(){
      try {
        final ClassLoader oldTccl=SecurityActions.getContextClassLoader();
        try {
          try {
            SecurityActions.setContextClassLoader(classLoader);
            EJBClientContext.setSelector(lazyConnectionContextSelector);
            applicationClientDeploymentServiceInjectedValue.getValue().getDeploymentCompleteLatch().await();
            NamespaceContextSelector.setDefault(namespaceContextSelectorInjectedValue);
            instance=applicationClientComponent.getValue().createInstance();
            mainMethod.invoke(null,new Object[]{parameters});
          }
 catch (          Exception e) {
            ROOT_LOGGER.exceptionRunningAppClient(e,e.getClass().getSimpleName());
          }
 finally {
            SecurityActions.setContextClassLoader(oldTccl);
          }
        }
  finally {
          CurrentServiceContainer.getServiceContainer().shutdown();
        }
      }
  finally {
        lazyConnectionContextSelector.close();
      }
    }
  }
);
  thread.start();
}
