{
  thread=new Thread(new Runnable(){
    @Override public void run(){
      try {
        final ClassLoader oldTccl=SecurityActions.getContextClassLoader();
        try {
          try {
            SecurityActions.setContextClassLoader(classLoader);
            AccessController.doPrivileged(new SetSelectorAction(contextSelector));
            applicationClientDeploymentServiceInjectedValue.getValue().getDeploymentCompleteLatch().await();
            NamespaceContextSelector.setDefault(namespaceContextSelectorInjectedValue);
            try {
              for (              SetupAction action : setupActions) {
                action.setup(Collections.<String,Object>emptyMap());
              }
              instance=applicationClientComponent.getValue().createInstance();
              mainMethod.invoke(null,new Object[]{parameters});
            }
  finally {
              final ListIterator<SetupAction> iterator=setupActions.listIterator(setupActions.size());
              Throwable error=null;
              while (iterator.hasPrevious()) {
                SetupAction action=iterator.previous();
                try {
                  action.teardown(Collections.<String,Object>emptyMap());
                }
 catch (                Throwable e) {
                  error=e;
                }
              }
              if (error != null) {
                throw new RuntimeException(error);
              }
            }
          }
 catch (          Exception e) {
            ROOT_LOGGER.exceptionRunningAppClient(e,e.getClass().getSimpleName());
          }
 finally {
            SecurityActions.setContextClassLoader(oldTccl);
          }
        }
  finally {
          CurrentServiceContainer.getServiceContainer().shutdown();
        }
      }
  finally {
        if (contextSelector instanceof LazyConnectionContextSelector) {
          ((LazyConnectionContextSelector)contextSelector).close();
        }
      }
    }
  }
);
  thread.start();
}
