{
  final CalendarTimer calendarTimer=this.getTimer();
  final TimerState timerState=calendarTimer.getState();
  if (timerState != TimerState.CANCELED && timerState != TimerState.EXPIRED) {
    if (calendarTimer.getNextExpiration() == null) {
      calendarTimer.expireTimer();
    }
 else {
      calendarTimer.setTimerState(TimerState.ACTIVE);
      timerService.persistTimer(calendarTimer);
    }
  }
}
