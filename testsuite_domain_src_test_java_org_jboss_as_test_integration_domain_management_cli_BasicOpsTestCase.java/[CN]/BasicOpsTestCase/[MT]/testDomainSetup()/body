{
  CLIWrapper cli=new CLIWrapper(false);
  String line=cli.readLine(10000);
  while (!line.contains("You are disconnected")) {
    line=cli.readLine(10000);
  }
  cli.sendLine("connect",false);
  line=cli.readLine(5000);
  assertTrue("Check we are disconnected:" + line,line.indexOf("disconnected") >= 0);
  cli.sendLine("version",false);
  line=cli.readLine(5000);
  assertTrue("Connect failed:" + line,line.indexOf("[domain@") >= 0);
  cli.sendLine(":read-children-names(child-type=host)");
  CLIOpResult res=cli.readAllAsOpResult(WAIT_TIMEOUT,WAIT_LINETIMEOUT);
  assertTrue(res.getResult() instanceof List);
  List hosts=(List)res.getResult();
  assertTrue(hosts.contains("master"));
  assertTrue(hosts.contains("slave"));
  assertTrue(checkHostServers(cli,"master",new String[]{"main-one","main-two","other-one"}));
  assertTrue(checkHostServers(cli,"slave",new String[]{"main-three","main-four","other-two"}));
  cli.quit();
}
