{
  String subsystemXml=readResource("full-expressions.xml");
  ModelVersion modelVersion=ModelVersion.create(1,1,1);
  KernelServicesBuilder builder=createKernelServicesBuilder(AdditionalInitialization.MANAGEMENT).setSubsystemXml(subsystemXml);
  final PathAddress subsystemAddress=PathAddress.pathAddress(PathElement.pathElement(SUBSYSTEM,mainSubsystemName));
  builder.createLegacyKernelServicesBuilder(null,ModelTestControllerVersion.V7_1_3_FINAL,modelVersion).addMavenResourceURL("org.jboss.as:jboss-as-transactions:7.1.3.Final").addOperationValidationResolve(ADD,subsystemAddress).excludeFromParent(SingleClassFilter.createFilter(TransactionLogger.class));
  KernelServices mainServices=builder.build();
  KernelServices legacyServices=mainServices.getLegacyServices(modelVersion);
  Assert.assertNotNull(legacyServices);
  checkSubsystemModelTransformation(mainServices,modelVersion);
}
