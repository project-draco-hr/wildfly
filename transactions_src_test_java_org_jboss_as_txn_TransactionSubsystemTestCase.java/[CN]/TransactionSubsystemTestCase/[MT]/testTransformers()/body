{
  String subsystemXml=readResource("subsystem.xml");
  ModelVersion modelVersion=ModelVersion.create(1,1,0);
  KernelServicesBuilder builder=createKernelServicesBuilder(AdditionalInitialization.MANAGEMENT).setSubsystemXml(subsystemXml);
  builder.createLegacyKernelServicesBuilder(null,modelVersion).addMavenResourceURL("org.jboss.as:jboss-as-transactions:7.1.2.Final");
  KernelServices mainServices=builder.build();
  KernelServices legacyServices=mainServices.getLegacyServices(modelVersion);
  Assert.assertNotNull(legacyServices);
  checkSubsystemModelTransformation(mainServices,modelVersion);
  final ModelNode operation=new ModelNode();
  operation.get(OP).set(WRITE_ATTRIBUTE_OPERATION);
  operation.get(OP_ADDR).add(SUBSYSTEM,TransactionExtension.SUBSYSTEM_NAME);
  operation.get(NAME).set("status-socket-binding");
  operation.get(VALUE).set("${org.jboss.test:default-socket-binding}");
  final ModelNode mainResult=mainServices.executeOperation(operation);
  Assert.assertTrue(SUCCESS.equals(mainResult.get(OUTCOME).asString()));
  final OperationTransformer.TransformedOperation op=mainServices.transformOperation(modelVersion,operation);
  ModelNode result=mainServices.executeOperation(modelVersion,op);
  Assert.assertEquals(FAILED,result.get(OUTCOME).asString());
}
