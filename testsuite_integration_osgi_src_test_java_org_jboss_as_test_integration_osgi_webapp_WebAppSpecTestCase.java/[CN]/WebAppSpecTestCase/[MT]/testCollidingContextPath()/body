{
  Bundle bundleF1=syscontext.installBundle(BUNDLE_F1_WAB,deployer.getDeployment(BUNDLE_F1_WAB));
  try {
    bundleF1.start();
    String result=performCall("/bundleF/host-message.txt");
    Assert.assertEquals("Hello from Host",result);
    result=performCall("/bundleF/servlet?input=Hello");
    Assert.assertEquals("bundle-f1.wab called with: Hello",result);
    Bundle bundleF2=syscontext.installBundle(BUNDLE_F2_WAB,deployer.getDeployment(BUNDLE_F2_WAB));
    try {
      try {
        bundleF2.start();
        Assert.fail("IOException expected");
      }
 catch (      BundleException ex) {
      }
      bundleF1.stop();
      result=performCall("/bundleF/host-message.txt");
      Assert.assertEquals("Hello from Host",result);
      result=performCall("/bundleF/servlet?input=Hello");
      Assert.assertEquals("bundle-f2.wab called with: Hello",result);
    }
  finally {
      bundleF2.uninstall();
    }
  }
  finally {
    bundleF1.uninstall();
  }
}
