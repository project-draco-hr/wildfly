{
  boolean empty=isEmpty();
  NamespaceContext context=writer.getNamespaceContext();
  String prefix=writer.getNamespaceContext().getPrefix(namespace);
  if (prefix == null) {
    writer.setDefaultNamespace(namespace);
    if (empty) {
      writer.writeEmptyElement(name);
    }
 else {
      writer.writeStartElement(name);
    }
    writer.writeNamespace(null,namespace);
  }
 else {
    if (empty) {
      writer.writeEmptyElement(namespace,name);
    }
 else {
      writer.writeStartElement(namespace,name);
    }
  }
  for (  Map.Entry<String,AttributeValue> attr : attributes.entrySet()) {
    writer.writeAttribute(attr.getKey(),attr.getValue().getValue());
  }
  for (  Node child : children) {
    child.marshall(writer);
  }
  if (!empty) {
    try {
      writer.writeEndElement();
    }
 catch (    XMLStreamException e) {
      throw e;
    }
  }
}
