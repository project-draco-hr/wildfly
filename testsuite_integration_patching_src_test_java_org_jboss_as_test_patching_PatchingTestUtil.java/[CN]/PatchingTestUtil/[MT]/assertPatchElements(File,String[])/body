{
  if (isWindows) {
    return;
  }
  File modulesPatchesDir=new File(baseModuleDir,".overlays");
  if (!modulesPatchesDir.exists()) {
    assertNull("Overlay directory does not exist, but it should",expectedPatchElements);
    return;
  }
  final List<File> patchDirs=Arrays.asList(modulesPatchesDir.listFiles(new FileFilter(){
    @Override public boolean accept(    File pathname){
      return pathname.isDirectory();
    }
  }
));
  if (expectedPatchElements == null) {
    assertTrue("Overlays directory should contain no directories, but contains: " + patchDirs.toString(),patchDirs.isEmpty());
  }
 else {
    final List<String> ids=Arrays.asList(expectedPatchElements);
    assertEquals("Overlays directory should contain " + expectedPatchElements.length + "  patches",expectedPatchElements.length,patchDirs.size());
    for (    File f : patchDirs) {
      assertTrue("Unexpected patch in .overlays directory: " + f.getName(),ids.contains(f.getName()));
    }
  }
}
