{
  final boolean restart=RESTART.resolveModelAttribute(context,operation).asBoolean();
  context.addStep(new OperationStepHandler(){
    @Override public void execute(    OperationContext context,    ModelNode operation) throws OperationFailedException {
      processState.setStopping();
      final Thread thread=new Thread(new Runnable(){
        public void run(){
          System.exit(restart ? ExitCodes.RESTART_PROCESS_FROM_STARTUP_SCRIPT : 0);
        }
      }
);
      thread.setName("Management Triggered Shutdown");
      thread.start();
      context.completeStep(OperationContext.RollbackHandler.NOOP_ROLLBACK_HANDLER);
    }
  }
,OperationContext.Stage.RUNTIME);
  context.stepCompleted();
}
