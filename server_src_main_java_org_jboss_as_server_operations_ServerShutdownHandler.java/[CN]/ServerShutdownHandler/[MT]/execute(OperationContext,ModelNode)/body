{
  final boolean restart=operation.hasDefined(RESTART) ? operation.get(RESTART).asBoolean() : false;
  context.addStep(new OperationStepHandler(){
    @Override public void execute(    OperationContext context,    ModelNode operation) throws OperationFailedException {
      final Thread thread=new Thread(new Runnable(){
        public void run(){
          System.exit(restart ? ExitCodes.RESTART_PROCESS_FROM_STARTUP_SCRIPT : 0);
        }
      }
);
      thread.setName("Management Triggered Shutdown");
      thread.start();
      context.completeStep();
    }
  }
,OperationContext.Stage.RUNTIME);
  context.completeStep();
}
