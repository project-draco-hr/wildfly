{
  ClassLoader oldTccl=WildFlySecurityManager.getCurrentContextClassLoaderPrivileged();
  try {
    for (    SetupAction action : setupActions) {
      action.setup(null);
    }
    WildFlySecurityManager.setCurrentContextClassLoaderPrivileged(classLoader);
    bootstrap.getValue().getBootstrap().startInitialization();
    bootstrap.getValue().getBootstrap().deployBeans();
    bootstrap.getValue().getBootstrap().validateBeans();
    bootstrap.getValue().getBootstrap().endInitialization();
  }
  finally {
    for (    SetupAction action : setupActions) {
      try {
        action.teardown(null);
      }
 catch (      Exception e) {
        WeldLogger.DEPLOYMENT_LOGGER.exceptionClearingThreadState(e);
      }
    }
    WildFlySecurityManager.setCurrentContextClassLoaderPrivileged(oldTccl);
  }
}
