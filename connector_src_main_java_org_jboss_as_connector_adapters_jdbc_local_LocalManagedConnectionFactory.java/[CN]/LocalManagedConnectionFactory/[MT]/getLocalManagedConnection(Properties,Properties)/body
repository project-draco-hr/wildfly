{
  Connection con=null;
  try {
    String url=getConnectionURL();
    Driver d=getDriver(url);
    con=d.connect(url,copy);
    if (con == null)     throw new ResourceException("Wrong driver class [" + d.getClass() + "] for this connection URL ["+ url+ "]");
    return new LocalManagedConnection(this,con,props,transactionIsolation,preparedStatementCacheSize);
  }
 catch (  Throwable e) {
    if (con != null) {
      try {
        con.close();
      }
 catch (      Throwable ignored) {
      }
    }
    throw new ResourceException("Could not create connection",e);
  }
}
