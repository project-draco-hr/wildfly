{
  try {
    final Object[] params=new Object[beans.size()];
    final Set<CreationalContext<?>> contexts=new HashSet<CreationalContext<?>>();
    int i=0;
    for (    Bean<?> bean : beans) {
      final CreationalContext<?> ctx=beanManager.createCreationalContext(bean);
      contexts.add(ctx);
      final Object value=beanManager.getReference(bean,method.getParameterTypes()[i],ctx);
      params[i++]=value;
    }
    method.invoke(instance,params);
    return contexts;
  }
 catch (  IllegalAccessException e) {
    throw new RuntimeException("Failed to perform CDI injection of initalizer method: " + method + " on "+ instance.getClass(),e);
  }
catch (  InvocationTargetException e) {
    throw new RuntimeException("Failed to perform CDI injection of field: " + method + " on "+ instance.getClass(),e);
  }
}
