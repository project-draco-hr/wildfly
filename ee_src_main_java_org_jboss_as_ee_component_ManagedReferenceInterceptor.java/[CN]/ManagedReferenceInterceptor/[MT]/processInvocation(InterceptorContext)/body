{
  final ManagedReference existing=referenceReference.get();
  if (existing == null) {
    final ManagedReference reference=componentInstantiator.getReference();
    boolean ok=false;
    try {
      referenceReference.set(reference);
      context.setTarget(reference.getInstance());
      Object result=context.proceed();
      ok=true;
      return result;
    }
  finally {
      context.setTarget(null);
      if (!ok) {
        reference.release();
        referenceReference.set(null);
      }
    }
  }
 else {
    return context.proceed();
  }
}
