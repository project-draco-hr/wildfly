{
  Writer writer=resp.getWriter();
  String method=req.getParameter("method");
  String username=req.getParameter("username");
  String password=req.getParameter("password");
  if ("whoAmI".equals(method)) {
    LoginContext lc=null;
    try {
      if (username != null && password != null) {
        lc=getCLMLoginContext(username,password);
        lc.login();
      }
      try {
        writer.write(bean.whoAmI());
      }
  finally {
        if (lc != null) {
          lc.logout();
        }
      }
    }
 catch (    LoginException le) {
      throw new IOException("Unexpected failure",le);
    }
  }
 else   if ("doubleWhoAmI".equals(method)) {
    String[] response=null;
    if (username != null && password != null) {
      try {
        response=bean.doubleWhoAmI(username,password);
      }
 catch (      Exception e) {
        writer.write(e.getClass().getName());
      }
    }
 else {
      try {
        response=bean.doubleWhoAmI();
      }
 catch (      Exception e) {
        throw new ServletException("Unexpected failure",e);
      }
    }
    writer.write(response[0] + "," + response[1]);
  }
 else {
    throw new IllegalArgumentException("Parameter 'method' either missing or invalid method='" + method + "'");
  }
}
