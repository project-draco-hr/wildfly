{
  Config config=this.configuration;
switch (config.referralHandling) {
case FOLLOW:
    return new LdapConnectionManager(){
      @Override public void verifyIdentity(      String bindDn,      String bindCredential) throws NamingException {
        LdapConnectionManagerService.this.verifyIdentity(new Config(referralUri.toString(),configuration),bindDn,bindCredential);
      }
      @Override public DirContext getConnection() throws NamingException {
        return LdapConnectionManagerService.this.getConnection(new Config(referralUri.toString(),configuration));
      }
      @Override public LdapConnectionManager findForReferral(      URI referralUri){
        return LdapConnectionManagerService.this.findForReferral(referralUri);
      }
    }
;
case THROW:
  if (this.handlesReferralFor(referralUri)) {
    return this;
  }
for (LdapConnectionManagerService current : connectionManagerRegistry.availableServices()) {
  if (current != null && current.handlesReferralFor(referralUri)) {
    return current;
  }
}
break;
default :
return null;
}
return null;
}
