{
  assertMechanism(AuthMechanism.CLIENT_CERT);
  if (credential instanceof X509CertificateCredential == false) {
    return null;
  }
  X509CertificateCredential certCred=(X509CertificateCredential)credential;
  AuthorizingCallbackHandler ach=securityRealm.getAuthorizingCallbackHandler(AuthMechanism.CLIENT_CERT);
  Principal user=certCred.getCertificate().getSubjectDN();
  Collection<Principal> userCol=Collections.singleton(user);
  SubjectUserInfo supplemental;
  try {
    supplemental=ach.createSubjectUserInfo(userCol);
  }
 catch (  IOException e) {
    return null;
  }
  addInetPrincipal(supplemental.getSubject().getPrincipals());
  return new RealmIdentityAccount(supplemental.getSubject(),user);
}
