{
  if (mechanism != currentMechanism.get()) {
    throw new IllegalStateException("Unexpected authentication mechanism executing.");
  }
}
