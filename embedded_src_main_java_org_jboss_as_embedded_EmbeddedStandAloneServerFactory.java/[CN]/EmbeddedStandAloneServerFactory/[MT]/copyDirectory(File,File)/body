{
  for (  String current : src.list()) {
    final File srcFile=new File(src,current);
    final File destFile=new File(dest,current);
    if (srcFile.isDirectory()) {
      destFile.mkdir();
      copyDirectory(srcFile,destFile);
    }
 else {
      try {
        final InputStream in=new BufferedInputStream(new FileInputStream(srcFile));
        final OutputStream out=new BufferedOutputStream(new FileOutputStream(destFile));
        try {
          int i;
          while ((i=in.read()) != -1) {
            out.write(i);
          }
        }
 catch (        IOException e) {
          throw ServerMessages.MESSAGES.errorCopyingFile(srcFile.getAbsolutePath(),destFile.getAbsolutePath(),e);
        }
 finally {
          StreamUtils.safeClose(in);
          StreamUtils.safeClose(out);
        }
      }
 catch (      FileNotFoundException e) {
        throw EmbeddedLogger.ROOT_LOGGER.cannotSetupEmbeddedServer(e);
      }
    }
  }
}
