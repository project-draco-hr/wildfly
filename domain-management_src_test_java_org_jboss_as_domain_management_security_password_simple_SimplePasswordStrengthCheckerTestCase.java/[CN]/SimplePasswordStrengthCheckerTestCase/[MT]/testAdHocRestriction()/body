{
  List<PasswordRestriction> restrictions=new ArrayList<PasswordRestriction>();
  restrictions.add(ALPHA_RESTRICTION);
  restrictions.add(SYMBOL_RESTRICTION);
  SimplePasswordStrengthChecker checker=new SimplePasswordStrengthChecker(restrictions,this.dictionary,this.keyboard);
  String pwd="!#*_3x";
  List<PasswordRestriction> adHocRestrictions=new ArrayList<PasswordRestriction>();
  ValueRestriction restriction=new ValueRestriction(new String[]{pwd});
  adHocRestrictions.add(restriction);
  PasswordStrengthCheckResult result=checker.check("",pwd,adHocRestrictions);
  assertNotNull(result);
  assertNotNull(result.getPassedRestrictions());
  assertNotNull(result.getRestrictionFailures());
  assertEquals(2,result.getPassedRestrictions().size());
  assertEquals(1,result.getRestrictionFailures().size());
  assertNotNull(result.getStrength());
  assertEquals(ALPHA_RESTRICTION,result.getPassedRestrictions().get(0));
  assertEquals(SYMBOL_RESTRICTION,result.getPassedRestrictions().get(1));
  assertEquals(MESSAGES.passwordMustNotBeEqual(pwd).getMessage(),result.getRestrictionFailures().get(0).getMessage());
}
