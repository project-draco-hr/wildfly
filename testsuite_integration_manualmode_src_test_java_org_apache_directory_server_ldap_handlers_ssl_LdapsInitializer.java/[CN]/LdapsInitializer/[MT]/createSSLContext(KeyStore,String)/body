{
  try {
    final KeyManagerFactory keyManagerFactory=KeyManagerFactory.getInstance(KeyManagerFactory.getDefaultAlgorithm());
    keyManagerFactory.init(keystore,keystorePwd.toCharArray());
    SSLContext sslContext=SSLContext.getInstance("TLS");
    sslContext.init(keyManagerFactory.getKeyManagers(),new TrustManager[]{new TrustAndStoreTrustManager()},null);
    return sslContext;
  }
 catch (  Exception e) {
    throw new LdapException("Creating SSL context failed.",e);
  }
}
