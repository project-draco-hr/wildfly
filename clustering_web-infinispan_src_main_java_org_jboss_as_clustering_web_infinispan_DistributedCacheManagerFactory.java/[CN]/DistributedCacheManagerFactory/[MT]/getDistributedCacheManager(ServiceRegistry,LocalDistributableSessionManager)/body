{
  Cache<SessionKeyImpl,Map<Object,Object>> sessionCache=this.sessionCacheSource.getCache(registry,manager);
  SharedLocalYieldingClusterLockManager lockManager=this.lockManagerSource.getLockManager(sessionCache);
  BatchingManager batchingManager=new TransactionBatchingManager(sessionCache.getAdvancedCache().getTransactionManager());
  SessionAttributeStorage<T> storage=this.storageFactory.createStorage(manager.getReplicationConfig().getReplicationGranularity(),this.marshallerFactory.createMarshaller(manager));
  return new DistributedCacheManager<T,SessionKeyImpl>(registry,manager,new AtomicMapCache<SessionKeyImpl,Object,Object>(sessionCache),this.jvmRouteCacheSource,lockManager,storage,batchingManager,new SessionKeyFactoryImpl(manager),this.invoker);
}
