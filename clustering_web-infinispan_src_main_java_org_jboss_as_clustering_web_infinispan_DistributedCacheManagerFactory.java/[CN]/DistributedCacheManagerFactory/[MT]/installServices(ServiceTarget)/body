{
  InjectedValue<Cache> cache=new InjectedValue<Cache>();
  InjectedValue<Registry.RegistryEntryProvider> providerValue=new InjectedValue<Registry.RegistryEntryProvider>();
  ServiceController<?> controller=AsynchronousService.addService(target,JVM_ROUTE_REGISTRY_SERVICE_NAME,new RegistryService(cache,providerValue)).addDependency(CacheService.getServiceName(DEFAULT_CACHE_CONTAINER,null),Cache.class,cache).addDependency(DistributedCacheManagerFactoryService.JVM_ROUTE_REGISTRY_ENTRY_PROVIDER_SERVICE_NAME,Registry.RegistryEntryProvider.class,providerValue).setInitialMode(ServiceController.Mode.ON_DEMAND).install();
  return Collections.<ServiceController<?>>singleton(controller);
}
