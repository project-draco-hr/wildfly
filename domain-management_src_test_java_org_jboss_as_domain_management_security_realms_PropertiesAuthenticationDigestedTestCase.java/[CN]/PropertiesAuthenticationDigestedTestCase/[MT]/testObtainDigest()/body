{
  AuthorizingCallbackHandler cbh=securityRealm.getAuthorizingCallbackHandler(AuthMechanism.DIGEST);
  NameCallback ncb=new NameCallback("Username",TEST_USERNAME);
  RealmCallback rcb=new RealmCallback("Realm",TEST_REALM);
  DigestHashCallback dhc=new DigestHashCallback("Hash");
  cbh.handle(new Callback[]{ncb,rcb,dhc});
  UsernamePasswordHashUtil uph=new UsernamePasswordHashUtil();
  String expected=uph.generateHashedHexURP(TEST_USERNAME,TEST_REALM,TEST_PASSWORD.toCharArray());
  assertEquals("Expected hash",expected,dhc.getHexHash());
}
