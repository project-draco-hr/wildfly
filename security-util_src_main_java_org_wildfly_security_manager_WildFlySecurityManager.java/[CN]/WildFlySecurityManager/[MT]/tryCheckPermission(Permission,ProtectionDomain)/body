{
  final ProtectionDomain protectionDomain=findAccessDenial(permission,domains);
  if (protectionDomain != null) {
    if (ENTERED.get() != TRUE) {
      ENTERED.set(TRUE);
      try {
        final CodeSource codeSource=protectionDomain.getCodeSource();
        final ClassLoader classLoader=protectionDomain.getClassLoader();
        final Principal[] principals=protectionDomain.getPrincipals();
        if (principals == null || principals.length == 0) {
          access.accessCheckFailed(permission,codeSource,classLoader);
        }
 else {
          access.accessCheckFailed(permission,codeSource,classLoader,Arrays.toString(principals));
        }
      }
  finally {
        ENTERED.set(FALSE);
      }
    }
    return false;
  }
  return true;
}
