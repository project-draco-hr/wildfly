{
  ClassLoader tccl=Thread.currentThread().getContextClassLoader();
  String resourcesLocation="org/jboss/as/test/integration/web/classpath/resources/";
  JavaArchive servletJar=ShrinkWrap.create(JavaArchive.class,"jbosstest-web-libservlet.jar");
  servletJar.addClass(SimpleServlet.class);
  WebArchive war=ShrinkWrap.create(WebArchive.class,"manifest-web.war");
  war.setManifest(resourcesLocation + "manifest-web.mf");
  war.setWebXML(tccl.getResource(resourcesLocation + "manifest-web.xml"));
  war.addAsWebResource(tccl.getResource(resourcesLocation + "classpath.jsp"),"classpath.jsp");
  war.addClass(ClasspathServlet2.class);
  war.addClass(Debug.class);
  war.addAsLibrary(servletJar);
  JavaArchive utilJar=ShrinkWrap.create(JavaArchive.class,"jbosstest-web-util.jar");
  utilJar.setManifest(resourcesLocation + "manifest-util.mf");
  utilJar.addClass(Util.class);
  JavaArchive utilJar2=ShrinkWrap.create(JavaArchive.class,"jbosstest-web-util2.jar");
  utilJar2.addPackage(Util2.class.getPackage());
  EnterpriseArchive ear=ShrinkWrap.create(EnterpriseArchive.class,"manifest-web.ear");
  ear.setApplicationXML(tccl.getResource(resourcesLocation + "application.xml"));
  ear.addAsModule(war);
  ear.addAsModule(utilJar);
  ear.addAsModule(utilJar2);
  System.out.println(ear.toString(true));
  System.out.println(war.toString(true));
  System.out.println(servletJar.toString(true));
  System.out.println(utilJar.toString(true));
  System.out.println(utilJar2.toString(true));
  return ear;
}
