{
  JavaArchive archive=getTargetModuleArchive();
  assertNull("Bundle null",executeDeploy(archive));
  final ModuleIdentifier moduleId=ModuleIdentifier.create("test." + archive.getName());
  assertNotNull("Module not null",loadModule(moduleId));
  registerTargetService(moduleId);
  Bundle bundle=getBundleManager().installBundle(moduleId);
  assertBundleState(Bundle.INSTALLED,bundle.getState());
  String result=invokeTargetService(moduleId,"hello world");
  assertEquals("hello world",result);
  bundle.uninstall();
  assertBundleState(Bundle.UNINSTALLED,bundle.getState());
}
