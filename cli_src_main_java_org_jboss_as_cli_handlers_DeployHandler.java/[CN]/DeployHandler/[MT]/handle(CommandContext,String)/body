{
  ModelControllerClient client=ctx.getModelControllerClient();
  if (client == null) {
    ctx.printLine("The controller client is not available. Make sure you are connected to the controller.");
    return;
  }
  if (args == null) {
    ctx.printLine("Required argument is missing.");
    return;
  }
  final String filePath;
  final String name;
  final String runtimeName;
  int spaceInd=args.indexOf(' ');
  if (spaceInd < 0) {
    filePath=args;
  }
 else {
    filePath=args.substring(0,spaceInd);
  }
  File f=new File(filePath);
  if (!f.exists()) {
    ctx.printLine("The path doesn't exist: " + f.getAbsolutePath());
    return;
  }
  if (spaceInd < 0) {
    name=f.getName();
    runtimeName=null;
  }
 else {
    char ch=args.charAt(spaceInd++);
    while (spaceInd < args.length() && Character.isWhitespace(ch)) {
      ch=args.charAt(spaceInd++);
    }
    if (spaceInd == args.length()) {
      name=f.getName();
      runtimeName=null;
    }
 else {
      int nextSpace=args.indexOf(' ',spaceInd + 1);
      if (nextSpace < 0) {
        name=args.substring(spaceInd - 1,args.length());
        runtimeName=null;
      }
 else {
        name=args.substring(spaceInd - 1,nextSpace);
        runtimeName=args.substring(nextSpace).trim();
      }
    }
  }
  final String url;
  try {
    url=f.toURI().toURL().toExternalForm();
  }
 catch (  Exception e) {
    ctx.printLine("Failed to create a URL from '" + args + "': "+ e.getLocalizedMessage());
    return;
  }
  DefaultOperationRequestBuilder builder=new DefaultOperationRequestBuilder();
  builder.setOperationName("upload-deployment-url");
  builder.addProperty("name",name);
  if (runtimeName != null) {
    builder.addProperty("runtime-name",runtimeName);
  }
  builder.addProperty("url",url);
  ModelNode result;
  try {
    ModelNode request=builder.buildRequest();
    result=client.execute(request);
  }
 catch (  Exception e) {
    ctx.printLine("Failed to upload content: " + e.getLocalizedMessage());
    return;
  }
  if (!Util.isSuccess(result)) {
    ctx.printLine(Util.getFailureDescription(result));
    return;
  }
  byte[] hash=Util.getHash(result);
  if (hash == null) {
    ctx.printLine("Failed to obtain the hash of the deployment.");
    return;
  }
  builder=new DefaultOperationRequestBuilder();
  builder.setOperationName("add");
  builder.addNode("deployment",name);
  builder.getModelNode().get("hash").set(hash);
  try {
    ModelNode request=builder.buildRequest();
    result=client.execute(request);
  }
 catch (  Exception e) {
    ctx.printLine("Failed to add the deployment content to the repository: " + e.getLocalizedMessage());
    return;
  }
  if (!Util.isSuccess(result)) {
    ctx.printLine(Util.getFailureDescription(result));
    return;
  }
  builder=new DefaultOperationRequestBuilder();
  builder.setOperationName("deploy");
  builder.addNode("deployment",name);
  try {
    ModelNode request=builder.buildRequest();
    result=client.execute(request);
  }
 catch (  Exception e) {
    ctx.printLine("Failed to deploy: " + e.getLocalizedMessage());
    return;
  }
  if (!Util.isSuccess(result)) {
    ctx.printLine(Util.getFailureDescription(result));
    return;
  }
  ctx.printLine("'" + name + "' deployed successfully.");
}
