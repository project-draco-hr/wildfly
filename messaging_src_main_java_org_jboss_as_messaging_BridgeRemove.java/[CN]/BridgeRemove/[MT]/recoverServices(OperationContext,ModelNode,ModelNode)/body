{
  final ServiceRegistry registry=context.getServiceRegistry(true);
  final ServiceController<?> hqService=registry.getService(MessagingServices.JBOSS_MESSAGING);
  if (hqService != null && hqService.getState() == ServiceController.State.UP) {
    final String name=PathAddress.pathAddress(operation.require(ModelDescriptionConstants.OP_ADDR)).getLastElement().getValue();
    final BridgeConfiguration bridgeConfiguration=BridgeAdd.createBridgeConfiguration(name,model);
    HornetQServer server=HornetQServer.class.cast(hqService.getValue());
    BridgeAdd.createBridge(name,bridgeConfiguration,server.getHornetQServerControl());
  }
}
