{
  testAddPath();
  ServiceController<?> pathManagerService=getContainer().getRequiredService(PathManagerService.SERVICE_NAME);
  PathManager pathManager=(PathManager)pathManagerService.getValue();
  ModelNode operation=createOperation(ADD);
  operation.get(OP_ADDR).add(PATH,"add3");
  operation.get(PATH).set("xyz");
  executeForResult(operation);
  PerformChangeCallback allCallback1=new PerformChangeCallback(pathManager,"add1",Event.ADDED,Event.REMOVED,Event.UPDATED);
  PerformChangeCallback allCallback2=new PerformChangeCallback(pathManager,"add2",Event.ADDED,Event.REMOVED,Event.UPDATED);
  PerformChangeCallback addCallback2=new PerformChangeCallback(pathManager,"add2",Event.ADDED);
  PerformChangeCallback changeCallback2=new PerformChangeCallback(pathManager,"add2",Event.UPDATED);
  PerformChangeCallback removeCallback2=new PerformChangeCallback(pathManager,"add2",Event.REMOVED);
  operation=createOperation(WRITE_ATTRIBUTE_OPERATION);
  operation.get(OP_ADDR).add(PATH,"add2");
  operation.get(NAME).set(RELATIVE_TO);
  operation.get(VALUE).set("add3");
  executeForResult(operation);
  allCallback1.checkDone();
  allCallback2.checkEvent(Event.UPDATED,"add2","123","add3");
  allCallback2.checkDone();
  addCallback2.checkDone();
  changeCallback2.checkEvent(Event.UPDATED,"add2","123","add3");
  changeCallback2.checkDone();
  removeCallback2.checkDone();
  operation=createOperation(WRITE_ATTRIBUTE_OPERATION);
  operation.get(OP_ADDR).add(PATH,"add2");
  operation.get(NAME).set(RELATIVE_TO);
  operation.get(VALUE).set(new ModelNode());
  executeForResult(operation);
  allCallback1.checkDone();
  allCallback2.checkEvent(Event.UPDATED,"add2","123",null);
  allCallback2.checkDone();
  addCallback2.checkDone();
  changeCallback2.checkEvent(Event.UPDATED,"add2","123",null);
  changeCallback2.checkDone();
  removeCallback2.checkDone();
  operation=createOperation(WRITE_ATTRIBUTE_OPERATION);
  operation.get(OP_ADDR).add(PATH,"add2");
  operation.get(NAME).set(PATH);
  operation.get(VALUE).set("abc");
  executeForResult(operation);
  allCallback1.checkDone();
  allCallback2.checkEvent(Event.UPDATED,"add2","abc",null);
  allCallback2.checkDone();
  addCallback2.checkDone();
  changeCallback2.checkEvent(Event.UPDATED,"add2","abc",null);
  changeCallback2.checkDone();
  removeCallback2.checkDone();
  operation=createOperation(WRITE_ATTRIBUTE_OPERATION);
  operation.get(OP_ADDR).add(PATH,"add2");
  operation.get(NAME).set(RELATIVE_TO);
  operation.get(VALUE).set("add1");
  executeForResult(operation);
  allCallback1.checkDone();
  allCallback2.checkEvent(Event.UPDATED,"add2","abc","add1");
  allCallback2.checkDone();
  addCallback2.checkDone();
  changeCallback2.checkEvent(Event.UPDATED,"add2","abc","add1");
  changeCallback2.checkDone();
  removeCallback2.checkDone();
}
