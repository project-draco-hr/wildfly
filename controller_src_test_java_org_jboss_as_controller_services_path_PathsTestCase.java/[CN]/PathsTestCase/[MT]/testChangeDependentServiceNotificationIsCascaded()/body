{
  testAddPath();
  ServiceController<?> pathManagerService=getContainer().getRequiredService(PathManagerService.SERVICE_NAME);
  PathManager pathManager=(PathManager)pathManagerService.getValue();
  PerformChangeCallback allCallback1=new PerformChangeCallback(pathManager,"add1",Event.ADDED,Event.REMOVED,Event.UPDATED);
  PerformChangeCallback allCallback2=new PerformChangeCallback(pathManager,"add2",Event.ADDED,Event.REMOVED,Event.UPDATED);
  PerformChangeCallback allCallback3=new PerformChangeCallback(pathManager,"add3",Event.ADDED,Event.REMOVED,Event.UPDATED);
  checkServiceAndPathEntry("add1","xyz",null);
  checkServiceAndPathEntry("add2","123","add1");
  ModelNode operation=createOperation(WRITE_ATTRIBUTE_OPERATION);
  operation.get(OP_ADDR).add(PATH,"add1");
  operation.get(NAME).set(PATH);
  operation.get(VALUE).set("abc");
  executeForResult(operation);
  checkServiceAndPathEntry("add1","abc",null);
  checkServiceAndPathEntry("add2","123","add1");
  allCallback1.checkEvent(Event.UPDATED,"add1","abc",null);
  allCallback1.checkDone();
  allCallback2.checkEvent(Event.UPDATED,"add2","123","add1");
  allCallback2.checkDone();
  allCallback3.checkDone();
  operation=createOperation(ADD);
  operation.get(OP_ADDR).add(PATH,"add3");
  operation.get(NAME).set(PATH);
  operation.get(PATH).set("def");
  operation.get(RELATIVE_TO).set("add2");
  executeForResult(operation);
  allCallback1.clear();
  allCallback2.clear();
  allCallback3.clear();
  operation=createOperation(WRITE_ATTRIBUTE_OPERATION);
  operation.get(OP_ADDR).add(PATH,"add1");
  operation.get(NAME).set(PATH);
  operation.get(VALUE).set("456");
  executeForResult(operation);
  checkServiceAndPathEntry("add1","456",null);
  checkServiceAndPathEntry("add2","123","add1");
  checkServiceAndPathEntry("add3","def","add2");
  allCallback1.checkEvent(Event.UPDATED,"add1","456",null);
  allCallback1.checkDone();
  allCallback2.checkEvent(Event.UPDATED,"add2","123","add1");
  allCallback2.checkDone();
  allCallback3.checkEvent(Event.UPDATED,"add3","def","add2");
  allCallback3.checkDone();
  operation=createOperation(WRITE_ATTRIBUTE_OPERATION);
  operation.get(OP_ADDR).add(PATH,"add3");
  operation.get(NAME).set(RELATIVE_TO);
  operation.get(VALUE).set(new ModelNode());
  executeForResult(operation);
  allCallback1.clear();
  allCallback2.clear();
  allCallback3.clear();
  operation=createOperation(WRITE_ATTRIBUTE_OPERATION);
  operation.get(OP_ADDR).add(PATH,"add1");
  operation.get(NAME).set(PATH);
  operation.get(VALUE).set("abc");
  executeForResult(operation);
  checkServiceAndPathEntry("add1","abc",null);
  checkServiceAndPathEntry("add2","123","add1");
  checkServiceAndPathEntry("add3","def",null);
  allCallback1.checkEvent(Event.UPDATED,"add1","abc",null);
  allCallback1.checkDone();
  allCallback2.checkEvent(Event.UPDATED,"add2","123","add1");
  allCallback2.checkDone();
  allCallback3.checkDone();
  operation=createOperation(WRITE_ATTRIBUTE_OPERATION);
  operation.get(OP_ADDR).add(PATH,"add3");
  operation.get(NAME).set(RELATIVE_TO);
  operation.get(VALUE).set("add2");
  executeForResult(operation);
  allCallback1.clear();
  allCallback2.clear();
  allCallback3.clear();
  operation=createOperation(WRITE_ATTRIBUTE_OPERATION);
  operation.get(OP_ADDR).add(PATH,"add1");
  operation.get(NAME).set(PATH);
  operation.get(VALUE).set("456");
  executeForResult(operation);
  checkServiceAndPathEntry("add1","456",null);
  checkServiceAndPathEntry("add2","123","add1");
  checkServiceAndPathEntry("add3","def","add2");
  allCallback1.checkEvent(Event.UPDATED,"add1","456",null);
  allCallback1.checkDone();
  allCallback2.checkEvent(Event.UPDATED,"add2","123","add1");
  allCallback2.checkDone();
  allCallback3.checkEvent(Event.UPDATED,"add3","def","add2");
  allCallback3.checkDone();
  operation=createOperation(REMOVE);
  operation.get(OP_ADDR).add(PATH,"add3");
  operation.get(NAME).set(RELATIVE_TO);
  operation.get(VALUE).set("add2");
  executeForResult(operation);
  allCallback1.clear();
  allCallback2.clear();
  allCallback3.clear();
  operation=createOperation(WRITE_ATTRIBUTE_OPERATION);
  operation.get(OP_ADDR).add(PATH,"add1");
  operation.get(NAME).set(PATH);
  operation.get(VALUE).set("abc");
  executeForResult(operation);
  checkServiceAndPathEntry("add1","abc",null);
  checkServiceAndPathEntry("add2","123","add1");
  allCallback1.checkEvent(Event.UPDATED,"add1","abc",null);
  allCallback1.checkDone();
  allCallback2.checkEvent(Event.UPDATED,"add2","123","add1");
  allCallback2.checkDone();
  allCallback3.checkDone();
}
