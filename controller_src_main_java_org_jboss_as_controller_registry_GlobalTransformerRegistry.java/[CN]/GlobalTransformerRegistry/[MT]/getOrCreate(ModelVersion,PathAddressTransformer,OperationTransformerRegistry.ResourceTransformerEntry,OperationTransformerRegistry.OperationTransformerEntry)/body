{
  for (; ; ) {
    final Map<ModelVersion,OperationTransformerRegistry> snapshot=registryUpdater.get(this);
    OperationTransformerRegistry registry=snapshot.get(version);
    if (registry == null) {
      registry=new OperationTransformerRegistry(pathAddressTransformer,resourceTransformer,defaultTransformer);
      OperationTransformerRegistry existing=registryUpdater.putAtomic(this,version,registry,snapshot);
      if (existing == null) {
        return registry;
      }
 else       if (existing != registry) {
        return existing;
      }
    }
    return registry;
  }
}
