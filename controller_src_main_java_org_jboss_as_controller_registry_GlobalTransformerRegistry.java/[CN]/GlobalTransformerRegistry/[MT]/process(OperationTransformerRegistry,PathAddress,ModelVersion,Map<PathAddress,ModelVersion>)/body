{
  final OperationTransformerRegistry current=registryUpdater.get(this,version);
  if (current != null) {
    final OperationTransformerRegistry.ResourceTransformerEntry resourceTransformer=current.getResourceTransformer();
    final OperationTransformerRegistry.OperationTransformerEntry defaultTransformer=current.getDefaultTransformer();
    registry.createChildRegistry(address.iterator(),current.getPathAddressTransformer(),resourceTransformer,defaultTransformer);
    final Map<String,OperationTransformerRegistry.OperationTransformerEntry> transformers=current.getTransformers();
    for (    final Map.Entry<String,OperationTransformerRegistry.OperationTransformerEntry> transformer : transformers.entrySet()) {
      registry.registerTransformer(address,transformer.getKey(),transformer.getValue().getTransformer());
    }
  }
  final Map<String,SubRegistry> snapshot=subRegistriesUpdater.get(this);
  if (snapshot != null) {
    for (    final Map.Entry<String,SubRegistry> registryEntry : snapshot.entrySet()) {
      final String key=registryEntry.getKey();
      final SubRegistry subRegistry=registryEntry.getValue();
      final Map<String,GlobalTransformerRegistry> children=SubRegistry.childrenUpdater.get(subRegistry);
      for (      final Map.Entry<String,GlobalTransformerRegistry> childEntry : children.entrySet()) {
        final String value=childEntry.getKey();
        final GlobalTransformerRegistry child=childEntry.getValue();
        final PathAddress childAddress=address.append(PathElement.pathElement(key,value));
        final ModelVersion childVersion=versions.containsKey(childAddress) ? versions.get(childAddress) : version;
        child.process(registry,childAddress,childVersion,versions);
      }
    }
  }
}
