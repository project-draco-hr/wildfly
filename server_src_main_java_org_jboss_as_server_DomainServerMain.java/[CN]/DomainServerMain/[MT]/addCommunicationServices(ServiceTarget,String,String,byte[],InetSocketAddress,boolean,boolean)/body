{
  final ServiceName endpointName;
  if (!managementSubsystemEndpoint) {
    endpointName=ManagementRemotingServices.MANAGEMENT_ENDPOINT;
    if (!isReconnect) {
      ManagementRemotingServices.installManagementRemotingEndpoint(serviceTarget,SecurityActions.getSystemProperty(ServerEnvironment.NODE_NAME));
    }
  }
 else {
    endpointName=RemotingServices.SUBSYSTEM_ENDPOINT;
  }
  HostControllerConnectionService.install(serviceTarget,endpointName,managementSocket,serverName,authKey);
  final HostControllerServerClient client=new HostControllerServerClient(serverName,serverProcessName);
  serviceTarget.addService(HostControllerServerClient.SERVICE_NAME,client).addDependency(HostControllerConnectionService.SERVICE_NAME,ManagementChannel.class,client.getHcChannelInjector()).addDependency(Services.JBOSS_SERVER_CONTROLLER,ModelController.class,client.getServerControllerInjector()).setInitialMode(ServiceController.Mode.ACTIVE).install();
}
