{
  final EjbJarMetaData ejbJarMetaData=deploymentUnit.getAttachment(EjbDeploymentAttachmentKeys.EJB_JAR_METADATA);
  Boolean beanClustered=null;
  Boolean allBeansClustered=null;
  if (ejbJarMetaData != null) {
    final AssemblyDescriptorMetaData assemblyMetadata=ejbJarMetaData.getAssemblyDescriptor();
    if (assemblyMetadata != null) {
      final List<EJBBoundClusteringMetaData> clusteringMetaDatas=assemblyMetadata.getAny(EJBBoundClusteringMetaData.class);
      if (clusteringMetaDatas != null) {
        for (        final EJBBoundClusteringMetaData clusteringMetaData : clusteringMetaDatas) {
          if ("*".equals(clusteringMetaData.getEjbName())) {
            allBeansClustered=clusteringMetaData.isClustered();
          }
 else           if (ejbComponentDescription.getComponentName().equals(clusteringMetaData.getEjbName())) {
            beanClustered=clusteringMetaData.isClustered();
          }
        }
      }
    }
  }
  if (beanClustered != null) {
    if (beanClustered) {
      this.validateAndMarkBeanAsClustered(ejbComponentDescription,new ClusteringInfo(),deploymentUnit);
    }
 else {
      this.validateAndMarkBeanAsClustered(ejbComponentDescription,null,deploymentUnit);
    }
  }
 else   if (allBeansClustered != null) {
    if (allBeansClustered) {
      this.validateAndMarkBeanAsClustered(ejbComponentDescription,new ClusteringInfo(),deploymentUnit);
    }
 else {
      this.validateAndMarkBeanAsClustered(ejbComponentDescription,null,deploymentUnit);
    }
  }
}
