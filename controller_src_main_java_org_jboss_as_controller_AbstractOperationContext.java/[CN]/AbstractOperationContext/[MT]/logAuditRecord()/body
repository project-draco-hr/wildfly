{
  if (!auditLogged) {
    try {
      AccessAuditContext accessContext=SecurityActions.currentAccessAuditContext();
      Caller caller=getCaller();
      Subject subject=SecurityActions.getSubject(caller);
      auditLogger.log(!isModelAffected(),resultAction,caller == null ? null : caller.getName(),accessContext == null ? null : accessContext.getDomainUuid(),accessContext == null ? null : accessContext.getAccessMechanism(),getSubjectInetAddress(subject),getModel(),controllerOperations);
      auditLogged=true;
    }
 catch (    Exception e) {
      ControllerLogger.MGMT_OP_LOGGER.failedToUpdateAuditLog(e);
    }
  }
}
