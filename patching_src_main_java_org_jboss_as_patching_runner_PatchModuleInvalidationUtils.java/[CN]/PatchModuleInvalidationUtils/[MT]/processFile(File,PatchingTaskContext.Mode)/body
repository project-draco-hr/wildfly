{
  if (mode == PatchingTaskContext.Mode.APPLY) {
    if (ENABLE_INVALIDATION) {
      updateJar(file,GOOD_ENDSIG_PATTERN,BAD_BYTE_SKIP,CRIPPLED_ENDSIG,GOOD_ENDSIG);
    }
  }
 else   if (mode == PatchingTaskContext.Mode.ROLLBACK) {
    updateJar(file,CRIPPLED_ENDSIG_PATTERN,BAD_BYTE_SKIP,GOOD_ENDSIG,CRIPPLED_ENDSIG);
  }
 else {
    throw new IllegalStateException();
  }
}
