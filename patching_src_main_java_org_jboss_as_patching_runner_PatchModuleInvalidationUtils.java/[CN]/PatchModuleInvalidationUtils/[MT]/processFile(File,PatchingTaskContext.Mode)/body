{
  if (mode == PatchingTaskContext.Mode.APPLY) {
    updateJar(file,GOOD_ENDSIG_PATTERN,GOOD_END_BAD_BYTE_SKIP,CRIPPLED_ENDSIG,GOOD_ENDSIG);
  }
 else   if (mode == PatchingTaskContext.Mode.ROLLBACK) {
    updateJar(file,CRIPPLED_ENDSIG_PATTERN,CRIPPLED_BAD_BYTE_SKIP,GOOD_ENDSIG,CRIPPLED_ENDSIG);
  }
 else {
    throw new IllegalStateException();
  }
}
