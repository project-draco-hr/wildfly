{
  ContainerAnalysis ret=null;
  try {
synchronized (this) {
      ret=lookupDone(cls);
      if (ret != null)       return ret;
      final ContainerAnalysis inProgress=workInProgress.get(new InProgressKey(cls,Thread.currentThread()));
      if (inProgress != null) {
        return inProgress;
      }
      ret=createWorkInProgress(cls);
    }
    doTheWork(cls,ret);
  }
  finally {
synchronized (this) {
      workInProgress.remove(new InProgressKey(cls,Thread.currentThread()));
      if (ret != null) {
        workDone.put(cls,new SoftReference<ContainerAnalysis>(ret));
      }
      notifyAll();
    }
  }
  return ret;
}
