{
  assertNotBuilt();
  built=true;
  ModelNode add=new ModelNode();
  add.get(OP).set(ADD);
  add.get(ADDRESS).set(parent.getLdapAuthorizationAddress().add(GROUP_SEARCH,PRINCIPAL_TO_GROUP));
  if (groupDnAttribute != null) {
    add.get(GROUP_DN_ATTRIBUTE).set(groupDnAttribute);
  }
  if (groupName != null) {
    add.get(GROUP_NAME).set(groupName.toString());
  }
  if (groupNameAttribute != null) {
    add.get(GROUP_NAME_ATTRIBUTE).set(groupNameAttribute);
  }
  if (iterative) {
    add.get(ITERATIVE).set(true);
  }
  if (groupAttribute != null) {
    add.get(GROUP_ATTRIBUTE).set(groupAttribute);
  }
  if (preferOriginalConnection == false) {
    add.get(PREFER_ORIGINAL_CONNECTION).set(preferOriginalConnection);
  }
  return parent.addStep(add);
}
