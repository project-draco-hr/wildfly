{
  log.info("stopping server " + serverName);
  final String processName=ManagedServer.getServerProcessName(serverName);
  try {
    final ManagedServer server=servers.get(processName);
    if (server != null) {
      server.setState(ServerState.STOPPING);
      if (gracefulTimeout > -1) {
        log.warnf("Graceful shutdown of server %s was requested but is not presently supported. " + "Falling back to rapid shutdown.",serverName);
        server.stopServerProcess();
        server.removeServerProcess();
      }
 else {
        server.stopServerProcess();
        server.removeServerProcess();
      }
    }
  }
 catch (  final Exception e) {
    log.errorf(e,"Failed to stop server %s",serverName);
  }
  return determineServerStatus(serverName);
}
