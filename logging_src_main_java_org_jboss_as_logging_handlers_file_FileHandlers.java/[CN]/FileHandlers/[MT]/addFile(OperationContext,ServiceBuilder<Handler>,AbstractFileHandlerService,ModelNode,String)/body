{
  ServiceController<?> result=null;
  if (file.isDefined()) {
    final ModelNode path=PATH.resolveModelAttribute(context,file);
    final ModelNode relativeTo=RELATIVE_TO.resolveModelAttribute(context,file);
    final ServiceName serviceName=LogServices.handlerFileName(name);
    final ServiceTarget serviceTarget=context.getServiceTarget();
    final HandlerFileService fileService=new HandlerFileService(path.asString(),relativeTo.isDefined() ? relativeTo.asString() : null);
    final ServiceBuilder<?> fileBuilder=serviceTarget.addService(serviceName,fileService);
    fileBuilder.addDependency(PathManagerService.SERVICE_NAME,PathManager.class,fileService.getPathManagerInjector());
    result=fileBuilder.setInitialMode(ServiceController.Mode.ACTIVE).install();
    serviceBuilder.addDependency(serviceName,String.class,service.getFileNameInjector());
  }
  return result;
}
