{
  final String fileContent="Hello World!";
  File tempDir=mkdir(new File(System.getProperty("java.io.tmpdir")),randomString());
  String patchID=randomString();
  File oneOffPatchDir=mkdir(tempDir,patchID);
  ContentModification miscFileAdded=ContentModificationUtils.addMisc(oneOffPatchDir,patchID,fileContent,"awesomeDirectory","awesomeFile");
  ProductConfig productConfig=new ProductConfig(PRODUCT,AS_VERSION,"main");
  Patch oneOffPatch=PatchBuilder.create().setPatchId(patchID).setDescription("A one-off patch adding a misc file.").oneOffPatchIdentity(productConfig.getProductName(),productConfig.getProductVersion()).getParent().addContentModification(miscFileAdded).build();
  PatchingTestUtil.createPatchXMLFile(oneOffPatchDir,oneOffPatch);
  File zippedPatch=PatchingTestUtil.createZippedPatchFile(oneOffPatchDir,patchID);
  controller.start(CONTAINER);
  CliUtilsForPatching.applyPatch(zippedPatch.getAbsolutePath());
  controller.stop(CONTAINER);
  controller.start(CONTAINER);
  String path=PatchingTestUtil.AS_DISTRIBUTION + "/awesomeDirectory/awesomeFile";
  Assert.assertTrue("File " + path + " should exist",new File(path).exists());
  Assert.assertTrue("The patch " + patchID + " should be listed as installed",CliUtilsForPatching.getInstalledPatches().contains(patchID));
  Assert.assertEquals("Unexpected contents of misc file",fileContent,PatchingTestUtil.readFile(path));
  controller.stop(CONTAINER);
  controller.start(CONTAINER);
  CliUtilsForPatching.rollbackPatch(patchID);
  controller.stop(CONTAINER);
  controller.start(CONTAINER);
  Assert.assertFalse("File + " + path + " should have been deleted",new File(path).exists());
  Assert.assertFalse("The patch " + patchID + " NOT should be listed as installed",CliUtilsForPatching.getInstalledPatches().contains(patchID));
  controller.stop(CONTAINER);
}
