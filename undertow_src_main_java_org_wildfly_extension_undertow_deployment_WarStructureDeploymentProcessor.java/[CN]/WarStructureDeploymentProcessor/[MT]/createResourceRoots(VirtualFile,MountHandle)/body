{
  final List<ResourceRoot> entries=new ArrayList<ResourceRoot>();
  final VirtualFile webinfClasses=deploymentRoot.getChild(WEB_INF_CLASSES);
  if (webinfClasses.exists()) {
    final ResourceRoot webInfClassesRoot=new ResourceRoot(webinfClasses.getName(),webinfClasses,null);
    ModuleRootMarker.mark(webInfClassesRoot);
    entries.add(webInfClassesRoot);
  }
  final VirtualFile webinfLib=deploymentRoot.getChild(WEB_INF_LIB);
  if (webinfLib.exists()) {
    final List<VirtualFile> archives=webinfLib.getChildren(DEFAULT_WEB_INF_LIB_FILTER);
    for (    final VirtualFile archive : archives) {
      try {
        final Closeable closable;
        if (archive.isFile()) {
          closable=VFS.mountZip(archive,archive,TempFileProviderService.provider());
        }
 else {
          closable=null;
        }
        final ResourceRoot webInfArchiveRoot=new ResourceRoot(archive.getName(),archive,new MountHandle(closable));
        ModuleRootMarker.mark(webInfArchiveRoot);
        entries.add(webInfArchiveRoot);
      }
 catch (      IOException e) {
        throw new DeploymentUnitProcessingException(MESSAGES.failToProcessWebInfLib(archive),e);
      }
    }
  }
  return entries;
}
