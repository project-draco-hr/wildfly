{
  super(manager,q);
  JDBCJBossQLQueryMetaData metadata=(JDBCJBossQLQueryMetaData)q;
  if (getLog().isDebugEnabled()) {
    getLog().debug("JBossQL: " + metadata.getJBossQL());
  }
  QLCompiler compiler=JDBCQueryManager.getInstance(metadata.getQLCompilerClass(),manager.getCatalog());
  try {
    compiler.compileJBossQL(metadata.getJBossQL(),metadata.getMethod().getReturnType(),metadata.getMethod().getParameterTypes(),metadata);
  }
 catch (  Throwable t) {
    throw new RuntimeException(CmpMessages.MESSAGES.errorCompilingJbossQlStatement(metadata.getJBossQL(),t));
  }
  setSQL(compiler.getSQL());
  setOffsetParam(compiler.getOffsetParam());
  setOffsetValue(compiler.getOffsetValue());
  setLimitParam(compiler.getLimitParam());
  setLimitValue(compiler.getLimitValue());
  if (compiler.isSelectEntity()) {
    JDBCEntityBridge selectEntity=(JDBCEntityBridge)compiler.getSelectEntity();
    setSelectEntity(selectEntity);
    JDBCReadAheadMetaData readahead=metadata.getReadAhead();
    if (readahead.isOnFind()) {
      setEagerLoadGroup(readahead.getEagerLoadGroup());
      setOnFindCMRList(compiler.getLeftJoinCMRList());
      if (compiler.isSelectDistinct()) {
        boolean[] mask=getEagerLoadMask();
        JDBCCMPFieldBridge[] tableFields=(JDBCCMPFieldBridge[])selectEntity.getTableFields();
        for (int i=0; i < tableFields.length; ++i) {
          if (mask[i] && !tableFields[i].getJDBCType().isSearchable()) {
            mask[i]=false;
          }
        }
      }
    }
  }
 else   if (compiler.isSelectField()) {
    setSelectField((JDBCCMPFieldBridge)compiler.getSelectField());
  }
 else {
    setSelectFunction(compiler.getSelectFunction(),(JDBCStoreManager)compiler.getStoreManager());
  }
  setParameterList(compiler.getInputParameters());
}
