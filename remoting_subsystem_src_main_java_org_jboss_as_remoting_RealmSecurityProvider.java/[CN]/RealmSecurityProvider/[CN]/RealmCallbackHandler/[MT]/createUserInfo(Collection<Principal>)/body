{
  Collection<Principal> converted=new ArrayList<Principal>(remotingPrincipals.size());
  Principal inetAddressPrincipal=null;
  for (  Principal current : remotingPrincipals) {
    if (current instanceof UserPrincipal) {
      if (realm != null) {
        converted.add(new RealmUser(realm.getName(),current.getName()));
      }
 else {
        converted.add(new RealmUser(current.getName()));
      }
    }
 else     if (current instanceof InetAddressPrincipal) {
      inetAddressPrincipal=new org.jboss.as.controller.security.InetAddressPrincipal(((InetAddressPrincipal)current).getInetAddress());
    }
  }
  SubjectUserInfo sui=innerHandler.createSubjectUserInfo(converted);
  Subject subject=sui.getSubject();
  subject.getPrincipals().addAll(remotingPrincipals);
  if (inetAddressPrincipal != null) {
    subject.getPrincipals().add(inetAddressPrincipal);
  }
  return new RealmSubjectUserInfo(sui);
}
