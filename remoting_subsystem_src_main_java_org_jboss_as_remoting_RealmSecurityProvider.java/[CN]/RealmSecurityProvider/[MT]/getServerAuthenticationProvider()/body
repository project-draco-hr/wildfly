{
  return new ServerAuthenticationProvider(){
    @Override public AuthorizingCallbackHandler getCallbackHandler(    String mechanismName){
      final CallbackHandler cbh=RealmSecurityProvider.this.getCallbackHandler(mechanismName);
      if (cbh instanceof AuthorizingCallbackHandler) {
        return (AuthorizingCallbackHandler)cbh;
      }
 else {
        return new AuthorizingCallbackHandler(){
          public void handle(          Callback[] callbacks) throws IOException, UnsupportedCallbackException {
            cbh.handle(callbacks);
          }
          public UserInfo createUserInfo(          final Collection<Principal> remotingPrincipals){
            return new SimpleUserInfo(remotingPrincipals);
          }
        }
;
      }
    }
  }
;
}
