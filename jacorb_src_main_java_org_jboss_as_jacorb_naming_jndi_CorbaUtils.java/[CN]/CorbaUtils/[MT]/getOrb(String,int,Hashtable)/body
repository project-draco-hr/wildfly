{
  Properties orbProp;
  if (env != null) {
    if (env instanceof Properties) {
      orbProp=(Properties)env.clone();
    }
 else {
      Enumeration envProp;
      orbProp=new Properties();
      for (envProp=env.keys(); envProp.hasMoreElements(); ) {
        String key=(String)envProp.nextElement();
        Object val=env.get(key);
        if (val instanceof String) {
          orbProp.put(key,val);
        }
      }
    }
  }
 else {
    orbProp=new Properties();
  }
  if (server != null) {
    orbProp.put("org.omg.CORBA.ORBInitialHost",server);
  }
  if (port >= 0) {
    orbProp.put("org.omg.CORBA.ORBInitialPort","" + port);
  }
  if (env != null) {
    Object applet=env.get(Context.APPLET);
    if (applet != null) {
      return initAppletORB(applet,orbProp);
    }
  }
  return ORB.init(new String[0],orbProp);
}
