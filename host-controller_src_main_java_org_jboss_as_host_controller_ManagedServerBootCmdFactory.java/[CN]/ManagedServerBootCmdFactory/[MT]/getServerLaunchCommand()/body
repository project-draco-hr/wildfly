{
  final List<String> command=new ArrayList<String>();
  if (jvmElement.getLaunchCommand() != null) {
    List<String> commandPrefix=getLaunchPrefixCommands();
    if (commandPrefix != null)     command.addAll(commandPrefix);
  }
  command.add(getJavaCommand());
  command.add("-D[" + ManagedServer.getServerProcessName(serverName) + "]");
  JvmOptionsBuilderFactory.getInstance().addOptions(jvmElement,command);
  Map<String,String> bootTimeProperties=getAllSystemProperties(true);
  for (  Map.Entry<String,String> hostProp : environment.getHostSystemProperties().entrySet()) {
    if (!bootTimeProperties.containsKey(hostProp.getKey())) {
      bootTimeProperties.put(hostProp.getKey(),hostProp.getValue());
    }
  }
  for (  Entry<String,String> entry : bootTimeProperties.entrySet()) {
    String property=entry.getKey();
    String value=entry.getValue();
    if (!"org.jboss.boot.log.file".equals(property) && !"logging.configuration".equals(property) && !HOST_CONTROLLER_PROCESS_NAME_PROP.equals(property)) {
      final StringBuilder sb=new StringBuilder("-D");
      sb.append(property);
      if (value != null) {
        sb.append('=');
        sb.append(value);
      }
      command.add(sb.toString());
    }
  }
  String serverDirProp=bootTimeProperties.get(ServerEnvironment.SERVER_BASE_DIR);
  File serverDir=serverDirProp == null ? new File(environment.getDomainServersDir(),serverName) : new File(serverDirProp);
  final String logDir=addPathProperty(command,"log",ServerEnvironment.SERVER_LOG_DIR,bootTimeProperties,directoryGrouping,environment.getDomainLogDir(),serverDir);
  addPathProperty(command,"tmp",ServerEnvironment.SERVER_TEMP_DIR,bootTimeProperties,directoryGrouping,environment.getDomainTempDir(),serverDir);
  final String dataDir=addPathProperty(command,"data",ServerEnvironment.SERVER_DATA_DIR,bootTimeProperties,directoryGrouping,environment.getDomainDataDir(),serverDir);
  final File loggingConfig=new File(dataDir,"logging.properties");
  final String path;
  if (loggingConfig.exists()) {
    path="file:" + loggingConfig.getAbsolutePath();
  }
 else {
    command.add("-Dorg.jboss.boot.log.file=" + getAbsolutePath(new File(logDir),"server.log"));
    final String domainConfigFile="file:" + getAbsolutePath(environment.getDomainConfigurationDir(),"logging.properties");
    final String systemPropConfigFile=WildFlySecurityManager.getPropertyPrivileged("logging.configuration",null);
    final File defaultConfigFile=getAbsoluteFile(environment.getDomainConfigurationDir(),"default-server-logging.properties");
    if (domainConfigFile.equals(systemPropConfigFile) && defaultConfigFile.exists()) {
      path="file:" + defaultConfigFile.getAbsolutePath();
    }
 else     if (systemPropConfigFile != null) {
      path=systemPropConfigFile;
    }
 else {
      path=domainConfigFile;
    }
  }
  command.add(String.format("-Dlogging.configuration=%s",path));
  command.add("-jar");
  command.add(getAbsolutePath(environment.getHomeDir(),"jboss-modules.jar"));
  command.add("-mp");
  command.add(environment.getModulePath());
  command.add("org.jboss.as.server");
  return command;
}
