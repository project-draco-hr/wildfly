{
  InjectedValue<ServerEnvironment> env=new InjectedValue<>();
  MyService service=new MyService(env);
  ServiceController<?> factoryService=context.getServiceRegistry().getRequiredService(SingletonServiceName.BUILDER.getServiceName(CONTAINER_NAME));
  SingletonServiceBuilderFactory factory=(SingletonServiceBuilderFactory)factoryService.getValue();
  factory.createSingletonServiceBuilder(name,service).electionPolicy(new PreferredSingletonElectionPolicy(new SimpleSingletonElectionPolicy(),new NamePreference(PREFERRED_NODE))).requireQuorum(quorum).build(context.getServiceTarget()).addDependency(ServerEnvironmentService.SERVICE_NAME,ServerEnvironment.class,env).setInitialMode(ServiceController.Mode.ACTIVE).install();
}
