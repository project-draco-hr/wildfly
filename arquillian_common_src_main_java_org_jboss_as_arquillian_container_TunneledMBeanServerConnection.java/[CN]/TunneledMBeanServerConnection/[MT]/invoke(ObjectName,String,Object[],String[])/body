{
  File notifications=File.createTempFile("arq","notifications");
  FakeJMXNotificationThread thread=new FakeJMXNotificationThread(notifications,listeners);
  thread.start();
  ModelNode request=new ModelNode();
  request.get(OP).set(INVOKE_MBEAN_RAW);
  request.get(OP_ADDR).add(SUBSYSTEM,JMX);
  request.get(MBEAN_NAME).set(name.toString());
  request.get(MBEAN_OPERATION_NAME).set(operationName);
  request.get(NOTIFICATION_FILE).set(notifications.getAbsolutePath());
  if (signature != null) {
    for (    String param : signature) {
      request.get(SIGNATURE).add(param);
    }
  }
  if (params != null) {
    for (    Object param : params) {
      request.get(PARAMETERS).add(getBytes(param));
    }
  }
  ModelNode response=client.execute(request);
  thread.done();
  notifications.delete();
  if (!SUCCESS.equals(response.get(OUTCOME).asString())) {
    throw new IOException("Failed operation: " + response.get(FAILURE_DESCRIPTION).toString());
  }
  byte[] bytes=response.get(RESULT).asBytes();
  try {
    return new ObjectInputStream(new ByteArrayInputStream(bytes)).readObject();
  }
 catch (  ClassNotFoundException e) {
    throw new IOException(e);
  }
}
