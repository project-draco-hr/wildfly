{
  final DeploymentUnit deploymentUnit=phaseContext.getDeploymentUnit();
  if (deploymentUnit.hasAttachment(DeploymentDependencies.ATTACHMENT_KEY)) {
    if (deploymentUnit.getParent() != null) {
      ServerLogger.DEPLOYMENT_LOGGER.deploymentDependenciesAreATopLevelElement(deploymentUnit.getName());
    }
 else {
      processDependencies(phaseContext,deploymentUnit);
    }
  }
  if (deploymentUnit.getParent() != null) {
    DeploymentUnit parent=deploymentUnit.getParent();
    if (parent.hasAttachment(DeploymentDependencies.ATTACHMENT_KEY)) {
      processDependencies(phaseContext,parent);
    }
  }
}
