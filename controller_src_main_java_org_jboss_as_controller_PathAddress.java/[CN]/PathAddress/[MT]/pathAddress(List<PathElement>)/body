{
  if (elements.size() == 0) {
    return EMPTY_ADDRESS;
  }
  final ArrayList<PathElement> newList=new ArrayList<PathElement>(elements.size());
  final Set<String> seen=new HashSet<String>();
  int index=0;
  for (  PathElement element : elements) {
    final String name=element.getKey();
    if (seen.add(name)) {
      newList.add(element);
    }
 else {
      throw duplicateElement(name);
    }
    if (index == 1 && name.equals(SERVER) && seen.contains(HOST)) {
      seen.clear();
    }
    index++;
  }
  return new PathAddress(Collections.unmodifiableList(newList));
}
