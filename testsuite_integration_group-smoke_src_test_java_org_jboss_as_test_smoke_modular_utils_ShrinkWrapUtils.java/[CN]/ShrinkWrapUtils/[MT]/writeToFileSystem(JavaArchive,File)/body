{
  InputStream inputStream=javaArchive.as(ZipExporter.class).exportAsInputStream();
  String jarFileName=javaArchive.getName();
  File jarFile=new File(destDirectory,jarFileName);
  FileOutputStream fos=new FileOutputStream(jarFile);
  BufferedOutputStream bos=null;
  BufferedInputStream bis=null;
  try {
    bos=new BufferedOutputStream(fos);
    bis=new BufferedInputStream(inputStream);
    byte[] content=new byte[4096];
    int length;
    while ((length=bis.read(content)) != -1) {
      bos.write(content,0,length);
    }
    bos.flush();
  }
  finally {
    if (bos != null) {
      bos.close();
    }
    if (bis != null) {
      bis.close();
    }
  }
  return jarFile;
}
