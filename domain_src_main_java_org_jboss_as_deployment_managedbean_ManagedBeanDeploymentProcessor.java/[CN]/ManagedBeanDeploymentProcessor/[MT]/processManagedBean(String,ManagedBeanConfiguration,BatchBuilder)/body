{
  final Class<Object> beanClass=(Class<Object>)managedBeanConfiguration.getType();
  final String managedBeanName=managedBeanConfiguration.getName();
  final List<ResourceInjection<?>> resourceInjections=new ArrayList<ResourceInjection<?>>();
  final ManagedBeanService<Object> managedBeanService=new ManagedBeanService<Object>(beanClass,managedBeanConfiguration.getPostConstructMethod(),managedBeanConfiguration.getPreDestroyMethod(),resourceInjections);
  final ServiceName moduleContextServiceName=ContextNames.GLOBAL_CONTEXT_SERVICE_NAME.append(deploymentName);
  final ServiceName managedBeanServiceName=ManagedBeanService.SERVICE_NAME.append(deploymentName,managedBeanName);
  final BatchServiceBuilder<?> serviceBuilder=batchBuilder.addService(managedBeanServiceName,managedBeanService);
  final ServiceName managedBeanContextName=moduleContextServiceName.append(managedBeanName,"context");
  for (  ResourceConfiguration resourceConfiguration : managedBeanConfiguration.getResourceInjectionConfigurations()) {
    final ResourceInjection<Object> resourceInjection=processResource(resourceConfiguration,batchBuilder,serviceBuilder,moduleContextServiceName,managedBeanContextName);
    if (resourceInjection != null) {
      resourceInjections.add(resourceInjection);
    }
  }
  final ContextService actualBeanContext=new ContextService(managedBeanName + "-context");
  batchBuilder.addService(managedBeanContextName,actualBeanContext).addDependency(moduleContextServiceName,Context.class,actualBeanContext.getParentContextInjector());
  final Reference managedBeanFactoryReference=ManagedBeanObjectFactory.createReference(beanClass,managedBeanServiceName);
  final ResourceBinder<Reference> managedBeanFactoryBinder=new ResourceBinder<Reference>(managedBeanName,Values.immediateValue(managedBeanFactoryReference));
  final ServiceName referenceBinderName=moduleContextServiceName.append(managedBeanName);
  batchBuilder.addService(referenceBinderName,managedBeanFactoryBinder).addDependency(moduleContextServiceName,Context.class,managedBeanFactoryBinder.getContextInjector()).addDependency(managedBeanServiceName);
}
