{
  final String localContextName=resourceConfiguration.getLocalContextName();
  final String targetContextName=resourceConfiguration.getTargetContextName();
  final ResourceInjection<Object> resourceInjection=getResourceInjection(resourceConfiguration);
  final ServiceName binderName=beanContextServiceName.append(localContextName);
  if (resourceInjection != null) {
    serviceBuilder.addDependency(binderName,resourceInjection.getValueInjector());
  }
  final LinkRef linkRef=new LinkRef(targetContextName.startsWith("java") ? targetContextName : moduleContext.getContextName() + "/" + targetContextName);
  final ResourceBinder<LinkRef> resourceBinder=new ResourceBinder<LinkRef>(localContextName,Values.immediateValue(linkRef));
  final BatchServiceBuilder<Object> binderServiceBuilder=batchBuilder.addService(binderName,resourceBinder);
  binderServiceBuilder.addDependency(beanContextServiceName,Context.class,resourceBinder.getContextInjector());
  if (targetContextName.startsWith("java:")) {
    binderServiceBuilder.addOptionalDependency(ResourceBinder.JAVA_BINDER.append(targetContextName));
  }
 else {
    binderServiceBuilder.addOptionalDependency(moduleContext.getContextServiceName().append(targetContextName));
  }
  return resourceInjection;
}
