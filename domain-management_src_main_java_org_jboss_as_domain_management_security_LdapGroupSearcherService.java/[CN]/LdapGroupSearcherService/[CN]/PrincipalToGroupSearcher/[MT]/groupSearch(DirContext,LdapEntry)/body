{
  Set<LdapEntry> foundEntries=new HashSet<LdapEntry>();
  Attributes groups=dirContext.getAttributes(entry.getDistinguishedName(),new String[]{groupAttribute});
  Attribute groupRef=groups.get(groupAttribute);
  if (groupRef != null) {
    NamingEnumeration<String> groupRefValues=(NamingEnumeration<String>)groupRef.getAll();
    while (groupRefValues.hasMore()) {
      String current=groupRefValues.next();
      String groupName=null;
      if (groupNameAttribute != null) {
        Attributes groupNameAttrs=dirContext.getAttributes(current,new String[]{groupNameAttribute});
        Attribute groupNameAttr=groupNameAttrs.get(groupNameAttribute);
        groupName=(String)groupNameAttr.get();
      }
      foundEntries.add(new LdapEntry(groupName,current));
    }
  }
  return foundEntries.toArray(new LdapEntry[foundEntries.size()]);
}
