{
  if (SECURITY_LOGGER.isTraceEnabled()) {
    SECURITY_LOGGER.tracef("createSearchControl recursive=%b,  attributes=%s",recursive,Arrays.toString(attributes));
  }
  SearchControls searchControls=new SearchControls();
  if (recursive) {
    searchControls.setSearchScope(SearchControls.SUBTREE_SCOPE);
  }
 else {
    searchControls.setSearchScope(SearchControls.ONELEVEL_SCOPE);
  }
  searchControls.setReturningAttributes(attributes);
  searchControls.setTimeLimit(searchTimeLimit);
  return searchControls;
}
