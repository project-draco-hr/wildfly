{
  try (ByteArrayOutputStream output=new ByteArrayOutputStream()){
    output.write(this.currentVersion);
    try (Marshaller marshaller=this.marshallingContext.createMarshaller(this.currentVersion)){
      marshaller.start(Marshalling.createByteOutput(output));
      marshaller.writeUTF(this.service.getCanonicalName());
      marshaller.writeObject(command);
      marshaller.flush();
    }
     return output.toByteArray();
  }
 }
