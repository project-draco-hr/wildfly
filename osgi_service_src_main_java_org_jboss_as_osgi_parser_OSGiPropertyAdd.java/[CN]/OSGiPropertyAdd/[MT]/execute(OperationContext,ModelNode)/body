{
  Resource resource=context.createResource(PathAddress.EMPTY_ADDRESS);
  ModelNode model=resource.getModel();
  final ModelNode propVal=operation.get(CommonAttributes.VALUE);
  model.get(CommonAttributes.VALUE).set(propVal);
  if (context.getType() == OperationContext.Type.SERVER) {
    context.addStep(new OperationStepHandler(){
      @Override public void execute(      OperationContext context,      ModelNode operation) throws OperationFailedException {
        String propName=operation.get(ModelDescriptionConstants.OP_ADDR).asObject().get(CommonAttributes.PROPERTY).asString();
        SubsystemState stateService=(SubsystemState)context.getServiceRegistry(true).getRequiredService(SubsystemState.SERVICE_NAME).getValue();
        Object oldVal=stateService.setProperty(propName,propVal.asString());
        if (context.completeStep() == OperationContext.ResultAction.ROLLBACK) {
          stateService.setProperty(propName,oldVal);
        }
      }
    }
,OperationContext.Stage.RUNTIME);
  }
  context.completeStep();
}
