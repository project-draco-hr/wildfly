{
  modelOnlyStates.put(index,Boolean.valueOf(modelOnly));
  OperationContext stepOperationContext;
  if (modelOnly) {
    stepOperationContext=super.getStepOperationContext(index,address,stepHandler);
  }
 else   if (stepHandler instanceof BootOperationHandler) {
    overallRuntimeContext.restartRequired();
    modelOnly=true;
    modelOnlyStates.put(index,Boolean.TRUE);
    stepOperationContext=super.getStepOperationContext(index,address,stepHandler);
  }
 else {
    final ModelNode stepModel=getStepSubModel(address,stepHandler);
    stepOperationContext=new StepRuntimeOperationContext(stepModel);
  }
  return stepOperationContext;
}
