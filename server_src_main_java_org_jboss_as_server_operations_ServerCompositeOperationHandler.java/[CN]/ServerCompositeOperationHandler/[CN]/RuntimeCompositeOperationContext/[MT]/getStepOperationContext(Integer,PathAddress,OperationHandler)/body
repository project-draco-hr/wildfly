{
  modelOnlyStates.put(index,Boolean.valueOf(modelOnly));
  NewOperationContext stepOperationContext;
  if (modelOnly) {
    stepOperationContext=super.getStepOperationContext(index,address,stepHandler);
  }
 else   if (stepHandler instanceof BootOperationHandler) {
    overallRuntimeContext.restartRequired();
    modelOnly=true;
    modelOnlyStates.put(index,Boolean.TRUE);
    stepOperationContext=super.getStepOperationContext(index,address,stepHandler);
  }
 else   if (stepHandler instanceof RuntimeOperationHandler) {
    final ModelNode stepModel=getStepSubModel(address,stepHandler);
    return getRuntimeOperationContext(stepModel);
  }
 else {
    stepOperationContext=super.getStepOperationContext(index,address,stepHandler);
  }
  return stepOperationContext;
}
