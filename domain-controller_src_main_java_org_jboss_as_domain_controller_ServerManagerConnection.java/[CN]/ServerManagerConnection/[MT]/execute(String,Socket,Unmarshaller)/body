{
  if (socket == null)   throw new IllegalArgumentException("Socket is null");
  if (unmarshaller == null)   throw new IllegalArgumentException("Unmarshaller is null");
  Marshaller marshaller=null;
  try {
    marshaller=MARSHALLER_FACTORY.createMarshaller(CONFIG);
    final OutputStream outputStream=socket.getOutputStream();
    marshaller.start(Marshalling.createByteOutput(outputStream));
    doExecute(id,socket,unmarshaller,marshaller);
  }
  finally {
    unmarshaller.finish();
    if (marshaller != null)     marshaller.finish();
  }
}
