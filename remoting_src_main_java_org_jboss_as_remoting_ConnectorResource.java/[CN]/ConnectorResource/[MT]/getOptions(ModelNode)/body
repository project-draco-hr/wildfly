{
  final OptionMap optionMap;
  if (properties.isDefined() && properties.asInt() > 0) {
    OptionMap.Builder builder=OptionMap.builder();
    final ClassLoader loader=SecurityActions.getClassLoader(ConnectorResource.class);
    for (    Property property : properties.asPropertyList()) {
      String name=property.getName();
      if (!name.contains(".")) {
        name="org.xnio.Options." + name;
      }
      final Option option=Option.fromString(name,loader);
      builder.set(option,option.parseValue(property.getValue().get(CommonAttributes.VALUE).asString(),loader));
    }
    optionMap=builder.getMap();
  }
 else {
    optionMap=OptionMap.EMPTY;
  }
  return optionMap;
}
