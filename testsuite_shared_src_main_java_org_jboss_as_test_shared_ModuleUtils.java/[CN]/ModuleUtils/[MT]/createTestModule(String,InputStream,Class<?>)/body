{
  JavaArchive jar=ShrinkWrap.create(JavaArchive.class,moduleName + ".jar");
  jar.addClasses(classes);
  jar.addAsManifestResource(EmptyAsset.INSTANCE,"beans.xml");
  addExtensionsIfAvailable(jar,classes);
  Indexer indexer=new Indexer();
  for (  Class<?> clazz : classes) {
    try (final InputStream resource=clazz.getResourceAsStream(clazz.getSimpleName() + ".class")){
      indexer.index(resource);
    }
   }
  Index index=indexer.complete();
  ByteArrayOutputStream data=new ByteArrayOutputStream();
  IndexWriter writer=new IndexWriter(data);
  writer.write(index);
  jar.addAsManifestResource(new ByteArrayAsset(data.toByteArray()),"jandex.idx");
  createTestModule(moduleName,moduleXml,jar);
}
