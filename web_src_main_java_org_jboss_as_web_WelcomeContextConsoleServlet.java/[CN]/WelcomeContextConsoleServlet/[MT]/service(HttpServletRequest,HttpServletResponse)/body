{
  String target=noconsole;
  if (hasConsole) {
    InetAddress inboundAddress=InetAddress.getByName(req.getLocalAddr());
    boolean secureRedirect=secureRedirect(req.isSecure());
    NetworkInterfaceBinding interfaceBinding=secureRedirect ? secureConsoleNetworkInterface : consoleNetworkInterface;
    String redirectHost=getRedirectHost(interfaceBinding,inboundAddress,req.getServerName());
    if (redirectHost != null) {
      if (secureRedirect) {
        target=assembleURI(HTTPS,redirectHost,consoleSecurePort,SECURE_DEFAULT_PORT,CONSOLE_PATH);
      }
 else {
        target=assembleURI(HTTP,redirectHost,consolePort,DEFAULT_PORT,CONSOLE_PATH);
      }
    }
 else {
      target=noredirect;
    }
  }
  resp.sendRedirect(target);
}
