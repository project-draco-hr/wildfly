{
  ListenerInfo l;
  final Class<? extends EventListener> listenerClass=(Class<? extends EventListener>)classReflectionIndex.classIndex(listener.getListenerClass()).getModuleClass();
  ComponentRegistry.ComponentManagedReferenceFactory creator=components.getComponentsByClass().get(listenerClass);
  if (creator != null) {
    InstanceFactory<EventListener> factory=createInstanceFactory(creator);
    l=new ListenerInfo(listenerClass,factory);
  }
 else {
    l=new ListenerInfo(listenerClass);
  }
  d.addListener(l);
}
