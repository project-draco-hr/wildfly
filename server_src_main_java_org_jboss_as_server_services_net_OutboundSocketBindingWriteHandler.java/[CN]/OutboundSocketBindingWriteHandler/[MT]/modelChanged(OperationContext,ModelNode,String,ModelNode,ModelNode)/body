{
  final boolean restartRequired=requiresRestart();
  boolean setReload=false;
  if (context.isNormalServer()) {
    if (restartRequired) {
      context.reloadRequired();
      setReload=true;
    }
 else {
      context.addStep(new OperationStepHandler(){
        public void execute(        OperationContext context,        ModelNode operation) throws OperationFailedException {
          final ModelNode resolvedValue=newValue.isDefined() ? newValue.resolve() : newValue;
          if (resolvedValueValidator != null) {
            resolvedValueValidator.validateResolvedParameter(VALUE,resolvedValue);
          }
          final PathAddress address=PathAddress.pathAddress(operation.get(OP_ADDR));
          final PathElement element=address.getLastElement();
          final String bindingName=element.getValue();
          final ModelNode bindingModel=context.readResource(PathAddress.EMPTY_ADDRESS).getModel();
          final ServiceController<?> controller=context.getServiceRegistry(true).getRequiredService(OutboundSocketBinding.OUTBOUND_SOCKET_BINDING_BASE_SERVICE_NAME.append(bindingName));
          final OutboundSocketBinding binding=controller.getState() == ServiceController.State.UP ? OutboundSocketBinding.class.cast(controller.getValue()) : null;
          final boolean bound=binding != null && binding.isConnected();
          if (binding == null) {
            handleBindingReinstall(context,bindingName,bindingModel);
          }
 else {
            context.reloadRequired();
          }
          context.completeStep(new OperationContext.RollbackHandler(){
            @Override public void handleRollback(            OperationContext context,            ModelNode operation){
              if (binding == null) {
                revertBindingReinstall(context,bindingName,bindingModel,attributeName,currentValue);
              }
 else {
                context.revertReloadRequired();
              }
            }
          }
);
        }
      }
,OperationContext.Stage.RUNTIME);
    }
  }
  OperationContext.RollbackHandler rollbackHandler=setReload ? OperationContext.RollbackHandler.REVERT_RELOAD_REQUIRED_ROLLBACK_HANDLER : OperationContext.RollbackHandler.NOOP_ROLLBACK_HANDLER;
  context.completeStep(rollbackHandler);
}
