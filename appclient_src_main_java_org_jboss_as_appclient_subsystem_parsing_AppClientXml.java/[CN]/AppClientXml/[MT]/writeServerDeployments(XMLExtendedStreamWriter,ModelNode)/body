{
  Set<String> deploymentNames=modelNode.keys();
  if (deploymentNames.size() > 0) {
    boolean deploymentWritten=false;
    for (    String uniqueName : deploymentNames) {
      final ModelNode deployment=modelNode.get(uniqueName);
      if (deployment.hasDefined(PERSISTENT) && !deployment.get(PERSISTENT).asBoolean()) {
        continue;
      }
      if (!deploymentWritten) {
        writer.writeStartElement(Element.DEPLOYMENTS.getLocalName());
        deploymentWritten=true;
      }
      final String runtimeName=deployment.get(RUNTIME_NAME).asString();
      boolean enabled=deployment.get(ENABLED).asBoolean();
      writer.writeStartElement(Element.DEPLOYMENT.getLocalName());
      writeAttribute(writer,Attribute.NAME,uniqueName);
      writeAttribute(writer,Attribute.RUNTIME_NAME,runtimeName);
      if (!enabled) {
        writeAttribute(writer,Attribute.ENABLED,"false");
      }
      final List<ModelNode> contentItems=deployment.require(CONTENT).asList();
      for (      ModelNode contentItem : contentItems) {
        writeContentItem(writer,contentItem);
      }
      writer.writeEndElement();
    }
    if (deploymentWritten) {
      writer.writeEndElement();
    }
  }
}
