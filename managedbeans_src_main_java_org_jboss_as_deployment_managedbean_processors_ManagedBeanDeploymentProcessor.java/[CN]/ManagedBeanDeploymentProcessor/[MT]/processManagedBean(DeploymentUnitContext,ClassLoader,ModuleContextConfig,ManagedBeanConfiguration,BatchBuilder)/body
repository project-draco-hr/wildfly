{
  final Class<?> beanClass=managedBeanConfiguration.getType();
  final String managedBeanName=managedBeanConfiguration.getName();
  final List<ResourceInjection<?>> resourceInjections=new ArrayList<ResourceInjection<?>>();
  final List<ManagedBeanInterceptor<?>> interceptors=new ArrayList<ManagedBeanInterceptor<?>>();
  final ManagedBeanService<?> managedBeanService=createManagedBeanService(beanClass,classLoader,managedBeanConfiguration,resourceInjections,interceptors);
  final ServiceName moduleContextServiceName=moduleContext.getContextServiceName();
  final ServiceName managedBeanServiceName=ManagedBeanService.SERVICE_NAME.append(deploymentContext.getName(),managedBeanName);
  final ServiceBuilder<?> serviceBuilder=batchBuilder.addService(managedBeanServiceName,managedBeanService);
  final ServiceName managedBeanContextServiceName=moduleContextServiceName.append(managedBeanName,"context");
  final JndiName managedBeanContextJndiName=moduleContext.getContextName().append(managedBeanName + "-context");
  for (  ResourceConfiguration resourceConfiguration : managedBeanConfiguration.getResourceConfigurations()) {
    final ResourceInjection<?> resourceInjection=processResource(deploymentContext,moduleContext,resourceConfiguration.getInjectedType(),resourceConfiguration,batchBuilder,serviceBuilder,managedBeanContextServiceName,managedBeanContextJndiName);
    if (resourceInjection != null) {
      resourceInjections.add(resourceInjection);
    }
  }
  for (  InterceptorConfiguration interceptorConfiguration : managedBeanConfiguration.getInterceptorConfigurations()) {
    interceptors.add(processInterceptor(interceptorConfiguration.getInterceptorClass(),deploymentContext,moduleContext,interceptorConfiguration,batchBuilder,serviceBuilder,managedBeanContextServiceName,managedBeanContextJndiName));
  }
  final ContextService actualBeanContext=new ContextService(managedBeanContextJndiName);
  batchBuilder.addService(managedBeanContextServiceName,actualBeanContext).addDependency(moduleContextServiceName,Context.class,actualBeanContext.getParentContextInjector());
  final Reference managedBeanFactoryReference=ManagedBeanObjectFactory.createReference(beanClass,managedBeanServiceName.toString());
  final ResourceBinder<Reference> managedBeanFactoryBinder=new ResourceBinder<Reference>(moduleContext.getContextName().append(managedBeanName),Values.immediateValue(managedBeanFactoryReference));
  final ServiceName referenceBinderName=moduleContextServiceName.append(managedBeanName);
  batchBuilder.addService(referenceBinderName,managedBeanFactoryBinder).addDependency(moduleContextServiceName,Context.class,managedBeanFactoryBinder.getContextInjector()).addDependency(managedBeanServiceName);
}
