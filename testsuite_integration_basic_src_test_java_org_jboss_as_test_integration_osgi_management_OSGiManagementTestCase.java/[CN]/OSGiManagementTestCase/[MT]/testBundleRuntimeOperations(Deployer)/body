{
  deployer.deploy("test-bundle");
  Long testBundleId=OSGiManagementOperations.getBundleId(getControllerClient(),"test-bundle",Version.parseVersion("999"));
  assertTrue(testBundleId > 0);
  ModelNode resultMap=OSGiManagementOperations.getBundleInfo(getControllerClient(),testBundleId);
  assertEquals(testBundleId.toString(),resultMap.get("id").asString());
  assertEquals("ACTIVE",resultMap.get("state").asString());
  assertEquals("1",resultMap.get("startlevel").asString());
  assertEquals("bundle",resultMap.get("type").asString());
  assertEquals("test-bundle",resultMap.get("symbolic-name").asString());
  assertEquals("999.0.0",resultMap.get("version").asString());
  assertTrue(OSGiManagementOperations.bundleStop(getControllerClient(),testBundleId));
  ModelNode resultMap3=OSGiManagementOperations.getBundleInfo(getControllerClient(),testBundleId);
  assertEquals("RESOLVED",resultMap3.get("state").asString());
  assertTrue(OSGiManagementOperations.bundleStart(getControllerClient(),testBundleId));
  ModelNode resultMap2=OSGiManagementOperations.getBundleInfo(getControllerClient(),testBundleId);
  assertEquals("ACTIVE",resultMap2.get("state").asString());
  deployer.deploy("test-fragment");
  Long testFragId=OSGiManagementOperations.getBundleId(getControllerClient(),"test-fragment",Version.parseVersion("0.0.0"));
  assertTrue(testFragId > 0);
  ModelNode resultMap4=OSGiManagementOperations.getBundleInfo(getControllerClient(),testFragId);
  assertEquals(testFragId.toString(),resultMap4.get("id").asString());
  assertEquals("fragment",resultMap4.get("type").asString());
  assertEquals("test-fragment",resultMap4.get("symbolic-name").asString());
  assertEquals("0.0.0",resultMap4.get("version").asString());
  deployer.undeploy("test-fragment");
  deployer.undeploy("test-bundle");
  Long testBundleId2=OSGiManagementOperations.getBundleId(getControllerClient(),"test-bundle",Version.parseVersion("999"));
  assertEquals("Bundle should have been undeployed",new Long(-1),testBundleId2);
  Long testFragId2=OSGiManagementOperations.getBundleId(getControllerClient(),"test-fragment",Version.parseVersion("0.0.0"));
  assertEquals("Fragment should have been undeployed",new Long(-1),testFragId2);
}
