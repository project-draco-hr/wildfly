{
  do {
    ModelNode node=OSGiManagementOperations.getBundleInfo(getControllerClient(),bundleId);
    if (state.equals(node.get(ModelConstants.STATE).asString()))     return;
    timeout-=500;
    Thread.sleep(500);
  }
 while (timeout > 0);
  fail("Desired bundle state not reached: " + state);
}
