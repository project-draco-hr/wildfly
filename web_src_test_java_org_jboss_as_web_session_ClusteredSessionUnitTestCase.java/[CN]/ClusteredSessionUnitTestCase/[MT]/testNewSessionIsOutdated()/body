{
  DistributableSessionManager<?> mgr=new DistributableSessionManager<OutgoingDistributableSessionData>(new MockDistributedCacheManagerFactory(),mock(Container.class),SessionTestUtil.createWebMetaData(10));
  SessionTestUtil.setupContainer("test",null,mgr);
  mgr.start();
  mgr.getReplicationConfig().setReplicationGranularity(ReplicationGranularity.SESSION);
  ClusteredSession<?> sess=(ClusteredSession<?>)mgr.createEmptySession();
  assertTrue(sess.isOutdated());
  sess.setCreationTime(System.currentTimeMillis());
  assertFalse(sess.isOutdated());
  mgr.getReplicationConfig().setReplicationGranularity(ReplicationGranularity.ATTRIBUTE);
  sess=(ClusteredSession<?>)mgr.createEmptySession();
  assertTrue(sess.isOutdated());
  sess.setCreationTime(System.currentTimeMillis());
  assertFalse(sess.isOutdated());
}
