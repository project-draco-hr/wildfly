{
  final LayersConfig layersConfig=getLayersConfig(root);
  processBase(root,layers,layersConfig,setter);
  final File layersDir=new File(root,layersConfig.getLayersPath());
  if (!layersDir.exists()) {
    if (layersConfig.isConfigured()) {
      throw processingError("No layers directory found at " + layersDir);
    }
    return;
  }
  for (  final String layer : layersConfig.getLayers()) {
    if (BASE.equals(layer)) {
      continue;
    }
    File layerDir=new File(layersDir,layer);
    if (!layerDir.exists()) {
      if (layersConfig.isConfigured()) {
        throw processingError("Cannot find layer '%s' under directory %s",layer,layersDir);
      }
      return;
    }
    layers.addLayer(layer,layerDir,setter);
  }
  final File addOnsDir=new File(root,layersConfig.getAddOnsPath());
  final File[] addOnsList=addOnsDir.listFiles();
  if (addOnsList != null) {
    for (    final File addOn : addOnsList) {
      layers.addAddOn(addOn.getName(),addOn,setter);
    }
  }
}
