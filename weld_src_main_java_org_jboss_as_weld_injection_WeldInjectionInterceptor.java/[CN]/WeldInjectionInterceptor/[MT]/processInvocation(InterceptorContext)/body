{
  final ManagedReference managedReference=targetReference.get();
  if (managedReference instanceof WeldManagedReference) {
    final WeldManagedReference reference=(WeldManagedReference)managedReference;
    reference.getInjectionTarget().inject(targetReference.get().getInstance(),reference.getContext());
    for (    final Map.Entry<Class<?>,AtomicReference<ManagedReference>> entry : interceptors.entrySet()) {
      final ManagedReference instance=entry.getValue().get();
      if (instance != null) {
        reference.injectInterceptor(entry.getKey(),instance.getInstance());
      }
    }
  }
 else   if (managedReferenceFactory != null) {
    final ManagedReference newReference=managedReferenceFactory.injectExistingReference(managedReference);
    targetReference.set(newReference);
  }
  return context.proceed();
}
