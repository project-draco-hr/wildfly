{
  if (!reloadSupported) {
    revertRestartRequired(stamp);
  }
  Integer theirStamp=Integer.class.cast(stamp);
synchronized (service) {
    if (state.compareAndSet(State.RELOAD_REQUIRED,State.RUNNING,theirStamp,this.stamp.incrementAndGet())) {
      service.stateChanged(State.RUNNING);
    }
  }
}
