{
  Integer theirStamp=Integer.class.cast(stamp);
synchronized (service) {
    if (state.compareAndSet(State.RESTART_REQUIRED,State.RUNNING,theirStamp,this.stamp.incrementAndGet())) {
      restartRequiredFlag=false;
      service.stateChanged(State.RUNNING);
    }
  }
}
