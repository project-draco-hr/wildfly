{
  final String warName="helloworld.war";
  File war=new File(tmpDir,warName);
  testSupport.createZip(war,0,false,false,false,false);
  TesteeSet ts=createTestee();
  ts.controller.addCompositeFailureResponse(1,1);
  ts.testee.setAutoDeployZippedContent(true);
  ts.testee.scan();
  assertTrue(war.getAbsolutePath() + " is missing after deployment",war.exists());
  File failed=new File(tmpDir,warName + FileSystemDeploymentService.FAILED_DEPLOY);
  assertTrue(failed.getAbsolutePath() + " marker file not found after deployment",failed.exists());
  long newLastModifiedTime=failed.lastModified() + 1000;
  logger.info("Updating last modified time of war " + war + " from "+ war.lastModified()+ " to "+ newLastModifiedTime+ " to simulate changes to the deployment");
  war.setLastModified(newLastModifiedTime);
  ts.controller.addCompositeSuccessResponse(1);
  ts.testee.scan();
  assertTrue(war.getAbsolutePath() + " is missing after re-deployment",war.exists());
  File deployed=createFile(warName + FileSystemDeploymentService.DEPLOYED);
  assertTrue(deployed.getAbsolutePath() + " marker file not found after re-deployment",deployed.exists());
  failed=new File(tmpDir,warName + FileSystemDeploymentService.FAILED_DEPLOY);
  assertFalse(failed.getAbsolutePath() + " marker file (unexpectedly) exists after re-deployment",failed.exists());
}
