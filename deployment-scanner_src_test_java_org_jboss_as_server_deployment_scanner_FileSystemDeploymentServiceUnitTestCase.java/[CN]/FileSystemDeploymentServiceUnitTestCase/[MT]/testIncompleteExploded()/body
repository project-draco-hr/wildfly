{
  File deployment=new File(tmpDir,"foo.ear");
  deployment.mkdirs();
  File deployed=new File(tmpDir,"foo.ear" + FileSystemDeploymentService.DEPLOYED);
  File pending=new File(tmpDir,"foo.ear" + FileSystemDeploymentService.PENDING);
  File incomplete=new File(deployment,"bar.war");
  testSupport.createZip(incomplete,0,false,true,true,false);
  TesteeSet ts=createTestee();
  ts.testee.setAutoDeployExplodedContent(true);
  ts.testee.scan();
  assertFalse(deployed.exists());
  assertTrue(pending.exists());
  incomplete.delete();
  testSupport.createZip(incomplete,0,false,false,true,false);
  ts.controller.addCompositeSuccessResponse(1);
  ts.testee.scan();
  assertTrue(deployed.exists());
  assertFalse(pending.exists());
}
