{
  File war1=createFile("foo.war");
  File dodeploy1=createFile("foo.war" + FileSystemDeploymentService.DO_DEPLOY);
  File war2=createFile("bar.war");
  File dodeploy2=createFile("bar.war" + FileSystemDeploymentService.DO_DEPLOY);
  TesteeSet ts=createTestee();
  ts.controller.addPartialCompositeFailureResultResponse(2,2);
  ts.testee.scan();
  String[] list=tmpDir.list();
  String deployed=null;
  String failed=null;
  for (  final String name : list) {
    if (name.endsWith(FileSystemDeploymentService.DEPLOYED)) {
      Assert.assertNull(deployed);
      deployed=name.substring(0,name.length() - FileSystemDeploymentService.DEPLOYED.length());
    }
 else     if (name.endsWith(FileSystemDeploymentService.FAILED_DEPLOY)) {
      Assert.assertNull(failed);
      failed=name.substring(0,name.length() - FileSystemDeploymentService.FAILED_DEPLOY.length());
    }
  }
  Assert.assertNotNull(deployed);
  Assert.assertNotNull(failed);
  assertTrue(war1.exists());
  assertFalse(dodeploy1.exists());
  assertTrue(war2.exists());
  assertFalse(dodeploy2.exists());
  File deployed1=new File(tmpDir,deployed + FileSystemDeploymentService.DEPLOYED);
  File failed1=new File(tmpDir,deployed + FileSystemDeploymentService.FAILED_DEPLOY);
  File deployed2=new File(tmpDir,failed + FileSystemDeploymentService.DEPLOYED);
  File failed2=new File(tmpDir,failed + FileSystemDeploymentService.FAILED_DEPLOY);
  assertTrue(deployed1.getAbsolutePath(),deployed1.exists());
  assertFalse(failed1.getAbsolutePath(),failed1.exists());
  assertFalse(deployed2.exists());
  assertTrue(failed2.exists());
  dodeploy2=createFile(failed + FileSystemDeploymentService.DO_DEPLOY);
  ts.controller.addCompositeSuccessResponse(1);
  ts.testee.scan();
  deployed2=new File(tmpDir,failed + FileSystemDeploymentService.DEPLOYED);
  failed2=new File(tmpDir,failed + FileSystemDeploymentService.FAILED_DEPLOY);
  assertFalse(dodeploy2.exists());
  assertTrue(deployed2.exists());
  assertFalse(failed2.exists());
}
