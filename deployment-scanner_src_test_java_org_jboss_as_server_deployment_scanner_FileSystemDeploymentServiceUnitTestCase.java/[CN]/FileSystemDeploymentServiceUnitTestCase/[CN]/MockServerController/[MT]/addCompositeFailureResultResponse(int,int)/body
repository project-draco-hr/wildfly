{
  if (count < failureStep) {
    throw new IllegalArgumentException("failureStep must be > count");
  }
  ModelNode rsp=new ModelNode();
  rsp.get(OUTCOME).set(SUCCESS);
  ModelNode result=rsp.get(RESULT);
  ModelNode failedStep=result.get("step-" + failureStep);
  failedStep.get(OUTCOME).set(SUCCESS);
  ModelNode stepResult=failedStep.get(RESULT);
  for (int i=1; i <= count; i++) {
    String step="step-" + i;
    if (i < failureStep) {
      stepResult.get(step,OUTCOME).set(SUCCESS);
      stepResult.get(step,RESULT);
      stepResult.get(step,ROLLED_BACK).set(true);
    }
 else     if (i == failureStep) {
      stepResult.get(step,OUTCOME).set(FAILED);
      stepResult.get(step,FAILURE_DESCRIPTION).set(new ModelNode().set("true failed step"));
      stepResult.get(step,ROLLED_BACK).set(true);
    }
 else {
      stepResult.get(step,OUTCOME).set(CANCELLED);
    }
  }
  rsp.get(FAILURE_DESCRIPTION).set(new ModelNode().set("badness happened"));
  rsp.get(ROLLED_BACK).set(true);
  responses.add(new Response(true,rsp));
}
