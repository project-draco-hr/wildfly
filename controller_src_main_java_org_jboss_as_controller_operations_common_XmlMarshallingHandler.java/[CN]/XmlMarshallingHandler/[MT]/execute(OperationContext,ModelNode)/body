{
  final Resource resource=context.getRootResource();
  final ModelNode model=Resource.Tools.readModel(resource);
  try {
    final ByteArrayOutputStream baos=new ByteArrayOutputStream();
    try {
      BufferedOutputStream output=new BufferedOutputStream(baos);
      configPersister.marshallAsXml(model,output);
      output.close();
      baos.close();
    }
  finally {
      safeClose(baos);
    }
    String xml=new String(baos.toByteArray());
    context.getResult().set(xml);
  }
 catch (  Exception e) {
    context.getFailureDescription().set(e.toString());
  }
  context.completeStep();
}
