{
  final String operationName=operation.require(OP).asString();
  OperationStepHandler stepHandler;
  final ImmutableManagementResourceRegistration registration=context.getResourceRegistration();
  if (registration != null) {
    stepHandler=registration.getOperationHandler(PathAddress.EMPTY_ADDRESS,operationName);
  }
 else {
    stepHandler=resolveWildcardOperationHandler(PathAddress.pathAddress(operation.get(OP_ADDR)),operationName,context.getRootResourceRegistration());
  }
  if (stepHandler != null) {
    context.addStep(stepHandler,OperationContext.Stage.MODEL);
  }
 else {
    PathAddress pathAddress=PathAddress.pathAddress(operation.get(OP_ADDR));
    if (registration == null) {
      context.getFailureDescription().set(ControllerMessages.MESSAGES.noSuchResourceType(pathAddress));
    }
 else {
      context.getFailureDescription().set(ControllerMessages.MESSAGES.noHandlerForOperation(operationName,pathAddress));
    }
  }
  context.stepCompleted();
}
