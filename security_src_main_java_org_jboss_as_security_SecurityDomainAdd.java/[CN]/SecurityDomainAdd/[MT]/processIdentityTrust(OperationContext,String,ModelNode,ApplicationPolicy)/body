{
  node=peek(node,IDENTITY_TRUST,CLASSIC,TRUST_MODULE);
  if (node == null) {
    return false;
  }
  IdentityTrustInfo identityTrustInfo=new IdentityTrustInfo(securityDomain);
  for (  Property moduleProperty : node.asPropertyList()) {
    ModelNode module=moduleProperty.getValue();
    String codeName=module.require(CODE).asString();
    ControlFlag controlFlag=ControlFlag.valueOf(module.require(FLAG).asString());
    Map<String,Object> options=extractOptions(context,module);
    IdentityTrustModuleEntry entry=new IdentityTrustModuleEntry(codeName,options);
    entry.setControlFlag(controlFlag);
    identityTrustInfo.add(entry);
    String moduleName=module.get(MODULE).asString();
    if (module.hasDefined(MODULE) && moduleName != null && moduleName.length() > 0) {
      identityTrustInfo.setJBossModuleName(moduleName);
    }
  }
  applicationPolicy.setIdentityTrustInfo(identityTrustInfo);
  return true;
}
