{
  try {
    String protocol="TLS";
    if (ssl.has(PROTOCOL)) {
      protocol=ssl.get(PROTOCOL).asString();
    }
    KeyManager[] keyManagers=null;
    KeyStore theKeyStore=keystore.getOptionalValue();
    if (theKeyStore != null) {
      KeyManagerFactory keyManagerFactory=KeyManagerFactory.getInstance("SunX509");
      keyManagerFactory.init(theKeyStore,password);
      keyManagers=keyManagerFactory.getKeyManagers();
    }
    TrustManager[] trustManagers=null;
    KeyStore theTrustStore=truststore.getOptionalValue();
    if (theTrustStore != null) {
      TrustManagerFactory trustManagerFactory=TrustManagerFactory.getInstance("SunX509");
      trustManagerFactory.init(theTrustStore);
      trustManagers=trustManagerFactory.getTrustManagers();
    }
    SSLContext sslContext=SSLContext.getInstance(protocol);
    sslContext.init(keyManagers,trustManagers,null);
    this.sslContext=sslContext;
  }
 catch (  NoSuchAlgorithmException nsae) {
    throw MESSAGES.unableToStart(nsae);
  }
catch (  KeyManagementException kme) {
    throw MESSAGES.unableToStart(kme);
  }
catch (  KeyStoreException kse) {
    throw MESSAGES.unableToStart(kse);
  }
catch (  UnrecoverableKeyException e) {
    throw MESSAGES.unableToStart(e);
  }
}
