{
  this.schema=schema;
  this.tableId=tableId;
  this.leftField=leftField;
  this.rightField=rightField;
  JDBCRelationMetaData metadata=leftField.getMetaData().getRelationMetaData();
  ds=leftField.getManager().getDataSource(metadata.getDataSourceName());
  tableName=SQLUtil.fixTableName(metadata.getDefaultTableName(),ds);
  log=Logger.getLogger(getClass().getName() + "." + tableName);
  insertSql="insert into " + tableName + " (";
  JDBCCMPFieldBridge2[] keyFields=(JDBCCMPFieldBridge2[])this.leftField.getTableKeyFields();
  insertSql+=keyFields[0].getColumnName();
  for (int i=1; i < keyFields.length; ++i) {
    insertSql+=", " + keyFields[i].getColumnName();
  }
  keyFields=(JDBCCMPFieldBridge2[])this.rightField.getTableKeyFields();
  insertSql+=", " + keyFields[0].getColumnName();
  for (int i=1; i < keyFields.length; ++i) {
    insertSql+=", " + keyFields[i].getColumnName();
  }
  insertSql+=") values (?";
  for (int i=1; i < this.leftField.getTableKeyFields().length + this.rightField.getTableKeyFields().length; ++i) {
    insertSql+=", ?";
  }
  insertSql+=")";
  log.debug("insert sql: " + insertSql);
  deleteSql="delete from " + tableName + " where ";
  keyFields=(JDBCCMPFieldBridge2[])this.leftField.getTableKeyFields();
  deleteSql+=keyFields[0].getColumnName() + "=?";
  for (int i=1; i < keyFields.length; ++i) {
    deleteSql+=" and " + keyFields[i].getColumnName() + "=?";
  }
  keyFields=(JDBCCMPFieldBridge2[])this.rightField.getTableKeyFields();
  deleteSql+=" and " + keyFields[0].getColumnName() + "=?";
  for (int i=1; i < keyFields.length; ++i) {
    deleteSql+=" and " + keyFields[i].getColumnName() + "=?";
  }
  log.debug("delete sql: " + deleteSql);
}
