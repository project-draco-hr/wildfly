{
  InfinispanSessionManagerFactory factory=new InfinispanSessionManagerFactory(config);
  return target.addService(name,factory).addDependency(CacheServiceName.CACHE.getServiceName(containerName,cacheName),Cache.class,factory.cache).addDependency(CacheContainerServiceName.AFFINITY.getServiceName(containerName),KeyAffinityServiceFactory.class,factory.affinityFactory).addDependency(GroupServiceNames.COMMAND_DISPATCHER.getServiceName(containerName),CommandDispatcherFactory.class,factory.dispatcherFactory).addDependency(CacheServiceNames.NODE_FACTORY.getServiceName(containerName),NodeFactory.class,factory.nodeFactory);
}
