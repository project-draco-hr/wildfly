{
  final byte rootId;
  final String filePath;
  ByteDataInput input=null;
  try {
    input=new SimpleByteDataInput(inputStream);
    expectHeader(input,DomainControllerProtocol.PARAM_ROOT_ID);
    rootId=input.readByte();
    expectHeader(input,DomainControllerProtocol.PARAM_FILE_PATH);
    filePath=input.readUTF();
    input.close();
    log.debugf("host controller [%s] requested file [%s] from root [%d]",hostControllerId,filePath,rootId);
switch (rootId) {
case (byte)DomainControllerProtocol.PARAM_ROOT_ID_FILE:
{
        localPath=localFileRepository.getFile(filePath);
        break;
      }
case (byte)DomainControllerProtocol.PARAM_ROOT_ID_CONFIGURATION:
{
      localPath=localFileRepository.getConfigurationFile(filePath);
      break;
    }
case (byte)DomainControllerProtocol.PARAM_ROOT_ID_DEPLOYMENT:
{
    byte[] hash=DeploymentUnitElement.hexStringToBytes(filePath);
    localPath=localFileRepository.getDeploymentRoot(hash);
    break;
  }
default :
{
  throw new IOException(String.format("Invalid root id [%d]",rootId));
}
}
}
  finally {
safeClose(input);
}
}
