{
  final DeploymentUnit deploymentUnit=phaseContext.getDeploymentUnit();
  final ResourceRoot deploymentRoot=deploymentUnit.getAttachment(Attachments.DEPLOYMENT_ROOT);
  if (deploymentRoot == null)   return;
  Manifest manifest=deploymentUnit.getAttachment(Attachments.OSGI_MANIFEST);
  if (manifest != null)   return;
  Boolean ignore=deploymentUnit.getAttachment(Attachments.IGNORE_OSGI);
  if (ignore != null && ignore.booleanValue())   return;
  manifest=deploymentRoot.getAttachment(Attachments.MANIFEST);
  if (BundleInfo.isValidBundleManifest(manifest)) {
    deploymentUnit.putAttachment(Attachments.OSGI_MANIFEST,manifest);
  }
}
