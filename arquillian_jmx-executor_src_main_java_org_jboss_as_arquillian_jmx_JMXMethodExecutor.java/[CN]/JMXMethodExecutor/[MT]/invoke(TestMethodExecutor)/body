{
  if (testMethodExecutor == null)   throw new IllegalArgumentException("TestMethodExecutor null");
  Object testInstance=testMethodExecutor.getInstance();
  String testClass=testInstance.getClass().getName();
  String testMethod=testMethodExecutor.getMethod().getName();
  TestResult result=null;
  try {
    JMXTestRunnerMBean testRunner=getMBeanProxy(testRunnerName,JMXTestRunnerMBean.class);
    if (executionType == ExecutionType.EMBEDDED) {
      InputStream resultStream=testRunner.runTestMethodEmbedded(testClass,testMethod,props);
      ObjectInputStream ois=new ObjectInputStream(resultStream);
      result=(TestResult)ois.readObject();
    }
 else     if (executionType == ExecutionType.REMOTE) {
      result=testRunner.runTestMethod(testClass,testMethod,props);
    }
  }
 catch (  final Throwable e) {
    result=new TestResult(Status.FAILED);
    result.setThrowable(e);
  }
 finally {
    result.setEnd(System.currentTimeMillis());
  }
  return result;
}
