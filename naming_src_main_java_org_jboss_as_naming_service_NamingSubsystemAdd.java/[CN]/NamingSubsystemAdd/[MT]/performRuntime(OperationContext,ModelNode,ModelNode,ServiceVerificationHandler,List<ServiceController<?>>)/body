{
  log.info("Activating Naming Subsystem");
  NamingContext.initializeNamingManager();
  final NamingStore namingStore=new InMemoryNamingStore(new NamingEventCoordinator());
  final ServiceTarget target=context.getServiceTarget();
  newControllers.add(target.addService(NamingService.SERVICE_NAME,new NamingService(namingStore)).addAliases(ContextNames.JAVA_CONTEXT_SERVICE_NAME).setInitialMode(ServiceController.Mode.ACTIVE).addListener(verificationHandler).install());
  newControllers.add(addGlobalContextFactory(target,"global",verificationHandler));
  newControllers.add(addGlobalContextFactory(target,"jboss",verificationHandler));
  newControllers.add(addContextFactory(target,"app",verificationHandler));
  newControllers.add(addContextFactory(target,"module",verificationHandler));
  newControllers.add(addContextFactory(target,"comp",verificationHandler));
  newControllers.add(InitialContextFactoryService.addService(target,verificationHandler));
  newControllers.add(target.addService(JndiViewExtensionRegistry.SERVICE_NAME,new JndiViewExtensionRegistry()).install());
  if (context.isBooting()) {
    context.addStep(new AbstractDeploymentChainStep(){
      protected void execute(      DeploymentProcessorTarget processorTarget){
        processorTarget.addDeploymentProcessor(Phase.INSTALL,Phase.INSTALL_JNDI_DEPENDENCY_SETUP,new JndiNamingDependencySetupProcessor());
        processorTarget.addDeploymentProcessor(Phase.INSTALL,Phase.INSTALL_JNDI_DEPENDENCIES,new JndiNamingDependencyProcessor());
      }
    }
,OperationContext.Stage.RUNTIME);
  }
}
