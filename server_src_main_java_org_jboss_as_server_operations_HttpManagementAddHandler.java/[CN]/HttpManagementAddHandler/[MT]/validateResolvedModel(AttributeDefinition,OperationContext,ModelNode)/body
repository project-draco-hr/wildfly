{
  final String attributeName=definition.getName();
  final boolean has=subModel.has(attributeName);
  if (!has && definition.isRequired(subModel)) {
    throw new OperationFailedException(new ModelNode().set(String.format("%s is required",attributeName)));
  }
  ModelNode result;
  if (has) {
    if (!definition.isAllowed(subModel)) {
      if (subModel.hasDefined(attributeName)) {
        throw new OperationFailedException(new ModelNode().set(String.format("%s is not allowed when [%s] are present",attributeName,definition.getAlternatives())));
      }
 else {
        result=new ModelNode();
      }
    }
 else {
      result=definition.resolveModelAttribute(context,subModel);
    }
  }
 else {
    result=new ModelNode();
  }
  return result;
}
