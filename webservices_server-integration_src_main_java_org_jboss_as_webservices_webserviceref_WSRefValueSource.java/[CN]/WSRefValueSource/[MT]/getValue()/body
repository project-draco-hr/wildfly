{
  final ClassLoader oldCL=Thread.currentThread().getContextClassLoader();
  try {
    final ClassLoader integrationCL=ClassLoaderProvider.getDefaultProvider().getServerIntegrationClassLoader();
    final ClassLoader newCL=new DelegateClassLoader(integrationCL,oldCL);
    Thread.currentThread().setContextClassLoader(newCL);
    final Referenceable referenceable=getReferenceable(integrationCL);
    final Class<?> clazz=Class.forName(referenceable.getReference().getFactoryClassName(),true,integrationCL);
    final ObjectFactory factory=(ObjectFactory)clazz.newInstance();
    return factory.getObjectInstance(referenceable.getReference(),null,null,null);
  }
 catch (  final Exception e) {
    throw new RuntimeException(e);
  }
 finally {
    Thread.currentThread().setContextClassLoader(oldCL);
  }
}
