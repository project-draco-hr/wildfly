{
  notifyLifecycleListeners(LifecycleState.STOPPING);
  try {
    if (this.threadFactory != null) {
      this.executor.shutdownNow();
    }
 else {
      for (      Future<?> future : this.expirationFutures.values()) {
        future.cancel(false);
      }
    }
    this.expirationFutures.clear();
    this.cache.clear();
    notifyLifecycleListeners(LifecycleState.STOPPED);
  }
 catch (  RuntimeException e) {
    notifyLifecycleListeners(LifecycleState.FAILED);
    throw e;
  }
}
