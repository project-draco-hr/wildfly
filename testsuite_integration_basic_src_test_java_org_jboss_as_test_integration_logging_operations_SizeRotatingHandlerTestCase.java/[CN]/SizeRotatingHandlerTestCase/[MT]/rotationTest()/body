{
  final String message="SizeRotatingHandlerTestCase - This is my dummy message which is gonna fill my log file";
  final String newMessage="SizeRotatingHandlerTestCase - This is new message";
  final int maxBackupIndex=3;
  fileName="size-rotating-reload-rotationTest.log";
  loggingSetup();
  ModelNode op=Operations.createWriteAttributeOperation(SIZE_HANDLER_ADDRESS,"max-backup-index",maxBackupIndex);
  validateResponse(op);
  op=Operations.createWriteAttributeOperation(SIZE_HANDLER_ADDRESS,"rotate-size","2k");
  validateResponse(op);
  op=Operations.createReadResourceOperation(SIZE_HANDLER_ADDRESS);
  validateResponse(op);
  for (int i=0; i < 100; i++) {
    makeLog(message);
  }
  checkLogs(message,true);
  int count=0;
  for (  File file : logFile.getParentFile().listFiles()) {
    if (file.getName().contains(logFile.getName())) {
      Assert.assertTrue("This file is bigger than allowed rotate-size: " + file.getName(),file.length() < 2200);
      checkLogs(message,true,file);
      count++;
    }
  }
  Assert.assertEquals("Incorrect number of log files were found.",maxBackupIndex + 1,count);
  searchLog(newMessage,true);
}
