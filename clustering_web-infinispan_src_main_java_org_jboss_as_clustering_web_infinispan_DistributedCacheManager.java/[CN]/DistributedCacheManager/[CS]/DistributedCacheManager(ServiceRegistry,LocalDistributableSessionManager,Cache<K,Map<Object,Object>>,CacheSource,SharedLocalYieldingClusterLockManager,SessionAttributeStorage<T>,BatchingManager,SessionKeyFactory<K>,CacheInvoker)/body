{
  this.manager=manager;
  this.lockManager=lockManager;
  this.sessionCache=sessionCache;
  this.attributeStorage=attributeStorage;
  this.batchingManager=batchingManager;
  this.keyFactory=keyFactory;
  this.invoker=new ForceSynchronousCacheInvoker(invoker);
  Configuration configuration=this.sessionCache.getConfiguration();
  this.passivationEnabled=configuration.isCacheLoaderPassivation() && !configuration.isCacheLoaderShared();
  List<CacheLoaderConfig> loaders=configuration.getCacheLoaders();
  CacheLoaderConfig loader=!loaders.isEmpty() ? loaders.get(0) : null;
  this.requiresPurge=(loader != null) && (loader instanceof CacheStoreConfig) ? ((CacheStoreConfig)loader).isPurgeOnStartup() : false;
  this.jvmRouteHandler=configuration.getCacheMode().isDistributed() ? new JvmRouteHandler(registry,jvmRouteCacheSource,this.manager) : null;
}
