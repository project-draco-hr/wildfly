{
  this.manager=manager;
  this.lockManager=lockManager;
  this.cache=cache;
  this.attributeStorage=attributeStorage;
  this.batchingManager=batchingManager;
  this.invoker=new ForceSynchronousCacheInvoker(invoker);
  this.lockTimeout=this.cache.getCacheConfiguration().locking().lockAcquisitionTimeout();
  Configuration configuration=this.cache.getCacheConfiguration();
  this.passivationEnabled=configuration.loaders().passivation() && !configuration.loaders().shared() && !configuration.loaders().cacheLoaders().isEmpty();
  this.persistenceEnabled=!configuration.loaders().passivation() && !configuration.loaders().cacheLoaders().isEmpty();
  this.registry=registry;
  this.affinity=affinityFactory.createService(cache,this);
}
