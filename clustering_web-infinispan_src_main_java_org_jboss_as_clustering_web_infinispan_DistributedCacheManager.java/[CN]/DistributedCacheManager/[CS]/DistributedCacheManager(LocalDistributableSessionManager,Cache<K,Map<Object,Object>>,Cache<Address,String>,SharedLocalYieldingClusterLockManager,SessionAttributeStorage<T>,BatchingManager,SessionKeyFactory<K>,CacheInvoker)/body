{
  this.manager=manager;
  this.lockManager=lockManager;
  this.sessionCache=sessionCache;
  this.attributeStorage=attributeStorage;
  this.batchingManager=batchingManager;
  this.keyFactory=keyFactory;
  this.invoker=new ForceSynchronousCacheInvoker(invoker);
  Configuration configuration=this.sessionCache.getConfiguration();
  Configuration.CacheMode mode=configuration.getCacheMode();
  this.passivationEnabled=configuration.isCacheLoaderPassivation() && !configuration.isCacheLoaderShared();
  List<CacheLoaderConfig> loaders=configuration.getCacheLoaders();
  CacheLoaderConfig loader=!loaders.isEmpty() ? loaders.get(0) : null;
  this.requiresPurge=(loader != null) && (loader instanceof CacheStoreConfig) ? ((CacheStoreConfig)loader).isPurgeOnStartup() && mode.isReplicated() : false;
  this.jvmRouteHandler=mode.isDistributed() ? new JvmRouteHandler(jvmRouteCache,this.manager) : null;
}
