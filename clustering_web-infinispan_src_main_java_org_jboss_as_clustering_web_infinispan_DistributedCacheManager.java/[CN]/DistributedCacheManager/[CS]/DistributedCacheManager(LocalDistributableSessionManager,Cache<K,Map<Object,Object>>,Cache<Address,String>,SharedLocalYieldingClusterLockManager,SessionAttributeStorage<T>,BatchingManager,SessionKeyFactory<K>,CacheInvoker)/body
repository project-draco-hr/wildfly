{
  this.manager=manager;
  this.lockManager=lockManager;
  this.sessionCache=sessionCache;
  this.attributeStorage=attributeStorage;
  this.batchingManager=batchingManager;
  this.keyFactory=keyFactory;
  this.invoker=new ForceSynchronousCacheInvoker(invoker);
  Configuration configuration=this.sessionCache.getCacheConfiguration();
  CacheMode mode=configuration.clustering().cacheMode();
  this.passivationEnabled=configuration.loaders().passivation() && !configuration.loaders().shared();
  List<AbstractLoaderConfiguration> loaders=configuration.loaders().cacheLoaders();
  AbstractLoaderConfiguration loader=!loaders.isEmpty() ? loaders.get(0) : null;
  this.requiresPurge=(loader != null) ? loader.purgeOnStartup() && mode.isReplicated() : false;
  this.jvmRouteHandler=mode.isDistributed() ? new JvmRouteHandler(jvmRouteCache,this.manager) : null;
}
