{
  if (this.requiresPurge) {
    Operation<Void> operation=new Operation<Void>(){
      @Override public Void invoke(      Cache<K,Map<Object,Object>> cache){
        for (        K key : cache.getAdvancedCache().withFlags(Flag.CACHE_MODE_LOCAL).keySet()) {
          if (DistributedCacheManager.this.keyFactory.ours(key)) {
            cache.getAdvancedCache().withFlags(Flag.CACHE_MODE_LOCAL).remove(key);
          }
        }
        return null;
      }
    }
;
    this.batch(operation);
  }
}
