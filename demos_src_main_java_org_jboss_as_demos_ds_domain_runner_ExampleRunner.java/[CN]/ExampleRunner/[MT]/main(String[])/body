{
  DomainDeploymentUtils utils=null;
  try {
    utils=new DomainDeploymentUtils("ds-mbean.sar",Test.class.getPackage());
    utils.deploy();
    ObjectName objectName=new ObjectName("jboss:name=test,type=ds");
    MBeanServerConnection mbeanServer=utils.getServerOneConnection();
    System.out.println("Calling TestMBean.test() on server one");
    String s=(String)mbeanServer.invoke(objectName,"test",new Object[0],new String[0]);
    System.out.println("Received reply: " + s);
    mbeanServer=utils.getServerTwoConnection();
    System.out.println("Calling TestMBean.test() on server two");
    s=(String)mbeanServer.invoke(objectName,"test",new Object[0],new String[0]);
    System.out.println("Received reply: " + s);
  }
 catch (  Exception e) {
    e.printStackTrace();
  }
 finally {
    utils.undeploy();
    safeClose(utils);
  }
}
