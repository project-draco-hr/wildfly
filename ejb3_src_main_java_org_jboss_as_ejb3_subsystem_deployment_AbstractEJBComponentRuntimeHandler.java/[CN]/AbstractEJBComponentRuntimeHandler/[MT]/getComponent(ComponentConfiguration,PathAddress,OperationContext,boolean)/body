{
  ServiceName createServiceName=config.getComponentDescription().getCreateServiceName();
  ServiceRegistry registry=context.getServiceRegistry(forWrite);
  ServiceController<?> controller=registry.getService(createServiceName);
  if (controller == null) {
    throw new OperationFailedException(new ModelNode().set(String.format("No EJB component is available for address %s",operationAddress)));
  }
  ServiceController.State controllerState=controller.getState();
  if (controllerState != ServiceController.State.UP) {
    throw new OperationFailedException(new ModelNode().set(String.format("EJB component for address %s is in " + "state %s, must be in state %s",operationAddress,controllerState,ServiceController.State.UP)));
  }
  return componentClass.cast(controller.getValue());
}
