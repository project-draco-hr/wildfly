{
  final DeploymentUnit depUnit=phaseContext.getDeploymentUnit();
  if (DeploymentTypeMarker.isType(DeploymentType.EAR,depUnit) || DeploymentTypeMarker.isType(DeploymentType.WAR,depUnit))   return;
  if (depUnit.hasAttachment(OSGiConstants.BUNDLE_REVISION_KEY))   return;
  final Module module=depUnit.getAttachment(Attachments.MODULE);
  final ModuleSpecification moduleSpecification=depUnit.getAttachment(Attachments.MODULE_SPECIFICATION);
  if (module == null || moduleSpecification.isPrivateModule())   return;
  OSGiMetaData metadata=depUnit.getAttachment(OSGiConstants.OSGI_METADATA_KEY);
  registrationTracker.registerModule(module,metadata);
}
