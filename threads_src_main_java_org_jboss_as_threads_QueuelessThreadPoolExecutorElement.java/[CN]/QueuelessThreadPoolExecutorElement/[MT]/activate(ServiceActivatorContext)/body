{
  final BatchBuilder batchBuilder=context.getBatchBuilder();
  long keepAlive=-1L;
  final TimeSpec keepaliveTime=getKeepaliveTime();
  if (keepaliveTime != null)   keepAlive=keepaliveTime.getUnit().toNanos(keepaliveTime.getDuration());
  final ScaledCount maxThreads=getMaxThreads();
  final QueuelessThreadPoolService service=new QueuelessThreadPoolService(maxThreads != null ? maxThreads.getScaledCount() : Integer.MAX_VALUE,blocking,keepAlive);
  final ServiceName serviceName=JBOSS_THREAD_EXECUTOR.append(getName());
  final BatchServiceBuilder<ExecutorService> serviceBuilder=batchBuilder.addService(serviceName,service);
  final String threadFactory=getThreadFactory();
  final ServiceName threadFactoryName;
  if (threadFactory == null) {
    threadFactoryName=serviceName.append("thread-factory");
    batchBuilder.addService(threadFactoryName,new ThreadFactoryService());
  }
 else {
    threadFactoryName=JBOSS_THREAD_FACTORY.append(threadFactory);
  }
  serviceBuilder.addDependency(threadFactoryName,ThreadFactory.class,service.getThreadFactoryInjector());
  final String handoffExecutor=getHandoffExecutor();
  if (handoffExecutor == null) {
    final ServiceName handoffExecutorName=JBOSS_THREAD_EXECUTOR.append(handoffExecutor);
    serviceBuilder.addDependency(handoffExecutorName,Executor.class,service.getHandoffExecutorInjector());
  }
}
