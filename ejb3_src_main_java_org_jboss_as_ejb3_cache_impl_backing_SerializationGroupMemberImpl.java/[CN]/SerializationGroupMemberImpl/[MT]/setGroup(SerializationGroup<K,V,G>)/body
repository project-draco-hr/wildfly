{
  if (this.group != group) {
    if (group == null && groupLockHeld) {
      this.group.unlock();
      groupLockHeld=false;
    }
    this.group=group;
    if (this.groupId == null && group != null)     this.groupId=group.getId();
    if (group != null && lock.isHeldByCurrentThread()) {
      group.lock();
      groupLockHeld=true;
    }
  }
}
