{
  final Endpoint endpoint;
  try {
    boolean ok=false;
    endpoint=Remoting.createEndpoint(endpointName,optionMap);
    try {
      endpoint.addConnectionProvider("remote",new RemoteConnectionProviderFactory(),optionMap);
      endpoint.addConnectionProvider("http-remoting",new HttpUpgradeConnectionProviderFactory(),optionMap);
      endpoint.addConnectionProvider("https-remoting",new HttpUpgradeConnectionProviderFactory(),optionMap);
      ok=true;
    }
  finally {
      if (!ok) {
        endpoint.closeAsync();
      }
    }
  }
 catch (  IOException e) {
    throw MESSAGES.couldNotStart(e);
  }
  this.endpoint=endpoint;
}
