{
  try {
    final Module module=moduleLoader.loadModule(ModuleIdentifier.fromString(moduleName));
    boolean initialized=false;
    for (    final Extension extension : module.loadService(Extension.class)) {
      ClassLoader oldTccl=SecurityActions.setThreadContextClassLoader(extension.getClass());
      try {
        extension.initializeParsers(context);
      }
  finally {
        SecurityActions.setThreadContextClassLoader(oldTccl);
      }
      if (!initialized) {
        initialized=true;
      }
    }
    if (!initialized) {
      throw new IllegalStateException("No META-INF/services/" + Extension.class.getName() + " found for "+ module.getIdentifier());
    }
    return null;
  }
 catch (  final ModuleLoadException e) {
    return new XMLStreamException("Failed to load module",e);
  }
}
