{
  Property property=node.asProperty();
  Element element=Element.forName(property.getName());
  writer.writeStartElement(element.getLocalName());
switch (element) {
case ANY:
    writer.writeStartElement(Element.ANY.getLocalName());
  writeInterfaceCriteria(writer,property.getValue().get(ANY).asList());
writer.writeEndElement();
break;
case NOT:
writer.writeStartElement(Element.NOT.getLocalName());
writeInterfaceCriteria(writer,property.getValue().get(NOT).asList());
writer.writeEndElement();
break;
case INET_ADDRESS:
writeAttribute(writer,Attribute.VALUE,property.getValue().asString());
break;
case NIC:
writeAttribute(writer,Attribute.NAME,property.getValue().asString());
break;
case NIC_MATCH:
writeAttribute(writer,Attribute.PATTERN,property.getValue().asString());
break;
case SUBNET_MATCH:
String network=property.getValue().get(NETWORK).asString();
String mask=property.getValue().get(MASK).asString();
String subnet=network + "/" + mask;
writeAttribute(writer,Attribute.VALUE,subnet);
break;
default :
throw new RuntimeException("Unknown property in interface criteria list: " + property);
}
writer.writeEndElement();
}
