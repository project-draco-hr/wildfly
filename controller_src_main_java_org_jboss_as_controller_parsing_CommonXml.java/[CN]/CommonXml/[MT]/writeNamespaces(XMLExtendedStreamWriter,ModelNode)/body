{
  final boolean needXsd=modelNode.hasDefined(SCHEMA_LOCATIONS) && modelNode.get(SCHEMA_LOCATIONS).asInt() > 0;
  final boolean hasNamepaces=modelNode.hasDefined(NAMESPACES);
  if (!needXsd && !hasNamepaces) {
    return;
  }
  boolean wroteXsd=false;
  final String xsdUri=Namespace.XML_SCHEMA_INSTANCE.getUriString();
  if (hasNamepaces) {
    for (    final Property property : modelNode.get(NAMESPACES).asPropertyList()) {
      final String uri=property.getValue().asString();
      writer.writeNamespace(property.getName(),uri);
      if (!wroteXsd && xsdUri.equals(uri)) {
        wroteXsd=true;
      }
    }
  }
  if (needXsd && !wroteXsd) {
    writer.writeNamespace("xsd",xsdUri);
  }
}
