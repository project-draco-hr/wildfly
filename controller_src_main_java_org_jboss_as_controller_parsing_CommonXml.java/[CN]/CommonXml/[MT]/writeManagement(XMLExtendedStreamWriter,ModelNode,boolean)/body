{
  boolean hasSecurityRealm=management.hasDefined(SECURITY_REALM);
  boolean hasConnection=management.hasDefined(OUTBOUND_CONNECTION);
  boolean hasInterface=allowInterfaces && management.hasDefined(MANAGEMENT_INTERFACE);
  if ((hasSecurityRealm == false) && (hasConnection == false) && (hasInterface == false)) {
    return;
  }
  writer.writeStartElement(Element.MANAGEMENT.getLocalName());
  if (hasSecurityRealm) {
    ModelNode securityRealms=management.get(SECURITY_REALM);
    writer.writeStartElement(Element.SECURITY_REALMS.getLocalName());
    for (    Property variable : securityRealms.asPropertyList()) {
      writer.writeStartElement(Element.SECURITY_REALM.getLocalName());
      writeAttribute(writer,Attribute.NAME,variable.getName());
      ModelNode realm=variable.getValue();
      if (realm.hasDefined(SERVER_IDENTITIES)) {
        writer.writeStartElement(Element.SERVER_IDENTITIES.getLocalName());
        ModelNode serverIdentities=realm.get(SERVER_IDENTITIES);
        if (serverIdentities.hasDefined(SSL)) {
          writer.writeStartElement(Element.SSL.getLocalName());
          ModelNode ssl=serverIdentities.get(SSL);
          if (ssl.hasDefined(PROTOCOL)) {
            writer.writeAttribute(Attribute.PROTOCOL.getLocalName(),ssl.get(PROTOCOL).asString());
          }
          if (ssl.hasDefined(KEYSTORE)) {
            writer.writeStartElement(Element.KEYSTORE.getLocalName());
            ModelNode keystore=ssl.get(KEYSTORE);
            writer.writeAttribute(Attribute.PATH.getLocalName(),keystore.require(PATH).asString());
            if (keystore.hasDefined(RELATIVE_TO)) {
              writer.writeAttribute(Attribute.RELATIVE_TO.getLocalName(),keystore.require(RELATIVE_TO).asString());
            }
            writer.writeAttribute(Attribute.PASSWORD.getLocalName(),keystore.require(PASSWORD).asString());
            writer.writeEndElement();
          }
          writer.writeEndElement();
        }
        if (serverIdentities.hasDefined(SECRET)) {
          ModelNode secret=serverIdentities.get(SECRET);
          writer.writeStartElement(Element.SECRET.getLocalName());
          writer.writeAttribute(Attribute.VALUE.getLocalName(),secret.require(VALUE).asString());
          writer.writeEndElement();
        }
        writer.writeEndElement();
      }
      if (realm.hasDefined(AUTHENTICATION)) {
        writer.writeStartElement(Element.AUTHENTICATION.getLocalName());
        ModelNode authentication=realm.require(AUTHENTICATION);
        if (authentication.hasDefined(USERS)) {
          ModelNode userDomain=authentication.get(USERS);
          ModelNode users=userDomain.require(USER);
          writer.writeStartElement(Element.USERS.getLocalName());
          for (          Property userProps : users.asPropertyList()) {
            String userName=userProps.getName();
            ModelNode currentUser=userProps.getValue();
            writer.writeStartElement(Element.USER.getLocalName());
            writer.writeAttribute(Attribute.USERNAME.getLocalName(),userName);
            if (currentUser.hasDefined(PASSWORD)) {
              writer.writeStartElement(Element.PASSWORD.getLocalName());
              writer.writeCharacters(currentUser.get(PASSWORD).asString());
              writer.writeEndElement();
            }
            writer.writeEndElement();
          }
          writer.writeEndElement();
        }
 else         if (authentication.hasDefined(LDAP)) {
          ModelNode userLdap=authentication.get(LDAP);
          writer.writeStartElement(Element.LDAP.getLocalName());
          writer.writeAttribute(Attribute.CONNECTION.getLocalName(),userLdap.require(CONNECTION).asString());
          writer.writeAttribute(Attribute.BASE_DN.getLocalName(),userLdap.require(BASE_DN).asString());
          writer.writeAttribute(Attribute.USERNAME_ATTRIBUTE.getLocalName(),userLdap.require(USERNAME_ATTRIBUTE).asString());
          if (userLdap.has(RECURSIVE)) {
            writer.writeAttribute(Attribute.RECURSIVE.getLocalName(),userLdap.require(RECURSIVE).asString());
          }
          if (userLdap.hasDefined(USER_DN)) {
            writer.writeAttribute(Attribute.USER_DN.getLocalName(),userLdap.require(USER_DN).asString());
          }
          writer.writeEndElement();
        }
 else         if (authentication.hasDefined(PROPERTIES)) {
          ModelNode properties=authentication.require(PROPERTIES);
          writer.writeStartElement(Element.PROPERTIES.getLocalName());
          writer.writeAttribute(Attribute.PATH.getLocalName(),properties.require(PATH).asString());
          if (properties.hasDefined(RELATIVE_TO)) {
            writer.writeAttribute(Attribute.RELATIVE_TO.getLocalName(),properties.require(RELATIVE_TO).asString());
          }
          writer.writeEndElement();
        }
        writer.writeEndElement();
      }
      writer.writeEndElement();
    }
    writer.writeEndElement();
  }
  if (hasConnection) {
    writer.writeStartElement(Element.OUTBOUND_CONNECTIONS.getLocalName());
    ModelNode connections=management.get(OUTBOUND_CONNECTION);
    for (    Property variable : connections.asPropertyList()) {
      ModelNode connection=variable.getValue();
      String type=connection.require(TYPE).asString();
      if (LDAP.equals(type)) {
        writer.writeStartElement(Element.LDAP.getLocalName());
        writer.writeAttribute(Attribute.NAME.getLocalName(),variable.getName());
        writer.writeAttribute(Attribute.URL.getLocalName(),connection.require(URL).asString());
        writer.writeAttribute(Attribute.SEARCH_DN.getLocalName(),connection.require(SEARCH_DN).asString());
        writer.writeAttribute(Attribute.SEARCH_CREDENTIAL.getLocalName(),connection.require(SEARCH_CREDENTIAL).asString());
        if (connection.has(INITIAL_CONTEXT_FACTORY)) {
          writer.writeAttribute(Attribute.INITIAL_CONTEXT_FACTORY.getLocalName(),connection.require(INITIAL_CONTEXT_FACTORY).asString());
        }
        writer.writeEndElement();
      }
    }
    writer.writeEndElement();
  }
  if (allowInterfaces && hasInterface) {
    writer.writeStartElement(Element.MANAGEMENT_INTERFACES.getLocalName());
    ModelNode managementInterfaces=management.get(MANAGEMENT_INTERFACE);
    if (managementInterfaces.hasDefined(NATIVE_REMOTING_INTERFACE)) {
      writer.writeEmptyElement(Element.NATIVE_REMOTING_INTERFACE.getLocalName());
    }
    if (managementInterfaces.hasDefined(NATIVE_INTERFACE)) {
      writeManagementProtocol(Element.NATIVE_INTERFACE,writer,managementInterfaces.get(NATIVE_INTERFACE));
    }
    if (managementInterfaces.hasDefined(HTTP_INTERFACE)) {
      writeManagementProtocol(Element.HTTP_INTERFACE,writer,managementInterfaces.get(HTTP_INTERFACE));
    }
    writer.writeEndElement();
  }
  writer.writeEndElement();
}
