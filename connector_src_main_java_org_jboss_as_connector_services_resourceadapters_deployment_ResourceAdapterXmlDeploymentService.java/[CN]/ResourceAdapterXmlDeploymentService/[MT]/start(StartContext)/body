{
  try {
    Connector cmd=mdr.getValue().getResourceAdapter(deployment);
    File root=mdr.getValue().getRoot(deployment);
    cmd=(new Merger()).mergeConnectorWithCommonIronJacamar(raxml,cmd);
    final AS7RaXmlDeployer raDeployer=new AS7RaXmlDeployer(context.getChildTarget(),connectorXmlDescriptor.getUrl(),raName,root,module.getClassLoader(),cmd,raxml,null,deploymentServiceName);
    raDeployer.setConfiguration(config.getValue());
    try {
      WritableServiceBasedNamingStore.pushOwner(duServiceName);
      ClassLoader old=SecurityActions.getThreadContextClassLoader();
      try {
        SecurityActions.setThreadContextClassLoader(module.getClassLoader());
        raxmlDeployment=raDeployer.doDeploy();
      }
  finally {
        SecurityActions.setThreadContextClassLoader(old);
        WritableServiceBasedNamingStore.popOwner();
      }
    }
 catch (    Throwable t) {
      unregisterAll(raName);
      throw MESSAGES.failedToStartRaDeployment(t,raName);
    }
    ServiceName raServiceName=ConnectorServices.registerResourceAdapter(raName);
    value=new ResourceAdapterDeployment(raxmlDeployment,raName,raServiceName);
    managementRepository.getValue().getConnectors().add(value.getDeployment().getConnector());
    registry.getValue().registerResourceAdapterDeployment(value);
    context.getChildTarget().addService(raServiceName,new ResourceAdapterService(raName,raServiceName,value.getDeployment().getResourceAdapter())).addDependency(deploymentServiceName).setInitialMode(ServiceController.Mode.ACTIVE).install();
  }
 catch (  Exception e) {
    throw new StartException(e);
  }
}
