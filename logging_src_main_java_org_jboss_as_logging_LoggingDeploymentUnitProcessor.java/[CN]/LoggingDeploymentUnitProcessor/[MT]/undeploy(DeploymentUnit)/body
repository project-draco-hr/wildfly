{
  if (context.hasAttachment(Attachments.MODULE)) {
    final Module module=context.getAttachment(Attachments.MODULE);
    final ClassLoader current=SecurityActions.getThreadContextClassLoader();
    try {
      SecurityActions.setThreadContextClassLoader(module.getClassLoader());
      final LogContext logContext=LogContext.getLogContext();
      LoggingExtension.CONTEXT_SELECTOR.unregisterLogContext(module.getClassLoader(),logContext);
      LoggingLogger.ROOT_LOGGER.tracef("Removing LogContext '%s' from '%s'",logContext,module);
      context.removeAttachment(LOG_CONTEXT_KEY);
    }
  finally {
      SecurityActions.setThreadContextClassLoader(current);
    }
  }
}
