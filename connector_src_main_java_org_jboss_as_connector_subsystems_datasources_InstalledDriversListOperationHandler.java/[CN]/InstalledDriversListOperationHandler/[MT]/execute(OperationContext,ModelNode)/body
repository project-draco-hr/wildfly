{
  if (context.isNormalServer()) {
    context.addStep(new OperationStepHandler(){
      public void execute(      OperationContext context,      ModelNode operation) throws OperationFailedException {
        ServiceController<?> sc=context.getServiceRegistry(false).getRequiredService(ConnectorServices.JDBC_DRIVER_REGISTRY_SERVICE);
        DriverRegistry driverRegistry=DriverRegistry.class.cast(sc.getValue());
        ModelNode result=context.getResult();
        for (        InstalledDriver driver : driverRegistry.getInstalledDrivers()) {
          ModelNode driverNode=new ModelNode();
          driverNode.get(DRIVER_NAME.getName()).set(driver.getDriverName());
          if (driver.isFromDeployment()) {
            driverNode.get(DEPLOYMENT_NAME).set(driver.getDriverName());
            driverNode.get(DRIVER_MODULE_NAME.getName());
            driverNode.get(MODULE_SLOT);
            driverNode.get(DRIVER_DATASOURCE_CLASS_NAME.getName());
            driverNode.get(DRIVER_XA_DATASOURCE_CLASS_NAME.getName());
          }
 else {
            driverNode.get(DEPLOYMENT_NAME);
            driverNode.get(DRIVER_MODULE_NAME.getName()).set(driver.getModuleName().getName());
            driverNode.get(MODULE_SLOT).set(driver.getModuleName() != null ? driver.getModuleName().getSlot() : "");
            driverNode.get(DRIVER_DATASOURCE_CLASS_NAME.getName()).set(driver.getDataSourceClassName() != null ? driver.getDataSourceClassName() : "");
            driverNode.get(DRIVER_XA_DATASOURCE_CLASS_NAME.getName()).set(driver.getXaDataSourceClassName() != null ? driver.getXaDataSourceClassName() : "");
          }
          driverNode.get(DRIVER_CLASS_NAME.getName()).set(driver.getDriverClassName());
          driverNode.get(DRIVER_MAJOR_VERSION.getName()).set(driver.getMajorVersion());
          driverNode.get(DRIVER_MINOR_VERSION.getName()).set(driver.getMinorVersion());
          driverNode.get(JDBC_COMPLIANT).set(driver.isJdbcCompliant());
          result.add(driverNode);
        }
        context.stepCompleted();
      }
    }
,OperationContext.Stage.RUNTIME);
  }
 else {
    context.getResult().set(MESSAGES.noMetricsAvailable());
  }
  context.stepCompleted();
}
