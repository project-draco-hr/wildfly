{
  if (context.getType() == NewOperationContext.Type.SERVER) {
    context.addStep(new NewStepHandler(){
      public void execute(      NewOperationContext context,      ModelNode operation) throws OperationFailedException {
        ServiceController<?> sc=context.getServiceRegistry(false).getRequiredService(ConnectorServices.JDBC_DRIVER_REGISTRY_SERVICE);
        DriverRegistry driverRegistry=DriverRegistry.class.cast(sc.getValue());
        ModelNode result=context.getResult();
        for (        InstalledDriver driver : driverRegistry.getInstalledDrivers()) {
          ModelNode driverNode=new ModelNode();
          driverNode.get(DRIVER_NAME).set(driver.getDriverName());
          if (driver.isFromDeployment()) {
            driverNode.get(DEPLOYMENT_NAME).set(driver.getDriverName());
            driverNode.get(DRIVER_MODULE_NAME);
            driverNode.get(MODULE_SLOT);
            driverNode.get(DRIVER_XA_DATASOURCE_CLASS_NAME);
          }
 else {
            driverNode.get(DEPLOYMENT_NAME);
            driverNode.get(DRIVER_MODULE_NAME).set(driver.getModuleName().getName());
            driverNode.get(MODULE_SLOT).set(driver.getModuleName().getSlot());
            driverNode.get(DRIVER_XA_DATASOURCE_CLASS_NAME).set(driver.getXaDataSourceClassName());
          }
          driverNode.get(DRIVER_CLASS_NAME).set(driver.getDriverClassName());
          driverNode.get(DRIVER_MAJOR_VERSION).set(driver.getMajorVersion());
          driverNode.get(DRIVER_MINOR_VERSION).set(driver.getMinorVersion());
          driverNode.get(JDBC_COMPLIANT).set(driver.isJdbcCompliant());
          result.add(driverNode);
        }
        context.completeStep();
      }
    }
,NewOperationContext.Stage.RUNTIME);
  }
 else {
    context.getResult().set("no metrics available");
  }
  context.completeStep();
}
