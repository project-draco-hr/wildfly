{
  final int argsLength=args.length;
  for (int i=0; i < argsLength; i++) {
    final String arg=args[i];
    try {
      if (CommandLineConstants.PROPERTIES.equals(arg) || "-P".equals(arg)) {
        URL url=null;
        try {
          url=makeURL(args[++i]);
          Properties props=System.getProperties();
          props.load(url.openConnection().getInputStream());
        }
 catch (        MalformedURLException e) {
          System.err.printf("Malformed URL provided for option %s\n",arg);
          return null;
        }
catch (        IOException e) {
          System.err.printf("Unable to load properties from URL %s\n",url);
          return null;
        }
      }
 else       if (arg.startsWith("-D")) {
        String name, value;
        int idx=arg.indexOf("=");
        if (idx == -1) {
          name=arg.substring(2);
          value="true";
        }
 else {
          name=arg.substring(2,idx);
          value=arg.substring(idx + 1,arg.length());
        }
        systemProperties.setProperty(name,value);
        SecurityActions.setSystemProperty(name,value);
      }
 else {
        System.err.printf("Invalid option '%s'\n",arg);
        return null;
      }
    }
 catch (    IndexOutOfBoundsException e) {
      System.err.printf("Argument expected for option %s\n",arg);
      return null;
    }
  }
  return new ServerEnvironment(systemProperties,systemEnvironment,true);
}
