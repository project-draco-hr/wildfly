{
  final XMLMapper mapper=XMLMapper.Factory.create();
  registerStandardDomainReaders(mapper);
  try {
    final List<AbstractDomainModelUpdate<?>> domainUpdates=new ArrayList<AbstractDomainModelUpdate<?>>();
    mapper.parseDocument(domainUpdates,XMLInputFactory.newInstance().createXMLStreamReader(new BufferedReader(reader)));
    final DomainModel domainModel=new DomainModel();
    for (    final AbstractDomainModelUpdate<?> update : domainUpdates) {
      domainModel.update(update);
    }
    return domainModel;
  }
 catch (  RuntimeException e) {
    throw e;
  }
catch (  Exception e) {
    throw new RuntimeException("Caught exception during processing of domain.xml",e);
  }
}
