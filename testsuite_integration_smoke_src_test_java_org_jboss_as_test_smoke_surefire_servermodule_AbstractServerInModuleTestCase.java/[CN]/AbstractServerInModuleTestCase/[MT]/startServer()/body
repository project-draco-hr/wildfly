{
  EmbeddedStandAloneServerFactory.setupCleanDirectories(System.getProperties());
  ServerEnvironment serverEnvironment=Main.determineEnvironment(new String[0],new Properties(System.getProperties()),System.getenv(),ServerEnvironment.LaunchType.EMBEDDED);
  serverDetails+="AS server details: ";
  serverDetails+="server homedir = " + serverEnvironment.getHomeDir();
  serverDetails+=", javaextdirs = " + serverEnvironment.getJavaExtDirs();
  serverDetails+=", modules_dir = " + serverEnvironment.getModulesDir();
  serverDetails+=", server_base = " + serverEnvironment.getServerBaseDir();
  serverDetails+=", server_config_dir = " + serverEnvironment.getServerConfigurationDir();
  serverDetails+=", server_config_file = " + serverEnvironment.getServerConfigurationFile();
  Assert.assertNotNull(serverEnvironment);
  final Bootstrap bootstrap=Bootstrap.Factory.newInstance();
  final Bootstrap.Configuration configuration=new Bootstrap.Configuration(serverEnvironment);
  configuration.setModuleLoader(Module.getBootModuleLoader());
  configuration.setPortOffset(0);
  container=bootstrap.startup(configuration,Collections.<ServiceActivator>emptyList()).get();
  Assert.assertNotNull(serverDetails,container);
}
