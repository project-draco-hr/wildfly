{
  System.out.println("Enter testStandaloneMaxSessionsWithMaxIdle");
  String warName="test" + ++managerIndex;
  String passDir=getPassivationDir(managerIndex,1);
  JBossWebMetaData webMetaData=SessionTestUtil.createWebMetaData(1,true,1,-1);
  cacheContainers[0]=SessionTestUtil.createCacheContainer(true,passDir,false,false);
  cacheContainers[0].start();
  managers[0]=SessionTestUtil.createManager(webMetaData,warName,5,cacheContainers[0],null);
  managers[0].start();
  assertTrue("Passivation is enabled",managers[0].isPassivationEnabled());
  assertEquals("Correct max active count",1,managers[0].getMaxActiveAllowed());
  assertEquals("Correct max idle time",1,managers[0].getPassivationMaxIdleTime());
  assertEquals("Correct min idle time",-1,managers[0].getPassivationMinIdleTime());
  Session sess1=createAndUseSession(managers[0],"1",true,true);
  assertEquals("Session count correct",1,managers[0].getActiveSessionCount());
  assertEquals("Local session count correct",1,managers[0].getLocalActiveSessionCount());
  createAndUseSession(managers[0],"2",false,false);
  sess1.setMaxInactiveInterval(1);
  SessionTestUtil.sleepThread(1100);
  createAndUseSession(managers[0],"2",true,true);
  assertEquals("Session count correct",1,managers[0].getActiveSessionCount());
  assertEquals("Local session count correct",1,managers[0].getLocalActiveSessionCount());
  assertEquals("Created session count correct",2,managers[0].getCreatedSessionCount());
  assertEquals("Expired session count correct",1,managers[0].getExpiredSessionCount());
  assertEquals("Passivated session count correct",0,managers[0].getPassivatedSessionCount());
  SessionTestUtil.sleepThread(1100);
  assertEquals("Passivated session count correct",0,managers[0].getPassivatedSessionCount());
  createAndUseSession(managers[0],"3",true,true);
  assertEquals("Session count correct",1,managers[0].getActiveSessionCount());
  assertEquals("Local session count correct",1,managers[0].getLocalActiveSessionCount());
  assertEquals("Created session count correct",3,managers[0].getCreatedSessionCount());
  assertEquals("Expired session count correct",1,managers[0].getExpiredSessionCount());
  assertEquals("Passivated session count correct",1,managers[0].getPassivatedSessionCount());
}
