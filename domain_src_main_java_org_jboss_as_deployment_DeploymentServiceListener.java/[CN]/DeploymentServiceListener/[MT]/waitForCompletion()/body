{
  delegateListener.finishBatch();
  try {
    latch.await(DEPLOYMENT_TIMEOUT_IN_SECONDS,TimeUnit.SECONDS);
  }
 catch (  Exception e) {
    throw new DeploymentException("Failed to install deployment batch",e);
  }
  final boolean finished=delegateListener.finished();
  if (!finished) {
    throw new DeploymentException("Failed to execute deployment within timeout.");
  }
  if (finished && !startExceptions.isEmpty()) {
    throw new DeploymentException("Deployment failed to start " + startExceptions,startExceptions.get(0));
  }
}
