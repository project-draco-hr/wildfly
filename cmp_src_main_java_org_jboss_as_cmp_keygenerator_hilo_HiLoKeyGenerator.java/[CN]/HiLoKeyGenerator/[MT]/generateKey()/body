{
  if (lo < hi) {
    ++lo;
  }
 else {
    Transaction curTx=null;
    try {
      curTx=tm.suspend();
    }
 catch (    SystemException e) {
      throw new IllegalStateException("Failed to suspend current transaction.");
    }
    try {
      tm.begin();
    }
 catch (    Exception e) {
      throw new IllegalStateException("Failed to begin a new transaction.");
    }
    try {
      doGenerate();
      tm.commit();
    }
 catch (    SQLException e) {
      log.error("Failed to update table: " + e.getMessage(),e);
      try {
        tm.rollback();
      }
 catch (      SystemException e1) {
        log.error("Failed to rollback.",e1);
      }
      throw new IllegalStateException(e.getMessage());
    }
catch (    Exception e) {
      log.error("Failed to commit.",e);
    }
 finally {
      if (curTx != null) {
        try {
          tm.resume(curTx);
        }
 catch (        Exception e) {
          throw new IllegalStateException("Failed to resume transaction: " + e.getMessage());
        }
      }
    }
  }
  return new Long(lo);
}
