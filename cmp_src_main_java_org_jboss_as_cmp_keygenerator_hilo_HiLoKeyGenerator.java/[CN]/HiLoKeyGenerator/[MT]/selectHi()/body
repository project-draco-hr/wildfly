{
  Connection con=null;
  PreparedStatement selectHiSt=null;
  ResultSet rs=null;
  if (log.isTraceEnabled()) {
    log.trace("Executing SQL: " + selectHiSql);
  }
  try {
    con=ds.getConnection();
    selectHiSt=con.prepareStatement(selectHiSql);
    rs=selectHiSt.executeQuery();
    if (!rs.next()) {
      throw new IllegalStateException("The sequence has not been initialized in the service start phase!");
    }
    return rs.getLong(1);
  }
  finally {
    JDBCUtil.safeClose(rs);
    JDBCUtil.safeClose(selectHiSt);
    JDBCUtil.safeClose(con);
  }
}
