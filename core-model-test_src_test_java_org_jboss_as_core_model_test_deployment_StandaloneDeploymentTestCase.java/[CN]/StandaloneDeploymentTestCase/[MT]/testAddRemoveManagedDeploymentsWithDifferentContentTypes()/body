{
  KernelServices kernelServices=createKernelServices();
  ModelNode content=getInputStreamIndexContent();
  ModelNode op=createOperation(kernelServices,"Test1",content);
  ModelTestUtils.checkOutcome(kernelServices.executeOperation(op,new ByteArrayInputStream(new byte[]{1,2,3,4,5})));
  ModelNode hashA=checkSingleDeployment(kernelServices,"Test1",false);
  removeDeployment(kernelServices,"Test1");
  checkNoDeployments(kernelServices);
  content=getByteContent(1,2,3,4,5);
  op=createOperation(kernelServices,"Test1",content);
  ModelTestUtils.checkOutcome(kernelServices.executeOperation(op));
  ModelNode hashB=checkSingleDeployment(kernelServices,"Test1",false);
  removeDeployment(kernelServices,"Test1");
  checkNoDeployments(kernelServices);
  Assert.assertEquals(hashA,hashB);
  content=new ModelNode();
  content.get(HASH).set(hashA);
  op=createOperation(kernelServices,"Test1",content);
  ModelTestUtils.checkOutcome(kernelServices.executeOperation(op));
  ModelNode hashC=checkSingleDeployment(kernelServices,"Test1",false);
  removeDeployment(kernelServices,"Test1");
  checkNoDeployments(kernelServices);
  Assert.assertEquals(hashA,hashC);
  content=getFileUrl("Test1",1,2,3,4,5);
  op=createOperation(kernelServices,"Test1",content);
  ModelTestUtils.checkOutcome(kernelServices.executeOperation(op));
  ModelNode hashD=checkSingleDeployment(kernelServices,"Test1",false);
  removeDeployment(kernelServices,"Test1");
  checkNoDeployments(kernelServices);
  Assert.assertEquals(hashA,hashD);
}
