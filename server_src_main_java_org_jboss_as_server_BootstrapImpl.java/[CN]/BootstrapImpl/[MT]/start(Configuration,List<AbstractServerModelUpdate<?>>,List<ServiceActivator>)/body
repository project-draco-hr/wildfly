{
  if (configuration == null) {
    throw new IllegalArgumentException("configuration is null");
  }
  if (bootUpdates == null) {
    throw new IllegalArgumentException("bootUpdates is null");
  }
  final ModuleLoader moduleLoader=configuration.getModuleLoader();
  final String name=configuration.getName();
  final ServerEnvironment serverEnvironment=configuration.getServerEnvironment();
  if (moduleLoader == null) {
    throw new IllegalArgumentException("moduleLoader is null");
  }
  if (name == null) {
    throw new IllegalArgumentException("name is null");
  }
  if (serverEnvironment == null) {
    throw new IllegalArgumentException("serverEnvironment is null");
  }
  final ServiceContainer container=ServiceContainer.Factory.create();
  final int threads=Runtime.getRuntime().availableProcessors();
  container.setExecutor(new ThreadPoolExecutor(threads,threads,Long.MAX_VALUE,TimeUnit.NANOSECONDS,new LinkedBlockingQueue<Runnable>()));
  final StartTask future=new StartTask(container);
  final ServiceTarget tracker=container.subTarget();
  final Service<ServerController> serverControllerService=new ApplicationServerService(configuration,bootUpdates,extraServices);
  tracker.addListener(new BootstrapListener(future,serverControllerService,configuration.getStartTime()));
  tracker.addService(ServiceName.JBOSS.append("as"),serverControllerService).install();
  return future;
}
