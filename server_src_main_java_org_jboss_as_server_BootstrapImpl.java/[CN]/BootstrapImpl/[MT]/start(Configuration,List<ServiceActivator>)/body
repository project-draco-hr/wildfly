{
  if (configuration == null) {
    throw new IllegalArgumentException("configuration is null");
  }
  final ModuleLoader moduleLoader=configuration.getModuleLoader();
  final ServerEnvironment serverEnvironment=configuration.getServerEnvironment();
  final String name=serverEnvironment.getServerName();
  final ServerConfigurationPersister configurationPersister=configuration.getConfigurationPersister();
  if (moduleLoader == null) {
    throw new IllegalArgumentException("moduleLoader is null");
  }
  if (name == null) {
    throw new IllegalArgumentException("name is null");
  }
  if (serverEnvironment == null) {
    throw new IllegalArgumentException("serverEnvironment is null");
  }
  if (configurationPersister == null) {
    throw new IllegalArgumentException("configurationPersister is null");
  }
  final ServiceContainer container=ServiceContainer.Factory.create("jboss-as-server");
  final StartTask future=new StartTask(container);
  final ServiceTarget tracker=container.subTarget();
  final Service<?> applicationServerService=new ApplicationServerService(extraServices,configuration);
  container.addListener(new BootstrapListener(future,container,configuration.getStartTime()));
  tracker.addService(Services.JBOSS_AS,applicationServerService).install();
  return future;
}
