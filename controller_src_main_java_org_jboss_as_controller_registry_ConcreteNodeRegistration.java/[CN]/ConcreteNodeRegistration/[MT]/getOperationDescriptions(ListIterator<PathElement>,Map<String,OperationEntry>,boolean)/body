{
  if (!iterator.hasNext() || inherited) {
    for (    final Map.Entry<String,OperationEntry> entry : operationsUpdater.get(this).entrySet()) {
      if (!providers.containsKey(entry.getKey())) {
        if (!iterator.hasNext() || (inherited && entry.getValue().isInherited())) {
          providers.put(entry.getKey(),entry.getValue());
        }
      }
    }
    if (!iterator.hasNext()) {
      return;
    }
  }
  final PathElement next=iterator.next();
  try {
    final String key=next.getKey();
    final Map<String,NodeSubregistry> snapshot=childrenUpdater.get(this);
    final NodeSubregistry subregistry=snapshot.get(key);
    if (subregistry != null) {
      subregistry.getHandlers(iterator,next.getValue(),providers,inherited);
    }
  }
  finally {
    iterator.previous();
  }
}
