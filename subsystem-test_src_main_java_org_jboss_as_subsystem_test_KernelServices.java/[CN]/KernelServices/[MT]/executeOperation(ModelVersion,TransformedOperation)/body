{
  if (legacyServices == null) {
    throw new IllegalStateException("Can only be called for the main controller");
  }
  KernelServices legacy=legacyServices.get(modelVersion);
  if (legacy == null) {
    throw new IllegalStateException("No legacy subsystem controller was found for model version " + modelVersion);
  }
  ModelNode result=new ModelNode();
  if (op.getTransformedOperation() != null) {
    result=legacy.executeOperation(op.getTransformedOperation());
  }
  OperationResultTransformer resultTransformer=op.getResultTransformer();
  if (resultTransformer != null) {
    result=resultTransformer.transformResult(result);
  }
  return result;
}
