{
  final KernelServices kernelServices=boot();
  final ModelNode jobRepositoryAddress=createAddress(JobRepositoryDefinition.IN_MEMORY.getPathElement());
  ModelNode op=SubsystemOperations.CompositeOperationBuilder.create().addStep(SubsystemOperations.createRemoveOperation(jobRepositoryAddress)).addStep(SubsystemOperations.createAddOperation(jobRepositoryAddress)).build().getOperation();
  ModelNode result=kernelServices.executeOperation(op);
  boolean success=SubsystemOperations.isSuccessfulOutcome(result);
  Assert.assertTrue(success ? "" : SubsystemOperations.getFailureDescriptionAsString(result),success);
  op=SubsystemOperations.CompositeOperationBuilder.create().addStep(SubsystemOperations.createRemoveOperation(jobRepositoryAddress)).addStep(SubsystemOperations.createAddOperation(createAddress(JobRepositoryDefinition.NAME,"foo"))).build().getOperation();
  result=kernelServices.executeOperation(op);
  success=SubsystemOperations.isSuccessfulOutcome(result);
  Assert.assertFalse(success ? "" : SubsystemOperations.getFailureDescriptionAsString(result),success);
  final ModelNode threadPoolAddress=createAddress("thread-pool","batch");
  ModelNode addThreadPoolOp=SubsystemOperations.createAddOperation(threadPoolAddress);
  addThreadPoolOp.get("max-threads").set(4);
  op=SubsystemOperations.CompositeOperationBuilder.create().addStep(SubsystemOperations.createRemoveOperation(threadPoolAddress)).addStep(addThreadPoolOp).build().getOperation();
  result=kernelServices.executeOperation(op);
  success=SubsystemOperations.isSuccessfulOutcome(result);
  Assert.assertTrue(success ? "" : SubsystemOperations.getFailureDescriptionAsString(result),success);
  addThreadPoolOp=SubsystemOperations.createAddOperation(createAddress("thread-pool","foo"));
  addThreadPoolOp.get("max-threads").set(4);
  op=SubsystemOperations.CompositeOperationBuilder.create().addStep(SubsystemOperations.createRemoveOperation(threadPoolAddress)).addStep(addThreadPoolOp).build().getOperation();
  result=kernelServices.executeOperation(op);
  success=SubsystemOperations.isSuccessfulOutcome(result);
  Assert.assertFalse(success ? "" : SubsystemOperations.getFailureDescriptionAsString(result),success);
}
