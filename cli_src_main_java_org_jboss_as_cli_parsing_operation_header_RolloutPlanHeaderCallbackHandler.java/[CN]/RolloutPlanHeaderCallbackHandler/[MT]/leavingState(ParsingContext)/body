{
  final String id=ctx.getState().getId();
  if (id.equals(HeaderValueState.ID)) {
    handler.header(header);
  }
 else   if (PropertyValueState.ID.equals(id)) {
    final String value=buffer.length() == 0 ? null : buffer.toString().trim();
    if (value == null || value.isEmpty()) {
      throw new CommandFormatException("Property '" + name + "' is missing value at index "+ ctx.getLocation());
    }
    if (group != null) {
      ((SingleRolloutPlanGroup)group).addProperty(name,value);
    }
 else {
      header.addProperty(name,value);
    }
    name=null;
  }
 else   if (ServerGroupNameState.ID.equals(id)) {
    final String groupName=buffer.toString().trim();
    if (groupName.isEmpty()) {
      throw new CommandFormatException("Empty group name at index " + ctx.getLocation());
    }
    ((SingleRolloutPlanGroup)group).setGroupName(groupName);
  }
 else   if (ServerGroupState.ID.equals(id)) {
    if (concurrent) {
      header.addConcurrentGroup(group);
      concurrent=false;
    }
 else {
      header.addGroup(group);
    }
    group=null;
  }
}
