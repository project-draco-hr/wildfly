{
  final String id=ctx.getState().getId();
  if (HeaderValueState.ID.equals(id)) {
    ctx.enterState(RolloutPlanState.INSTANCE);
  }
 else   if (ServerGroupState.ID.equals(id)) {
    group=new SingleRolloutPlanGroup();
  }
 else   if (ConcurrentSignState.ID.equals(id)) {
    concurrent=true;
    header.groupConcurrentSeparator(ctx.getLocation());
  }
 else   if ("NAME_VALUE_SEPARATOR".equals(id)) {
    name=buffer.length() == 0 ? null : buffer.toString().trim();
    if (name == null || name.isEmpty()) {
      throw new CommandFormatException("Property is missing name at index " + ctx.getLocation());
    }
    if (group != null) {
      group.addProperty(name,lastChunkIndex);
      group.propertyValueSeparator(ctx.getLocation());
    }
  }
 else   if (ServerGroupSeparatorState.ID.equals(id)) {
    header.groupSequenceSeparator(ctx.getLocation());
  }
 else   if (PropertyListState.ID.equals(id)) {
    if (group != null) {
      group.propertyListStart(ctx.getLocation());
    }
 else {
      header.propertyListStart(ctx.getLocation());
    }
  }
  buffer.setLength(0);
  lastChunkIndex=ctx.getLocation();
}
