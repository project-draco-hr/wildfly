{
  final String socketBindingRef;
  if (serverModel.hasDefined(SOCKET_BINDING_GROUP)) {
    socketBindingRef=serverModel.get(SOCKET_BINDING_GROUP).asString();
  }
 else {
    final String serverGroupName=serverModel.require(GROUP).asString();
    socketBindingRef=domainModel.require(SERVER_GROUP).require(serverGroupName).require(SOCKET_BINDING_GROUP).asString();
  }
  final Set<String> processed=new HashSet<String>();
  final Map<String,ModelNode> groups=new LinkedHashMap<String,ModelNode>();
  if (domainModel.hasDefined(SOCKET_BINDING_GROUP)) {
    for (    Property prop : domainModel.get(SOCKET_BINDING_GROUP).asPropertyList()) {
      ModelNode node=prop.getValue().clone();
      if (portOffSet > 0) {
        node.get(PORT_OFFSET).set(portOffSet);
      }
      groups.put(prop.getName(),node);
    }
  }
  final ModelNode group=groups.get(socketBindingRef);
  final ModelNode groupAddress=pathAddress(PathElement.pathElement(SOCKET_BINDING_GROUP,SOCKET_BINDING_GROUP_NAME));
  updates.add(SocketBindingGroupAddHandler.getOperation(groupAddress,group));
  mergeBindingGroups(updates,groups,group,processed,group.get(INTERFACE));
}
