{
  final Set<String> processed=new HashSet<String>();
  final Map<String,ModelNode> groups=new LinkedHashMap<String,ModelNode>();
  if (domainModel.hasDefined(SOCKET_BINDING_GROUP)) {
    for (    Property prop : domainModel.get(SOCKET_BINDING_GROUP).asPropertyList()) {
      ModelNode node=prop.getValue().clone();
      if (portOffSet > 0) {
        node.get(PORT_OFFSET).set(portOffSet);
      }
      groups.put(prop.getName(),node);
    }
  }
  final ModelNode group=groups.get(bindingRef);
  if (group == null) {
    throw MESSAGES.undefinedSocketBindingGroup(bindingRef);
  }
  final ModelNode groupAddress=pathAddress(PathElement.pathElement(SOCKET_BINDING_GROUP,bindingRef));
  final ModelNode groupAdd=BindingGroupAddHandler.getOperation(groupAddress,group);
  groupAdd.get(PORT_OFFSET).set(portOffSet);
  updates.add(groupAdd);
  mergeBindingGroups(updates,groups,bindingRef,group,processed);
}
