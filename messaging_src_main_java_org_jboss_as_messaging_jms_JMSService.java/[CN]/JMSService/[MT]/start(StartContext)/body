{
  try {
    final JMSServerManager jmsServer=new JMSServerManagerImpl(hornetQServer.getValue(),new AS7BindingRegistry(context.getController().getServiceContainer()));
    try {
      final ClassLoader loader=getClass().getClassLoader();
      SecurityActions.setContextClassLoader(loader);
      jmsServer.start();
      if (!hornetQServer.getValue().getConfiguration().isBackup()) {
        hornetQServer.getValue().getRemotingService().allowInvmSecurityOverride(new HornetQPrincipal(HornetQDefaultCredentials.getUsername(),HornetQDefaultCredentials.getPassword()));
      }
 else {
        hornetQServer.getValue().registerActivateCallback(new ActivateCallback(){
          public void preActivate(){
          }
          public void activated(){
            hornetQServer.getValue().getRemotingService().allowInvmSecurityOverride(new HornetQPrincipal(HornetQDefaultCredentials.getUsername(),HornetQDefaultCredentials.getPassword()));
          }
          public void deActivate(){
          }
        }
);
      }
    }
  finally {
      SecurityActions.setContextClassLoader(null);
    }
    this.jmsServer=jmsServer;
  }
 catch (  Exception e) {
    throw new StartException(e);
  }
}
