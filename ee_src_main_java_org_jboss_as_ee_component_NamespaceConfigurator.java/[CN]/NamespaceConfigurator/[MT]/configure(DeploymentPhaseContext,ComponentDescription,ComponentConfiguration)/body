{
  final ComponentNamingMode namingMode=description.getNamingMode();
  final InjectedEENamespaceContextSelector selector=new InjectedEENamespaceContextSelector();
  final String applicationName=configuration.getApplicationName();
  final String moduleName=configuration.getModuleName();
  final String compName=configuration.getComponentName();
  final ServiceName appContextServiceName=ContextNames.contextServiceNameOfApplication(applicationName);
  final ServiceName moduleContextServiceName=ContextNames.contextServiceNameOfModule(applicationName,moduleName);
  final ServiceName compContextServiceName=ContextNames.contextServiceNameOfComponent(applicationName,moduleName,compName);
  final Injector<NamingStore> appInjector=selector.getAppContextInjector();
  final Injector<NamingStore> moduleInjector=selector.getModuleContextInjector();
  final Injector<NamingStore> compInjector=selector.getCompContextInjector();
  configuration.getStartDependencies().add(new DependencyConfigurator<ComponentStartService>(){
    public void configureDependency(    final ServiceBuilder<?> serviceBuilder,    ComponentStartService service){
      serviceBuilder.addDependency(appContextServiceName,NamingStore.class,appInjector);
      serviceBuilder.addDependency(moduleContextServiceName,NamingStore.class,moduleInjector);
      if (namingMode == ComponentNamingMode.CREATE) {
        serviceBuilder.addDependency(compContextServiceName,NamingStore.class,compInjector);
      }
 else       if (namingMode == ComponentNamingMode.USE_MODULE) {
        serviceBuilder.addDependency(moduleContextServiceName,NamingStore.class,compInjector);
      }
    }
  }
);
  final InterceptorFactory interceptorFactory=new ImmediateInterceptorFactory(new NamespaceContextInterceptor(selector));
  configuration.addPostConstructInterceptor(interceptorFactory,InterceptorOrder.ComponentPostConstruct.JNDI_NAMESPACE_INTERCEPTOR);
  configuration.addPreDestroyInterceptor(interceptorFactory,InterceptorOrder.ComponentPreDestroy.JNDI_NAMESPACE_INTERCEPTOR);
  configuration.addComponentInterceptor(interceptorFactory,InterceptorOrder.Component.JNDI_NAMESPACE_INTERCEPTOR,false);
  configuration.setNamespaceContextInterceptorFactory(interceptorFactory);
}
