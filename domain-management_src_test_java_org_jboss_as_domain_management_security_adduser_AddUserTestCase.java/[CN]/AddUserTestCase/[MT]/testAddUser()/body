{
  values.setGroups(ROLES);
  AddUserState addUserState=new AddUserState(consoleMock,values);
  AssertConsoleBuilder consoleBuilder=new AssertConsoleBuilder().expectedDisplayText(MESSAGES.addedUser(values.getUserName(),values.getUserFiles().get(0).getCanonicalPath())).expectedDisplayText(AddUser.NEW_LINE).expectedDisplayText(MESSAGES.addedGroups(values.getUserName(),values.getGroups(),values.getGroupFiles().get(0).getCanonicalPath())).expectedDisplayText(AddUser.NEW_LINE);
  consoleMock.setResponses(consoleBuilder);
  addUserState.update(values);
  assertRolePropertyFile(USER_NAME);
  assertUserPropertyFile(USER_NAME);
  consoleBuilder.validate();
}
