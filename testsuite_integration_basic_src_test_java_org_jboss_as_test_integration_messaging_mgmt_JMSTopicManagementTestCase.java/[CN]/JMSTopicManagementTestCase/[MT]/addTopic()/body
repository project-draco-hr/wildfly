{
  count++;
  final String jndiName=getTopicJndiName();
  adminSupport.createJmsTopic(getTopicName(),jndiName);
  TransportConfiguration transportConfiguration=new TransportConfiguration(NettyConnectorFactory.class.getName());
  HornetQConnectionFactory cf=HornetQJMSClient.createConnectionFactoryWithoutHA(JMSFactoryType.CF,transportConfiguration);
  cf.setClientID("sender");
  conn=cf.createTopicConnection("guest","guest");
  conn.start();
  topic=HornetQJMSClient.createTopic(getTopicName());
  session=conn.createTopicSession(false,TopicSession.AUTO_ACKNOWLEDGE);
  cf=HornetQJMSClient.createConnectionFactoryWithoutHA(JMSFactoryType.CF,transportConfiguration);
  cf.setClientID("consumer");
  consumerConn=cf.createTopicConnection("guest","guest");
  consumerConn.start();
  consumerSession=consumerConn.createTopicSession(false,TopicSession.AUTO_ACKNOWLEDGE);
}
