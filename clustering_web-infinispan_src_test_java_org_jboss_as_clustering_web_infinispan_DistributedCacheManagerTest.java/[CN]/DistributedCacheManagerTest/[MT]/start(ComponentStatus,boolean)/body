{
  EmbeddedCacheManager container=mock(EmbeddedCacheManager.class);
  Address address=mock(Address.class);
  Cache<Address,String> jvmRouteCache=mock(Cache.class);
  ArgumentCaptor<DistributedCacheManager.JvmRouteHandler> capturedJvmRouteHandler=ArgumentCaptor.forClass(DistributedCacheManager.JvmRouteHandler.class);
  String jvmRoute="node0";
  when(this.sessionCache.getStatus()).thenReturn(status);
  when(this.sessionCache.getCacheManager()).thenReturn(container);
  doNothing().when(container).addListener(capturedJvmRouteHandler.capture());
  when(this.sessionManager.getJvmRoute()).thenReturn(jvmRoute);
  when(container.getAddress()).thenReturn(address);
  when(this.jvmRouteCacheSource.<Address,String>getCache(this.registry,this.sessionManager)).thenReturn(jvmRouteCache);
  when(jvmRouteCache.putIfAbsent(same(address),same(jvmRoute))).thenReturn(null);
  this.manager.start();
  verify(this.sessionCache).addListener(same(this.manager));
  reset(this.sessionCache);
  return capturedJvmRouteHandler.getValue();
}
