{
  final DeploymentUnit deploymentUnit=phaseContext.getDeploymentUnit();
  if (DeploymentTypeMarker.isType(DeploymentType.EAR,deploymentUnit)) {
    return;
  }
  final CompositeIndex compositeIndex=deploymentUnit.getAttachment(Attachments.COMPOSITE_ANNOTATION_INDEX);
  if (compositeIndex == null) {
    if (logger.isTraceEnabled()) {
      logger.trace("Skipping EJB annotation processing since no composite annotation index found in unit: " + deploymentUnit);
    }
  }
 else {
    processAnnotations(deploymentUnit,compositeIndex);
  }
  processDeploymentDescriptor(deploymentUnit);
}
