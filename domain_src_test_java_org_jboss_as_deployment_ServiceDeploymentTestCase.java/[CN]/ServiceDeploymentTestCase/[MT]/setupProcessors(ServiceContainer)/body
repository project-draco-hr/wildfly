{
  final BatchBuilder builder=serviceContainer.batchBuilder();
  final CountDownLatch latch=new CountDownLatch(1);
  final TimingServiceListener listener=new TimingServiceListener(new Runnable(){
    public void run(){
      latch.countDown();
    }
  }
);
  builder.addListener(listener);
  addProcessor(builder,ServiceName.JBOSS.append("deployment","processor","module","dependency"),new ModuleDependencyProcessor(),ModuleDependencyProcessor.PRIORITY);
  addProcessor(builder,ServiceName.JBOSS.append("deployment","processor","module","dependency","test"),new TestModuleDependencyProcessor(),TestModuleDependencyProcessor.PRIORITY);
  addProcessor(builder,ServiceName.JBOSS.append("deployment","processor","module","config"),new ModuleConfgProcessor(),ModuleConfgProcessor.PRIORITY);
  addProcessor(builder,ServiceName.JBOSS.append("deployment","processor","module","deployment"),new ModuleDeploymentProcessor(),ModuleDeploymentProcessor.PRIORITY);
  addProcessor(builder,ServiceName.JBOSS.append("deployment","processor","service","parser"),new ServiceDeploymentParsingProcessor(),ServiceDeploymentParsingProcessor.PRIORITY);
  addProcessor(builder,ServiceName.JBOSS.append("deployment","processor","service","deployment"),new ServiceDeploymentProcessor(),ServiceDeploymentProcessor.PRIORITY);
  builder.install();
  listener.finishBatch();
  latch.await(1L,TimeUnit.SECONDS);
  if (!listener.finished())   fail("Did not install processors within 1 seconds");
}
