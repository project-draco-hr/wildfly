{
  final VirtualFile deploymentFile=initializeDeployment("/test/serviceXmlDeployment.jar");
  final DeploymentResult result=new DeploymentUnitElement(null,deploymentFile.getPathName(),new byte[0],true,true).activate(serviceContainer).getDeploymentResult();
  assertDeploymentSuccess(result);
  final ServiceController<?> testServiceController=serviceContainer.getService(TestServiceDeployment.TEST_SERVICE_NAME);
  assertNotNull(testServiceController);
  assertEquals(ServiceController.State.UP,testServiceController.getState());
  final LegacyService legacyService=(LegacyService)testServiceController.getValue();
  assertNotNull(legacyService);
  assertEquals("Test Value",legacyService.getSomethingElse());
  final ServiceController<?> testServiceControllerTwo=serviceContainer.getService(TestServiceDeployment.TEST_SERVICE_NAME.append("second"));
  assertNotNull(testServiceControllerTwo);
  assertEquals(ServiceController.State.UP,testServiceControllerTwo.getState());
  final LegacyService legacyServiceTwo=(LegacyService)testServiceControllerTwo.getValue();
  assertNotNull(legacyServiceTwo);
  assertEquals(legacyService,legacyServiceTwo.getOther());
  assertEquals("Test Value - more value",legacyServiceTwo.getSomethingElse());
  final ServiceController<?> testServiceControllerThree=serviceContainer.getService(TestServiceDeployment.TEST_SERVICE_NAME.append("third"));
  assertNotNull(testServiceControllerThree);
  assertEquals(ServiceController.State.UP,testServiceControllerThree.getState());
  final LegacyService legacyServiceThree=(LegacyService)testServiceControllerThree.getValue();
  assertNotNull(legacyServiceThree);
  assertEquals(legacyService,legacyServiceThree.getOther());
  assertEquals("Another test value",legacyServiceThree.getSomethingElse());
  serviceContainer.shutdown();
}
