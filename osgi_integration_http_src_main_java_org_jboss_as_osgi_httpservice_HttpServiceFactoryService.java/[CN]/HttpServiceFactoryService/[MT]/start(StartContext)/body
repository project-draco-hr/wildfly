{
  ServerEnvironment serverEnvironment=injectedServerEnvironment.getValue();
  Host virtualHost=injectedVirtualHost.getValue().getHost();
  BundleContext syscontext=injectedSystemContext.getValue();
  WebServer webServer=injectedWebServer.getValue();
  Hashtable<String,Object> props=new Hashtable<String,Object>();
  props.put("provider",getClass().getPackage().getName());
  ServiceFactory serviceFactory=new HttpServiceFactory(webServer,virtualHost,serverEnvironment);
  registration=syscontext.registerService(HttpService.class.getName(),serviceFactory,props);
}
