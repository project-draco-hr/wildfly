{
  InputStream inputA=deployer.getDeployment(BUNDLE_A);
  Bundle bundleA=context.installBundle(BUNDLE_A,inputA);
  try {
    Assert.assertEquals("Bundle INSTALLED",Bundle.INSTALLED,bundleA.getState());
    InputStream inputB=deployer.getDeployment(BUNDLE_B);
    Bundle bundleB=context.installBundle(BUNDLE_B,inputB);
    try {
      Assert.assertEquals("Bundle INSTALLED",Bundle.INSTALLED,bundleB.getState());
      try {
        bundleB.start();
        Assert.fail("BundleException expected");
      }
 catch (      BundleException ex) {
      }
      Assert.assertEquals("Bundle INSTALLED",Bundle.INSTALLED,bundleA.getState());
      Assert.assertEquals("Bundle INSTALLED",Bundle.INSTALLED,bundleB.getState());
    }
  finally {
      bundleB.uninstall();
    }
  }
  finally {
    bundleA.uninstall();
  }
}
