{
  try {
    final Enumeration<URL> resources=module.getClassLoader().getResources("META-INF/jandex.idx");
    if (!resources.hasMoreElements()) {
      throw new RuntimeException("Module " + module + " has no jandex index, make sure index generation is enabled in build.xml by setting jandex=\"true\"");
    }
    final Set<Index> indexes=new HashSet<Index>();
    while (resources.hasMoreElements()) {
      final URL url=resources.nextElement();
      InputStream stream=url.openStream();
      try {
        IndexReader reader=new IndexReader(stream);
        indexes.add(reader.read());
      }
  finally {
        stream.close();
      }
    }
    return new CompositeIndex(indexes);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
