{
  if (o == null) {
    return new ModelNode();
  }
  if (o instanceof CompositeData) {
    final ModelNode node=new ModelNode();
    final CompositeData composite=(CompositeData)o;
    for (    String key : composite.getCompositeType().keySet()) {
      if (!typeNode.hasDefined(key)) {
        throw new IllegalArgumentException("Unknown value " + key);
      }
      final ModelNode type=typeNode.get(key).get(TYPE);
      final ModelNode valueType=typeNode.get(key).get(VALUE_TYPE);
      TypeConverter converter=getConverter(type,valueType);
      node.get(key).set(converter.toModelNode(composite.get(key)));
    }
    return node;
  }
 else {
    return ModelNode.fromJSONString((String)o);
  }
}
