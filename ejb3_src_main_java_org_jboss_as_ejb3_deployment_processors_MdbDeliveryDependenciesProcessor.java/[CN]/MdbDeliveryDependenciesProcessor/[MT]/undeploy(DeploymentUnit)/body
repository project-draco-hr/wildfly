{
  final EEModuleConfiguration moduleConfiguration=deploymentUnit.getAttachment(EE_MODULE_CONFIGURATION);
  if (moduleConfiguration == null) {
    return;
  }
  final ServiceRegistry serviceRegistry=deploymentUnit.getServiceRegistry();
  for (  final ComponentConfiguration configuration : moduleConfiguration.getComponentConfigurations()) {
    final ComponentDescription description=configuration.getComponentDescription();
    if (description instanceof MessageDrivenComponentDescription) {
      final ServiceName mdbDeliveryControllerServiceName=createMdbDeliveryControllerServiceName(description.getStartServiceName());
      final ServiceController<?> mdbDeliveryControllerService=serviceRegistry.getService(mdbDeliveryControllerServiceName);
      if (mdbDeliveryControllerService != null) {
        mdbDeliveryControllerService.setMode(Mode.REMOVE);
      }
    }
  }
  if (getEJBBoundClusteringMetaData(deploymentUnit) != null) {
    final ServiceController<?> barrierDependentService=serviceRegistry.getService(createClusteredSingletonDemanderServiceName(deploymentUnit));
    if (barrierDependentService != null) {
      barrierDependentService.setMode(Mode.REMOVE);
    }
  }
}
