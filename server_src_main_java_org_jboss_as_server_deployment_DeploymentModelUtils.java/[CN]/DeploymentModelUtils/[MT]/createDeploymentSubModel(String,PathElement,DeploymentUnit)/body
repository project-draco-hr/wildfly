{
  final Resource root=unit.getAttachment(DEPLOYMENT_RESOURCE);
synchronized (root) {
    final ImmutableManagementResourceRegistration registration=unit.getAttachment(REGISTRATION_ATTACHMENT);
    final Resource subsystem=getOrCreate(root,PathElement.pathElement(SUBSYSTEM,subsystemName));
    final ImmutableManagementResourceRegistration subModel=registration.getSubModel(getExtensionAddress(subsystemName,address));
    if (subModel == null) {
      throw new IllegalStateException(address.toString());
    }
    return getOrCreate(subsystem,address).getModel();
  }
}
