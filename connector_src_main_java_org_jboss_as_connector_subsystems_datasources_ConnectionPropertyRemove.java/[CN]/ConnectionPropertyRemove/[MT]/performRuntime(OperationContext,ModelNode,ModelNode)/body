{
  final ServiceRegistry registry=context.getServiceRegistry(true);
  final ModelNode address=operation.require(OP_ADDR);
  PathAddress path=PathAddress.pathAddress(address);
  final String jndiName=path.getElement(path.size() - 2).getValue();
  final String configPropertyName=PathAddress.pathAddress(address).getLastElement().getValue();
  final ServiceName dataSourceConfigServiceName=DataSourceConfigService.SERVICE_NAME_BASE.append(jndiName);
  final ServiceController<?> dataSourceConfigController=registry.getService(dataSourceConfigServiceName);
  if (dataSourceConfigController == null || !((DataSource)dataSourceConfigController.getValue()).isEnabled()) {
    ServiceName propertySeerviceName=DataSourceConfigService.SERVICE_NAME_BASE.append(jndiName).append("connection-properties").append(configPropertyName);
    final ServiceController<?> propertyController=registry.getService(propertySeerviceName);
    if (propertyController != null) {
      context.removeService(propertySeerviceName);
    }
  }
 else {
    context.reloadRequired();
  }
}
