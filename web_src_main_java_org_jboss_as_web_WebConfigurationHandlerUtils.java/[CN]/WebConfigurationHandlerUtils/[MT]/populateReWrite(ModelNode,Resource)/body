{
  int num=0;
  for (  final ModelNode entry : resource.getModel().get(REWRITE).asList()) {
    String name="rule-" + num++;
    PathElement rewritepath=PathElement.pathElement(REWRITE,name);
    resource.registerChild(rewritepath,Resource.Factory.create());
    final Resource rewritevalve=resource.getChild(rewritepath);
    for (    final String attribute : entry.keys()) {
      if (entry.hasDefined(attribute)) {
        if (attribute.equals(CONDITION)) {
          int j=0;
          for (          final ModelNode cond : entry.get(CONDITION).asList()) {
            String condname="condition-" + j++;
            PathElement conditionpath=PathElement.pathElement(CONDITION,condname);
            rewritevalve.registerChild(conditionpath,Resource.Factory.create());
            final Resource condition=rewritevalve.getChild(conditionpath);
            populateModel(condition.getModel(),cond);
          }
        }
 else {
          rewritevalve.getModel().get(attribute).set(entry.get(attribute));
        }
      }
    }
  }
}
