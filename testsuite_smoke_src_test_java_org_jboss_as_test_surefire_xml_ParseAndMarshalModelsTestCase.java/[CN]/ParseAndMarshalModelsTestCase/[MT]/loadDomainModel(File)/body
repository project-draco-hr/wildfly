{
  final QName rootElement=new QName(Namespace.CURRENT.getUriString(),"domain");
  final DomainXml parser=new DomainXml(Module.getBootModuleLoader());
  final XmlConfigurationPersister persister=new XmlConfigurationPersister(file,rootElement,parser,parser);
  final List<ModelNode> ops=persister.load();
  TestDomainController controller=new TestDomainController(persister);
  executeOperations(controller,ops);
  ModelNode model=controller.getDomainModel().clone();
  persister.store(model);
  return model;
}
