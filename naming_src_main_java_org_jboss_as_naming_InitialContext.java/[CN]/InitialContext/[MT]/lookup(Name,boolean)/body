{
  final ParsedName parsedName=parse(name);
  if (parsedName.namespace() == null) {
    if (!parsedName.remaining().isEmpty()) {
      final String firstPart=parsedName.remaining().get(0);
      int index=firstPart.indexOf(':');
      if (index != -1) {
        final String scheme=firstPart.substring(0,index);
        ObjectFactory factory=urlContextFactories.get(scheme);
        if (factory != null) {
          try {
            return ((Context)factory.getObjectInstance(null,name,this,getEnvironment())).lookup(name);
          }
 catch (          NamingException e) {
            throw e;
          }
catch (          Exception e) {
            NamingException n=new NamingException(e.getMessage());
            n.initCause(e);
            throw n;
          }
        }
 else {
          Context ctx=NamingManager.getURLContext(scheme,getEnvironment());
          if (ctx != null) {
            return ctx.lookup(name);
          }
        }
      }
    }
  }
  final Context namespaceContext=findContext(name,parsedName);
  if (namespaceContext == null)   return super.lookup(parsedName.remaining(),dereference);
 else   return namespaceContext.lookup(parsedName.remaining());
}
