{
  final List<String> lines;
  if (numberOfLines < 0) {
    lines=new ArrayList<String>();
  }
 else {
    lines=new ArrayList<String>(numberOfLines);
  }
  final InputStream in;
  BufferedReader reader=null;
  try {
    if (tail) {
      in=new LifoFileInputStream(file);
    }
 else {
      in=new FileInputStream(file);
    }
    if (encoding == null) {
      reader=new BufferedReader(new InputStreamReader(in));
    }
 else {
      reader=new BufferedReader(new InputStreamReader(in,encoding));
    }
    int lineCount=0;
    String line;
    while ((line=reader.readLine()) != null) {
      if (++lineCount <= skip)       continue;
      if (lines.size() == numberOfLines)       break;
      lines.add(line);
    }
    if (tail) {
      Collections.reverse(lines);
    }
    return lines;
  }
  finally {
    safeClose(reader);
  }
}
