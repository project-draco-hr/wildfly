{
  if (node == null) {
    throw new IllegalArgumentException("node is null");
  }
  if (state == null) {
    throw new IllegalArgumentException("state is null");
  }
  this.node=node;
  this.state=state;
  childIndex=0;
  collection=state instanceof ArtifactCollectionState;
  if (collection) {
    ArtifactCollectionState<?> col=(ArtifactCollectionState<?>)state;
    col.resetIndex();
    if (col.hasNext(ctx)) {
      col.next(ctx);
    }
  }
}
