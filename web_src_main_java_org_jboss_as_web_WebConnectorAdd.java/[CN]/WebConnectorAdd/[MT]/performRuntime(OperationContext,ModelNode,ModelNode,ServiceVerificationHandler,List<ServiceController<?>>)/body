{
  final PathAddress address=PathAddress.pathAddress(operation.get(OP_ADDR));
  final String name=address.getLastElement().getValue();
  ModelNode fullModel=Resource.Tools.readModel(context.readResource(PathAddress.EMPTY_ADDRESS));
  final String bindingRef=WebConnectorDefinition.SOCKET_BINDING.resolveModelAttribute(context,fullModel).asString();
  final boolean enabled=WebConnectorDefinition.ENABLED.resolveModelAttribute(context,fullModel).asBoolean();
  final String protocol=WebConnectorDefinition.PROTOCOL.resolveModelAttribute(context,fullModel).asString();
  final String scheme=WebConnectorDefinition.SCHEME.resolveModelAttribute(context,fullModel).asString();
  final WebConnectorService service=new WebConnectorService(protocol,scheme);
  service.setSecure(WebConnectorDefinition.SECURE.resolveModelAttribute(context,fullModel).asBoolean());
  service.setEnableLookups(WebConnectorDefinition.ENABLE_LOOKUPS.resolveModelAttribute(context,fullModel).asBoolean());
  ModelNode resolved;
  if (operation.hasDefined(PROXY_NAME) && (resolved=WebConnectorDefinition.PROXY_NAME.resolveModelAttribute(context,fullModel)).isDefined()) {
    service.setProxyName(resolved.asString());
  }
  if (operation.hasDefined(PROXY_PORT) && (resolved=WebConnectorDefinition.PROXY_PORT.resolveModelAttribute(context,fullModel)).isDefined()) {
    service.setProxyPort(resolved.asInt());
  }
  if (operation.hasDefined(REDIRECT_PORT) && (resolved=WebConnectorDefinition.REDIRECT_PORT.resolveModelAttribute(context,fullModel)).isDefined()) {
    service.setRedirectPort(resolved.asInt());
  }
  if (operation.hasDefined(MAX_POST_SIZE) && (resolved=WebConnectorDefinition.MAX_POST_SIZE.resolveModelAttribute(context,fullModel)).isDefined()) {
    service.setMaxPostSize(resolved.asInt());
  }
  if (operation.hasDefined(MAX_SAVE_POST_SIZE) && (resolved=WebConnectorDefinition.MAX_SAVE_POST_SIZE.resolveModelAttribute(context,fullModel)).isDefined()) {
    service.setMaxSavePostSize(resolved.asInt());
  }
  if (operation.hasDefined(MAX_CONNECTIONS) && (resolved=WebConnectorDefinition.MAX_CONNECTIONS.resolveModelAttribute(context,fullModel)).isDefined()) {
    service.setMaxConnections(resolved.asInt());
  }
  if (operation.hasDefined(VIRTUAL_SERVER) && (resolved=WebConnectorDefinition.VIRTUAL_SERVER.resolveModelAttribute(context,fullModel)).isDefined()) {
    List<String> vServers=new LinkedList<String>();
    for (    ModelNode vServer : resolved.asList()) {
      vServers.add(vServer.asString());
    }
    service.setVirtualServers(vServers);
  }
  if (fullModel.get(SSL_PATH.getKey(),SSL_PATH.getValue()).isDefined()) {
    service.setSsl(resolveExpressions(context,fullModel.get(SSL_PATH.getKey(),SSL_PATH.getValue())));
  }
  final ServiceBuilder<Connector> serviceBuilder=context.getServiceTarget().addService(WebSubsystemServices.JBOSS_WEB_CONNECTOR.append(name),service).addDependency(WebSubsystemServices.JBOSS_WEB,WebServer.class,service.getServer()).addDependency(SocketBinding.JBOSS_BINDING_NAME.append(bindingRef),SocketBinding.class,service.getBinding());
  if (operation.hasDefined(EXECUTOR)) {
    String executorRef=operation.get(EXECUTOR).asString();
    serviceBuilder.addDependency(ThreadsServices.executorName(executorRef),Executor.class,service.getExecutor());
  }
  serviceBuilder.setInitialMode(enabled ? Mode.ACTIVE : Mode.NEVER);
  if (enabled) {
    serviceBuilder.addListener(verificationHandler);
  }
  final ServiceController<Connector> serviceController=serviceBuilder.install();
  if (newControllers != null) {
    newControllers.add(serviceController);
  }
}
