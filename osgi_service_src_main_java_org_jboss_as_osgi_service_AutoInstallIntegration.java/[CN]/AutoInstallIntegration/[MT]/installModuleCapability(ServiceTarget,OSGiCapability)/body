{
  String identifier=osgicap.getIdentifier();
  if (isValidModuleIdentifier(identifier)) {
    ModuleIdentifier moduleId=ModuleIdentifier.fromString(identifier);
    File bundleFile=ModuleIdentityArtifactProvider.getRepositoryEntry(bundlesDir,moduleId);
    if (bundleFile != null) {
      return false;
    }
    Module module=null;
    try {
      ModuleLoader moduleLoader=Module.getBootModuleLoader();
      module=moduleLoader.loadModule(moduleId);
    }
 catch (    ModuleLoadException e) {
      LOGGER.debugf("Cannot load module: %s",moduleId);
    }
    if (module != null) {
      OSGiMetaData metadata=getModuleMetadata(module);
      XResourceBuilder builder=XResourceBuilderFactory.create();
      if (metadata != null) {
        builder.loadFrom(metadata);
      }
 else {
        builder.loadFrom(module);
      }
      XResource res=builder.getResource();
      res.addAttachment(Module.class,module);
      injectedEnvironment.getValue().installResources(res);
      return true;
    }
  }
  return false;
}
