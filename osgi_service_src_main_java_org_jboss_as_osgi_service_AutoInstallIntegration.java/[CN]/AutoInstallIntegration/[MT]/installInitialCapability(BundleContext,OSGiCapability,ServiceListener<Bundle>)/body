{
  String identifier=osgicap.getIdentifier();
  Integer level=osgicap.getStartLevel();
  ServiceName result=null;
  if (isValidModuleIdentifier(identifier)) {
    ModuleIdentifier moduleId=ModuleIdentifier.fromString(identifier);
    File bundleFile=ModuleIdentityRepository.getRepositoryEntry(bundlesDir,moduleId);
    if (bundleFile != null) {
      LOGGER.tracef("Installing initial bundle capability: %s",identifier);
      URL bundleURL=bundleFile.toURI().toURL();
      result=installBundleFromURL(bundleURL,identifier,level,listener);
    }
  }
 else   if (isValidMavenIdentifier(identifier)) {
    LOGGER.tracef("Installing initial maven capability: %s",identifier);
    ServiceReference sref=context.getServiceReference(XRepository.class.getName());
    XRepository repository=(XRepository)context.getService(sref);
    MavenCoordinates mavenId=MavenCoordinates.parse(identifier);
    Requirement req=XRequirementBuilder.create(mavenId).getRequirement();
    Collection<Capability> caps=repository.findProviders(req);
    if (caps.isEmpty() == false) {
      XResource resource=(XResource)caps.iterator().next().getResource();
      XCapability ccap=(XCapability)resource.getCapabilities(ContentNamespace.CONTENT_NAMESPACE).get(0);
      URL bundleURL=new URL((String)ccap.getAttribute(ContentNamespace.CAPABILITY_URL_ATTRIBUTE));
      result=installBundleFromURL(bundleURL,identifier,level,listener);
    }
  }
  if (result == null)   throw MESSAGES.startFailedCannotResolveInitialCapability(null,identifier);
  return result;
}
