{
  PartitionManager partitionManager=getPartitionManager();
  IdentityManager identityManager=partitionManager.createIdentityManager();
  String loginName="johny";
  User user=getUser(identityManager,loginName);
  if (user != null) {
    identityManager.remove(user);
  }
  identityManager.add(new User(loginName));
  user=getUser(identityManager,"johny");
  String roleName="admin";
  Role role=getRole(identityManager,roleName);
  if (role != null) {
    identityManager.remove(role);
  }
  identityManager.add(new Role(roleName));
  role=getRole(identityManager,"admin");
  RelationshipManager relationshipManager=partitionManager.createRelationshipManager();
  BasicModel.grantRole(relationshipManager,user,role);
  assertTrue(hasRole(relationshipManager,user,role));
}
