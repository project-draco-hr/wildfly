{
  long timeout=session.getMetaData().getMaxInactiveInterval(TimeUnit.MILLISECONDS);
  if (timeout > 0) {
    long lastAccessed=session.getMetaData().getLastAccessedTime().getTime();
    long delay=Math.max(lastAccessed + timeout - System.currentTimeMillis(),0);
    String id=session.getId();
    Runnable task=new ExpirationTask(id);
    InfinispanWebLogger.ROOT_LOGGER.tracef("Session %s will expire in %d ms",id,timeout);
synchronized (task) {
      this.expirationFutures.put(id,this.executor.schedule(task,delay,TimeUnit.MILLISECONDS));
    }
  }
}
