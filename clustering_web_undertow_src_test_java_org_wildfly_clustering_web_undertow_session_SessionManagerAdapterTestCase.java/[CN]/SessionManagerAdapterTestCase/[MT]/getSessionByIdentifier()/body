{
  ImmutableSession session=mock(ImmutableSession.class);
  String id="session";
  Batcher batcher=mock(Batcher.class);
  Batch batch=mock(Batch.class);
  when(this.manager.getBatcher()).thenReturn(batcher);
  when(this.manager.viewSession(id)).thenReturn(session);
  when(session.getId()).thenReturn(id);
  when(batcher.startBatch()).thenReturn(batch);
  io.undertow.server.session.Session result=this.adapter.getSession(id);
  assertSame(this.adapter,result.getSessionManager());
  assertSame(id,result.getId());
  verify(batch).discard();
}
