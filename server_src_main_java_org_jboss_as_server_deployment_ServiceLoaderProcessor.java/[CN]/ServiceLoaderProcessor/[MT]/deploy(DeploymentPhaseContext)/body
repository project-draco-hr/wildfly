{
  final Map<String,List<String>> foundServices=new HashMap<String,List<String>>();
  final DeploymentUnit deploymentUnit=phaseContext.getDeploymentUnit();
  final ResourceRoot deploymentRoot=deploymentUnit.getAttachment(Attachments.DEPLOYMENT_ROOT);
  if (deploymentRoot != null) {
    processRoot(deploymentRoot,foundServices);
  }
  final AttachmentList<ResourceRoot> resourceRoots=deploymentUnit.getAttachment(Attachments.RESOURCE_ROOTS);
  if (resourceRoots != null) {
    for (    ResourceRoot resourceRoot : resourceRoots) {
      processRoot(resourceRoot,foundServices);
    }
  }
  deploymentUnit.putAttachment(Attachments.SERVICES,new ServicesAttachment(foundServices));
}
