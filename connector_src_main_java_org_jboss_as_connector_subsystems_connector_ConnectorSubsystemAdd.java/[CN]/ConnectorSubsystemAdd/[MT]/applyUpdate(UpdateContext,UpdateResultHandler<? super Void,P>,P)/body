{
  final ServiceTarget serviceTarget=updateContext.getServiceTarget();
  WorkManager wm=new WorkManagerImpl();
  final WorkManagerService wmService=new WorkManagerService(wm);
  serviceTarget.addService(ConnectorServices.WORKMANAGER_SERVICE,wmService).addDependency(ThreadsServices.EXECUTOR.append(shortRunningThreadPool),Executor.class,wmService.getExecutorShortInjector()).addDependency(ThreadsServices.EXECUTOR.append(longRunningThreadPool),Executor.class,wmService.getExecutorLongInjector()).addDependency(TxnServices.JBOSS_TXN_XA_TERMINATOR,JBossXATerminator.class,wmService.getXaTerminatorInjector()).setInitialMode(Mode.ACTIVE).install();
  CloneableBootstrapContext ctx=new BaseCloneableBootstrapContext();
  final DefaultBootStrapContextService defaultBootCtxService=new DefaultBootStrapContextService(ctx);
  serviceTarget.addService(ConnectorServices.DEFAULT_BOOTSTRAP_CONTEXT_SERVICE,defaultBootCtxService).addDependency(ConnectorServices.WORKMANAGER_SERVICE,WorkManager.class,defaultBootCtxService.getWorkManagerValueInjector()).addDependency(TxnServices.JBOSS_TXN_XA_TERMINATOR,JBossXATerminator.class,defaultBootCtxService.getXaTerminatorInjector()).addDependency(TxnServices.JBOSS_TXN_TRANSACTION_MANAGER,com.arjuna.ats.jbossatx.jta.TransactionManagerService.class,defaultBootCtxService.getTxManagerInjector()).setInitialMode(Mode.ACTIVE).install();
  final ConnectorSubsystemConfiguration config=new ConnectorSubsystemConfiguration();
  config.setArchiveValidation(archiveValidation);
  config.setArchiveValidationFailOnError(archiveValidationFailOnError);
  config.setArchiveValidationFailOnWarn(archiveValidationFailOnWarn);
  config.setBeanValidation(false);
  final ConnectorConfigService connectorConfigService=new ConnectorConfigService(config);
  serviceTarget.addService(ConnectorServices.CONNECTOR_CONFIG_SERVICE,connectorConfigService).addDependency(ConnectorServices.DEFAULT_BOOTSTRAP_CONTEXT_SERVICE,CloneableBootstrapContext.class,connectorConfigService.getDefaultBootstrapContextInjector()).setInitialMode(Mode.ACTIVE).install();
}
