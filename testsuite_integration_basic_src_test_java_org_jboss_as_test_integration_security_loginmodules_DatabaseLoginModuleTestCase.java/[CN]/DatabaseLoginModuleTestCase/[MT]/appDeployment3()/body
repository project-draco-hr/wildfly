{
  log.info("start" + DEP3 + "deployment");
  WebAppDeployment dep=new WebAppDeployment(DEP3,SecuredServletWithDBSetupForDep3.class,DatabaseServerLoginModule.class);
  DEPLOYMENTS.put(DEP3,dep);
  log.debug("adding module options");
  dep.addModuleOption("dsJndiName","java:jboss/datasources/LoginDSdep" + DEP_NUM.get(DEP3));
  dep.addModuleOption("principalsQuery","select Password from Principals where PrincipalID=?");
  dep.addModuleOption("rolesQuery","select Role, RoleGroup from Roles where PrincipalID=?");
  dep.addModuleOption("hashAlgorithm","MD5");
  dep.addModuleOption("hashEncoding","base64");
  Map<String,String> usersProps=new HashMap<String,String>();
  usersProps.put("anil",Utils.hash("anil","MD5",Coding.BASE_64));
  usersProps.put("marcus",Utils.hash("marcus","MD5",BASE_64));
  databaseManager.updateDatabase(DEP_NUM.get(DEP3),usersProps);
  log.debug(dep.getWar().toString(true));
  WebArchive war=dep.getWar();
  addH2Lib(war);
  return war;
}
