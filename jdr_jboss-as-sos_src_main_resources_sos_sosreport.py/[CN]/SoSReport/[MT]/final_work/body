def final_work(self):
    self.policy.packageResults(self.archive.name())
    self._finish_logging()
    self.archive.close()
    final_filename = compress(self.archive, self.opts.compression_type)
    if (not self.opts.upload):
        self.policy.displayResults(final_filename)
    else:
        self.policy.uploadResults(final_filename)
    self.tempfile_util.clean()
    return final_filename
