{
  final ServiceName serviceName=getServiceName(unit,endpoint.getShortName());
  final EndpointService service=new EndpointService(endpoint,serviceName);
  final ServiceBuilder<Endpoint> builder=serviceTarget.addService(serviceName,service);
  builder.addDependency(DependencyType.REQUIRED,SecurityDomainService.SERVICE_NAME.append(getDeploymentSecurityDomainName(endpoint)),SecurityDomainContext.class,service.getSecurityDomainContextInjector());
  builder.addDependency(DependencyType.REQUIRED,WSServices.REGISTRY_SERVICE,EndpointRegistry.class,service.getEndpointRegistryInjector());
  builder.addDependency(DependencyType.OPTIONAL,MBEAN_SERVER_NAME,MBeanServer.class,service.getMBeanServerInjector());
  builder.setInitialMode(Mode.ACTIVE);
  builder.install();
}
