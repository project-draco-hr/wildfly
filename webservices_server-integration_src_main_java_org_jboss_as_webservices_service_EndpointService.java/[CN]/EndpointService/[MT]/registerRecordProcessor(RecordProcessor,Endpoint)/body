{
  MBeanServer mbeanServer=mBeanServerValue.getValue();
  if (mbeanServer != null) {
    try {
      mbeanServer.registerMBean(processor,ObjectNameFactory.create(ep.getName() + ",recordProcessor=" + processor.getName()));
    }
 catch (    final JMException ex) {
      ROOT_LOGGER.trace("Cannot register endpoint in JMX server, trying with the default ManagedRecordProcessor",ex);
      try {
        mbeanServer.registerMBean(new ManagedRecordProcessor(processor),ObjectNameFactory.create(ep.getName() + ",recordProcessor=" + processor.getName()));
      }
 catch (      final JMException e) {
        ROOT_LOGGER.cannotRegisterRecordProcessor();
      }
    }
  }
 else {
    ROOT_LOGGER.mBeanServerNotAvailable(processor);
  }
}
