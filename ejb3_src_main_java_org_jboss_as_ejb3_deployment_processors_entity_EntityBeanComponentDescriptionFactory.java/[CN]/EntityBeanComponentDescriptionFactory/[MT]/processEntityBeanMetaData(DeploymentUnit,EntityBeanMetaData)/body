{
  if (entity.isCMP()) {
    throw EjbMessages.MESSAGES.cmpEntityBeansAreNotSupported();
  }
  final EjbJarDescription ejbJarDescription=getEjbJarDescription(deploymentUnit);
  final String beanName=entity.getName();
  final String beanClassName=entity.getEjbClass();
  if (!shouldProcess(entity)) {
    return;
  }
  mark(deploymentUnit);
  final EntityBeanComponentDescription description=createDescription(beanName,beanClassName,ejbJarDescription,deploymentUnit.getServiceName(),entity);
  description.setDeploymentDescriptorEnvironment(new DeploymentDescriptorEnvironment("java:comp/env/",entity));
  if (appclient) {
    deploymentUnit.addToAttachmentList(Attachments.ADDITIONAL_RESOLVABLE_COMPONENTS,description);
  }
 else {
    ejbJarDescription.getEEModuleDescription().addComponent(description);
  }
  description.setPersistenceType(entity.getPersistenceType());
  description.setReentrant(entity.isReentrant());
  description.setPrimaryKeyType(entity.getPrimKeyClass());
  final String localHome=entity.getLocalHome();
  if (localHome != null) {
    description.addLocalHome(localHome);
  }
  final String local=entity.getLocal();
  if (local != null) {
    description.addEjbLocalObjectView(local);
  }
  final String home=entity.getHome();
  if (home != null) {
    description.addRemoteHome(home);
  }
  final String remote=entity.getRemote();
  if (remote != null) {
    description.addEjbObjectView(remote);
  }
}
