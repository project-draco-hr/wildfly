{
  @SuppressWarnings("unchecked") Map<Object,Object> map=mock(Map.class);
  OutgoingSessionGranularitySessionData data=mock(OutgoingSessionGranularitySessionData.class);
  Map<String,Object> attributes=Collections.emptyMap();
  Object marshalledAttributes=new Object();
  when(data.getSessionAttributes()).thenReturn(attributes);
  when(this.marshaller.marshal(attributes)).thenReturn(marshalledAttributes);
  this.storage.store(map,data);
  verify(map).put(eq((byte)SessionMapEntry.ATTRIBUTES.ordinal()),same(marshalledAttributes));
}
