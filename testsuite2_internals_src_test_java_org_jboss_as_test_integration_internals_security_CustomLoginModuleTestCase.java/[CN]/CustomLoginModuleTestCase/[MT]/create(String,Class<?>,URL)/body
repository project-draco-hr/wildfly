{
  WebArchive war=ShrinkWrap.create(WebArchive.class,name);
  war.addClass(servletClass);
  ClassLoader tccl=Thread.currentThread().getContextClassLoader();
  war.addAsWebResource(tccl.getResource("web-secure.war/login.jsp"),"login.jsp");
  war.addAsWebResource(tccl.getResource("web-secure.war/error.jsp"),"error.jsp");
  war.addAsWebInfResource(tccl.getResource("custom-login-module.war/jboss-web.xml"),"jboss-web.xml");
  war.addClass(CustomTestLoginModule.class);
  if (webxml != null) {
    war.setWebXML(webxml);
  }
  return war;
}
