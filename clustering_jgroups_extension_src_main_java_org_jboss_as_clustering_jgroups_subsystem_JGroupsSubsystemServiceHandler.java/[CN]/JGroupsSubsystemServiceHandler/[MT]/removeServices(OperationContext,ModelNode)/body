{
  context.removeService(new ProtocolDefaultsBuilder().getServiceName());
  @SuppressWarnings("deprecation") String defaultStack=ModelNodes.asString(DEFAULT_STACK.getDefinition().resolveModelAttribute(context,model),ProtocolStackServiceNameFactory.DEFAULT_STACK);
  if ((defaultStack != null) && !defaultStack.equals(ProtocolStackServiceNameFactory.DEFAULT_STACK)) {
    context.removeService(ProtocolStackServiceName.CHANNEL_FACTORY.getServiceName());
  }
  String defaultChannel=ModelNodes.asString(DEFAULT_CHANNEL.getDefinition().resolveModelAttribute(context,model),ChannelServiceNameFactory.DEFAULT_CHANNEL);
  if ((defaultChannel != null) && !defaultChannel.equals(ChannelServiceNameFactory.DEFAULT_CHANNEL)) {
    for (    GroupBuilderProvider provider : ServiceLoader.load(DistributedGroupBuilderProvider.class,DistributedGroupBuilderProvider.class.getClassLoader())) {
      for (      Builder<?> builder : provider.getBuilders(ChannelServiceNameFactory.DEFAULT_CHANNEL,null)) {
        context.removeService(builder.getServiceName());
      }
    }
    context.removeService(JGroupsBindingFactory.createChannelFactoryBinding(ChannelServiceNameFactory.DEFAULT_CHANNEL).getBinderServiceName());
    context.removeService(ProtocolStackServiceName.CHANNEL_FACTORY.getServiceName(ChannelServiceNameFactory.DEFAULT_CHANNEL));
    context.removeService(JGroupsBindingFactory.createChannelBinding(ChannelServiceNameFactory.DEFAULT_CHANNEL).getBinderServiceName());
    for (    ChannelServiceNameFactory factory : ChannelServiceName.values()) {
      context.removeService(factory.getServiceName());
    }
  }
}
