{
  log.info("Enter testSnapshot");
  ++testCount;
  JBossWebMetaData webMetaData=createWebMetaData(null,null,null,null,null);
  cacheContainer=SessionTestUtil.createCacheContainer(true,null,false,false);
  cacheContainer.start();
  manager=SessionTestUtil.createManager(webMetaData,"test" + testCount,5,cacheContainer,null);
  manager.start();
  assertEquals("With no config, using instant",SnapshotMode.INSTANT,manager.getSnapshotMode());
  manager.stop();
  webMetaData=createWebMetaData(null,null,null,null,Boolean.TRUE);
  webMetaData.getReplicationConfig().setSnapshotMode(SnapshotMode.INTERVAL);
  webMetaData.getReplicationConfig().setSnapshotInterval(new Integer(2));
  manager=SessionTestUtil.createManager(webMetaData,"test" + ++testCount,5,cacheContainer,null);
  manager.start();
  assertEquals("With config, using interval",SnapshotMode.INTERVAL,manager.getSnapshotMode());
  assertEquals("With config, using 2 second interval",2,manager.getSnapshotInterval());
}
