{
  final CommandContext cmdCtx=CommandContextFactory.getInstance().newCommandContext(defaultProtocol,defaultHost,defaultPort,username,password,initConsole,connectionTimeout);
  if (connect) {
    try {
      cmdCtx.connectController();
    }
 catch (    CommandLineException e) {
      throw new CliInitializationException("Failed to connect to the controller",e);
    }
  }
  return cmdCtx;
}
