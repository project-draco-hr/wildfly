{
  int i=0;
  try {
    while (cmdCtx.getExitCode() == 0 && i < commands.length && !cmdCtx.isTerminated()) {
      cmdCtx.handle(commands[i]);
      ++i;
    }
  }
 catch (  Throwable t) {
    cmdCtx.error("Failed to process command '" + commands[i] + "': "+ t.getLocalizedMessage());
    t.printStackTrace();
  }
 finally {
    if (!cmdCtx.isTerminated()) {
      cmdCtx.terminateSession();
    }
    cmdCtx.disconnectController();
  }
}
