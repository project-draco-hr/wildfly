{
  int i=0;
  try {
    while (cmdCtx.getExitCode() == 0 && i < commands.length && !cmdCtx.isTerminated()) {
      cmdCtx.handleSafe(commands[i]);
      ++i;
    }
  }
  finally {
    if (!cmdCtx.isTerminated()) {
      cmdCtx.terminateSession();
    }
    cmdCtx.disconnectController();
  }
}
