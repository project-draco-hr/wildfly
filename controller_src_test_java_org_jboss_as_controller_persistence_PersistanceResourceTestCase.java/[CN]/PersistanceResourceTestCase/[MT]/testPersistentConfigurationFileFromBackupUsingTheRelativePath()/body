{
  bootFile.getParentFile().mkdirs();
  createFile(historyDir,bootFile.getName(),"boot");
  ConfigurationFile configurationFile=new ConfigurationFile(standardDir,"standard.xml","standard_xml_history/standard.boot.xml",true);
  File bootingFile=configurationFile.getBootFile();
  Assert.assertEquals(bootFile.getCanonicalPath(),bootingFile.getCanonicalPath());
  TestConfigurationFilePersister persister=new TestConfigurationFilePersister(configurationFile);
  configurationFile.successfulBoot();
  checkDirectoryExists(historyDir);
  checkDirectoryExists(currentHistoryDir);
  checkFiles(null,"boot","boot","boot","boot");
  store(persister,"One");
  checkFiles(null,"One","boot","boot","One","boot");
  store(persister,"Two");
  checkFiles(null,"Two","boot","boot","Two","boot","One");
  store(persister,"Three");
  checkFiles(null,"Three","boot","boot","Three","boot","One","Two");
  configurationFile=new ConfigurationFile(standardDir,"standard.xml","standard_xml_history/standard.last.xml",true);
  bootingFile=configurationFile.getBootFile();
  Assert.assertEquals(lastFile.getCanonicalPath(),bootingFile.getCanonicalPath());
  persister=new TestConfigurationFilePersister(configurationFile);
  configurationFile.successfulBoot();
  checkDirectoryExists(historyDir);
  checkDirectoryExists(currentHistoryDir);
  checkFiles(null,"Three","boot","Three","Three");
  store(persister,"Four");
  checkFiles(null,"Four","boot","Three","Four","Three");
  configurationFile=new ConfigurationFile(standardDir,"standard.xml","standard_xml_history/standard.initial.xml",true);
  bootingFile=configurationFile.getBootFile();
  Assert.assertEquals(initialFile.getCanonicalPath(),bootingFile.getCanonicalPath());
  persister=new TestConfigurationFilePersister(configurationFile);
  configurationFile.successfulBoot();
  checkDirectoryExists(historyDir);
  checkDirectoryExists(currentHistoryDir);
  checkFiles(null,"boot","boot","boot","boot");
  store(persister,"Four");
  checkFiles(null,"Four","boot","boot","Four","boot");
  store(persister,"Five");
  checkFiles(null,"Five","boot","boot","Five","boot","Four");
  store(persister,"Six");
  checkFiles(null,"Six","boot","boot","Six","boot","Four","Five");
  configurationFile=new ConfigurationFile(standardDir,"standard.xml","standard_xml_history/current/standard.v2.xml",true);
  bootingFile=configurationFile.getBootFile();
  Assert.assertEquals(new File(currentHistoryDir,"standard.v2.xml").getCanonicalPath(),bootingFile.getCanonicalPath());
  persister=new TestConfigurationFilePersister(configurationFile);
  configurationFile.successfulBoot();
  checkDirectoryExists(historyDir);
  checkDirectoryExists(currentHistoryDir);
  checkFiles(null,"Four","boot","Four","Four");
}
