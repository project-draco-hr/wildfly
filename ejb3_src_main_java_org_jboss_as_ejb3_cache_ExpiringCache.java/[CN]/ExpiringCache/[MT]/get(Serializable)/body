{
synchronized (cache) {
    Entry val=cache.get(key);
    if (val == null) {
      throw new NoSuchEJBException("Could not find EJB with id " + key);
    }
    val.lastUsed=System.currentTimeMillis();
    val.state=State.IN_USE;
    return val.getValue();
  }
}
