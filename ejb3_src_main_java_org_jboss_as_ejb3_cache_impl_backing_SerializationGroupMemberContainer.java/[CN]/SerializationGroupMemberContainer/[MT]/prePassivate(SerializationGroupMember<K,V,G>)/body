{
  log.tracef("prePassivate(%s)",entry);
  if (!entry.isPrePassivated()) {
    passivationManager.prePassivate(entry.getUnderlyingItem());
  }
  SerializationGroup<K,V,G> group=entry.getGroup();
  if (group != null) {
    if (!group.tryLock())     throw new IllegalStateException("Cannot obtain lock on " + group.getId() + " to passivate "+ entry);
    try {
      group.removeActive(entry.getId());
      if (group.getInUseCount() == 0) {
        groupCache.passivate(group.getId());
      }
 else {
        log.tracef("Group %s has %d in-use members; not passivating serialization group %s",group,group.getInUseCount(),entry);
      }
      entry.setGroup(null);
    }
  finally {
      group.unlock();
    }
  }
}
