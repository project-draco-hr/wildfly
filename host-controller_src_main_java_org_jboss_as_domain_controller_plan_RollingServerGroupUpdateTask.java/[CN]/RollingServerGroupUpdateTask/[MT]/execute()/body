{
  boolean interrupted=false;
  final ServerTaskExecutor.ServerOperationListener listener=new ServerTaskExecutor.ServerOperationListener();
  for (  final ServerUpdateTask task : tasks) {
    final ServerIdentity identity=task.getServerIdentity();
    if (interrupted || !updatePolicy.canUpdateServer(identity)) {
      DomainControllerLogger.DOMAIN_DEPLOYMENT_LOGGER.tracef("Skipping server update task for %s",identity);
      continue;
    }
    if (executor.executeTask(listener,task)) {
      try {
        final TransactionalProtocolClient.PreparedOperation<ServerTaskExecutor.ServerOperation> prepared=listener.retrievePreparedOperation();
        recordPreparedOperation(identity,prepared);
      }
 catch (      InterruptedException e) {
        DomainControllerLogger.DOMAIN_DEPLOYMENT_LOGGER.interruptedAwaitingPreparedResponse(getClass().getSimpleName(),Collections.singleton(identity));
        executor.cancelTask(identity);
        interrupted=true;
      }
    }
  }
  if (interrupted) {
    Thread.currentThread().interrupt();
  }
}
