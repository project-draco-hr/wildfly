{
  ctx.handle("deployment-overlay add --name=overlay-test --content=WEB-INF/web.xml=" + overrideXml.getAbsolutePath() + " --deployments="+ war1.getName()+ " --server-groups=main-server-group");
  ctx.handle("deploy --server-groups=main-server-group " + war1.getAbsolutePath());
  ctx.handle("deploy --server-groups=main-server-group " + war2.getAbsolutePath());
  ctx.handle("deploy --server-groups=main-server-group " + war3.getAbsolutePath());
  assertEquals("OVERRIDDEN",performHttpCall("master","main-one","deployment0"));
  assertEquals("NON OVERRIDDEN",performHttpCall("master","main-one","deployment1"));
  assertEquals("NON OVERRIDDEN",performHttpCall("master","main-one","another"));
  assertEquals("OVERRIDDEN",performHttpCall("slave","main-three","deployment0"));
  assertEquals("NON OVERRIDDEN",performHttpCall("slave","main-three","deployment1"));
  assertEquals("NON OVERRIDDEN",performHttpCall("slave","main-three","another"));
  ctx.handle("deployment-overlay link --name=overlay-test --deployments=a*.war --server-groups=main-server-group");
  assertEquals("OVERRIDDEN",performHttpCall("master","main-one","deployment0"));
  assertEquals("NON OVERRIDDEN",performHttpCall("master","main-one","deployment1"));
  assertEquals("NON OVERRIDDEN",performHttpCall("master","main-one","another"));
  assertEquals("OVERRIDDEN",performHttpCall("slave","main-three","deployment0"));
  assertEquals("NON OVERRIDDEN",performHttpCall("slave","main-three","deployment1"));
  assertEquals("NON OVERRIDDEN",performHttpCall("slave","main-three","another"));
  ctx.handle("/server-group=main-server-group/deployment=" + war1.getName() + ":redeploy");
  ctx.handle("/server-group=main-server-group/deployment=" + war2.getName() + ":redeploy");
  ctx.handle("/server-group=main-server-group/deployment=" + war3.getName() + ":redeploy");
  assertEquals("OVERRIDDEN",performHttpCall("master","main-one","deployment0"));
  assertEquals("NON OVERRIDDEN",performHttpCall("master","main-one","deployment1"));
  assertEquals("OVERRIDDEN",performHttpCall("master","main-one","another"));
  assertEquals("OVERRIDDEN",performHttpCall("slave","main-three","deployment0"));
  assertEquals("NON OVERRIDDEN",performHttpCall("slave","main-three","deployment1"));
  assertEquals("OVERRIDDEN",performHttpCall("slave","main-three","another"));
  ctx.handle("deployment-overlay link --name=overlay-test --deployments=" + war2.getName() + " --redeploy-affected --server-groups=main-server-group");
  assertEquals("OVERRIDDEN",performHttpCall("master","main-one","deployment0"));
  assertEquals("OVERRIDDEN",performHttpCall("master","main-one","deployment1"));
  assertEquals("OVERRIDDEN",performHttpCall("master","main-one","another"));
  assertEquals("OVERRIDDEN",performHttpCall("slave","main-three","deployment0"));
  assertEquals("OVERRIDDEN",performHttpCall("slave","main-three","deployment1"));
  assertEquals("OVERRIDDEN",performHttpCall("slave","main-three","another"));
  ctx.handle("deployment-overlay remove --name=overlay-test --deployments=" + war2.getName() + " --redeploy-affected --server-groups=main-server-group");
  assertEquals("OVERRIDDEN",performHttpCall("master","main-one","deployment0"));
  assertEquals("NON OVERRIDDEN",performHttpCall("master","main-one","deployment1"));
  assertEquals("OVERRIDDEN",performHttpCall("master","main-one","another"));
  assertEquals("OVERRIDDEN",performHttpCall("slave","main-three","deployment0"));
  assertEquals("NON OVERRIDDEN",performHttpCall("slave","main-three","deployment1"));
  assertEquals("OVERRIDDEN",performHttpCall("slave","main-three","another"));
  ctx.handle("deployment-overlay remove --name=overlay-test --deployments=a*.war --server-groups=main-server-group");
  assertEquals("OVERRIDDEN",performHttpCall("master","main-one","deployment0"));
  assertEquals("NON OVERRIDDEN",performHttpCall("master","main-one","deployment1"));
  assertEquals("OVERRIDDEN",performHttpCall("master","main-one","another"));
  assertEquals("OVERRIDDEN",performHttpCall("slave","main-three","deployment0"));
  assertEquals("NON OVERRIDDEN",performHttpCall("slave","main-three","deployment1"));
  assertEquals("OVERRIDDEN",performHttpCall("slave","main-three","another"));
  ctx.handle("/server-group=main-server-group/deployment=" + war1.getName() + ":redeploy");
  ctx.handle("/server-group=main-server-group/deployment=" + war2.getName() + ":redeploy");
  ctx.handle("/server-group=main-server-group/deployment=" + war3.getName() + ":redeploy");
  ctx.handle("deployment-overlay remove --name=overlay-test --content=WEB-INF/web.xml --redeploy-affected");
  assertEquals("NON OVERRIDDEN",performHttpCall("master","main-one","deployment0"));
  assertEquals("NON OVERRIDDEN",performHttpCall("master","main-one","deployment1"));
  assertEquals("NON OVERRIDDEN",performHttpCall("master","main-one","another"));
  assertEquals("NON OVERRIDDEN",performHttpCall("slave","main-three","deployment0"));
  assertEquals("NON OVERRIDDEN",performHttpCall("slave","main-three","deployment1"));
  assertEquals("NON OVERRIDDEN",performHttpCall("slave","main-three","another"));
  ctx.handle("deployment-overlay upload --name=overlay-test --content=WEB-INF/web.xml=" + overrideXml.getAbsolutePath() + " --redeploy-affected");
  assertEquals("OVERRIDDEN",performHttpCall("master","main-one","deployment0"));
  assertEquals("NON OVERRIDDEN",performHttpCall("master","main-one","deployment1"));
  assertEquals("NON OVERRIDDEN",performHttpCall("master","main-one","another"));
  assertEquals("OVERRIDDEN",performHttpCall("slave","main-three","deployment0"));
  assertEquals("NON OVERRIDDEN",performHttpCall("slave","main-three","deployment1"));
  assertEquals("NON OVERRIDDEN",performHttpCall("slave","main-three","another"));
}
