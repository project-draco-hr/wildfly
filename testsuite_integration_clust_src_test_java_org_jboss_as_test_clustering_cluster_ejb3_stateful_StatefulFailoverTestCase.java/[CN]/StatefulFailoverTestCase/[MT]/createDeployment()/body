{
  WebArchive war=ShrinkWrap.create(WebArchive.class,"stateful.war");
  war.addPackage(StatefulBean.class.getPackage());
  war.addClasses(EJBDirectory.class,AbstractEJBDirectory.class,LocalEJBDirectory.class);
  war.setWebXML(StatefulBean.class.getPackage(),"web.xml");
  war.addAsWebInfResource(new StringAsset("<beans>" + "<interceptors><class>" + StatefulCDIInterceptor.class.getName() + "</class></interceptors>"+ "<decorators><class>"+ CounterDecorator.class.getName()+ "</class></decorators>"+ "</beans>"),"beans.xml");
  war.addClasses(ViewChangeListener.class,ViewChangeListenerBean.class,ViewChangeListenerServlet.class);
  war.setManifest(new StringAsset("Manifest-Version: 1.0\nDependencies: org.jboss.msc, org.jboss.as.clustering.common, org.infinispan\n"));
  log.info(war.toString(true));
  return war;
}
