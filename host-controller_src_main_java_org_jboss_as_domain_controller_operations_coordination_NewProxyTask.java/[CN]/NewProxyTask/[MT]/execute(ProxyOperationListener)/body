{
  final OperationMessageHandler messageHandler=new DelegatingMessageHandler(context);
  final OperationAttachments operationAttachments=new DelegatingOperationAttachments(context);
  final ProxyOperation proxyOperation=new ProxyOperation(name,operation,messageHandler,operationAttachments);
  try {
    return client.execute(listener,proxyOperation);
  }
 catch (  IOException e) {
    final TransactionalProtocolClient.PreparedOperation<ProxyOperation> result=BlockingQueueOperationListener.FailedOperation.create(proxyOperation,e);
    listener.operationPrepared(result);
    return result.getFinalResult();
  }
}
