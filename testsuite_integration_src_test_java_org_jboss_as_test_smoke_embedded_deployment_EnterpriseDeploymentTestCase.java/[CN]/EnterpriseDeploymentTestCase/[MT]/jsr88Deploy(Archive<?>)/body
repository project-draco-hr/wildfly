{
  DeploymentManager manager=getDeploymentManager();
  Target[] targets=manager.getTargets();
  assertEquals(1,targets.length);
  InputStream deploymentPlan=createDeploymentPlan(archive.getName());
  InputStream inputStream=archive.as(ZipExporter.class).exportAsInputStream();
  ProgressObject progress=manager.distribute(targets,inputStream,deploymentPlan);
  StateType state=awaitCompletion(progress,TIMEOUT);
  if (state == StateType.COMPLETED) {
    progress=manager.start(progress.getResultTargetModuleIDs());
    awaitCompletion(progress,TIMEOUT);
  }
  return progress;
}
