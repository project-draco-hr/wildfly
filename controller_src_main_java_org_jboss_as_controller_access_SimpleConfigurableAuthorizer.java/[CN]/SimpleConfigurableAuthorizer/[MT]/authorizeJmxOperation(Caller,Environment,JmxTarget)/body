{
  Action fakeAction=new Action(Util.createOperation("test",PathAddress.EMPTY_ADDRESS),null);
  Set<String> roles=roleMapper.mapRoles(caller,null,fakeAction,(TargetAttribute)null);
  if (target.isNonFacadeMBeansSensitive()) {
    return authorize(roles,StandardRole.SUPERUSER,StandardRole.ADMINISTRATOR);
  }
 else {
    if (target.isReadOnly()) {
      return AuthorizationResult.PERMITTED;
    }
 else {
      return authorize(roles,StandardRole.SUPERUSER,StandardRole.ADMINISTRATOR,StandardRole.OPERATOR,StandardRole.MAINTAINER);
    }
  }
}
