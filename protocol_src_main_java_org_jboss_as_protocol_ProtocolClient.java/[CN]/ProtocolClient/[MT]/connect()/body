{
  log.tracef("Creating connection to %s",serverAddress);
  final Socket socket=socketFactory.createSocket();
  final ConnectionImpl connection=new ConnectionImpl(socket,messageHandler,readExecutor);
  final Thread thread=threadFactory.newThread(connection.getReadTask());
  if (thread == null) {
    throw new IllegalStateException("Thread creation was refused");
  }
  if (bindAddress != null)   socket.bind(bindAddress);
  if (readTimeout != 0)   socket.setSoTimeout(readTimeout);
  socket.connect(serverAddress,connectTimeout);
  thread.setName("Read thread for " + serverAddress);
  thread.start();
  log.tracef("Connected to %s",serverAddress);
  return connection;
}
