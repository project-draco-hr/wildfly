{
  final DeploymentUnit unit=dep.getAttachment(DeploymentUnit.class);
  if (!(unit instanceof WSEndpointDeploymentUnit)) {
    for (    final Endpoint endpoint : dep.getService().getEndpoints()) {
      ModelNode op=null;
      try {
        op=unit.createDeploymentSubModel(WSExtension.SUBSYSTEM_NAME,PathElement.pathElement(ENDPOINT,URLEncoder.encode(getId(endpoint),"UTF-8")));
      }
 catch (      final UnsupportedEncodingException e) {
        throw new RuntimeException(e);
      }
      op.get(ENDPOINT_NAME).set(getName(endpoint));
      op.get(ENDPOINT_CONTEXT).set(getContext(endpoint));
      op.get(ENDPOINT_CLASS).set(endpoint.getTargetBeanName());
      op.get(ENDPOINT_TYPE).set(getType(endpoint));
      op.get(ENDPOINT_WSDL).set(endpoint.getAddress() + "?wsdl");
    }
  }
}
