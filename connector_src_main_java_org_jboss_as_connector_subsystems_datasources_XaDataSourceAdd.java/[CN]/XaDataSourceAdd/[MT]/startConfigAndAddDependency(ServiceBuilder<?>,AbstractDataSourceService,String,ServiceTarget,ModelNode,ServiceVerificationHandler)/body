{
  final ModifiableXaDataSource dataSourceConfig;
  try {
    dataSourceConfig=xaFrom(operation);
  }
 catch (  ValidateException e) {
    throw new OperationFailedException(e,new ModelNode().set(MESSAGES.failedToCreate("XaDataSource",operation,e.getLocalizedMessage())));
  }
  final ServiceName dataSourceCongServiceName=XADataSourceConfigService.SERVICE_NAME_BASE.append(jndiName);
  final XADataSourceConfigService configService=new XADataSourceConfigService(dataSourceConfig);
  ServiceController<?> svcController=serviceTarget.addService(dataSourceCongServiceName,configService).addListener(handler).install();
  dataSourceServiceBuilder.addDependency(dataSourceCongServiceName,ModifiableXaDataSource.class,((XaDataSourceService)dataSourceService).getDataSourceConfigInjector());
  return svcController;
}
