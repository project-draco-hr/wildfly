{
  String prop=props.getProperty(propName,null);
  if (prop == null) {
    prop=props.getProperty(ServerEnvironment.SERVER_BASE_DIR,null);
    if (prop == null) {
      File dir=new File(jbossHomeDir,"standalone/" + relativeLocation);
      if (mustExist && (!dir.exists() || !dir.isDirectory())) {
        throw new IllegalArgumentException("No directory called 'standalone/' " + relativeLocation + " under "+ jbossHomeDir.getAbsolutePath());
      }
      return dir;
    }
 else {
      File server=new File(prop);
      validateDirectory(ServerEnvironment.SERVER_BASE_DIR,server);
      return new File(server,relativeLocation);
    }
  }
 else {
    File dir=new File(prop);
    validateDirectory(ServerEnvironment.SERVER_CONFIG_DIR,dir);
    return dir;
  }
}
