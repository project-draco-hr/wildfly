{
  if (raName == null || raName.trim().isEmpty()) {
    throw MESSAGES.undefinedVar("RaName");
  }
  if (serviceName == null) {
    throw MESSAGES.undefinedVar("ServiceName");
  }
  final Set<ServiceName> registeredServiceNames=resourceAdapterServiceNames.get(raName);
  if (registeredServiceNames == null || registeredServiceNames.isEmpty() || !registeredServiceNames.contains(serviceName)) {
    throw MESSAGES.serviceIsntRegistered(serviceName.getCanonicalName());
  }
  ROOT_LOGGER.tracef("ConnectorServices: unregisterResourceAdapter(%s, %s)",raName,serviceName);
  registeredServiceNames.remove(serviceName);
  if (!serviceName.equals(RESOURCE_ADAPTER_SERVICE_PREFIX.append(raName))) {
    final ServiceName baseServiceName=RESOURCE_ADAPTER_SERVICE_PREFIX.append(raName).append(RA_SERVICE_NAME_SEPARATOR);
    if (!baseServiceName.isParentOf(serviceName)) {
      throw MESSAGES.notResourceAdapterService(serviceName);
    }
    final String[] parts=serviceName.toArray();
    final String lastPart=parts[parts.length - 1];
    final Integer numericId;
    try {
      numericId=Integer.parseInt(lastPart);
    }
 catch (    NumberFormatException nfe) {
      throw MESSAGES.notResourceAdapterService(serviceName);
    }
    resourceAdapterIdentifiers.get(raName).remove(numericId);
  }
}
