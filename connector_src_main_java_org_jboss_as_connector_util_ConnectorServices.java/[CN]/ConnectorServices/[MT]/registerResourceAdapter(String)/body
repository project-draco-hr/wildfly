{
  if (raName == null || raName.trim().isEmpty()) {
    throw MESSAGES.undefinedVar("RaName");
  }
  Set<ServiceName> serviceNamesForRAActivation=resourceAdapterServiceNames.get(raName);
  if (serviceNamesForRAActivation == null) {
    serviceNamesForRAActivation=new HashSet<ServiceName>();
    resourceAdapterServiceNames.put(raName,serviceNamesForRAActivation);
  }
  final ServiceName serviceName;
  if (serviceNamesForRAActivation.isEmpty()) {
    serviceName=RESOURCE_ADAPTER_SERVICE_PREFIX.append(raName);
  }
 else {
    final Integer nextId=getResourceAdapterIdentifier(raName);
    serviceName=RESOURCE_ADAPTER_SERVICE_PREFIX.append(raName).append(RA_SERVICE_NAME_SEPARATOR).append(nextId.toString());
  }
  serviceNamesForRAActivation.add(serviceName);
  ROOT_LOGGER.tracef("ConnectorServices: registerResourceAdapter(%s) -> %s",raName,serviceName);
  return serviceName;
}
