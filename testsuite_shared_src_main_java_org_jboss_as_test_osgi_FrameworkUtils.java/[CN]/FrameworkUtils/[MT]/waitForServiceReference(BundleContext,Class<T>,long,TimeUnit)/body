{
  ServiceTracker tracker=new ServiceTracker(context,clazz.getName(),null);
  tracker.open();
  ServiceReference<T> sref=null;
  try {
    if (tracker.waitForService(unit.toMillis(timeout)) != null) {
      sref=context.getServiceReference(clazz);
    }
  }
 catch (  InterruptedException e) {
  }
 finally {
    tracker.close();
  }
  Assert.assertNotNull("Service registered: " + clazz.getName(),sref);
  return sref;
}
