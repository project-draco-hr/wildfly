{
  final CountDownLatch latch=new CountDownLatch(1);
  FrameworkListener listener=new FrameworkListener(){
    @Override public void frameworkEvent(    FrameworkEvent event){
      if (event.getType() == FrameworkEvent.PACKAGES_REFRESHED) {
        latch.countDown();
      }
    }
  }
;
  FrameworkWiring fwrkWiring=context.getBundle().adapt(FrameworkWiring.class);
  fwrkWiring.refreshBundles(bundles,listener);
  latch.await(10,TimeUnit.SECONDS);
}
