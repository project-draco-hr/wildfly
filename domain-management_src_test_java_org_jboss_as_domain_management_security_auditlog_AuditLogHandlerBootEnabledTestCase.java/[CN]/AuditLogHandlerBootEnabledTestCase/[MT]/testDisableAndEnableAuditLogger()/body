{
  File file=new File(logDir,"test-file.log");
  readFile(file,1);
  ModelNode op=createAuditLogWriteAttributeOperation(AuditLogLoggerResourceDefinition.ENABLED.getName(),false);
  executeForResult(op);
  List<ModelNode> records=readFile(file,2);
  List<ModelNode> ops=checkBootRecordHeader(records.get(1),1,"core",false,false,true);
  checkOpsEqual(op,ops.get(0));
  op=Util.createOperation(READ_RESOURCE_OPERATION,PathAddress.EMPTY_ADDRESS);
  executeForResult(op);
  readFile(file,2);
  op=createAuditLogWriteAttributeOperation(AuditLogLoggerResourceDefinition.ENABLED.getName(),false);
  executeForResult(op);
  readFile(file,2);
  op=createAuditLogWriteAttributeOperation(AuditLogLoggerResourceDefinition.ENABLED.getName(),true);
  executeForResult(op);
  records=readFile(file,3);
  ops=checkBootRecordHeader(records.get(2),1,"core",false,false,true);
  checkOpsEqual(op,ops.get(0));
  op=Util.createOperation(READ_RESOURCE_OPERATION,PathAddress.EMPTY_ADDRESS);
  executeForResult(op);
  records=readFile(file,4);
  ops=checkBootRecordHeader(records.get(3),1,"core",true,false,true);
  checkOpsEqual(op,ops.get(0));
}
