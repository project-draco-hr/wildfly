{
  Service<Configuration> service=new CacheConfigurationService(cacheName,builder,moduleId,cacheConfigurationDependencies);
  ServiceBuilder<?> configBuilder=AsynchronousService.addService(target,CacheConfigurationService.getServiceName(containerName,cacheName),service).addDependency(EmbeddedCacheManagerService.getServiceName(containerName),EmbeddedCacheManager.class,cacheConfigurationDependencies.getCacheContainerInjector()).addDependency(Services.JBOSS_SERVICE_MODULE_LOADER,ModuleLoader.class,cacheConfigurationDependencies.getModuleLoaderInjector()).setInitialMode(ServiceController.Mode.PASSIVE);
  for (  Dependency<?> dependency : dependencies) {
    addDependency(configBuilder,dependency);
  }
  if (defaultCache) {
    configBuilder.addAliases(CacheConfigurationService.getServiceName(containerName,null));
  }
  return configBuilder.install();
}
