{
  final Class<?> componentClass=componentConfiguration.getComponentClass();
  final DeploymentReflectionIndex deploymentReflectionIndex=deploymentUnit.getAttachment(org.jboss.as.server.deployment.Attachments.REFLECTION_INDEX);
  final ClassReflectionIndex<?> classReflectionIndex=deploymentReflectionIndex.getClassIndex(componentClass);
  final ServiceName envContextServiceName=componentConfiguration.getEnvContextServiceName();
  for (  ResourceInjectionConfiguration resourceConfiguration : componentConfiguration.getResourceInjectionConfigs()) {
    final NamingLookupValue<Object> lookupValue=new NamingLookupValue<Object>(resourceConfiguration.getLocalContextName());
    final ResourceInjection injection=ResourceInjection.Factory.create(resourceConfiguration,componentClass,classReflectionIndex,lookupValue);
    if (injection != null) {
      componentConfiguration.addResourceInjection(injection);
      componentConfiguration.addDependency(bindResource(phaseContext.getServiceTarget(),componentConfiguration,resourceConfiguration));
    }
    componentConfiguration.addDependency(new ResourceInjectionDependency<Context>(envContextServiceName,Context.class,lookupValue.getContextInjector()));
  }
}
