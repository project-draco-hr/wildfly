{
  ModelNode addDeployment1=Util.createOperation(DeploymentAddHandler.OPERATION_NAME,PathAddress.pathAddress(PathElement.pathElement(DEPLOYMENT,"Test1")));
  addDeployment1.get(CONTENT).add(getByteContent(1,2,3,4,5));
  ModelNode addDeployment2=Util.createOperation(DeploymentAddHandler.OPERATION_NAME,PathAddress.pathAddress(PathElement.pathElement(DEPLOYMENT,"Test2")));
  addDeployment2.get(CONTENT).add(getByteContent(1,2,3,4,5));
  List<ModelNode> deployments=new ArrayList<ModelNode>();
  deployments.add(addDeployment1);
  deployments.add(addDeployment2);
  KernelServices kernelServices=createKernelServicesBuilder().setBootOperations(deployments).setModelInitializer(new ModelInitializer(){
    @Override public void populateModel(    Resource rootResource){
      Resource serverGroupRes=Resource.Factory.create();
      ModelNode model=serverGroupRes.getModel();
      model.get(PROFILE).set("Test");
      model.get(SOCKET_BINDING_GROUP).set("Test");
      rootResource.registerChild(PathElement.pathElement(SERVER_GROUP,"Test"),serverGroupRes);
    }
  }
,new ModelWriteSanitizer(){
    @Override public ModelNode sanitize(    ModelNode model){
      ModelNode node=model.clone();
      node.remove(SERVER_GROUP);
      return node;
    }
  }
).build();
  Assert.assertTrue(kernelServices.isSuccessfulBoot());
  return kernelServices;
}
