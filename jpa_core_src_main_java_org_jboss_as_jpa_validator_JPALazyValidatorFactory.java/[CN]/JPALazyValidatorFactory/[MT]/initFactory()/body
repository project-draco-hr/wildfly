{
  final ClassLoader oldTCCL=SecurityActions.getContextClassLoader();
  try {
    SecurityActions.setContextClassLoader(oldTCCL);
    ConstraintMapping mapping=new ConstraintMapping();
    HibernateValidatorConfiguration config=Validation.byProvider(HibernateValidator.class).providerResolver(new JbossProviderResolver()).configure();
    config.addMapping(mapping);
    ValidatorFactory factory=config.buildValidatorFactory();
    return factory;
  }
  finally {
    SecurityActions.setContextClassLoader(oldTCCL);
  }
}
