{
  final ClassLoader oldTCCL=WildFlySecurityManager.getCurrentContextClassLoaderPrivileged();
  try {
    WildFlySecurityManager.setCurrentContextClassLoaderPrivileged(oldTCCL);
    ConstraintMapping mapping=new ConstraintMapping();
    HibernateValidatorConfiguration config=Validation.byProvider(HibernateValidator.class).providerResolver(new JbossProviderResolver()).configure();
    config.addMapping(mapping);
    ValidatorFactory factory=config.buildValidatorFactory();
    return factory;
  }
  finally {
    WildFlySecurityManager.setCurrentContextClassLoaderPrivileged(oldTCCL);
  }
}
