{
  if (completed) {
    return;
  }
  completed=true;
  try {
    final FlushableDataOutput output=responseContext.writeMessage(response);
    try {
      output.write(ModelControllerProtocol.PARAM_RESPONSE);
      result.writeExternal(output);
      output.writeByte(ManagementProtocol.RESPONSE_END);
      output.close();
    }
  finally {
      StreamUtils.safeClose(output);
    }
    resultHandler.done(result);
  }
 catch (  IOException e) {
    resultHandler.failed(e);
  }
}
