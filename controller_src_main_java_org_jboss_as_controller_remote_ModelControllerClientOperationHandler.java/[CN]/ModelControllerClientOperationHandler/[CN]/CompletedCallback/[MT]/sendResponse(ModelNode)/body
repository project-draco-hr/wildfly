{
  if (completed) {
    return;
  }
  completed=true;
  final CountDownLatch latch=new CountDownLatch(1);
  final IOExceptionHolder exceptionHolder=new IOExceptionHolder();
  responseContext.executeAsync(new ManagementRequestContext.AsyncTask<Void>(){
    @Override public void execute(    final ManagementRequestContext<Void> context) throws Exception {
      FlushableDataOutput output=null;
      try {
        MGMT_OP_LOGGER.tracef("Transmitting response for %d",context.getOperationId());
        output=responseContext.writeMessage(response);
        output.write(ModelControllerProtocol.PARAM_RESPONSE);
        result.writeExternal(output);
        output.writeByte(ManagementProtocol.RESPONSE_END);
        output.close();
      }
 catch (      IOException e) {
        exceptionHolder.exception=e;
      }
 finally {
        StreamUtils.safeClose(output);
        latch.countDown();
      }
    }
  }
,false);
  try {
    latch.await();
  }
 catch (  InterruptedException e) {
    Thread.currentThread().interrupt();
  }
  if (exceptionHolder.exception != null) {
    resultHandler.failed(exceptionHolder.exception);
  }
 else {
    resultHandler.done(result);
  }
}
