{
  OperationAttachmentsProxy attachmentsProxy=new OperationAttachmentsProxy(getContext(),batchId,attachmentsLength);
  try {
    ModelNode result;
    try {
      log.tracef("Executing client request %d(%d)",batchId,getContext().getHeader().getRequestId());
      if (asynch) {
        asynchRequests.put(batchId,Thread.currentThread());
      }
      result=controller.execute(operation,new OperationMessageHandlerProxy(getContext(),batchId),ModelController.OperationTransactionControl.COMMIT,attachmentsProxy);
    }
 catch (    Exception e) {
      final ModelNode failure=new ModelNode();
      failure.get(OUTCOME).set(FAILED);
      failure.get(FAILURE_DESCRIPTION).set(e.getClass().getName() + ":" + e.getMessage());
      result=failure;
      attachmentsProxy.shutdown(e);
    }
 finally {
      log.tracef("Executed client request %d",batchId);
    }
    output.write(ModelControllerProtocol.PARAM_RESPONSE);
    result.writeExternal(output);
  }
  finally {
    if (asynch) {
      asynchRequests.remove(batchId);
    }
  }
}
