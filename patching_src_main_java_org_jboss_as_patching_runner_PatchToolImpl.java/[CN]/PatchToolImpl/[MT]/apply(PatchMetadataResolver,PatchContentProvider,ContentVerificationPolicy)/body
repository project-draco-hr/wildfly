{
  final InstallationManager.InstallationModification modification=manager.modifyInstallation(callback);
  try {
    return runner.applyPatch(patchResolver,contentProvider,contentPolicy,modification);
  }
 catch (  Exception e) {
    modification.cancel();
    throw rethrowException(e);
  }
}
