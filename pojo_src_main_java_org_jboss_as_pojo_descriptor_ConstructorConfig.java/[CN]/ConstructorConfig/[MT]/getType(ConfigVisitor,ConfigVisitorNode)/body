{
  if (factory != null)   throw new IllegalArgumentException("Too dynamic to determine injected type from factory!");
  if (previous instanceof ValueConfig == false)   throw new IllegalArgumentException("Previous node is not a value config!");
  ValueConfig vc=(ValueConfig)previous;
  if (factoryClass != null) {
    if (factoryMethod == null)     throw new IllegalArgumentException("Null factory method!");
    BeanInfo beanInfo=getTempBeanInfo(visitor,factoryClass);
    Method m=beanInfo.findMethod(factoryMethod,Configurator.getTypes(parameters));
    return m.getParameterTypes()[vc.getIndex()];
  }
 else {
    BeanInfo beanInfo=visitor.getBeanInfo();
    if (beanInfo == null)     throw new IllegalArgumentException("No bean info!");
    Constructor ctor=beanInfo.findConstructor(Configurator.getTypes(parameters));
    return ctor.getParameterTypes()[vc.getIndex()];
  }
}
