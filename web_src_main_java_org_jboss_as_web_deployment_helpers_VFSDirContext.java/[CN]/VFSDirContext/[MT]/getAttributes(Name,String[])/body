{
  VirtualFile entry=null;
  if (name.isEmpty()) {
    entry=base;
  }
 else {
    entry=treeLookup(name);
  }
  if (entry == null)   throw new NamingException(MESSAGES.resourceNotFound(name.toString()));
  ResourceAttributes attrs=new ResourceAttributes();
  attrs.setCreationDate(new Date(entry.getLastModified()));
  attrs.setName(entry.getName());
  if (entry.isFile())   attrs.setResourceType("");
 else   attrs.setCollection(true);
  attrs.setContentLength(entry.getSize());
  attrs.setLastModified(entry.getLastModified());
  return attrs;
}
