{
  final ActiveOperationImpl<T,A> request=new ActiveOperationImpl(id,attachment,callback);
  final ActiveOperation<?,?> existing=activeRequests.putIfAbsent(id,request);
  if (existing != null) {
    throw new IllegalStateException();
  }
  return request;
}
