{
  context.setRealm(realm.getValue());
  JsfInjectionProvider.getInjectionContainer().set(injectionContainer);
  context.setThreadBindingListener(new ThreadBindingListener(namespaceSelector.getOptionalValue()));
  try {
    SetupValve.beginComponentStart(setupActions);
    try {
      try {
        context.create();
      }
 catch (      Exception e) {
        throw new StartException("failed to create context",e);
      }
      try {
        context.start();
      }
 catch (      LifecycleException e) {
        throw new StartException("failed to start context",e);
      }
      log.info("registering web context: " + context.getName());
    }
  finally {
      SetupValve.endComponentStart();
    }
  }
  finally {
    JsfInjectionProvider.getInjectionContainer().set(null);
  }
}
