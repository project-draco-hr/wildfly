{
  Set<String> extensionModuleNames=extensionRegistry.getExtensionModuleNames();
  Set<String> subsystemNamesForProfile=new HashSet<>();
  for (  ResourceEntry entry : domainResource.getChild(profileElement).getChildren(SUBSYSTEM)) {
    subsystemNamesForProfile.add(entry.getName());
  }
  Set<PathElement> extensionsForProfile=new HashSet<>();
  for (  String extensionModule : extensionModuleNames) {
    Map<String,SubsystemInformation> infos=extensionRegistry.getAvailableSubsystems(extensionModule);
    for (    String subsystemName : infos.keySet()) {
      if (subsystemNamesForProfile.contains(subsystemName)) {
        extensionsForProfile.add(PathElement.pathElement(EXTENSION,extensionModule));
      }
    }
  }
  return extensionsForProfile;
}
