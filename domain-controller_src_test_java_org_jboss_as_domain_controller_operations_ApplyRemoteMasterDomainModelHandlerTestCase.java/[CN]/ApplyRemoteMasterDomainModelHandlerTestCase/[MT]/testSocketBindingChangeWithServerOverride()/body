{
  final ModelNode operation=new ModelNode();
  ModelNode change=new ModelNode();
  change.get("domain-resource-address").set(PathAddress.pathAddress(PathElement.pathElement(SOCKET_BINDING_GROUP,"some-binding")).toModelNode());
  final ModelNode newBinding=new ModelNode();
  newBinding.set("blahh");
  change.get("domain-resource-model").set(newBinding);
  operation.get(DOMAIN_MODEL).add(change);
  change=new ModelNode();
  change.get("domain-resource-address").set(PathAddress.pathAddress(PathElement.pathElement(SERVER_GROUP,"group-one")).toModelNode());
  ModelNode serverConfig=new ModelNode();
  serverConfig.get(SOCKET_BINDING_GROUP).set("some-binding");
  change.get("domain-resource-model").set(serverConfig);
  operation.get(DOMAIN_MODEL).add(change);
  change=new ModelNode();
  change.get("domain-resource-address").set(PathAddress.pathAddress(PathElement.pathElement(SERVER_GROUP,"group-two")).toModelNode());
  serverConfig=new ModelNode();
  serverConfig.get(SOCKET_BINDING_GROUP).set("some-binding");
  change.get("domain-resource-model").set(serverConfig);
  operation.get(DOMAIN_MODEL).add(change);
  final MockOperationContext operationContext=getOperationContext();
  final Resource groupOneResource=Resource.Factory.create();
  operationContext.root.registerChild(PathElement.pathElement(SERVER_GROUP,"group-one"),groupOneResource);
  groupOneResource.getModel().get(SOCKET_BINDING_GROUP).set("some-binding");
  final Resource groupTwoResource=Resource.Factory.create();
  operationContext.root.registerChild(PathElement.pathElement(SERVER_GROUP,"group-two"),groupTwoResource);
  groupTwoResource.getModel().get(SOCKET_BINDING_GROUP).set("some-binding");
  operationContext.root.getChild(PathElement.pathElement(HOST,"localhost")).getChild(PathElement.pathElement(SERVER_CONFIG,"server-one")).getModel().get(SOCKET_BINDING_GROUP).set("other-binding");
  operationContext.expectStep(PathAddress.pathAddress(PathElement.pathElement(HOST,"localhost"),PathElement.pathElement(SERVER,"server-three")));
  handler.execute(operationContext,operation);
  operationContext.verify();
}
