{
  final KernelServices kernelServices=boot();
  final String fileHandlerName="test-file-handler";
  final File logFile=createLogFile();
  addFileHandler(kernelServices,profileName,fileHandlerName,org.jboss.logmanager.Level.INFO,logFile,true);
  final ModelNode rootLoggerAddress=createRootLoggerAddress(profileName).toModelNode();
  ModelNode op=SubsystemOperations.createReadAttributeOperation(rootLoggerAddress,CommonAttributes.HANDLERS);
  ModelNode handlerResult=executeOperation(kernelServices,op);
  List<String> handlerList=SubsystemOperations.readResultAsList(handlerResult);
  assertTrue(String.format("Handler '%s' was not found. Result: %s",fileHandlerName,handlerResult),handlerList.contains(fileHandlerName));
  final Logger logger=getLogger(profileName);
  logger.info("Test message 1");
  logger.info("Test message 2");
  logger.info("Test message 3");
  final ModelNode handlerAddress=createFileHandlerAddress(profileName,fileHandlerName).toModelNode();
  executeOperation(kernelServices,SubsystemOperations.createWriteAttributeOperation(handlerAddress,CommonAttributes.ENABLED,false));
  logger.info("Test message 4");
  logger.info("Test message 5");
  logger.info("Test message 6");
  List<String> lines=FileUtils.readLines(logFile);
  assertEquals("Handler was not disable.",3,lines.size());
  executeOperation(kernelServices,SubsystemOperations.createWriteAttributeOperation(handlerAddress,CommonAttributes.ENABLED,true));
  logger.info("Test message 7");
  logger.info("Test message 8");
  logger.info("Test message 9");
  lines=FileUtils.readLines(logFile);
  assertEquals("Handler was not disable.",6,lines.size());
}
