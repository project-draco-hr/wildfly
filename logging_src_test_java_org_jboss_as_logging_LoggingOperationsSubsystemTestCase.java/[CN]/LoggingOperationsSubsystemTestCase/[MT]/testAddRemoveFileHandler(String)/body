{
  final KernelServices kernelServices=boot();
  final String fileHandlerName="test-file-handler";
  File logFile=createLogFile();
  addFileHandler(kernelServices,loggingProfile,fileHandlerName,org.jboss.logmanager.Level.INFO,logFile,true);
  final ModelNode rootLoggerAddress=createRootLoggerAddress(loggingProfile).toModelNode();
  ModelNode op=SubsystemOperations.createReadAttributeOperation(rootLoggerAddress,CommonAttributes.HANDLERS);
  ModelNode handlerResult=executeOperation(kernelServices,op);
  List<String> handlerList=SubsystemOperations.readResultAsList(handlerResult);
  assertTrue(String.format("Handler '%s' was not found. Result: %s",fileHandlerName,handlerResult),handlerList.contains(fileHandlerName));
  doLog(loggingProfile,LEVELS,"Test123");
  op=SubsystemOperations.createOperation(RootLoggerResourceDefinition.ROOT_LOGGER_REMOVE_HANDLER_OPERATION_NAME,rootLoggerAddress);
  op.get(CommonAttributes.NAME.getName()).set(fileHandlerName);
  executeOperation(kernelServices,op);
  op=SubsystemOperations.createReadAttributeOperation(rootLoggerAddress,CommonAttributes.HANDLERS);
  handlerResult=executeOperation(kernelServices,op);
  handlerList=SubsystemOperations.readResultAsList(handlerResult);
  assertFalse(String.format("Handler '%s' was not removed. Result: %s",fileHandlerName,handlerResult),handlerList.contains(fileHandlerName));
  removeFileHandler(kernelServices,loggingProfile,fileHandlerName,false);
  assertTrue(FileUtils.readFileToString(logFile).contains("Test123"));
  long checksum=FileUtils.checksumCRC32(logFile);
  doLog(loggingProfile,LEVELS,"Test123");
  assertEquals(checksum,FileUtils.checksumCRC32(logFile));
}
