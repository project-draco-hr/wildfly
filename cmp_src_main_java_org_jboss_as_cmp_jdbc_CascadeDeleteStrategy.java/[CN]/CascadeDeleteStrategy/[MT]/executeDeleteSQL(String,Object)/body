{
  Connection con=null;
  PreparedStatement ps=null;
  int rowsAffected=0;
  try {
    if (log.isDebugEnabled())     log.debug("Executing SQL: " + sql);
    con=entity.getDataSource().getConnection();
    ps=con.prepareStatement(sql);
    entity.setPrimaryKeyParameters(ps,1,key);
    rowsAffected=ps.executeUpdate();
  }
 catch (  Exception e) {
    throw CmpMessages.MESSAGES.couldNotRemoveEntity(key,e);
  }
 finally {
    JDBCUtil.safeClose(ps);
    JDBCUtil.safeClose(con);
  }
  if (rowsAffected == 0) {
    throw CmpMessages.MESSAGES.couldNotRemoveEntityNoRows(key);
  }
  if (log.isDebugEnabled())   log.debug("Remove: Rows affected = " + rowsAffected);
}
