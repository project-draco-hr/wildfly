{
  ServiceController<?> controller=context.getController();
  ROOT_LOGGER.debugf("Starting: %s in mode %s",controller.getName(),controller.getMode());
  ROOT_LOGGER.registerModule(module);
  try {
    XResourceBuilder builder=XResourceBuilderFactory.create();
    if (metadata != null) {
      builder.loadFrom(metadata);
    }
 else {
      builder.loadFrom(module);
    }
    resource=builder.getResource();
    resource.addAttachment(Module.class,module);
    injectedEnvironment.getValue().installResources(resource);
  }
 catch (  Throwable t) {
    throw new StartException(MESSAGES.failedToRegisterModule(module),t);
  }
}
