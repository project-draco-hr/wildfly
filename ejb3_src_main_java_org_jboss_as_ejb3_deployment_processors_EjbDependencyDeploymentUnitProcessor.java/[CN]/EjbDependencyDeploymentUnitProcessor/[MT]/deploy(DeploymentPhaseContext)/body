{
  DeploymentUnit deploymentUnit=phaseContext.getDeploymentUnit();
  final ModuleLoader moduleLoader=Module.getBootModuleLoader();
  final ModuleSpecification moduleSpecification=deploymentUnit.getAttachment(Attachments.MODULE_SPECIFICATION);
  moduleSpecification.addSystemDependency(new ModuleDependency(moduleLoader,EJB_CLIENT,false,false,false));
  if (!isEjbDeployment(deploymentUnit) && !DeploymentTypeMarker.isType(DeploymentType.APPLICATION_CLIENT,deploymentUnit)) {
    return;
  }
  if (Boolean.getBoolean("org.jboss.as.ejb3.EMBEDDED"))   moduleSpecification.addSystemDependency(new ModuleDependency(moduleLoader,ModuleIdentifier.CLASSPATH,false,false,false));
  moduleSpecification.addSystemDependency(new ModuleDependency(moduleLoader,JAVAEE_MODULE_IDENTIFIER,false,false,false));
  moduleSpecification.addSystemDependency(new ModuleDependency(moduleLoader,EJB3_TIMERS,false,false,false));
  if (JacORBDeploymentMarker.isJacORBDeployment(deploymentUnit)) {
    moduleSpecification.addSystemDependency(new ModuleDependency(moduleLoader,JACORB,false,false,false));
  }
}
