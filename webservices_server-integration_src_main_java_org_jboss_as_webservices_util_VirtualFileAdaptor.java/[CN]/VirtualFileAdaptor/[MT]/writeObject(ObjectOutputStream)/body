{
  VirtualFile file=getFile();
  URL url=rootUrl;
  if (url == null) {
    VirtualFile parentFile=file.getParent();
    url=parentFile != null ? parentFile.toURL() : null;
  }
  String pathName=path;
  if (pathName == null)   pathName=file.getName();
  ObjectOutputStream.PutField fields=out.putFields();
  fields.put("rootUrl",url);
  fields.put("path",pathName);
  VirtualFile newRoot=VFS.getChild(url);
  VirtualFile newChild=newRoot.getChild(pathName);
  fields.put("requiresMount",isMounted(newRoot,newChild));
  out.writeFields();
}
