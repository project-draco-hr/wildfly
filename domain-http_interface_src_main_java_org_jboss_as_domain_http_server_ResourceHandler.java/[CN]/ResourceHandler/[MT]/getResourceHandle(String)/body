{
  ResourceHandle handle=buffer.get(resource);
  if (handle == null) {
    InputStream resourceStream=getLoader().getResourceAsStream(resource);
    if (resourceStream != null) {
      try {
        ByteArrayOutputStream bout=new ByteArrayOutputStream();
        fastChannelCopy(resourceStream,bout);
        bout.flush();
        bout.close();
        resourceStream.close();
        handle=new ResourceHandle(bout.toByteArray());
      }
 catch (      IOException e) {
        throw MESSAGES.failedReadingResource(e,resource);
      }
      buffer.put(resource,handle);
    }
 else {
      handle=new ResourceHandle(null);
    }
  }
  return handle;
}
