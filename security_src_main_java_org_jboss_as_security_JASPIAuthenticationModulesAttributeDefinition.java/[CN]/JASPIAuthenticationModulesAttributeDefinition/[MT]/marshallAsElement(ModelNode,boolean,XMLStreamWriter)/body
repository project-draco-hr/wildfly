{
  if (resourceModel.hasDefined(getName()) && resourceModel.asInt() > 0) {
    final ModelNode modules=resourceModel.get(getName());
    for (    ModelNode module : modules.asList()) {
      writer.writeStartElement(getXmlName());
      writer.writeAttribute(Attribute.CODE.getLocalName(),module.get(CODE).asString());
      if (module.hasDefined(Constants.FLAG)) {
        writer.writeAttribute(Attribute.FLAG.getLocalName(),module.get(Constants.FLAG).asString().toLowerCase(Locale.ENGLISH));
      }
      if (module.hasDefined(Constants.MODULE)) {
        writer.writeAttribute(Attribute.MODULE.getLocalName(),module.get(Constants.MODULE).asString());
      }
      if (module.hasDefined(Constants.LOGIN_MODULE_STACK_REF)) {
        writer.writeAttribute(Attribute.LOGIN_MODULE_STACK_REF.getLocalName(),module.get(Constants.LOGIN_MODULE_STACK_REF).asString());
      }
      if (module.hasDefined(Constants.MODULE_OPTIONS)) {
        for (        ModelNode option : module.get(Constants.MODULE_OPTIONS).asList()) {
          writer.writeEmptyElement(Element.MODULE_OPTION.getLocalName());
          writer.writeAttribute(Attribute.NAME.getLocalName(),option.asProperty().getName());
          writer.writeAttribute(Attribute.VALUE.getLocalName(),option.asProperty().getValue().asString());
        }
      }
      writer.writeEndElement();
    }
  }
}
