{
  final Map<ServerIdentity,List<AbstractServerModelUpdate<?>>> result=new HashMap<ServerIdentity,List<AbstractServerModelUpdate<?>>>();
  for (int i=0; i < hostResults.size(); i++) {
    final HostUpdateApplierResponse domainResult=hostResults.get(i);
    final AbstractHostModelUpdate<?> domainUpdate=hostUpdates.get(i);
    final AbstractServerModelUpdate<?> serverUpdate=serverByHost.get(domainUpdate);
    for (    final ServerIdentity server : domainResult.getServers()) {
      List<AbstractServerModelUpdate<?>> serverList=result.get(server);
      if (serverList == null) {
        serverList=new ArrayList<AbstractServerModelUpdate<?>>();
        result.put(server,serverList);
      }
      serverList.add(serverUpdate);
    }
  }
  return result;
}
