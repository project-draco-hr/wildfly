{
  Map<String,Set<String>> result=new HashMap<String,Set<String>>();
  Set<PathElement> elements=registry.getChildAddresses(PathAddress.EMPTY_ADDRESS);
  for (  PathElement element : elements) {
    String childType=element.getKey();
    if (validChildType != null && !validChildType.equals(childType)) {
      continue;
    }
    Set<String> set=result.get(childType);
    if (set == null) {
      set=new HashSet<String>();
      result.put(childType,set);
      if (resource.hasChildren(childType)) {
        set.addAll(resource.getChildrenNames(childType));
      }
    }
    if (!element.isWildcard()) {
      ImmutableModelNodeRegistration childReg=registry.getSubModel(PathAddress.pathAddress(element));
      if (childReg != null && childReg.isRuntimeOnly()) {
        set.add(element.getValue());
      }
    }
  }
  return result;
}
