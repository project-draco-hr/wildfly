{
  final Resource resource=context.readResource(base);
  final PathAddress current=address.subAddress(base.size());
  final Iterator<PathElement> iterator=current.iterator();
  if (iterator.hasNext()) {
    final PathElement element=iterator.next();
    if (element.isMultiTarget()) {
      final String childType=element.getKey().equals("*") ? null : element.getKey();
      final ImmutableModelNodeRegistration registration=context.getModelNodeRegistration().getSubModel(base);
      if (registration.isRemote() || registration.isRuntimeOnly()) {
        throw new IllegalStateException();
      }
      final Map<String,Set<String>> resolved=getChildAddresses(registration,resource,childType);
      for (      Map.Entry<String,Set<String>> entry : resolved.entrySet()) {
        final String key=entry.getKey();
        final Set<String> children=entry.getValue();
        if (children.isEmpty()) {
          continue;
        }
        if (element.isWildcard()) {
          for (          final String child : children) {
            if (resource.hasChild(PathElement.pathElement(key,child))) {
              execute(address,base.append(PathElement.pathElement(key,child)),context);
            }
          }
        }
 else {
          for (          final String segment : element.getSegments()) {
            if (children.contains(segment)) {
              if (resource.hasChild(PathElement.pathElement(key,segment))) {
                execute(address,base.append(PathElement.pathElement(key,segment)),context);
              }
            }
          }
        }
      }
    }
 else {
      if (resource.hasChild(element)) {
        execute(address,base.append(element),context);
      }
    }
  }
 else {
    final String operationName=operation.require(OP).asString();
    final ModelNode newOp=operation.clone();
    newOp.get(OP_ADDR).set(base.toModelNode());
    final ModelNode result=this.result.add();
    result.get(OP_ADDR).set(base.toModelNode());
    context.addStep(result,newOp,handler,NewOperationContext.Stage.IMMEDIATE);
  }
}
