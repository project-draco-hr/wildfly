def checksum(file_, chunk_size=128, algorithm=None):
    'Returns the checksum of the supplied filename. The file is read in\n    chunk_size blocks'
    if (not algorithm):
        algorithm = get_hash_name()
    digest = hashlib.new(algorithm)
    with fileobj(file_, 'rb') as fd:
        data = fd.read(chunk_size)
        while data:
            digest.update(data)
            data = fd.read(chunk_size)
        return digest.hexdigest()
