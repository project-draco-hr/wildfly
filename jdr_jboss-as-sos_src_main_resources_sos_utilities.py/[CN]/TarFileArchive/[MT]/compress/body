def compress(self, method):
    super(TarFileArchive, self).compress(method)
    methods = ['xz', 'bzip2', 'gzip']
    if (method in methods):
        methods = [method]
    last_error = Exception('compression failed for an unknown reason')
    log = logging.getLogger('sos')
    for cmd in methods:
        try:
            command = shlex.split(('%s %s' % (cmd, self.name())))
            p = Popen(command, stdout=PIPE, stderr=PIPE, bufsize=(-1))
            (stdout, stderr) = p.communicate()
            if stdout:
                log.info(stdout)
            if stderr:
                log.error(stderr)
            self._suffix += ('.' + cmd.replace('ip', ''))
            return self.name()
        except Exception as e:
            last_error = e
    else:
        raise last_error
