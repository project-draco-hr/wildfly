def add_file(self, src, dest=None):
    if dest:
        dest = self.prepend(dest)
    else:
        dest = self.prepend(src)
    if os.path.isdir(src):
        self.tarfile.add(src, dest)
    else:
        fp = open(src, 'rb')
        content = fp.read()
        fp.close()
        tar_info = tarfile.TarInfo(name=dest)
        tar_info.size = len(content)
        tar_info.mtime = os.stat(src).st_mtime
        self.tarfile.addfile(tar_info, StringIO(content))
