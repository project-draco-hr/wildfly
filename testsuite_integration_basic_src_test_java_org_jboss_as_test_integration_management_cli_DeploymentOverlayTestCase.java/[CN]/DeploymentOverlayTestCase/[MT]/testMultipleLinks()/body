{
  ctx.handle("deployment-overlay add --name=overlay-test --content=WEB-INF/web.xml=" + overrideXml.getPath() + " --deployments="+ war1.getName());
  ctx.handle("deploy " + war1.getAbsolutePath());
  ctx.handle("deploy " + war2.getAbsolutePath());
  ctx.handle("deploy " + war3.getAbsolutePath());
  String response=readResponse("deployment0");
  assertEquals("OVERRIDDEN",response);
  response=readResponse("deployment1");
  assertEquals("NON OVERRIDDEN",response);
  response=readResponse("another");
  assertEquals("NON OVERRIDDEN",response);
  ctx.handle("deployment-overlay link --name=overlay-test --wildcards=a.*\\.war");
  response=readResponse("deployment0");
  assertEquals("OVERRIDDEN",response);
  response=readResponse("deployment1");
  assertEquals("NON OVERRIDDEN",response);
  response=readResponse("another");
  assertEquals("NON OVERRIDDEN",response);
  ctx.handle("/deployment=" + war1.getName() + ":redeploy");
  ctx.handle("/deployment=" + war2.getName() + ":redeploy");
  ctx.handle("/deployment=" + war3.getName() + ":redeploy");
  response=readResponse("deployment0");
  assertEquals("OVERRIDDEN",response);
  response=readResponse("deployment1");
  assertEquals("NON OVERRIDDEN",response);
  response=readResponse("another");
  assertEquals("OVERRIDDEN",response);
  ctx.handle("deployment-overlay link --name=overlay-test --deployments=" + war2.getName() + " --redeploy-affected");
  response=readResponse("deployment0");
  assertEquals("OVERRIDDEN",response);
  response=readResponse("deployment1");
  assertEquals("OVERRIDDEN",response);
  response=readResponse("another");
  assertEquals("OVERRIDDEN",response);
  ctx.handle("deployment-overlay remove --name=overlay-test --deployments=" + war2.getName() + " --redeploy-affected");
  response=readResponse("deployment0");
  assertEquals("OVERRIDDEN",response);
  response=readResponse("deployment1");
  assertEquals("NON OVERRIDDEN",response);
  response=readResponse("another");
  assertEquals("OVERRIDDEN",response);
  ctx.handle("deployment-overlay remove --name=overlay-test --wildcards=a.*\\.war");
  response=readResponse("deployment0");
  assertEquals("OVERRIDDEN",response);
  response=readResponse("deployment1");
  assertEquals("NON OVERRIDDEN",response);
  response=readResponse("another");
  assertEquals("OVERRIDDEN",response);
  ctx.handle("/deployment=" + war1.getName() + ":redeploy");
  ctx.handle("/deployment=" + war2.getName() + ":redeploy");
  ctx.handle("/deployment=" + war3.getName() + ":redeploy");
  response=readResponse("deployment0");
  assertEquals("OVERRIDDEN",response);
  response=readResponse("deployment1");
  assertEquals("NON OVERRIDDEN",response);
  response=readResponse("another");
  assertEquals("NON OVERRIDDEN",response);
  ctx.handle("deployment-overlay remove --name=overlay-test --content=WEB-INF/web.xml --redeploy-affected");
  response=readResponse("deployment0");
  assertEquals("NON OVERRIDDEN",response);
  response=readResponse("deployment1");
  assertEquals("NON OVERRIDDEN",response);
  response=readResponse("another");
  assertEquals("NON OVERRIDDEN",response);
  ctx.handle("deployment-overlay upload --name=overlay-test --content=WEB-INF/web.xml=" + overrideXml.getPath() + " --redeploy-affected");
  response=readResponse("deployment0");
  assertEquals("OVERRIDDEN",response);
  response=readResponse("deployment1");
  assertEquals("NON OVERRIDDEN",response);
  response=readResponse("another");
  assertEquals("NON OVERRIDDEN",response);
}
