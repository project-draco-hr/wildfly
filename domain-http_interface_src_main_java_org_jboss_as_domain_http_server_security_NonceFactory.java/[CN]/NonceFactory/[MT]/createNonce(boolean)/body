{
  byte[] newNonce=new byte[NONCE_BYTES];
  Random random=new Random(srand.nextLong());
  random.nextBytes(newNonce);
  String nonceString=HexConverter.convertToHexString(newNonce);
  if (store) {
synchronized (issuedNonces) {
      issuedNonces.add(nonceString);
      while (issuedNonces.size() > MAX_CACHED_NONCES) {
        issuedNonces.remove(0);
      }
    }
  }
  return nonceString;
}
