{
  final EchoRemote proxy=EJBClient.getProxy(APP_NAME,MODULE_NAME,null,InterceptedEchoBean.class.getSimpleName(),EchoRemote.class);
  Assert.assertNotNull("Received a null proxy",proxy);
  final String message="Hello world from a really remote client";
  EJBClientContext ejbClientContext=EJBClientContext.create();
  try {
    ejbClientContext.registerConnection(connection);
    final String echo=proxy.echo(message);
    final String expectedEcho=message + InterceptorTwo.MESSAGE_SEPARATOR + InterceptorOne.class.getSimpleName()+ InterceptorOne.MESSAGE_SEPARATOR+ InterceptorTwo.class.getSimpleName();
    Assert.assertEquals("Unexpected echo message",expectedEcho,echo);
  }
  finally {
    EJBClientContext.suspendCurrent();
  }
}
