{
  ControllerTransaction transaction=null;
  try {
    if (executionContext.getOperation().get(OP_ADDR).hasDefined(OP_ADDR)) {
      final PathAddress address=PathAddress.pathAddress(executionContext.getOperation().get(OP_ADDR));
      final ProxyController proxyExecutor=getRegistry().getProxyController(address);
      if (proxyExecutor != null) {
        Operation newContext=executionContext.clone();
        newContext.getOperation().get(OP_ADDR).set(address.subAddress(proxyExecutor.getProxyNodeAddress().size()).toModelNode());
        return proxyExecutor.execute(newContext,handler);
      }
    }
    transaction=new ControllerTransaction();
    return execute(executionContext,handler,transaction);
  }
 catch (  final Throwable t) {
    log.errorf(t,"operation (%s) failed - address: (%s)",executionContext.getOperation().get(OP),executionContext.getOperation().get(OP_ADDR));
    if (transaction != null) {
      transaction.setRollbackOnly();
    }
    handler.handleFailed(getFailureResult(t));
    return new BasicOperationResult();
  }
 finally {
    if (transaction != null) {
      transaction.commit();
    }
  }
}
