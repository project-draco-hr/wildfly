{
  final KernelServices kernelServices=boot();
  final ModelNode currentModel=getSubsystemModel(kernelServices);
  compare(currentModel,ConfigurationPersistence.getConfigurationPersistence(LogContext.getLogContext()));
  final String dir=resolveRelativePath(kernelServices,"jboss.server.config.dir");
  Assert.assertNotNull("jboss.server.config.dir could not be resolved",dir);
  final LogContext logContext=LogContext.create();
  final ConfigurationPersistence config=ConfigurationPersistence.getOrCreateConfigurationPersistence(logContext);
  final FileInputStream in=new FileInputStream(new File(dir,"logging.properties"));
  config.configure(in);
  compare(currentModel,config);
}
