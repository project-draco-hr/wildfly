{
  WebArchive war=ShrinkWrap.create(WebArchive.class);
  JavaArchive libJar=ShrinkWrap.create(JavaArchive.class);
  libJar.addClasses(WebInfLibClass.class,EarLibClassPathTransitiveClosureTestCase.class);
  war.addLibraries(libJar);
  EnterpriseArchive ear=ShrinkWrap.create(EnterpriseArchive.class);
  ear.addModule(war);
  JavaArchive earLib=ShrinkWrap.create(JavaArchive.class,"earLib.jar");
  earLib.addManifestResource(new ByteArrayAsset("Class-Path: ../cp1.jar\n".getBytes()),"MANIFEST.MF");
  ear.addLibraries(earLib);
  earLib=ShrinkWrap.create(JavaArchive.class,"cp1.jar");
  earLib.addManifestResource(new ByteArrayAsset("Class-Path: cp2.jar\n".getBytes()),"MANIFEST.MF");
  ear.addModule(earLib);
  earLib=ShrinkWrap.create(JavaArchive.class,"cp2.jar");
  earLib.addClass(EarLibClass.class);
  ear.addModule(earLib);
  return ear;
}
