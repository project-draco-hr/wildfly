{
  if (includeMechanisms != null) {
    streamWriter.writeEmptyElement("include-mechanisms");
    streamWriter.writeAttribute("value",includeMechanisms);
  }
  if (qop != null) {
    streamWriter.writeEmptyElement("qop");
    streamWriter.writeAttribute("value",qop.toString().toLowerCase(Locale.ENGLISH));
  }
  if (strength != null) {
    streamWriter.writeEmptyElement("strength");
    streamWriter.writeAttribute("value",strength.toString().toLowerCase(Locale.ENGLISH));
  }
  if (reuseSession != null) {
    streamWriter.writeEmptyElement("reuse-session");
    streamWriter.writeAttribute("value",reuseSession.toString());
  }
  if (serverAuth != null) {
    streamWriter.writeEmptyElement("server-auth");
    streamWriter.writeAttribute("value",serverAuth.toString());
  }
  if (policy != null) {
    streamWriter.writeStartElement("policy");
    policy.writeContent(streamWriter);
  }
  if (properties != null && !properties.isEmpty()) {
    streamWriter.writeStartElement(Element.PROPERTIES.getLocalName());
    for (    String key : properties.keySet()) {
      streamWriter.writeEmptyElement(Element.PROPERTY.getLocalName());
      streamWriter.writeAttribute(Attribute.NAME.getLocalName(),key);
      streamWriter.writeAttribute(Attribute.VALUE.getLocalName(),properties.get(key));
    }
    streamWriter.writeEndElement();
  }
  streamWriter.writeEndElement();
}
