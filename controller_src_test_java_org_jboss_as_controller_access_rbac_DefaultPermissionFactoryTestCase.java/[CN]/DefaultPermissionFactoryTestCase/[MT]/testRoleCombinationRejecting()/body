{
  Action action=new Action(null,null,EnumSet.of(Action.ActionEffect.ADDRESS,Action.ActionEffect.READ_CONFIG));
  TargetResource targetResource=TargetResource.forStandalone(PathAddress.EMPTY_ADDRESS,ROOT_RR,null);
  DefaultPermissionFactory permissionFactory=null;
  try {
    permissionFactory=new DefaultPermissionFactory(CombinationPolicy.REJECTING,new TestRoleMapper(),Collections.<ConstraintFactory>emptySet());
    permissionFactory.getUserPermissions(caller,environment,action,targetResource);
  }
 catch (  Exception e) {
    fail();
  }
  try {
    permissionFactory=new DefaultPermissionFactory(CombinationPolicy.REJECTING,new TestRoleMapper(StandardRole.MONITOR),Collections.<ConstraintFactory>emptySet());
    permissionFactory.getUserPermissions(caller,environment,action,targetResource);
  }
 catch (  Exception e) {
    fail();
  }
  permissionFactory=new DefaultPermissionFactory(CombinationPolicy.REJECTING,new TestRoleMapper(StandardRole.MONITOR,StandardRole.DEPLOYER));
  try {
    permissionFactory.getUserPermissions(caller,environment,action,targetResource);
    fail();
  }
 catch (  Exception e) {
  }
  permissionFactory=new DefaultPermissionFactory(CombinationPolicy.REJECTING,new TestRoleMapper(StandardRole.MONITOR,StandardRole.DEPLOYER,StandardRole.AUDITOR),Collections.<ConstraintFactory>emptySet());
  try {
    permissionFactory.getUserPermissions(caller,environment,action,targetResource);
    fail();
  }
 catch (  Exception e) {
  }
}
