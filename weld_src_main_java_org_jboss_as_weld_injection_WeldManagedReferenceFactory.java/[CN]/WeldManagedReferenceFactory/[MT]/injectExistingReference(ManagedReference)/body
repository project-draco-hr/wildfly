{
  final BeanManagerImpl beanManager=this.beanManager.getValue();
  final CreationalContext<?> ctx;
  if (bean == null) {
    ctx=beanManager.createCreationalContext(null);
  }
 else {
    ctx=beanManager.createCreationalContext(bean);
  }
  final Object instance=existing.getInstance();
  injectionTarget.inject(instance,ctx);
  return new ManagedReference(){
    @Override public void release(){
      try {
        existing.release();
      }
  finally {
        ctx.release();
      }
    }
    @Override public Object getInstance(){
      return instance;
    }
  }
;
}
