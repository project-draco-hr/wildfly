{
  final BeanManagerImpl beanManager=this.beanManager.getValue();
  if (injectionTarget == null) {
synchronized (this) {
      if (injectionTarget == null) {
        if (ejbName != null) {
          EjbDescriptor<Object> descriptor=beanManager.getEjbDescriptor(ejbName);
          bean=beanManager.getBean(descriptor);
        }
        injectionTarget=createInjectionTarget(componentClass,bean);
      }
    }
  }
  final CreationalContext<?> ctx;
  if (bean == null) {
    ctx=beanManager.createCreationalContext(null);
  }
 else {
    ctx=beanManager.createCreationalContext(bean);
  }
  final Object instance=injectionTarget.produce(ctx);
  return new WeldManagedReference(ctx,instance,injectionTarget);
}
