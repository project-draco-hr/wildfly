{
  final BeanManagerImpl beanManager=this.beanManager.getValue();
  if (injectionTarget == null) {
synchronized (this) {
      if (injectionTarget == null) {
        for (        final Class<?> interceptor : interceptorClasses) {
          interceptorInjections.put(interceptor,WeldEEInjection.createWeldEEInjection(interceptor,null,beanManager));
        }
        if (ejbName != null) {
          EjbDescriptor<Object> descriptor=beanManager.getEjbDescriptor(ejbName);
          bean=beanManager.getBean(descriptor);
        }
        injectionTarget=WeldEEInjection.createWeldEEInjection(componentClass,bean,beanManager);
      }
    }
  }
  final CreationalContext<?> ctx;
  if (bean == null) {
    ctx=beanManager.createCreationalContext(null);
  }
 else {
    ctx=beanManager.createCreationalContext(bean);
  }
  final Object instance=injectionTarget.produce(ctx);
  return new WeldManagedReference(ctx,instance,injectionTarget,interceptorInjections);
}
