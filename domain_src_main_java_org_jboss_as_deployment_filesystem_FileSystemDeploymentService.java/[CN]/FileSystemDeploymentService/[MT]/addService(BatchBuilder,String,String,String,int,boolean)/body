{
  final FileSystemDeploymentService service=new FileSystemDeploymentService(scanInterval,scanEnabled);
  final ServiceName name=getServiceName(path);
  final ServiceName pathService=name.append("path");
  if (relativeTo != null) {
    RelativePathService.addService(pathService,path,relativeTo,batchBuilder);
  }
 else {
    AbsolutePathService.addService(pathService,path,batchBuilder);
  }
  BatchServiceBuilder<FileSystemDeploymentService> serviceBuilder=batchBuilder.addService(name,service).addDependency(ServerDeploymentManager.SERVICE_NAME_LOCAL,ServerDeploymentManager.class,service.injectedDeploymentManager).addDependency(ServerDeploymentRepository.SERVICE_NAME,ServerDeploymentRepository.class,service.injectedDeploymentRepository).addDependency(ServerModel.SERVICE_NAME,ServerModel.class,service.injectedServerModel).addDependency(pathService,String.class,service.pathValue).setInitialMode(Mode.ACTIVE);
  final ScheduledExecutorService hack=Executors.newSingleThreadScheduledExecutor();
  service.injectedScheduleExecutor.inject(hack);
  return serviceBuilder;
}
