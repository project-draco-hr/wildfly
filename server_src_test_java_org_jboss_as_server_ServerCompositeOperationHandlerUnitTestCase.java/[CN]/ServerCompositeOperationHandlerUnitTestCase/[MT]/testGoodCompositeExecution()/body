{
  ModelNode step1=getOperation("good","attr1",2);
  ModelNode step2=getOperation("good","attr2",1);
  ModelNode result=controller.execute(getCompositeOperation(null,step1,step2));
  assertEquals("success",result.get("outcome").asString());
  assertEquals(2,result.get("result").asInt());
  assertEquals("success",result.get("result").get(0).get("outcome").asString());
  assertEquals("success",result.get("result").get(1).get("outcome").asString());
  assertEquals(1,result.get("result").get(0).get("result").asInt());
  assertEquals(2,result.get("result").get(1).get("result").asInt());
  assertEquals("good",result.get("result").get(0).get("compensating-operation","operation").asString());
  assertEquals("good",result.get("result").get(1).get("compensating-operation","operation").asString());
  assertEquals(new ModelNode().setEmptyList(),result.get("result").get(0).get("compensating-operation","address"));
  assertEquals(new ModelNode().setEmptyList(),result.get("result").get(1).get("compensating-operation","address"));
  assertEquals("composite",result.get("compensating-operation","operation").asString());
  assertEquals(new ModelNode().setEmptyList(),result.get("compensating-operation","address"));
  assertEquals(2,result.get("compensating-operation","steps").asInt());
  assertTrue(runtimeState.get());
  assertEquals(2,controller.execute(getOperation("good","attr1",3)).get("result").asInt());
  assertEquals(1,controller.execute(getOperation("good","attr2",3)).get("result").asInt());
}
