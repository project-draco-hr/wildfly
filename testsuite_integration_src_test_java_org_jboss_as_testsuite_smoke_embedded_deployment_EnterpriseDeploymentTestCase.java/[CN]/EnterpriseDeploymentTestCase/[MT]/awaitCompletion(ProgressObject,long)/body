{
  DeploymentStatus status=progress.getDeploymentStatus();
  if (status.isCompleted())   return;
  final CountDownLatch latch=new CountDownLatch(1);
  progress.addProgressListener(new ProgressListener(){
    public void handleProgressEvent(    ProgressEvent event){
      DeploymentStatus status=event.getDeploymentStatus();
      if (status.isCompleted()) {
        latch.countDown();
      }
    }
  }
);
  if (!status.isCompleted() && latch.await(timeout,TimeUnit.MILLISECONDS) == false)   throw new IllegalStateException("Deployment not completed: " + progress);
}
