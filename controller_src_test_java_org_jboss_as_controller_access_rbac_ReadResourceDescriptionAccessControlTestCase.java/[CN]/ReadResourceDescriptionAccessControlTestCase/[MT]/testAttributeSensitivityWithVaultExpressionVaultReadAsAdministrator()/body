{
  registerAttributeVaultSensitivityResource();
  VaultExpressionSensitivityConfig.INSTANCE.setConfiguredRequiresAccessPermission(false);
  VaultExpressionSensitivityConfig.INSTANCE.setConfiguredRequiresReadPermission(true);
  VaultExpressionSensitivityConfig.INSTANCE.setConfiguredRequiresWritePermission(false);
  try {
    ModelNode op=createReadResourceDescriptionOperation(PathAddress.EMPTY_ADDRESS,StandardRole.ADMINISTRATOR,true);
    ModelNode result=executeForResult(op);
    ResourceAccessControl accessControl=getResourceAccessControl(getChildDescription(result,ONE));
    Map<String,ModelNode> defaultAttributes=checkAttributeAccessControlNames(accessControl.defaultControl,ATTR_NONE,ATTR_VAULT);
    checkAttributePermissions(defaultAttributes,ATTR_NONE,true,true,null,null);
    checkAttributePermissions(defaultAttributes,ATTR_VAULT,true,true,null,null);
    Map<String,Boolean> defaultOps=checkOperationAccessControlNames(accessControl.defaultControl,ADD,REMOVE);
    Assert.assertEquals(true,defaultOps.get(ADD));
    Assert.assertEquals(true,defaultOps.get(REMOVE));
  }
  finally {
    VaultExpressionSensitivityConfig.INSTANCE.setConfiguredRequiresAccessPermission(null);
    VaultExpressionSensitivityConfig.INSTANCE.setConfiguredRequiresReadPermission(null);
    VaultExpressionSensitivityConfig.INSTANCE.setConfiguredRequiresWritePermission(null);
  }
}
