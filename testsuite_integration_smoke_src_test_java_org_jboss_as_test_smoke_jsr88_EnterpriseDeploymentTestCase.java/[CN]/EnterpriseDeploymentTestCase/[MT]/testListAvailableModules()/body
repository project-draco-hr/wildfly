{
  String uri=DeploymentManagerImpl.DEPLOYER_URI + "?targetType=as7&serverHost=127.0.0.1&serverPort=9999";
  DeploymentManager manager=getDeploymentManager(uri,USERNAME,PASSWORD);
  Target[] targets=manager.getTargets();
  TargetModuleID[] availableModules=manager.getAvailableModules(ModuleType.EAR,targets);
  assertNull(availableModules);
  ProgressObject progress=jsr88Deploy(manager,getEarArchive());
  TargetModuleID[] targetModules=progress.getResultTargetModuleIDs();
  try {
    availableModules=manager.getAvailableModules(ModuleType.EAR,targets);
    assertNotNull(availableModules);
    assertEquals(1,availableModules.length);
    TargetModuleID targetModuleID=availableModules[0];
    String moduleID=targetModuleID.getModuleID();
    assertTrue("Ends with deployment-app.ear",moduleID.endsWith("deployment-app.ear"));
  }
  finally {
    jsr88Undeploy(manager,targetModules);
  }
}
