{
  TransactionalModelControllerOperationHandler operationHandler=new TransactionalModelControllerOperationHandler(proxiedController,Executors.newCachedThreadPool());
  try {
    channels=new RemoteChannelPairSetup();
    channels.setupRemoting(operationHandler);
    channels.startChannels();
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
  final ManagementChannel clientChannel=channels.getClientChannel();
  final RemoteProxyController proxyController=RemoteProxyController.create(channels.getExecutorService(),proxyNodeAddress,ProxyOperationAddressTranslator.SERVER,channels.getClientChannel());
  clientChannel.setReceiver(proxyController);
  clientChannel.addCloseHandler(new CloseHandler<Channel>(){
    @Override public void handleClose(    Channel closed,    IOException exception){
      proxyController.shutdown();
    }
  }
);
  clientChannel.startReceiving();
  return proxyController;
}
