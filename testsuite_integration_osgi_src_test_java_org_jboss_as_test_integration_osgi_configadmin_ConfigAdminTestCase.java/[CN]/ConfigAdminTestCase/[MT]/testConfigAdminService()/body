{
  ConfigAdmin configAdmin=getConfigAdmin();
  boolean hasconfig=configAdmin.hasConfiguration(PID_A);
  Assert.assertFalse("Precondition: null config",hasconfig);
  Dictionary<String,String> config=new Hashtable<String,String>();
  config.put("foo","bar");
  Dictionary<String,String> oldConfig=configAdmin.putConfiguration(PID_A,config);
  try {
    Assert.assertNull("Old config null",oldConfig);
    Dictionary<String,String> regConfig=configAdmin.getConfiguration(PID_A);
    Assert.assertNotNull("Config not null",regConfig);
    Assert.assertEquals("bar",regConfig.get("foo"));
    try {
      regConfig.remove("foo");
      Assert.fail("UnsupportedOperationException expected");
    }
 catch (    UnsupportedOperationException ex) {
    }
    config.put("foo","baz");
    regConfig=configAdmin.getConfiguration(PID_A);
    Assert.assertEquals("bar",regConfig.get("foo"));
  }
  finally {
    oldConfig=configAdmin.removeConfiguration(PID_A);
    Assert.assertNotNull("Config not null",oldConfig);
  }
}
