{
  DeploymentUtils utils=new DeploymentUtils("ejb3-example.jar",SimpleStatelessSessionBean.class.getPackage());
  try {
    utils.addDeployment("ejb3-mbean.sar",Test.class.getPackage());
    utils.deploy();
    MBeanServerConnection mbeanServer=utils.getConnection();
    ObjectName name=new ObjectName("jboss:name=ejb3-test,type=service");
    Class[] parameterTypes=new Class[]{String.class};
    Object[] parameters=new Object[]{"Hello world"};
    Object[] params={"java:global/ejb3-example/SimpleStatelessSessionBean!" + SimpleStatelessSessionLocal.class.getName(),"echo",parameterTypes,parameters};
    String msg=(String)mbeanServer.invoke(name,"invoke",params,new String[]{String.class.getName(),String.class.getName(),new Class[0].getClass().getName(),new Object[0].getClass().getName()});
    System.out.println(msg);
  }
  finally {
    utils.undeploy();
    safeClose(utils);
  }
}
