{
  Extension extension=(Extension)Class.forName(extensionClassName).newInstance();
  ExtensionRegistry extensionRegistry=new ExtensionRegistry(ProcessType.DOMAIN_SERVER,new RunningModeControl(RunningMode.ADMIN_ONLY));
  ModelTestParser testParser=new TestParser(mainSubsystemName,extensionRegistry);
  if (additionalInit == null) {
    additionalInit=AdditionalInitialization.MANAGEMENT;
  }
  return AbstractKernelServicesImpl.create(mainSubsystemName,additionalInit,validateOpsFilter,extensionRegistry,bootOperations,testParser,extension,legacyModelVersion,false,persistXml);
}
