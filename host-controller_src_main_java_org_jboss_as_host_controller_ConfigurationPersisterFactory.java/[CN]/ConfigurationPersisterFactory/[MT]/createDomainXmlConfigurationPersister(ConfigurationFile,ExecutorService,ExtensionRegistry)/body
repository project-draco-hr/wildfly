{
  DomainXml domainXml=new DomainXml(Module.getBootModuleLoader(),executorService,extensionRegistry);
  BackupXmlConfigurationPersister persister=new BackupXmlConfigurationPersister(file,new QName(Namespace.CURRENT.getUriString(),"domain"),domainXml,domainXml);
  persister.registerAdditionalRootElement(new QName(Namespace.DOMAIN_1_1.getUriString(),"domain"),domainXml);
  persister.registerAdditionalRootElement(new QName(Namespace.DOMAIN_1_0.getUriString(),"domain"),domainXml);
  extensionRegistry.setWriterRegistry(persister);
  return persister;
}
