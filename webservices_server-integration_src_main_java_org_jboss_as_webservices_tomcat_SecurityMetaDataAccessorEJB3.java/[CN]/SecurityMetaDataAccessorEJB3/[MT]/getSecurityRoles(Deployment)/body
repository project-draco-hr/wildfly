{
  final WebServiceDeployment wsDeployment=WSHelper.getRequiredAttachment(dep,WebServiceDeployment.class);
  final SecurityRolesMetaData securityRolesMD=new SecurityRolesMetaData();
  final Iterator<WebServiceDeclaration> ejbContainers=wsDeployment.getServiceEndpoints().iterator();
  while (ejbContainers.hasNext()) {
    final WebServiceDeclaration ejbContainer=ejbContainers.next();
    final AnnotationInstance allowedRoles=ejbContainer.getAnnotation(ROLES_ALLOWED_DOT_NAME);
    final boolean hasAllowedRoles=allowedRoles != null;
    if (hasAllowedRoles) {
      for (      final String roleName : allowedRoles.value().asStringArray()) {
        final SecurityRoleMetaData securityRoleMD=new SecurityRoleMetaData();
        securityRoleMD.setRoleName(roleName);
        securityRolesMD.add(securityRoleMD);
      }
    }
  }
  return securityRolesMD;
}
