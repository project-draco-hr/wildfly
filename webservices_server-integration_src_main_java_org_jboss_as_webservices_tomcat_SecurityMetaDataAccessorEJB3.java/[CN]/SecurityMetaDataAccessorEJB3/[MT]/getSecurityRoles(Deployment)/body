{
  final DeploymentJaxws wsDeployment=WSHelper.getRequiredAttachment(dep,DeploymentJaxws.class);
  final SecurityRolesMetaData securityRolesMD=new SecurityRolesMetaData();
  final Iterator<EndpointJaxwsEjb> ejbContainers=wsDeployment.getEjbEndpoints().iterator();
  while (ejbContainers.hasNext()) {
    final EndpointJaxwsEjb ejbContainer=ejbContainers.next();
    final AnnotationInstance allowedRoles=ejbContainer.getAnnotation(ROLES_ALLOWED_ANNOTATION);
    final boolean hasAllowedRoles=allowedRoles != null;
    if (hasAllowedRoles) {
      for (      final String roleName : allowedRoles.value().asStringArray()) {
        final SecurityRoleMetaData securityRoleMD=new SecurityRoleMetaData();
        securityRoleMD.setRoleName(roleName);
        securityRolesMD.add(securityRoleMD);
      }
    }
  }
  return securityRolesMD;
}
