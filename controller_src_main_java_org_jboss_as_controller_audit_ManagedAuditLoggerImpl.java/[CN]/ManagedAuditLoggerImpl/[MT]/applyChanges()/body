{
  config.lock();
  try {
    if (!config.isManualCommit()) {
      throw new IllegalStateException("Attempt was made to manually apply changes when manual commit was not configured");
    }
    if (handlerUpdateTask != null) {
      handlerUpdateTask.applyChanges();
      handlerUpdateTask=null;
    }
  }
  finally {
    config.unlock();
  }
}
