{
  ServiceName localServiceName=LocalCallbackHandlerService.ServiceUtil.createServiceName(realmName);
  ModelNode node=LocalAuthenticationResourceDefinition.DEFAULT_USER.resolveModelAttribute(context,local);
  String defaultUser=node.isDefined() ? node.asString() : null;
  node=LocalAuthenticationResourceDefinition.ALLOWED_USERS.resolveModelAttribute(context,local);
  String allowedUsers=node.isDefined() ? node.asString() : null;
  node=LocalAuthenticationResourceDefinition.SKIP_GROUP_LOADING.resolveModelAttribute(context,local);
  boolean skipGroupLoading=node.asBoolean();
  LocalCallbackHandlerService localCallbackHandler=new LocalCallbackHandlerService(defaultUser,allowedUsers,skipGroupLoading);
  ServiceBuilder<?> jaasBuilder=serviceTarget.addService(localServiceName,localCallbackHandler);
  final ServiceController<?> serviceController=jaasBuilder.setInitialMode(ON_DEMAND).install();
  if (newControllers != null) {
    newControllers.add(serviceController);
  }
  CallbackHandlerService.ServiceUtil.addDependency(realmBuilder,injector,localServiceName,false);
}
