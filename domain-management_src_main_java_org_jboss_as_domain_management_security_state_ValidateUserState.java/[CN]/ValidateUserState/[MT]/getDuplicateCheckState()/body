{
  return new State(){
    @Override public State execute(){
      if (stateValues.getKnownUsers().contains(stateValues.getUserName())) {
        State duplicateContinuing=stateValues.isSilentOrNonInteractive() ? null : new PromptNewUserState(theConsole,stateValues);
        if (stateValues.isSilentOrNonInteractive()) {
          return new ErrorState(theConsole,MESSAGES.duplicateUser(stateValues.getUserName()),duplicateContinuing,stateValues);
        }
 else {
          String message=MESSAGES.aboutToUpdateUser(stateValues.getUserName());
          String prompt=MESSAGES.isCorrectPrompt() + " " + MESSAGES.yes()+ "/"+ MESSAGES.no()+ "?";
          stateValues.setExistingUser(true);
          return new ConfirmationChoice(theConsole,message,prompt,ValidateUserState.this,duplicateContinuing);
        }
      }
 else {
        stateValues.setExistingUser(false);
        return ValidateUserState.this;
      }
    }
  }
;
}
