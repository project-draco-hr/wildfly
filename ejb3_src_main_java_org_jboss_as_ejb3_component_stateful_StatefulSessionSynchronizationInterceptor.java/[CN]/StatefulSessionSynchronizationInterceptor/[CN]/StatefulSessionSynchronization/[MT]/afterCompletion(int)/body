{
  boolean committed=status == Status.STATUS_COMMITTED;
  try {
    if (ROOT_LOGGER.isTraceEnabled()) {
      ROOT_LOGGER.trace("After completion callback invoked on Transaction synchronization: " + this + " of stateful component instance: "+ statefulSessionComponentInstance);
    }
    if (!statefulSessionComponentInstance.isDiscarded()) {
      statefulSessionComponentInstance.afterCompletion(committed);
    }
  }
 catch (  Throwable t) {
    handleThrowable(t);
  }
  if (statefulSessionComponentInstance.isRemoved() && !statefulSessionComponentInstance.isDiscarded()) {
    try {
      statefulSessionComponentInstance.destroy();
    }
 catch (    Throwable t) {
      handleThrowable(t);
    }
  }
  statefulSessionComponentInstance.getLock().pushOwner(lockOwner);
  try {
    releaseInstance(statefulSessionComponentInstance);
  }
  finally {
    statefulSessionComponentInstance.getLock().popOwner();
  }
}
