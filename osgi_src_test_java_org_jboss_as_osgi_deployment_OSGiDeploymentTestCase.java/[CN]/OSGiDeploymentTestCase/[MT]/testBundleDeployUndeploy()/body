{
  JavaArchive archive=getBundleArchive();
  Bundle bundle=executeDeploy(archive);
  assertNotNull("Bundle not null",bundle);
  assertBundleState(Bundle.INSTALLED,bundle.getState());
  assertServiceUp(DeploymentService.SERVICE_NAME.append(archive.getName()));
  assertServiceUp(OSGiDeploymentService.SERVICE_NAME.append(archive.getName()));
  executeUndeploy(archive);
  assertServiceDown(DeploymentService.SERVICE_NAME.append(archive.getName()));
  assertServiceDown(OSGiDeploymentService.SERVICE_NAME.append(archive.getName()));
  assertBundleState(Bundle.UNINSTALLED,bundle.getState());
}
