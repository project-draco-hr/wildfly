{
  final JavaArchive archive=getSimpleArchive("module-two");
  DeploymentUnitProcessor processor=new DeploymentUnitProcessor(){
    @Override public void processDeployment(    DeploymentUnitContext context) throws DeploymentUnitProcessingException {
      OSGiMetaDataBuilder builder=OSGiMetaDataBuilder.createBuilder(archive.getName(),Version.parseVersion("1.0.0"));
      OSGiMetaDataAttachment.attachOSGiMetaData(context,builder.getOSGiMetaData());
    }
  }
;
  getDeploymentChain().addProcessor(processor,30);
  Bundle bundle=executeDeploy(archive);
  assertNotNull("Bundle not null",bundle);
  assertBundleState(Bundle.INSTALLED,bundle.getState());
  bundle.start();
  assertBundleState(Bundle.ACTIVE,bundle.getState());
  assertLoadClass(bundle,A.class.getName());
  bundle.uninstall();
  assertBundleState(Bundle.UNINSTALLED,bundle.getState());
  getDeploymentChain().removeProcessor(processor,30);
}
