{
  log.debug("Creating SDC for domain=" + securityDomain);
  AuthenticationManager am=createAuthenticationManager(securityDomain);
  Cache<Principal,DomainInfo> cache=null;
  if (cacheManager != null) {
    cacheManager.defineConfiguration(securityDomain,"auth-cache",new Configuration());
    cache=cacheManager.getCache(securityDomain);
  }
  if (cache != null && am instanceof CacheableManager) {
    @SuppressWarnings("unchecked") CacheableManager<Cache<Principal,DomainInfo>,Principal> cm=(CacheableManager<Cache<Principal,DomainInfo>,Principal>)am;
    cm.setCache(cache);
  }
  if (deepCopySubjectMode) {
    setDeepCopySubjectMode(am);
  }
  SecurityDomainContext securityDomainContext=new SecurityDomainContext(am);
  securityDomainContext.setAuthorizationManager(createAuthorizationManager(securityDomain));
  securityDomainContext.setAuditManager(createAuditManager(securityDomain));
  securityDomainContext.setIdentityTrustManager(createIdentityTrustManager(securityDomain));
  securityDomainContext.setMappingManager(createMappingManager(securityDomain));
  return securityDomainContext;
}
