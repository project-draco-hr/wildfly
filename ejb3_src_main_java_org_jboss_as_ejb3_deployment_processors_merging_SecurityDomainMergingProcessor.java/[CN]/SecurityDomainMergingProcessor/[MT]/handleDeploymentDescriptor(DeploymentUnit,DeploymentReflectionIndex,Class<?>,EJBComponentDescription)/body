{
  String securityDomain=null;
  String globalSecurityDomain=null;
  EjbJarMetaData ejbJarMetaData=deploymentUnit.getAttachment(EjbDeploymentAttachmentKeys.EJB_JAR_METADATA);
  if (ejbJarMetaData instanceof JBossEjb31MetaData) {
    JBossEjb31MetaData jbossMetaData=JBossEjb31MetaData.class.cast(ejbJarMetaData);
    JBossAssemblyDescriptorMetaData assemblyMetadata=jbossMetaData.getAssemblyDescriptor();
    if (assemblyMetadata != null) {
      List<EJBBoundSecurityMetaData> securityMetaDatas=assemblyMetadata.getAny(EJBBoundSecurityMetaData.class);
      if (securityMetaDatas != null) {
        for (        EJBBoundSecurityMetaData securityMetaData : securityMetaDatas) {
          if (securityMetaData.getEjbName().equals(description.getComponentName())) {
            securityDomain=securityMetaData.getSecurityDomain();
            break;
          }
          if (securityMetaData.getEjbName().equals("*")) {
            globalSecurityDomain=securityMetaData.getSecurityDomain();
            continue;
          }
        }
      }
    }
  }
  if (securityDomain != null)   description.setSecurityDomain(securityDomain);
 else   if (globalSecurityDomain != null)   description.setSecurityDomain(globalSecurityDomain);
}
