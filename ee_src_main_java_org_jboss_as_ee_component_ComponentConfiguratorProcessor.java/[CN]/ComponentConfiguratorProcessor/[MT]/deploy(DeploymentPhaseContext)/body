{
  final DeploymentUnit deploymentUnit=phaseContext.getDeploymentUnit();
  final EEModuleDescription moduleDescription=deploymentUnit.getAttachment(Attachments.EE_MODULE_DESCRIPTION);
  if (moduleDescription == null) {
    return;
  }
  final EEModuleConfiguration moduleConfiguration=deploymentUnit.getAttachment(Attachments.EE_MODULE_CONFIGURATION);
  if (moduleConfiguration == null) {
    throw new DeploymentUnitProcessingException("EE module description found, but no module configuration attached to the deployment.");
  }
  final Collection<ComponentDescription> componentDescriptions=moduleDescription.getComponentDescriptions();
  if (componentDescriptions != null)   for (  ComponentDescription componentDescription : componentDescriptions) {
    final ComponentConfiguration componentConfiguration=componentDescription.createConfiguration(moduleConfiguration);
    for (    ComponentConfigurator componentConfigurator : componentDescription.getConfigurators()) {
      componentConfigurator.configure(phaseContext,componentDescription,componentConfiguration);
    }
    moduleConfiguration.addComponentConfiguration(componentConfiguration);
  }
}
