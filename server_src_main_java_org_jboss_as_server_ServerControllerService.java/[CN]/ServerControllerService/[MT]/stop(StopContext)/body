{
  Logger.getLogger("org.jboss.as").infof("Shutdown requested; stopping all services");
  serverController=null;
  final ServiceContainer container=context.getController().getServiceContainer();
  final Set<ServiceName> bootServices=this.bootServices;
  context.asynchronous();
  final MultipleRemoveListener<Runnable> removeListener=MultipleRemoveListener.create(new Runnable(){
    public void run(){
      context.complete();
      Logger.getLogger("org.jboss.as").infof("JBoss AS %s \"%s\" stopped in %dms",Version.AS_VERSION,Version.AS_RELEASE_CODENAME,Integer.valueOf((int)(context.getElapsedTime() / 1000000L)));
    }
  }
);
  for (  ServiceName serviceName : bootServices) {
    final ServiceController<?> controller=container.getService(serviceName);
    if (controller != null) {
      controller.addListener(removeListener);
      controller.setMode(ServiceController.Mode.REMOVE);
    }
  }
  removeListener.done();
}
