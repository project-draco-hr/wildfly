{
  if (server != null) {
    final String host=String.class.cast(props.get(getHostKey(protocol)));
    final int port=Integer.class.cast(props.get(getPortKey(protocol)));
    Credentials c=server.getCredentials();
    URLName urlName=new URLName(protocol,host,port,"",c != null ? c.getUsername() : null,c != null ? c.getPassword() : null);
    if (c != null) {
      session.setPasswordAuthentication(urlName,new PasswordAuthentication(c.getUsername(),c.getPassword()));
    }
  }
}
