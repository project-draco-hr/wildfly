{
  Properties props=new Properties();
  if (config.getSmtpServer() != null) {
    props.setProperty("mail.transport.protocol","smtp");
    setServerProps(props,config.getSmtpServer(),"smtp");
  }
  if (config.getImapServer() != null) {
    setServerProps(props,config.getImapServer(),"imap");
  }
  if (config.getPop3Server() != null) {
    setServerProps(props,config.getPop3Server(),"pop3");
  }
  if (config.getCustomServers() != null) {
    configureCustomServers(props,config.getCustomServers());
  }
  if (config.getFrom() != null) {
    props.setProperty("mail.from",config.getFrom());
  }
  props.setProperty("mail.debug",String.valueOf(config.isDebug()));
  MailLogger.ROOT_LOGGER.tracef("props: %s",props);
  return props;
}
