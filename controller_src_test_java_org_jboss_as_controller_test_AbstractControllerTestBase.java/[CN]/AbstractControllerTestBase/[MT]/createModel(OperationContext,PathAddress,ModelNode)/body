{
  if (!node.isDefined()) {
    return;
  }
  final ManagementResourceRegistration registration=context.getResourceRegistrationForUpdate();
  final Set<String> children=registration.getChildNames(base);
  final ModelNode current=new ModelNode();
  final Resource resource=base.size() == 0 ? context.readResourceForUpdate(PathAddress.EMPTY_ADDRESS) : context.createResource(base);
  if (node.getType() == ModelType.OBJECT) {
    for (    final String key : node.keys()) {
      if (!children.contains(key)) {
        current.get(key).set(node.get(key));
      }
    }
    resource.getModel().set(current);
  }
 else {
    resource.getModel().set(node);
    return;
  }
  if (children != null && !children.isEmpty()) {
    for (    final String childType : children) {
      if (node.hasDefined(childType)) {
        for (        final String key : node.get(childType).keys()) {
          createModel(context,base.append(PathElement.pathElement(childType,key)),node.get(childType,key));
        }
      }
    }
  }
}
