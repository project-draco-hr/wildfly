{
  String outcome=modelNode.hasDefined("outcome") ? modelNode.get("outcome").asString() : "failed";
  UpdateResultHandlerResponse result;
  if ("success".equals(outcome)) {
    result=createSuccessResponse(modelNode.get("result"));
  }
 else   if ("cancelled".equals(outcome)) {
    return createCancellationResponse();
  }
 else {
    String message=modelNode.hasDefined("failure-description") ? modelNode.get("failure-description").asString() : "No failure details provided";
    result=createFailureResponse(new UpdateFailedException(message));
  }
  if (modelNode.get("rolled-back").asBoolean(false)) {
    result=createRollbackResponse(result);
  }
 else   if (modelNode.hasDefined("rollback-failure-description")) {
    String message=modelNode.get("rollback-failure-description").asString();
    result=createRollbackFailedResponse(result,new UpdateFailedException(message));
  }
  return result;
}
