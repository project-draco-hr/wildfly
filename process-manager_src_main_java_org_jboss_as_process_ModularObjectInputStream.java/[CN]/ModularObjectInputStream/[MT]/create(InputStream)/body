{
  final SecurityManager sm=System.getSecurityManager();
  if (sm != null) {
    try {
      return AccessController.doPrivileged(new PrivilegedExceptionAction<ModularObjectInputStream>(){
        public ModularObjectInputStream run() throws IOException {
          return new ModularObjectInputStream(in);
        }
      }
);
    }
 catch (    PrivilegedActionException e) {
      final Throwable t=e.getCause();
      if (t instanceof IOException) {
        throw (IOException)t;
      }
 else       if (t instanceof RuntimeException) {
        throw (RuntimeException)t;
      }
 else       if (t instanceof Error) {
        throw (Error)t;
      }
 else {
        throw new RuntimeException("Unexpected action exception",t);
      }
    }
  }
 else {
    return new ModularObjectInputStream(in);
  }
}
