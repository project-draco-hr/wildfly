{
  final BigDecimal maxThreadsCount=has(operation,count) ? operation.get(count).asBigDecimal() : null;
  final BigDecimal maxThreadsPerCpu=has(operation,perCpu) ? operation.get(perCpu).asBigDecimal() : null;
  if (maxThreadsCount != null && maxThreadsPerCpu == null) {
    throw new IllegalArgumentException("Need " + perCpu + " when "+ count+ " is set");
  }
  if (maxThreadsCount == null && maxThreadsPerCpu != null) {
    throw new IllegalArgumentException("Need " + count + " when "+ perCpu+ " is set");
  }
  return maxThreadsCount != null ? new ScaledCount(maxThreadsCount,maxThreadsPerCpu) : null;
}
