{
  final ServiceName userTransactionServiceName=contextServiceName.append("UserTransaction");
  final UserTransactionBindingService userTransactionBindingService=new UserTransactionBindingService("UserTransaction");
  serviceTarget.addService(userTransactionServiceName,userTransactionBindingService).addDependency(UserTransactionAccessControlService.SERVICE_NAME,UserTransactionAccessControlService.class,userTransactionBindingService.getUserTransactionAccessControlServiceInjector()).addDependency(UserTransactionService.SERVICE_NAME,UserTransaction.class,new ManagedReferenceInjector<UserTransaction>(userTransactionBindingService.getManagedObjectInjector())).addDependency(contextServiceName,ServiceBasedNamingStore.class,userTransactionBindingService.getNamingStoreInjector()).install();
  deploymentUnit.addToAttachmentList(org.jboss.as.server.deployment.Attachments.JNDI_DEPENDENCIES,userTransactionServiceName);
  final ServiceName transactionSynchronizationRegistryName=contextServiceName.append("TransactionSynchronizationRegistry");
  BinderService transactionSyncBinderService=new BinderService("TransactionSynchronizationRegistry");
  serviceTarget.addService(transactionSynchronizationRegistryName,transactionSyncBinderService).addDependency(TransactionSynchronizationRegistryService.SERVICE_NAME,TransactionSynchronizationRegistry.class,new ManagedReferenceInjector<TransactionSynchronizationRegistry>(transactionSyncBinderService.getManagedObjectInjector())).addDependency(contextServiceName,ServiceBasedNamingStore.class,transactionSyncBinderService.getNamingStoreInjector()).install();
  deploymentUnit.addToAttachmentList(org.jboss.as.server.deployment.Attachments.JNDI_DEPENDENCIES,transactionSynchronizationRegistryName);
}
