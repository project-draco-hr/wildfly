{
  final ModelNode address=createPeriodicRotatingFileHandlerAddress(profileName,"FILE").toModelNode();
  final String filename="test-file.log";
  final String newFilename="new-test-file.log";
  final ModelNode addOp=OperationBuilder.createAddOperation(address).addAttribute(CommonAttributes.FILE,createFileValue("jboss.server.log.dir",filename)).addAttribute(PeriodicHandlerResourceDefinition.SUFFIX,".yyyy-MM-dd").build();
  executeOperation(kernelServices,addOp);
  verifyFile(filename);
  testWriteCommonAttributes(kernelServices,address);
  testWrite(kernelServices,address,CommonAttributes.APPEND,false);
  testWrite(kernelServices,address,CommonAttributes.AUTOFLUSH,false);
  final ModelNode newFile=createFileValue("jboss.server.log.dir",newFilename);
  testWrite(kernelServices,address,CommonAttributes.FILE,newFile);
  verifyFile(newFilename);
  testWrite(kernelServices,address,PeriodicHandlerResourceDefinition.SUFFIX,".yyyy-MM-dd-HH");
  testUndefineCommonAttributes(kernelServices,address);
  testUndefine(kernelServices,address,CommonAttributes.APPEND);
  testUndefine(kernelServices,address,CommonAttributes.AUTOFLUSH);
  executeOperation(kernelServices,SubsystemOperations.createRemoveOperation(address));
  verifyRemoved(kernelServices,address);
  removeFile(filename);
  removeFile(newFilename);
}
