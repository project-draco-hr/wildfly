{
  final PathAddress address=getCacheContainerAddressFromOperation(operation);
  final String containerName=address.getLastElement().getValue();
  context.removeService(KeyAffinityServiceFactoryService.getServiceName(containerName));
  ModelNode resolvedValue=null;
  final String jndiName=(resolvedValue=CacheContainerResourceDefinition.JNDI_NAME.resolveModelAttribute(context,model)).isDefined() ? resolvedValue.asString() : null;
  context.removeService(createCacheContainerBinding(jndiName,containerName).getBinderServiceName());
  context.removeService(EmbeddedCacheManagerService.getServiceName(containerName));
  context.removeService(EmbeddedCacheManagerConfigurationService.getServiceName(containerName));
  context.removeService(GlobalComponentRegistryService.getServiceName(containerName));
  if (model.hasDefined(ModelKeys.TRANSPORT)) {
    removeServices(context,ClusterServiceInstaller.class,containerName);
    ChannelInstanceResourceDefinition.addChannelProtocolMetricsDeregistrationStep(context,containerName);
    context.removeService(createChannelBinding(containerName).getBinderServiceName());
    context.removeService(ChannelService.getServiceName(containerName));
  }
 else {
    removeServices(context,LocalServiceInstaller.class,containerName);
  }
}
