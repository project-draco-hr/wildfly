{
  String subsystemXml="threads-transform-1_0.xml";
  ModelVersion modelVersion=ModelVersion.create(1,0,0);
  KernelServicesBuilder builder=createKernelServicesBuilder(AdditionalInitialization.MANAGEMENT).setSubsystemXmlResource(subsystemXml);
  final PathAddress subsystemAddress=PathAddress.pathAddress(PathElement.pathElement(SUBSYSTEM,getMainSubsystemName()));
  builder.createLegacyKernelServicesBuilder(null,controllerVersion,modelVersion).addOperationValidationResolve("add",subsystemAddress.append(PathElement.pathElement("thread-factory"))).addMavenResourceURL("org.jboss.as:jboss-as-threads:" + controllerVersion.getMavenGavVersion()).excludeFromParent(SingleClassFilter.createFilter(ThreadsLogger.class));
  KernelServices mainServices=builder.build();
  KernelServices legacyServices=mainServices.getLegacyServices(modelVersion);
  Assert.assertNotNull(legacyServices);
  checkSubsystemModelTransformation(mainServices,modelVersion);
}
