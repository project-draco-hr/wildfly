{
  try {
switch (header.getOperationId()) {
case ManagementProtocol.CREATE_BATCH_ID_REQUEST:
      if (batchIdManager == null) {
        throw new IOException("No local batch id manager to service remote CREATE_BATCH_ID_REQUEST");
      }
    return new CreateBatchIdRequestHandler();
case ManagementProtocol.FREE_BATCH_ID_REQUEST:
  if (batchIdManager == null) {
    throw new IOException("No local batch id manager to service remote FREE_BATCH_ID_REQUEST");
  }
return new FreeBatchIdRequestHandler();
}
ManagementOperationHandler operationHandler=this.operationHandler;
if (operationHandler == null) {
throw new IOException("No operation handler set");
}
ManagementRequestHandler requestHandler=operationHandler.getRequestHandler(header.getOperationId());
if (requestHandler == null) {
throw new IOException("No request handler found with id " + header.getOperationId() + " in operation handler "+ operationHandler);
}
return requestHandler;
}
 catch (IOException e) {
e.printStackTrace();
throw e;
}
catch (Exception e) {
throw new IOException(e);
}
}
