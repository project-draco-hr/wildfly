{
  if (!byeByeSent.compareAndSet(false,true)) {
    return;
  }
  log.tracef("Closing %s by sending bye bye",this);
  pinger.removeChannel(this);
  ManagementByeByeHeader byeByeHeader=new ManagementByeByeHeader(ManagementProtocol.VERSION);
  try {
    SimpleDataOutput out=new SimpleDataOutput(Marshalling.createByteOutput(writeMessage()));
    try {
      byeByeHeader.write(out);
    }
 catch (    IOException ingore) {
    }
 finally {
      IoUtils.safeClose(out);
    }
  }
  finally {
    log.tracef("Invoking close on %s",this);
    super.close();
  }
}
