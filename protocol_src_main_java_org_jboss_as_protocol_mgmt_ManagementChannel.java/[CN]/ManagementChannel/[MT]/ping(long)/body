{
  if (awaitingPong.get()) {
    if (System.currentTimeMillis() - lastResponseReceived > timeOut) {
      try {
        log.tracef("Closing %s did not receive any pong within %dms",this,timeOut);
        close();
      }
 catch (      IOException ignore) {
      }
    }
  }
 else {
    log.tracef("No data received recently on %s, pinging to determine if the other end is alive",this);
    awaitingPong.set(true);
    ManagementPingHeader pingHeader=new ManagementPingHeader(ManagementProtocol.VERSION);
    sendHeaderAndCloseOnError(pingHeader);
  }
}
