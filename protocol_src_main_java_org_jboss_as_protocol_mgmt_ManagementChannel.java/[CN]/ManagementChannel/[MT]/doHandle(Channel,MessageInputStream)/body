{
  log.tracef("%s handling incoming data",this);
  final SimpleDataInput input=new SimpleDataInput(Marshalling.createByteInput(message));
  try {
    ManagementProtocolHeader header=ManagementProtocolHeader.parse(input);
    if (header.isRequest()) {
      requestReceiver.handleRequest((ManagementRequestHeader)header,input);
    }
 else {
      responseReceiver.handleResponse((ManagementResponseHeader)header,input);
    }
    while (input.read() != -1) {
    }
  }
 catch (  Exception e) {
    log.tracef(e,"%s error handling incoming data",this);
  }
 finally {
    log.tracef("%s done handling incoming data",this);
    IoUtils.safeClose(input);
    IoUtils.safeClose(message);
  }
}
