{
  String subsystemXml=readResource("subsystem.xml");
  ModelVersion modelVersion=ModelVersion.create(1,2,0);
  KernelServicesBuilder builder=createKernelServicesBuilder(createAdditionalInitialization());
  builder.createLegacyKernelServicesBuilder(null,modelVersion).addMavenResourceURL("org.jboss.as:jboss-as-modcluster:7.1.2.Final");
  KernelServices mainServices=builder.build();
  KernelServices legacyServices=mainServices.getLegacyServices(modelVersion);
  Assert.assertNotNull(legacyServices);
  Assert.assertTrue(mainServices.isSuccessfulBoot());
  Assert.assertTrue(legacyServices.isSuccessfulBoot());
  PathAddress rootAddr=PathAddress.pathAddress(PathElement.pathElement(SUBSYSTEM,ModClusterExtension.SUBSYSTEM_NAME));
  PathAddress confAddr=rootAddr.append(PathElement.pathElement(MOD_CLUSTER_CONFIG,CONFIGURATION));
  PathAddress simpAddr=confAddr.append(PathElement.pathElement(CommonAttributes.SIMPLE_LOAD_PROVIDER_FACTOR,CONFIGURATION));
  PathAddress dynaAddr=confAddr.append(PathElement.pathElement(CommonAttributes.DYNAMIC_LOAD_PROVIDER,CONFIGURATION));
  PathAddress metrAddr=dynaAddr.append(PathElement.pathElement(CommonAttributes.LOAD_METRIC,"*"));
  PathAddress custAddr=dynaAddr.append(PathElement.pathElement(CommonAttributes.CUSTOM_LOAD_METRIC,"*"));
  PathAddress sslAddr=confAddr.append(PathElement.pathElement(CommonAttributes.SSL,CONFIGURATION));
  ModelTestUtils.checkFailedTransformedBootOperations(mainServices,modelVersion,parse(subsystemXml),new FailedOperationTransformationConfig().addFailedAttribute(metrAddr,new FailedOperationTransformationConfig.RejectExpressionsConfig(CommonAttributes.CAPACITY,CommonAttributes.WEIGHT)).addFailedAttribute(custAddr,new FailedOperationTransformationConfig.RejectExpressionsConfig(CommonAttributes.CAPACITY,CommonAttributes.WEIGHT,CommonAttributes.CLASS)).addFailedAttribute(dynaAddr,new FailedOperationTransformationConfig.RejectExpressionsConfig(CommonAttributes.DECAY,CommonAttributes.HISTORY)).addFailedAttribute(simpAddr,new FailedOperationTransformationConfig.RejectExpressionsConfig(CommonAttributes.FACTOR)).addFailedAttribute(sslAddr,new FailedOperationTransformationConfig.RejectExpressionsConfig(CommonAttributes.CIPHER_SUITE,CommonAttributes.KEY_ALIAS,CommonAttributes.PROTOCOL)).addFailedAttribute(confAddr,new FailedOperationTransformationConfig.RejectExpressionsConfig(CommonAttributes.ADVERTISE,CommonAttributes.ADVERTISE_SOCKET,CommonAttributes.ADVERTISE_SOCKET,CommonAttributes.AUTO_ENABLE_CONTEXTS,CommonAttributes.FLUSH_PACKETS,CommonAttributes.PING,CommonAttributes.STICKY_SESSION,CommonAttributes.STICKY_SESSION_FORCE,CommonAttributes.STICKY_SESSION_REMOVE)));
}
