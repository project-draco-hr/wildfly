{
  BatchManager batchManager=ctx.getBatchManager();
  if (!batchManager.isBatchActive()) {
    ctx.error("No active batch.");
    return;
  }
  Batch batch=batchManager.getActiveBatch();
  List<BatchedCommand> currentBatch=batch.getCommands();
  if (currentBatch.isEmpty()) {
    ctx.error("The batch is empty.");
    batchManager.discardActiveBatch();
    return;
  }
  ModelNode composite=new ModelNode();
  composite.get(Util.OPERATION).set(Util.COMPOSITE);
  composite.get(Util.ADDRESS).setEmptyList();
  ModelNode steps=composite.get(Util.STEPS);
  for (  BatchedCommand cmd : currentBatch) {
    steps.add(cmd.getRequest());
  }
  try {
    ModelNode result=ctx.getModelControllerClient().execute(composite);
    if (Util.isSuccess(result)) {
      batchManager.discardActiveBatch();
      ctx.printLine("The batch executed successfully.");
    }
 else {
      ctx.error("Failed to execute batch: " + Util.getFailureDescription(result));
    }
  }
 catch (  Exception e) {
    ctx.error("Failed to execute batch: " + e.getLocalizedMessage());
  }
}
