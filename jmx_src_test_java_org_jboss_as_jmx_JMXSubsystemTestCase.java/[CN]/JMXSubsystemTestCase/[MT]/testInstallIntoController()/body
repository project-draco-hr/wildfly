{
  String subsystemXml="<subsystem xmlns=\"" + Namespace.CURRENT.getUriString() + "\">"+ "<remoting-connector/>"+ "</subsystem>";
  KernelServices services=createKernelServicesBuilder(new BaseAdditionalInitalization()).setSubsystemXml(subsystemXml).build();
  Assert.assertTrue(services.isSuccessfulBoot());
  ModelNode model=services.readWholeModel();
  Assert.assertTrue(model.get(SUBSYSTEM).hasDefined(JMXExtension.SUBSYSTEM_NAME));
  int port=12345;
  String urlString=System.getProperty("jmx.service.url","service:jmx:remoting-jmx://localhost:" + port);
  JMXServiceURL serviceURL=new JMXServiceURL(urlString);
  JMXConnector connector=null;
  try {
    MBeanServerConnection connection=null;
    long end=System.currentTimeMillis() + 10000;
    do {
      try {
        connector=JMXConnectorFactory.connect(serviceURL,null);
        connection=connector.getMBeanServerConnection();
      }
 catch (      Exception e) {
        e.printStackTrace();
        Thread.sleep(500);
      }
    }
 while (connection == null && System.currentTimeMillis() < end);
    Assert.assertNotNull(connection);
    connection.getMBeanCount();
  }
  finally {
    IoUtils.safeClose(connector);
  }
  super.assertRemoveSubsystemResources(services);
}
