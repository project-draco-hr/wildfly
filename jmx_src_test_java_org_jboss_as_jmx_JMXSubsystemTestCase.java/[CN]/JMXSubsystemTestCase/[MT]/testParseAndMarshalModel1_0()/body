{
  String subsystemXml="<subsystem xmlns=\"" + Namespace.JMX_1_0.getUriString() + "\">"+ "    <jmx-connector registry-binding=\"registry1\" server-binding=\"server1\" />"+ "</subsystem>";
  String finishedSubsystemXml="<subsystem xmlns=\"" + Namespace.JMX_1_0.getUriString() + "\"/>";
  AdditionalInitialization additionalInit=new BaseAdditionalInitialization();
  KernelServices servicesA=createKernelServicesBuilder(additionalInit).setSubsystemXml(subsystemXml).build();
  ModelNode modelA=servicesA.readWholeModel();
  String marshalled=servicesA.getPersistedSubsystemXml();
  servicesA.shutdown();
  Assert.assertTrue(marshalled.contains(Namespace.CURRENT.getUriString()));
  compareXml(null,finishedSubsystemXml,marshalled,true);
  KernelServices servicesB=createKernelServicesBuilder(additionalInit).setSubsystemXml(marshalled).build();
  ModelNode modelB=servicesB.readWholeModel();
  super.compare(modelA,modelB);
}
