{
  if (isVaultFormat(encrypted)) {
    if (fqn == null) {
      throw new SecurityException("Vault not initialized");
    }
    String[] split=encrypted.split("::");
    if (split[1].equals(fqn)) {
      Object value=options.get(split[2]);
      if (value == null) {
        value=split[3];
      }
      return value.toString();
    }
 else {
      throw new SecurityException("Unknown vault " + split[1]);
    }
  }
  return encrypted;
}
