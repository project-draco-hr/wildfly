{
  final File tempFileName=FilePersistenceUtils.createTempFile(fileName);
  try {
    try {
      FilePersistenceUtils.writeToTempFile(marshalled,tempFileName);
    }
 catch (    Exception e) {
      MGMT_OP_LOGGER.failedToStoreConfiguration(e,fileName.getName());
      return;
    }
    try {
      configurationFile.backup();
    }
  finally {
      configurationFile.commitTempFile(tempFileName);
    }
    configurationFile.fileWritten();
  }
 catch (  ConfigurationPersistenceException e) {
    MGMT_OP_LOGGER.errorf(e,e.toString());
  }
 finally {
    if (tempFileName.exists() && !tempFileName.delete()) {
      MGMT_OP_LOGGER.cannotDeleteTempFile(tempFileName.getName());
      tempFileName.deleteOnExit();
    }
  }
}
