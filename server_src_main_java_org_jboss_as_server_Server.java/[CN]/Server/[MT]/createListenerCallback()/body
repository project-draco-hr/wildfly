{
  return new ServerStartupListener.Callback(){
    public void run(    Map<ServiceName,StartException> serviceFailures,    long elapsedTime,    int totalServices,    int onDemandServices,    int startedServices){
      if (serviceFailures.isEmpty()) {
        log.infof("JBoss AS started - Installed %d and started %d services in %dms.",totalServices,startedServices,elapsedTime);
        sendMessage("STARTED");
      }
 else {
        sendMessage("START FAILED");
        final StringBuilder buff=new StringBuilder(String.format("JBoss AS server start failed. Attempted to start %d services in %dms",totalServices,elapsedTime));
        buff.append("\nThe following services failed to start:\n");
        for (        Map.Entry<ServiceName,StartException> entry : serviceFailures.entrySet()) {
          buff.append(String.format("\t%s => %s\n",entry.getKey(),entry.getValue().getMessage()));
        }
        log.error(buff.toString());
      }
    }
  }
;
}
