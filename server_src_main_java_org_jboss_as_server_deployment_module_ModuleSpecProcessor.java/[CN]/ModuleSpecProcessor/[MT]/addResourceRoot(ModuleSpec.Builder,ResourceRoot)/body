{
  try {
    if (resource.getExportFilters().isEmpty()) {
      specBuilder.addResourceRoot(ResourceLoaderSpec.createResourceLoaderSpec(new VFSResourceLoader(resource.getRootName(),resource.getRoot())));
    }
 else {
      final MultiplePathFilterBuilder filterBuilder=PathFilters.multiplePathFilterBuilder(true);
      for (      final FilterSpecification filter : resource.getExportFilters()) {
        filterBuilder.addFilter(filter.getPathFilter(),filter.isInclude());
      }
      specBuilder.addResourceRoot(ResourceLoaderSpec.createResourceLoaderSpec(new VFSResourceLoader(resource.getRootName(),resource.getRoot(),resource.isUsePhysicalCodeSource()),filterBuilder.create()));
    }
  }
 catch (  IOException e) {
    throw new DeploymentUnitProcessingException("Failed to create VFSResourceLoader for root [" + resource.getRootName() + "]",e);
  }
}
