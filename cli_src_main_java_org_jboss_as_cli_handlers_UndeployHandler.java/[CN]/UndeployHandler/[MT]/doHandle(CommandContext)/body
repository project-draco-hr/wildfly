{
  final ModelControllerClient client=ctx.getModelControllerClient();
  final ParsedCommandLine args=ctx.getParsedCommandLine();
  final boolean l=this.l.isPresent(args);
  if (!args.hasProperties() || l) {
    printList(ctx,Util.getDeployments(client),l);
    return;
  }
  final String name=this.name.getValue(ctx.getParsedCommandLine());
  if (name == null) {
    printList(ctx,Util.getDeployments(client),l);
    return;
  }
  final ModelNode request=buildRequestWOValidation(ctx);
  addHeaders(ctx,request);
  final ModelNode result;
  try {
    result=client.execute(request);
  }
 catch (  Exception e) {
    throw new CommandFormatException("Undeploy failed: " + e.getLocalizedMessage());
  }
  if (!Util.isSuccess(result)) {
    throw new CommandFormatException("Undeploy failed: " + Util.getFailureDescription(result));
  }
}
