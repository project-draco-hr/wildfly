{
  String adaptorModule=pu.getProperties().getProperty(Configuration.ADAPTER_MODULE);
  PersistenceProviderAdaptor adaptor=null;
  if (persistenceProviderDeploymentHolder != null) {
    adaptor=persistenceProviderDeploymentHolder.getAdapter();
  }
  if (adaptor == null) {
    adaptor=loadPersistenceAdapterModule(pu.getPersistenceProviderClassName(),adaptorModule);
  }
  if (adaptor == null) {
    throw MESSAGES.failedToGetAdapter(pu.getPersistenceProviderClassName());
  }
  return adaptor;
}
