{
  String providerName=pu.getPersistenceProviderClassName();
  List<PersistenceProvider> providers=PersistenceProviderResolverHolder.getPersistenceProviderResolver().getPersistenceProviders();
  for (  PersistenceProvider provider : providers) {
    if (provider.getClass().getName().equals(providerName)) {
      if (providerName.equals(Configuration.PROVIDER_CLASS_DEFAULT)) {
        if (persistenceProviderModule.equals(Configuration.PROVIDER_MODULE_HIBERNATE3)) {
          if (isHibernate3(provider)) {
            return provider;
          }
        }
 else         if (!isHibernate3(provider)) {
          return provider;
        }
      }
 else {
        return provider;
      }
    }
  }
  return null;
}
