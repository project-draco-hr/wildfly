{
  log.tracef("resolveInterface, checking NetworkInterface: %s\n",toString(networkInterface));
  final Enumeration<InetAddress> interfaceAddresses=networkInterface.getInetAddresses();
  while (interfaceAddresses.hasMoreElements()) {
    final InetAddress address=interfaceAddresses.nextElement();
    if (preferIPv4Stack && !preferIPv6Stack && !(address instanceof Inet4Address)) {
      continue;
    }
 else     if (preferIPv6Stack && !preferIPv4Stack && !(address instanceof Inet6Address)) {
      continue;
    }
    log.tracef("Checking interface(name=%s,address=%s), criteria=%s\n",networkInterface.getName(),address,criteria);
    InetAddress bindAddress=criteria.isAcceptable(networkInterface,address);
    if (bindAddress != null) {
      log.tracef("Criteria provided bind address: %s\n",bindAddress);
      return new NetworkInterfaceBinding(Collections.singleton(networkInterface),bindAddress);
    }
  }
  return null;
}
