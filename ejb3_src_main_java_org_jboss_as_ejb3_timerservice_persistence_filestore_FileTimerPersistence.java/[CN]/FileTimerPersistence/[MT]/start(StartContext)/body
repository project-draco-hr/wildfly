{
  final RiverMarshallerFactory factory=new RiverMarshallerFactory();
  final MarshallingConfiguration configuration=new MarshallingConfiguration();
  configuration.setClassResolver(ModularClassResolver.getInstance(moduleLoader.getValue()));
  this.configuration=configuration;
  this.factory=factory;
  final File baseDir=new File(this.baseDir.getValue());
  if (!baseDir.exists()) {
    if (createIfNotExists) {
      if (!baseDir.mkdirs()) {
        throw new RuntimeException("Could not create timer file store directory " + baseDir);
      }
    }
 else {
      throw new RuntimeException("Timer file store directory " + baseDir + " does not exist");
    }
  }
  if (!baseDir.isDirectory()) {
    throw new RuntimeException("Timer file store directory " + baseDir + " is not a directory");
  }
  started=true;
}
