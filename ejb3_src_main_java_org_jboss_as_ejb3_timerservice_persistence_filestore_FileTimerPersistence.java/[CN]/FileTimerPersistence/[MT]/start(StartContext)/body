{
  final RiverMarshallerFactory factory=new RiverMarshallerFactory();
  final MarshallingConfiguration configuration=new MarshallingConfiguration();
  configuration.setClassResolver(ModularClassResolver.getInstance(moduleLoader.getValue()));
  this.configuration=configuration;
  this.factory=factory;
  final File baseDir=new File(this.baseDir.getValue());
  if (!baseDir.exists()) {
    if (createIfNotExists) {
      if (!baseDir.mkdirs()) {
        throw MESSAGES.failToCreateTimerFileStoreDir(baseDir);
      }
    }
 else {
      throw MESSAGES.timerFileStoreDirNotExist(baseDir);
    }
  }
  if (!baseDir.isDirectory()) {
    throw MESSAGES.invalidTimerFileStoreDir(baseDir);
  }
  started=true;
}
