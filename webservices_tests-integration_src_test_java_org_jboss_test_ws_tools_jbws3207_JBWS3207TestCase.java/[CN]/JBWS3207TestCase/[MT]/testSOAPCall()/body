{
  URLConnection conn=null;
  InputStream in=null;
  OutputStreamWriter osw=null;
  final String message="<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:arc=\"http://service.jbws3207.tools.ws.test.jboss.org/\">" + "  <soapenv:Header/>" + "  <soapenv:Body>"+ "    <arc:echoString>"+ "      <arg0>Foo</arg0>"+ "    </arc:echoString>"+ "  </soapenv:Body>"+ "</soapenv:Envelope>";
  try {
    URL url=new URL("http://localhost:8080/ws-example");
    System.out.println("Reading response from " + url + ":");
    conn=url.openConnection();
    conn.setDoInput(true);
    conn.setDoOutput(true);
    osw=new OutputStreamWriter(conn.getOutputStream());
    osw.write(message);
    osw.flush();
    in=new BufferedInputStream(conn.getInputStream());
    int i=in.read();
    while (i != -1) {
      System.out.print((char)i);
      i=in.read();
    }
    System.out.println("");
  }
  finally {
    safeClose(osw);
    safeClose(in);
  }
}
