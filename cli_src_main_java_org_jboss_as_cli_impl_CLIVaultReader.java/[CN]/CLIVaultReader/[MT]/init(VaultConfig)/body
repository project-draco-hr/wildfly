{
  if (vaultConfig.getCode() == null) {
    vault=new PicketBoxSecurityVault();
  }
 else {
    try {
      if (vaultConfig.getModule() == null) {
        vault=SecurityActions.loadAndInstantiateFromClassClassLoader(PicketBoxSecurityVault.class,SecurityVault.class,vaultConfig.getCode());
      }
 else {
        vault=SecurityActions.loadAndInstantiateFromModule(vaultConfig.getModule(),SecurityVault.class,vaultConfig.getCode());
      }
    }
 catch (    Exception e) {
      throw new SecurityVaultException(e);
    }
  }
  vault.init(vaultConfig.getOptions());
}
