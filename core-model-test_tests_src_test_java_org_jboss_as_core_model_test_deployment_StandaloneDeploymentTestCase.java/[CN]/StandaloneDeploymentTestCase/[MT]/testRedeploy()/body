{
  KernelServices kernelServices=createKernelServices();
  ModelNode content=getInputStreamIndexContent();
  ModelNode op=createAddOperation(kernelServices,"Test1",null,true,true,content);
  ModelTestUtils.checkOutcome(kernelServices.executeOperation(op,new ByteArrayInputStream(new byte[]{1,2,3,4,5})));
  checkSingleDeployment(kernelServices,"Test1",true);
  op=Util.createOperation(DeploymentRedeployHandler.OPERATION_NAME,getPathAddress("Test1"));
  kernelServices.validateOperation(op);
  ModelTestUtils.checkOutcome(kernelServices.executeOperation(op));
  checkSingleDeployment(kernelServices,"Test1",true);
  op=Util.createOperation(DeploymentRemoveHandler.OPERATION_NAME,getPathAddress("Test1"));
  kernelServices.validateOperation(op);
  ModelTestUtils.checkOutcome(kernelServices.executeOperation(op));
  checkNoDeployments(kernelServices);
}
