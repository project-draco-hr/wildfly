{
  Map<String,Object> modAttrs=null;
  Set<String> removeAttrs=null;
  if (isSessionAttributeMapDirty()) {
synchronized (this) {
      if (attrModifiedMap_.size() > 0) {
        modAttrs=new HashMap<>(attrModifiedMap_);
      }
      if (attrRemovedSet_.size() > 0) {
        removeAttrs=new HashSet<>(attrRemovedSet_);
      }
    }
    clearAttrChangedMaps();
  }
  DistributableSessionMetadata metadata=isSessionMetadataDirty() ? getSessionMetadata() : null;
  Long timestamp=modAttrs != null || removeAttrs != null || metadata != null || getMustReplicateTimestamp() ? Long.valueOf(getSessionTimestamp()) : null;
  return new OutgoingData(getRealId(),getVersion(),timestamp,metadata,modAttrs,removeAttrs);
}
