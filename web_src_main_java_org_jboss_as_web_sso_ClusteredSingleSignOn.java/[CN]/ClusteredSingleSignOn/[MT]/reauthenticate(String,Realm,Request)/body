{
  if (ssoId == null || realm == null)   return false;
  boolean reauthenticated=false;
  SingleSignOnEntry entry=getSingleSignOnEntry(ssoId);
  if (entry != null && entry.getCanReauthenticate()) {
    String username=entry.getUsername();
    if (username != null) {
      Principal reauthPrincipal=realm.authenticate(username,entry.getPassword());
      if (reauthPrincipal != null) {
        reauthenticated=true;
        request.setAuthType(entry.getAuthType());
        request.setUserPrincipal(reauthPrincipal);
        entry.setPrincipal(reauthPrincipal);
      }
    }
  }
  return reauthenticated;
}
