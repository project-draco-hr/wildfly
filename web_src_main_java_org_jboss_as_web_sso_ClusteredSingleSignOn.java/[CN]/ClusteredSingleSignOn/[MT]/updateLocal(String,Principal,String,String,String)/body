{
  boolean shouldBroadcast=false;
  SingleSignOnEntry sso=getSingleSignOnEntry(ssoId);
  if (sso != null) {
    if (sso.getCanReauthenticate() == false) {
      WebLogger.WEB_SSO_LOGGER.tracef("Update sso id %s to auth type %s",ssoId,authType);
synchronized (sso) {
        shouldBroadcast=sso.updateCredentials2(principal,authType,username,password);
      }
    }
 else     if (sso.getPrincipal() == null && principal != null) {
      WebLogger.WEB_SSO_LOGGER.tracef("Update sso id %s with principal %s",ssoId,principal.getName());
synchronized (sso) {
        sso.setPrincipal(principal);
      }
    }
  }
  return shouldBroadcast;
}
