{
  PoolingClientConnectionManager connectionPool=new PoolingClientConnectionManager();
  DefaultHttpClient httpClient=new DefaultHttpClient(connectionPool);
  SchemeRegistry schemeRegistry=httpClient.getConnectionManager().getSchemeRegistry();
  schemeRegistry.register(new Scheme("http",80,PlainSocketFactory.getSocketFactory()));
  try {
    schemeRegistry.register(new Scheme("https",443,new SSLSocketFactory(new TrustStrategy(){
      @Override public boolean isTrusted(      X509Certificate[] chain,      String authType) throws CertificateException {
        return true;
      }
    }
,new AllowAllHostnameVerifier())));
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
  httpClient.setHttpRequestRetryHandler(new StandardHttpRequestRetryHandler(5,true));
  httpClient.getCredentialsProvider().setCredentials(new AuthScope(host,port,MANAGEMENT_REALM,AuthPolicy.DIGEST),new UsernamePasswordCredentials(username,password));
  return httpClient;
}
