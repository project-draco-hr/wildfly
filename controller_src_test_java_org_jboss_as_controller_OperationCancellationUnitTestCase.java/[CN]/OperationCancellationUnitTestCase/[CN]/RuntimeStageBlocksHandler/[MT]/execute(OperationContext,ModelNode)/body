{
  String name=operation.require("name").asString();
  context.readResourceForUpdate(PathAddress.EMPTY_ADDRESS).getModel().get(name);
  context.getResult();
  context.addStep(new OperationStepHandler(){
    @Override public void execute(    OperationContext context,    ModelNode operation){
      toggleRuntimeState(state);
      block();
      if (useNonRecursive) {
        context.completeStep(new OperationContext.RollbackHandler(){
          @Override public void handleRollback(          OperationContext context,          ModelNode operation){
            toggleRuntimeState(state);
          }
        }
);
      }
 else       if (context.completeStep() == OperationContext.ResultAction.ROLLBACK) {
        toggleRuntimeState(state);
      }
    }
  }
,OperationContext.Stage.RUNTIME);
  if (useNonRecursive) {
    context.completeStep(OperationContext.RollbackHandler.NOOP_ROLLBACK_HANDLER);
  }
 else {
    context.completeStep();
  }
}
