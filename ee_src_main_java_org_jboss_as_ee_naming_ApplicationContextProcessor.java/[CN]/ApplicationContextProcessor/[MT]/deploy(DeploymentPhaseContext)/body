{
  final DeploymentUnit deploymentUnit=phaseContext.getDeploymentUnit();
  if (deploymentUnit.getParent() != null) {
    return;
  }
  EEModuleDescription moduleDescription=deploymentUnit.getAttachment(org.jboss.as.ee.component.Attachments.EE_MODULE_DESCRIPTION);
  final ServiceTarget serviceTarget=phaseContext.getServiceTarget();
  final ServiceName applicationContextServiceName=ContextNames.contextServiceNameOfApplication(moduleDescription.getAppName());
  final RootContextService contextService=new RootContextService();
  serviceTarget.addService(applicationContextServiceName,contextService).install();
  final BinderService applicationNameBinder=new BinderService("AppName");
  serviceTarget.addService(applicationContextServiceName.append("AppName"),applicationNameBinder).addDependency(applicationContextServiceName,NamingStore.class,applicationNameBinder.getNamingStoreInjector()).addInjection(applicationNameBinder.getManagedObjectInjector(),new ValueManagedObject(Values.immediateValue(moduleDescription.getAppName()))).install();
  deploymentUnit.putAttachment(Attachments.APPLICATION_CONTEXT_CONFIG,applicationContextServiceName);
}
