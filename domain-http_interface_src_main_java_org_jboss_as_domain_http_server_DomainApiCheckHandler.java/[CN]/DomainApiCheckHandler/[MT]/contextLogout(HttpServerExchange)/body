{
  SecurityContext context=exchange.getAttachment(SecurityContext.ATTACHMENT_KEY);
  context.logout();
  final HeaderMap requestHeaders=exchange.getRequestHeaders();
  final HeaderMap responseHeaders=exchange.getResponseHeaders();
  String host=null;
  String protocol="http";
  String referrer=responseHeaders.getFirst(REFERER);
  if (referrer != null) {
    try {
      URI uri=new URI(referrer);
      protocol=uri.getScheme();
      host=uri.getHost() + (uri.getPort() == -1 ? "" : ":" + String.valueOf(uri.getPort()));
    }
 catch (    URISyntaxException e) {
    }
  }
  if (host == null) {
    host=requestHeaders.getFirst(HOST);
    if (host == null) {
      exchange.setResponseCode(StatusCodes.INTERNAL_SERVER_ERROR);
      return;
    }
  }
  responseHeaders.add(LOCATION,protocol + "://" + host+ "/logout?"+ LogoutHandler.REDIRECT);
  exchange.setResponseCode(StatusCodes.TEMPORARY_REDIRECT);
}
