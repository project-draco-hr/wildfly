{
  EnterpriseArchive ear=ShrinkWrap.create(EnterpriseArchive.class);
  WebArchive war=ShrinkWrap.create(WebArchive.class,"test.war");
  war.addClasses(TestAA.class);
  ear.addModule(war);
  JavaArchive ejb=ShrinkWrap.create(JavaArchive.class,"ejb1.jar");
  ejb.addClasses(MyEjb.class,EarJbossStructureExtendedVisibilityTestCase.class);
  ear.addModule(ejb);
  ejb=ShrinkWrap.create(JavaArchive.class,"ejb2.jar");
  ejb.addClasses(MyEjb2.class);
  ear.addModule(ejb);
  ear.addManifestResource(new StringAsset("<jboss-deployment-structure><extended-class-visibility>true</extended-class-visibility></jboss-deployment-structure>"),"jboss-deployment-structure.xml");
  return ear;
}
