{
  if (input.startsWith(AND,pos)) {
    return new AndOperation();
  }
 else   if (input.startsWith(OR,pos)) {
    return new OrOperation();
  }
 else   if (input.startsWith(EQ,pos)) {
    return new ComparisonOperation(EQ);
  }
 else   if (input.startsWith(NOT_EQ,pos)) {
    return new ComparisonOperation(NOT_EQ);
  }
 else   if (input.charAt(pos) == '>') {
    if (input.length() > pos + 1 && input.charAt(pos + 1) == '=') {
      return new ComparisonOperation(NLT);
    }
    return new ComparisonOperation(GT);
  }
 else   if (input.charAt(pos) == '<') {
    if (input.length() > pos + 1 && input.charAt(pos + 1) == '=') {
      return new ComparisonOperation(NGT);
    }
    return new ComparisonOperation(LT);
  }
 else {
    throw new IllegalStateException("Unrecognized operation at " + pos + " in '"+ input+ "'");
  }
}
