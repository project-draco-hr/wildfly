{
  final DataInputStream input=new DataInputStream(messageInputStream);
  final short invocationId=input.readShort();
  final int transactionIDBytesLength=PackedInteger.readPackedInteger(input);
  final byte[] transactionIDBytes=new byte[transactionIDBytesLength];
  input.read(transactionIDBytes);
  final TransactionID transactionID=TransactionID.createTransactionID(transactionIDBytes);
  final TransactionManagementTask transactionManagementTask;
switch (this.txRequestType) {
case COMMIT:
    transactionManagementTask=new TransactionCommitTask(this.transactionsRepository,transactionID,channel,invocationId);
  break;
case ROLLBACK:
transactionManagementTask=new TransactionRollbackTask(this.transactionsRepository,transactionID,channel,invocationId);
break;
default :
throw new IllegalArgumentException("Unknown transaction request type " + this.txRequestType);
}
this.executorService.submit(transactionManagementTask);
}
