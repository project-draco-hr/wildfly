{
  int orglevel=context.getBundle().adapt(FrameworkStartLevel.class).getStartLevel();
  InputStream input=deployer.getDeployment(GOOD_BUNDLE);
  Bundle bundle=context.installBundle(GOOD_BUNDLE,input);
  try {
    Assert.assertEquals("Bundle INSTALLED",Bundle.INSTALLED,bundle.getState());
    bundle.adapt(BundleStartLevel.class).setStartLevel(2);
    bundle.start();
    Assert.assertEquals("Bundle INSTALLED",Bundle.INSTALLED,bundle.getState());
    FrameworkUtils.setFrameworkStartLevel(context,2);
    Assert.assertEquals("Bundle ACTIVE",Bundle.ACTIVE,bundle.getState());
  }
  finally {
    FrameworkUtils.setFrameworkStartLevel(context,orglevel);
    bundle.uninstall();
  }
}
