{
  if (componentConfiguration.getComponentDescription() instanceof EJBComponentDescription == false) {
    throw MESSAGES.invalidEjbComponent(componentConfiguration.getComponentName(),componentConfiguration.getComponentClass());
  }
  final DeploymentReflectionIndex deploymentReflectionIndex=context.getDeploymentUnit().getAttachment(org.jboss.as.server.deployment.Attachments.REFLECTION_INDEX);
  final EJBComponentDescription ejbComponentDescription=(EJBComponentDescription)componentConfiguration.getComponentDescription();
  final String viewClassName=viewDescription.getViewClassName();
  final EJBViewDescription ejbViewDescription=(EJBViewDescription)viewDescription;
  boolean beanHasMethodLevelSecurityMetadata=false;
  final List<Method> viewMethods=viewConfiguration.getProxyFactory().getCachedMethods();
  for (  final Method viewMethod : viewMethods) {
    if (!Modifier.isPublic(viewMethod.getModifiers())) {
      continue;
    }
    if (viewMethod.getDeclaringClass() == WriteReplaceInterface.class) {
      continue;
    }
    final ApplicableMethodInformation<EJBMethodSecurityAttribute> permissions=ejbComponentDescription.getDescriptorMethodPermissions();
    boolean methodHasSecurityMetadata=handlePermissions(componentConfiguration,viewConfiguration,deploymentReflectionIndex,viewClassName,ejbViewDescription,viewMethod,permissions,false);
    if (!methodHasSecurityMetadata) {
      methodHasSecurityMetadata=handlePermissions(componentConfiguration,viewConfiguration,deploymentReflectionIndex,viewClassName,ejbViewDescription,viewMethod,ejbComponentDescription.getAnnotationMethodPermissions(),true);
    }
    if (methodHasSecurityMetadata) {
      beanHasMethodLevelSecurityMetadata=true;
    }
  }
  if (beanHasMethodLevelSecurityMetadata || this.hasSecurityMetaData(ejbComponentDescription)) {
    viewConfiguration.addViewInterceptor(new SecurityContextInterceptorFactory(),InterceptorOrder.View.SECURITY_CONTEXT);
  }
 else {
    ROOT_LOGGER.debug("Security is *not* enabled on EJB: " + ejbComponentDescription.getEJBName() + ", no security interceptors will apply");
    return;
  }
}
