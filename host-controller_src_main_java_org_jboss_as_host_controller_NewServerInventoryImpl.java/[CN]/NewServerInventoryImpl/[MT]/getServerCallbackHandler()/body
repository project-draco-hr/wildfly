{
  return new CallbackHandler(){
    public void handle(    Callback[] callbacks) throws IOException, UnsupportedCallbackException {
      List<Callback> toRespondTo=new LinkedList<Callback>();
      String userName;
      ManagedServer server=null;
      for (      Callback current : callbacks) {
        if (current instanceof AuthorizeCallback) {
          toRespondTo.add(current);
        }
 else         if (current instanceof NameCallback) {
          NameCallback nameCallback=(NameCallback)current;
          userName=nameCallback.getDefaultName();
          server=servers.get(ManagedServer.getServerProcessName(userName));
        }
 else         if (current instanceof PasswordCallback) {
          toRespondTo.add(current);
        }
 else         if (current instanceof RealmCallback) {
        }
 else {
          throw new UnsupportedCallbackException(current);
        }
      }
      if (server == null) {
        return;
      }
      for (      Callback current : toRespondTo) {
        if (current instanceof AuthorizeCallback) {
          AuthorizeCallback authorizeCallback=(AuthorizeCallback)current;
          authorizeCallback.setAuthorized(authorizeCallback.getAuthenticationID().equals(authorizeCallback.getAuthorizationID()));
        }
 else         if (current instanceof PasswordCallback) {
          String password=new String(server.getAuthKey());
          ((PasswordCallback)current).setPassword(password.toCharArray());
        }
      }
    }
  }
;
}
