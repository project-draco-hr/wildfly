{
  DeploymentPlanBuilder builder=manager.newDeploymentPlan().withRollback();
  for (  AbstractDeployment deployment : deployments) {
    builder=deployment.addDeployment(manager,builder);
  }
  try {
    manager.execute(builder.build()).get(timeout,TimeUnit.MILLISECONDS);
  }
  finally {
    markDeploymentsDeployed();
  }
}
