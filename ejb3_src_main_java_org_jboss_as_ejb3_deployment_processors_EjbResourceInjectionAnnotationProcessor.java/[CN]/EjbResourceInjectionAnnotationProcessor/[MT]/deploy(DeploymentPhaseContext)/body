{
  final DeploymentUnit deploymentUnit=phaseContext.getDeploymentUnit();
  final EEModuleDescription eeModuleDescription=deploymentUnit.getAttachment(Attachments.EE_MODULE_DESCRIPTION);
  final CompositeIndex index=deploymentUnit.getAttachment(org.jboss.as.server.deployment.Attachments.COMPOSITE_ANNOTATION_INDEX);
  final List<AnnotationInstance> resourceAnnotations=index.getAnnotations(EJB_ANNOTATION_NAME);
  for (  AnnotationInstance annotation : resourceAnnotations) {
    final AnnotationTarget annotationTarget=annotation.target();
    final EJBResourceWrapper annotationWrapper=new EJBResourceWrapper(annotation);
    if (annotationTarget instanceof FieldInfo) {
      processField(eeModuleDescription,annotationWrapper,(FieldInfo)annotationTarget);
    }
 else     if (annotationTarget instanceof MethodInfo) {
      processMethod(eeModuleDescription,annotationWrapper,(MethodInfo)annotationTarget);
    }
 else     if (annotationTarget instanceof ClassInfo) {
      processClass(eeModuleDescription,annotationWrapper,(ClassInfo)annotationTarget);
    }
  }
}
