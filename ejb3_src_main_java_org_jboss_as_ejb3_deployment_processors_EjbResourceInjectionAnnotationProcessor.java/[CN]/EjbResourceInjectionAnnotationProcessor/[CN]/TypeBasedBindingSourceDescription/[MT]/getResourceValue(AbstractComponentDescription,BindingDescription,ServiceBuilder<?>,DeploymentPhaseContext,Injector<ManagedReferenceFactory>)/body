{
  final DeploymentUnit deploymentUnit=phaseContext.getDeploymentUnit();
  final EEApplicationDescription applicationComponentDescription=deploymentUnit.getAttachment(Attachments.EE_APPLICATION_DESCRIPTION);
  if (applicationComponentDescription == null) {
    return;
  }
  final Set<AbstractComponentDescription> componentDescriptions=applicationComponentDescription.getComponentsForViewName(viewType);
  if (componentDescriptions == null) {
    throw new IllegalArgumentException("@EJB annotation target can not be resolved.  No beans defined with the required view [" + viewType + "]");
  }
  if (!componentDescriptions.isEmpty()) {
    if (componentDescriptions.size() > 1) {
      throw new IllegalArgumentException("@EJB annotation target can not be resolved.  Ambiguous required view [" + viewType + "]");
    }
    final AbstractComponentDescription targetComponentDescription=componentDescriptions.iterator().next();
    final ServiceName beanServiceName=deploymentUnit.getServiceName().append("component").append(targetComponentDescription.getComponentName()).append("VIEW").append(viewType);
    serviceBuilder.addDependency(beanServiceName,ManagedReferenceFactory.class,injector);
  }
}
