{
  String testContent="<profile name=\"foo\">" + MockSubsystemElement.getAnotherSubsystemXmlContent() + "</profile>";
  testContent+="<profile name=\"test\"><include profile=\"foo\"/>" + MockSubsystemElement.getSingleSubsystemXmlContent() + "</profile>";
  testContent=ModelParsingSupport.wrap(Element.PROFILES.getLocalName(),testContent);
  String fullcontent=ModelParsingSupport.getXmlContent(Element.DOMAIN.getLocalName(),getTargetNamespace(),getTargetNamespaceLocation(),testContent);
  DomainModel root=ModelParsingSupport.parseDomainModel(getXMLMapper(),fullcontent);
  ProfileElement testee=root.getProfile("test");
  assertNotNull(testee);
  assertEquals("test",testee.getName());
  Set<String> includes=testee.getIncludedProfiles();
  assertEquals(1,includes.size());
  String include=includes.iterator().next();
  assertEquals("foo",include);
  Set<AbstractSubsystemElement<? extends AbstractSubsystemElement<?>>> subsystems=testee.getSubsystems();
  assertEquals(1,subsystems.size());
  boolean gotMock=false;
  for (  AbstractSubsystemElement<? extends AbstractSubsystemElement<?>> subsystem : subsystems) {
    if (MockSubsystemElement.MOCK_ELEMENT_QNAME.equals(subsystem.getElementName())) {
      gotMock=true;
    }
 else {
      fail("Unknown subsystem QName " + subsystem.getElementName());
    }
  }
  assertTrue(gotMock);
}
