{
  ServiceController<?> controller=getServiceContainer().getService(serviceName);
  State state=controller != null ? controller.getState() : null;
  while ((state == null || state != expState) && timeout > 0) {
    try {
      Thread.sleep(100);
    }
 catch (    InterruptedException ex) {
    }
    controller=getServiceContainer().getService(serviceName);
    state=controller != null ? controller.getState() : null;
    timeout-=100;
  }
  assertEquals(serviceName.toString(),expState,state);
}
