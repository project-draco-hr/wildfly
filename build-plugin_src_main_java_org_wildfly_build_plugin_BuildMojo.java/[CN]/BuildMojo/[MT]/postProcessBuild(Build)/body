{
  final Path baseDir=Paths.get(new File(buildName,serverName).getAbsolutePath());
  Files.walkFileTree(baseDir,new SimpleFileVisitor<Path>(){
    @Override public FileVisitResult preVisitDirectory(    Path dir,    BasicFileAttributes attrs) throws IOException {
      String relative=baseDir.relativize(dir).toString();
      if (!OS_WINDOWS) {
        for (        FilePermission perm : build.getFilePermissions()) {
          if (perm.includeFile(relative)) {
            Files.setPosixFilePermissions(dir,perm.getPermission());
            continue;
          }
        }
      }
      return FileVisitResult.CONTINUE;
    }
    @Override public FileVisitResult visitFile(    Path file,    BasicFileAttributes attrs) throws IOException {
      String relative=baseDir.relativize(file).toString();
      if (!OS_WINDOWS) {
        for (        FilePermission perm : build.getFilePermissions()) {
          if (perm.includeFile(relative)) {
            Files.setPosixFilePermissions(file,perm.getPermission());
            continue;
          }
        }
      }
      if (build.getUnix().includeFile(relative)) {
        toUnixLineEndings(file);
      }
      if (build.getWindows().includeFile(relative)) {
        toWindowsLineEndings(file);
      }
      return FileVisitResult.CONTINUE;
    }
  }
);
}
