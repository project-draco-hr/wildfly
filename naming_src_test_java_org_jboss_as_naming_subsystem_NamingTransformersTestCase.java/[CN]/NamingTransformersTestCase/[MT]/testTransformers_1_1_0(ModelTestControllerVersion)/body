{
  if (version.isEap()) {
    ignoreThisTestIfEAPRepositoryIsNotReachable();
  }
  KernelServicesBuilder builder=createKernelServicesBuilder(createAdditionalInitialization()).setSubsystemXmlResource("subsystem_with_expressions_compatible_1.1.0.xml");
  builder.createLegacyKernelServicesBuilder(null,version,VERSION_1_1_0).addMavenResourceURL("org.jboss.as:jboss-as-naming:" + version.getMavenGavVersion()).skipReverseControllerCheck();
  KernelServices mainServices=builder.build();
  KernelServices legacyServices=mainServices.getLegacyServices(VERSION_1_1_0);
  assertNotNull(legacyServices);
  checkSubsystemModelTransformation(mainServices,VERSION_1_1_0,MODEL_FIXER_1_1_0);
  checkSimpleBindingTransformation(mainServices,VERSION_1_1_0);
  checkObjectFactoryWithEnvironmentBindingTransformation(mainServices,VERSION_1_1_0);
  checkSuccessfulObjectFactoryWithEnvironmentBindingTransformation(mainServices,VERSION_1_1_0);
  checkSuccessfulSimpleBindingTransformation(mainServices,VERSION_1_1_0);
  checkExternalContextEnvironmentBindingTransformationFails(mainServices,VERSION_1_1_0);
}
