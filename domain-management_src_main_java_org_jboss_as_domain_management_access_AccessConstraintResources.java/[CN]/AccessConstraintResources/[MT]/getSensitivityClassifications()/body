{
  Collection<SensitivityClassification> current=SensitiveTargetConstraint.FACTORY.getSensitivities();
  if (classifications == null || classifications.size() != current.size()) {
    Map<String,Map<String,SensitivityClassification>> classificationsMap=new TreeMap<String,Map<String,SensitivityClassification>>();
    for (    SensitivityClassification classification : current) {
      final String type=classification.isCore() ? CORE : classification.getSubsystem();
      Map<String,SensitivityClassification> byName=classificationsMap.get(type);
      if (byName == null) {
        byName=new TreeMap<String,SensitivityClassification>();
        classificationsMap.put(type,byName);
      }
      byName.put(classification.getName(),classification);
    }
    classifications=classificationsMap;
  }
  return classifications;
}
