{
  String subsystemXml=readResource("subsystem-1.1.0-JBPAPP-9314.xml");
  ModelVersion modelVersion=ModelVersion.create(1,1,0);
  KernelServicesBuilder builder=createKernelServicesBuilder(null).setSubsystemXml(subsystemXml);
  builder.createLegacyKernelServicesBuilder(null,modelVersion).addMavenResourceURL("org.jboss.as:jboss-as-web:7.1.2.Final").addMavenResourceURL("org.jboss.as:jboss-as-controller:7.1.2.Final").addParentFirstClassPattern("org.jboss.as.controller.*").addChildFirstClassPattern("org.jboss.as.controller.alias.*").skipReverseControllerCheck();
  KernelServices mainServices=builder.build();
  Assert.assertTrue(mainServices.isSuccessfulBoot());
  KernelServices legacyServices=mainServices.getLegacyServices(modelVersion);
  Assert.assertTrue(legacyServices.isSuccessfulBoot());
  ModelNode legacyModel=legacyServices.readWholeModel();
  Assert.assertFalse(legacyModel.get("subsystem","web","connector").has("http-vs"));
  Assert.assertTrue(mainServices.readWholeModel().get("subsystem","web","connector").hasDefined("http-vs"));
}
