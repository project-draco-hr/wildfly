{
  String subsystemXml=readResource("subsystem.xml");
  ModelVersion modelVersion=ModelVersion.create(1,1,0);
  KernelServicesBuilder builder=createKernelServicesBuilder(null).setSubsystemXml(subsystemXml);
  builder.createLegacyKernelServicesBuilder(null,modelVersion).addMavenResourceURL("org.jboss.as:jboss-as-web:7.1.2.Final").addMavenResourceURL("org.jboss.as:jboss-as-controller:7.1.2.Final").addParentFirstClassPattern("org.jboss.as.controller.*").addChildFirstClassPattern("org.jboss.as.controller.alias.*");
  try {
    builder.build();
    Assert.fail("Expected failure since we have a virtual-servers referenced by connectors");
  }
 catch (  OperationFailedException expected) {
    Assert.assertEquals(WebMessages.MESSAGES.transformationVersion_1_1_0_JBPAPP_9314().getMessage(),expected.getMessage());
  }
}
