{
  ModelNode cacheName=attribute.resolveModelAttribute(context,model);
  ServiceRegistry registry=context.getServiceRegistry(true);
  if (registry.getService(this.serviceName) != null) {
    context.removeService(this.serviceName);
  }
  if ((this.clusterNameServiceName != null) && (registry.getService(this.clusterNameServiceName) != null)) {
    context.removeService(this.clusterNameServiceName);
  }
  ServiceName dependency=cacheName.isDefined() ? CacheFactoryService.getServiceName(cacheName.asString()) : this.defaultServiceName;
  if (dependency != null) {
    ServiceController<?> controller=this.installValueService(context,this.serviceName,CacheFactory.class,dependency);
    if (newControllers != null) {
      newControllers.add(controller);
    }
    if ((this.clusterNameServiceName != null) && cacheName.isDefined()) {
      controller=this.installValueService(context,this.clusterNameServiceName,String.class,ClusteredBackingCacheEntryStoreSourceService.getCacheFactoryClusterNameServiceName(cacheName.asString()));
      if (newControllers != null) {
        newControllers.add(controller);
      }
    }
  }
}
