{
  ROOT_LOGGER.startingCollection();
  Date startTime=new Date();
  String homeDir=getJbossHomeDir();
  if (homeDir == null) {
    ROOT_LOGGER.jbossHomeNotSet();
    throw new OperationFailedException(MESSAGES.jbossHomeNotSet(),new ModelNode().set(MESSAGES.jbossHomeNotSet()));
  }
  String pyLocation=getPythonScriptLocation();
  ROOT_LOGGER.debug("Location of standard JDR scripts: " + pyLocation);
  String locationDir=getReportLocationDir();
  ROOT_LOGGER.debug("locationDir = " + locationDir);
  ROOT_LOGGER.debug("homeDir = " + homeDir);
  String pathToReport="";
  PythonInterpreter interpreter=new PythonInterpreter();
  try {
    SoSReport reporter=new SoSReport(interpreter,pyLocation,homeDir);
    reporter.setUsername(username);
    reporter.setPassword(password);
    reporter.setHostname(host);
    reporter.setPort(port);
    reporter.setHome(homeDir);
    reporter.setTmpDir(locationDir);
    reporter.setCompressionType(CompressionType.ZIP);
    pathToReport=reporter.execute();
  }
 catch (  Throwable t) {
    ROOT_LOGGER.pythonExceptionEncountered(t);
  }
 finally {
    interpreter.cleanup();
  }
  Date endTime=new Date();
  ROOT_LOGGER.endingCollection();
  JdrReport result=new JdrReport();
  result.setStartTime(startTime);
  result.setEndTime(endTime);
  result.setLocation(pathToReport);
  return result;
}
