{
  Headers headers=httpExchange.getRequestHeaders();
  boolean proxied=headers.containsKey(VIA);
  if (proxied || forceCreate) {
    return new DigestContext(nonceFactory,false);
  }
 else {
    DigestContext context=(DigestContext)httpExchange.getAttribute(DigestContext.KEY,HttpExchange.AttributeScope.CONNECTION);
    if (context == null) {
      context=new DigestContext(nonceFactory,USE_CONNECTION_LOCAL_NONCES);
      httpExchange.setAttribute(DigestContext.KEY,context,HttpExchange.AttributeScope.CONNECTION);
    }
    return context;
  }
}
