{
  this.subDeploymentClassLoaders=new HashSet<ClassLoader>(subDeploymentClassLoaders);
  this.additionalBeanDeploymentArchive=new BeanDeploymentArchiveImpl(Collections.<String>emptySet(),BeansXml.EMPTY_BEANS_XML,module,getClass().getName() + ADDITIONAL_CLASSES_BDA_SUFFIX);
  this.beanDeploymentArchives=new HashSet<BeanDeploymentArchiveImpl>(beanDeploymentArchives);
  this.extensions=new HashSet<Metadata<Extension>>(extensions);
  this.serviceRegistry=new SimpleServiceRegistry();
  this.beanDeploymentsByClassName=new HashMap<String,BeanDeploymentArchiveImpl>();
  this.module=module;
  this.serviceRegistry.add(ProxyServices.class,new ProxyServicesImpl(module));
  this.serviceRegistry.add(ResourceLoader.class,new WeldModuleResourceLoader(module));
  for (  BeanDeploymentArchiveImpl bda : beanDeploymentArchives) {
    bda.addBeanDeploymentArchive(additionalBeanDeploymentArchive);
    for (    String className : bda.getBeanClasses()) {
      beanDeploymentsByClassName.put(className,bda);
    }
  }
  additionalBeanDeploymentArchive.addBeanDeploymentArchives(this.beanDeploymentArchives);
}
