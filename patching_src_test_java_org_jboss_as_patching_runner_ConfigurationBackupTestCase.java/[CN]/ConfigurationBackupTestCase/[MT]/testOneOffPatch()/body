{
  String patchID=randomString();
  String layerPatchID=randomString();
  File patchDir=mkdir(tempDir,patchID);
  String moduleName=randomString();
  ContentModification moduleAdded=ContentModificationUtils.addModule(patchDir,layerPatchID,moduleName);
  InstalledIdentity installedIdentity=loadInstalledIdentity();
  final PatchBuilder builder=PatchBuilder.create();
  builder.setPatchId(patchID).setPatchId(patchID).setDescription(randomString()).oneOffPatchIdentity(installedIdentity.getIdentity().getName(),installedIdentity.getIdentity().getVersion(),Constants.NOT_PATCHED).getParent().oneOffPatchElement(layerPatchID,BASE,NOT_PATCHED,false).addContentModification(moduleAdded);
  Patch patch=builder.build();
  checkApplyPatchAndRollbackRestoresBackupConfiguration(patchDir,patch);
}
