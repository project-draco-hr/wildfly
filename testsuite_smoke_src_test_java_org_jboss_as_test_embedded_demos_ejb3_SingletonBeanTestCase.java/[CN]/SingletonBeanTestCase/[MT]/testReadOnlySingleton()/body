{
  Context ctx=new InitialContext();
  ReadOnlySingletonBean readOnlySingletonBean=(ReadOnlySingletonBean)ctx.lookup("java:global/ejb3-singleton-bean-example/" + ReadOnlySingletonBean.class.getSimpleName() + "!"+ ReadOnlySingletonBean.class.getName());
  final int NUM_THREADS=10;
  ExecutorService executor=Executors.newFixedThreadPool(NUM_THREADS);
  Future<String>[] results=new Future[NUM_THREADS];
  for (int i=0; i < NUM_THREADS; i++) {
    results[i]=executor.submit(new ReadOnlySingletonBeanInvoker(readOnlySingletonBean,i));
  }
  for (int i=0; i < NUM_THREADS; i++) {
    String result=results[i].get(10,TimeUnit.SECONDS);
    Assert.assertEquals("Unexpected value from singleton bean",String.valueOf(i),result);
  }
}
