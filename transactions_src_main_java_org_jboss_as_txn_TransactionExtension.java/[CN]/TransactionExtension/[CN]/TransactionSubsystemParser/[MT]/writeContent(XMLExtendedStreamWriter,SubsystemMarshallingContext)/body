{
  context.startSubsystemElement(Namespace.CURRENT.getUriString(),false);
  ModelNode node=context.getModelNode();
  if (hasDefined(node,CONFIGURATION)) {
    List<Property> configurations=node.get(CONFIGURATION).asPropertyList();
    for (    Property config : configurations) {
      if (config.getName().equals(CORE_ENVIRONMENT) && config.getValue().isDefined()) {
        writer.writeStartElement(Element.CORE_ENVIRONMENT.getLocalName());
        final ModelNode core=config.getValue();
        if (hasDefined(core,NODE_IDENTIFIER)) {
          writeAttribute(writer,Attribute.NODE_IDENTIFIER,core.get(NODE_IDENTIFIER));
        }
        if (hasDefined(core,PROCESS_ID)) {
          writeProcessId(writer,core.get(PROCESS_ID));
        }
        writer.writeEndElement();
      }
      if (config.getName().equals(RECOVERY_ENVIRONMENT) && config.getValue().isDefined()) {
        writer.writeStartElement(Element.RECOVERY_ENVIRONMENT.getLocalName());
        final ModelNode env=config.getValue();
        if (hasDefined(env,BINDING)) {
          writeAttribute(writer,Attribute.BINDING,env.get(BINDING));
        }
        if (hasDefined(env,STATUS_BINDING)) {
          writeAttribute(writer,Attribute.STATUS_BINDING,env.get(STATUS_BINDING));
        }
        if (hasDefined(env,RECOVERY_LISTENER)) {
          writeAttribute(writer,Attribute.RECOVERY_LISTENER,env.get(RECOVERY_LISTENER));
        }
        writer.writeEndElement();
      }
      if (config.getName().equals(COORDINATOR_ENVIRONMENT) && config.getValue().isDefined()) {
        writer.writeStartElement(Element.COORDINATOR_ENVIRONMENT.getLocalName());
        final ModelNode env=config.getValue();
        if (hasDefined(env,ENABLE_STATISTICS)) {
          writeAttribute(writer,Attribute.ENABLE_STATISTICS,env.get(ENABLE_STATISTICS));
        }
        if (hasDefined(env,ENABLE_TSM_STATUS)) {
          writeAttribute(writer,Attribute.ENABLE_TSM_STATUS,env.get(ENABLE_TSM_STATUS));
        }
        if (hasDefined(env,DEFAULT_TIMEOUT)) {
          writeAttribute(writer,Attribute.DEFAULT_TIMEOUT,env.get(DEFAULT_TIMEOUT));
        }
        writer.writeEndElement();
      }
      if (config.getName().equals(OBJECT_STORE) && config.getValue().isDefined()) {
        writer.writeStartElement(Element.OBJECT_STORE.getLocalName());
        final ModelNode env=config.getValue();
        if (hasDefined(env,RELATIVE_TO)) {
          writeAttribute(writer,Attribute.RELATIVE_TO,env.get(RELATIVE_TO));
        }
        if (hasDefined(env,PATH)) {
          writeAttribute(writer,Attribute.PATH,env.get(PATH));
        }
        writer.writeEndElement();
      }
    }
  }
  writer.writeEndElement();
}
