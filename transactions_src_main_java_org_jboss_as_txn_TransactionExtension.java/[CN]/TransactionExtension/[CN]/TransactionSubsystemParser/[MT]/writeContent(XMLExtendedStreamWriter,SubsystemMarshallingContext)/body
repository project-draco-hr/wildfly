{
  context.startSubsystemElement(Namespace.CURRENT.getUriString(),false);
  ModelNode node=context.getModelNode();
  if (hasDefined(node,CONFIGURATION)) {
    List<Property> configurations=node.get(CONFIGURATION).asPropertyList();
    for (    Property config : configurations) {
      if (config.getName().equals(CORE_ENVIRONMENT)) {
        writer.writeStartElement(Element.CORE_ENVIRONMENT.getLocalName());
        final ModelNode core=config.getValue();
        CoreEnvironmentAdd.NODE_IDENTIFIER.marshallAsAttribute(core,writer);
        CoreEnvironmentAdd.PATH.marshallAsAttribute(core,writer);
        CoreEnvironmentAdd.RELATIVE_TO.marshallAsAttribute(core,writer);
        writeProcessId(writer,core);
        writer.writeEndElement();
      }
      if (config.getName().equals(RECOVERY_ENVIRONMENT) && config.getValue().isDefined()) {
        writer.writeStartElement(Element.RECOVERY_ENVIRONMENT.getLocalName());
        final ModelNode env=config.getValue();
        if (hasDefined(env,BINDING)) {
          writeAttribute(writer,Attribute.BINDING,env.get(BINDING));
        }
        if (hasDefined(env,STATUS_BINDING)) {
          writeAttribute(writer,Attribute.STATUS_BINDING,env.get(STATUS_BINDING));
        }
        if (hasDefined(env,RECOVERY_LISTENER)) {
          writeAttribute(writer,Attribute.RECOVERY_LISTENER,env.get(RECOVERY_LISTENER));
        }
        writer.writeEndElement();
      }
      if (config.getName().equals(COORDINATOR_ENVIRONMENT)) {
        final ModelNode env=config.getValue();
        if (CoordinatorEnvironmentAdd.ENABLE_STATISTICS.isMarshallable(env) || CoordinatorEnvironmentAdd.ENABLE_TSM_STATUS.isMarshallable(env) || CoordinatorEnvironmentAdd.DEFAULT_TIMEOUT.isMarshallable(env)) {
          writer.writeStartElement(Element.COORDINATOR_ENVIRONMENT.getLocalName());
          CoordinatorEnvironmentAdd.ENABLE_STATISTICS.marshallAsAttribute(env,writer);
          CoordinatorEnvironmentAdd.ENABLE_TSM_STATUS.marshallAsAttribute(env,writer);
          CoordinatorEnvironmentAdd.DEFAULT_TIMEOUT.marshallAsAttribute(env,writer);
          writer.writeEndElement();
        }
      }
      if (config.getName().equals(OBJECT_STORE)) {
        final ModelNode env=config.getValue();
        if (ObjectStoreAdd.RELATIVE_TO.isMarshallable(env) || ObjectStoreAdd.PATH.isMarshallable(env)) {
          writer.writeStartElement(Element.OBJECT_STORE.getLocalName());
          ObjectStoreAdd.PATH.marshallAsAttribute(env,writer);
          ObjectStoreAdd.RELATIVE_TO.marshallAsAttribute(env,writer);
          writer.writeEndElement();
        }
      }
    }
  }
  writer.writeEndElement();
}
