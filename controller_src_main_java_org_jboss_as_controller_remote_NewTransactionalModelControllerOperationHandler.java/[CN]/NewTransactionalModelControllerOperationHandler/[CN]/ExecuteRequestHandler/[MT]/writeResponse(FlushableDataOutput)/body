{
  final CountDownLatch preparedOrFailedLatch=new CountDownLatch(1);
  executorService.execute(new Runnable(){
    @Override public void run(){
      final OperationMessageHandlerProxy messageHandlerProxy=new OperationMessageHandlerProxy(getContext(),executionId);
      final ProxyOperationControlProxy control=new ProxyOperationControlProxy(getContext(),executionId,preparedOrFailedLatch);
      final ModelNode result;
      try {
        result=controller.execute(operation,messageHandlerProxy,control,new OperationAttachmentsProxy(getContext(),executionId,attachmentsLength));
      }
 catch (      Exception e) {
        final ModelNode failure=new ModelNode();
        failure.get(OUTCOME).set(FAILED);
        failure.get(FAILURE_DESCRIPTION).set(e.getClass().getName() + ":" + e.getMessage());
        control.operationFailed(failure);
        return;
      }
      if (result.hasDefined(FAILURE_DESCRIPTION)) {
        control.operationFailed(result);
      }
 else {
        control.operationCompleted(result);
      }
    }
  }
);
  try {
    preparedOrFailedLatch.await();
  }
 catch (  InterruptedException e) {
    Thread.currentThread().interrupt();
    throw new IOException("Thread was interrupted waiting for the operation to prepare/fail");
  }
}
