{
  final CountDownLatch completedLatch=new CountDownLatch(1);
  final OperationTransaction blockingTransaction=new OperationTransaction(){
    @Override public void rollback(){
      transaction.rollback();
      completedLatch.countDown();
    }
    @Override public void commit(){
      transaction.commit();
      completedLatch.countDown();
    }
  }
;
  activeTransactions.put(executionId,blockingTransaction);
  new OperationStatusRequest(executionId,result){
    @Override protected byte getRequestCode(){
      return NewModelControllerProtocol.OPERATION_PREPARED_REQUEST;
    }
  }
.execute(executorService,getChannelStrategy(channel));
  try {
    completedLatch.await();
  }
 catch (  InterruptedException e) {
    Thread.currentThread().interrupt();
    throw new RuntimeException("Interrupted while waiting for Tx commit/rollback");
  }
}
