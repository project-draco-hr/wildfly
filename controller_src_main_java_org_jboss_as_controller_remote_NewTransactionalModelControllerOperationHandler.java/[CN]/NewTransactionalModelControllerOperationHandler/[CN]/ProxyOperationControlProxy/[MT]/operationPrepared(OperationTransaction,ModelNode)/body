{
  try {
    new OperationStatusRequest(batchId,result){
      @Override protected byte getRequestCode(){
        return NewModelControllerProtocol.OPERATION_PREPARED_REQUEST;
      }
      @Override protected void writeRequest(      final int protocolVersion,      final FlushableDataOutput output) throws IOException {
        super.writeRequest(protocolVersion,output);
      }
      @Override protected Void readResponse(      DataInput input) throws IOException {
        ProtocolUtils.expectHeader(input,NewModelControllerProtocol.PARAM_PREPARED);
        preparedOrFailedLatch.countDown();
        byte status=input.readByte();
        if (status == NewModelControllerProtocol.PARAM_COMMIT) {
          transaction.commit();
          txCompletedLatch.countDown();
        }
 else         if (status == NewModelControllerProtocol.PARAM_ROLLBACK) {
          transaction.rollback();
          txCompletedLatch.countDown();
        }
 else {
          throw new IllegalArgumentException("Invalid status code " + status);
        }
        return null;
      }
    }
.executeForResult(executorService,getChannelStrategy(context.getChannel()));
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
}
