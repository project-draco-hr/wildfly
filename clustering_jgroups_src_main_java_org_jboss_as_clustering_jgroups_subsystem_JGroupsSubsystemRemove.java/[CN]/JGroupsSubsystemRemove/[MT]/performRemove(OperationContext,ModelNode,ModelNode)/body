{
  ModelNode removeSubsystem=Util.createOperation(REMOVE,PathAddress.pathAddress(JGroupsExtension.SUBSYSTEM_PATH));
  context.addStep(removeSubsystem,new OriginalSubsystemRemoveHandler(),OperationContext.Stage.MODEL,true);
  if (model.hasDefined(ModelKeys.STACK)) {
    List<Property> stacks=model.get(ModelKeys.STACK).asPropertyList();
    for (    Property stack : stacks) {
      PathAddress address=PathAddress.pathAddress(JGroupsExtension.SUBSYSTEM_PATH).append(ModelKeys.STACK,stack.getName());
      ModelNode removeStack=Util.createOperation(REMOVE,address);
      context.addStep(removeStack,ProtocolStackRemove.INSTANCE,OperationContext.Stage.MODEL,true);
    }
  }
  context.stepCompleted();
}
