{
  final PathAddress opAddress=PathAddress.pathAddress(operation.require(OP_ADDR));
  ModelNode removeSubsystem=Util.createOperation(REMOVE,opAddress);
  context.addStep(removeSubsystem,new OriginalSubsystemRemoveHandler(),OperationContext.Stage.MODEL,true);
  if (model.hasDefined(ModelKeys.STACK)) {
    List<Property> stacks=model.get(ModelKeys.STACK).asPropertyList();
    for (    Property stack : stacks) {
      PathAddress address=opAddress.append(ModelKeys.STACK,stack.getName());
      ModelNode removeStack=Util.createOperation(REMOVE,address);
      context.addStep(removeStack,ProtocolStackRemove.INSTANCE,OperationContext.Stage.MODEL,true);
    }
  }
  context.stepCompleted();
}
