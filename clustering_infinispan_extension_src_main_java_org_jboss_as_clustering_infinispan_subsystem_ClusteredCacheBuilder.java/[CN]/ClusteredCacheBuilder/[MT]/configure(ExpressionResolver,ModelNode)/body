{
  Mode mode=ModelNodes.asEnum(ClusteredCacheResourceDefinition.Attribute.MODE.getDefinition().resolveModelAttribute(resolver,model),Mode.class);
  ClusteringConfigurationBuilder builder=new ConfigurationBuilder().clustering().cacheMode(mode.apply(this.mode));
  if (mode.isSynchronous()) {
    builder.sync().replTimeout(REMOTE_TIMEOUT.getDefinition().resolveModelAttribute(resolver,model).asLong());
  }
 else {
    int queueSize=QUEUE_SIZE.getDefinition().resolveModelAttribute(resolver,model).asInt();
    builder.async().asyncMarshalling(ASYNC_MARSHALLING.getDefinition().resolveModelAttribute(resolver,model).asBoolean()).useReplQueue(queueSize > 0).replQueueInterval(QUEUE_FLUSH_INTERVAL.getDefinition().resolveModelAttribute(resolver,model).asLong()).replQueueMaxElements(queueSize);
  }
  this.clustering=builder.create();
  return super.configure(resolver,model);
}
