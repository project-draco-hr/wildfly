{
  final ServiceTarget serviceTarget=context.getServiceTarget();
  final ServiceController<?> resourceAdaptersService=context.getServiceRegistry(false).getService(ConnectorServices.RESOURCEADAPTERS_SERVICE);
  ServiceController<?> controller=null;
  if (resourceAdaptersService == null) {
    controller=serviceTarget.addService(ConnectorServices.RESOURCEADAPTERS_SERVICE,new ResourceAdaptersService()).setInitialMode(ServiceController.Mode.ACTIVE).addListener(verificationHandler).install();
  }
  ServiceName raServiceName=ServiceName.of(ConnectorServices.RA_SERVICE,name);
  String bootStrapCtxName=DEFAULT_NAME;
  if (resourceAdapter.getBootstrapContext() != null && !resourceAdapter.getBootstrapContext().equals("undefined")) {
    bootStrapCtxName=resourceAdapter.getBootstrapContext();
  }
  final ServiceController<?> service=context.getServiceRegistry(true).getService(raServiceName);
  if (service == null) {
    ResourceAdapterService raService=new ResourceAdapterService(resourceAdapter);
    serviceTarget.addService(raServiceName,raService).setInitialMode(ServiceController.Mode.ACTIVE).addDependency(ConnectorServices.RESOURCEADAPTERS_SERVICE,ResourceAdaptersService.ModifiableResourceAdaptors.class,raService.getResourceAdaptersInjector()).addDependency(ConnectorServices.BOOTSTRAP_CONTEXT_SERVICE.append(bootStrapCtxName)).addListener(verificationHandler).install();
  }
  return raServiceName;
}
