{
  ElementNode config=new ElementNode(null,"config",SubsystemsParser.NAMESPACE);
  for (  String profile : profiles) {
    ElementNode subsystems=new ElementNode(config,"subsystems");
    if (!profile.isEmpty()) {
      subsystems.addAttribute("name",new AttributeValue(profile));
    }
    config.addChild(subsystems);
    for (    SubsystemConfig sub : configs) {
      ElementNode subsystem=new ElementNode(config,"subsystem");
      if (sub.getSupplement() != null) {
        subsystem.addAttribute("supplement",new AttributeValue(sub.getSupplement()));
      }
      subsystem.addChild(new TextNode(filePrefix + sub.getSubsystem() + ".xml"));
      subsystems.addChild(subsystem);
    }
  }
  Writer writer=new FileWriter(outputFile);
  try {
    XMLOutputFactory factory=XMLOutputFactory.newInstance();
    XMLStreamWriter xmlwriter=new FormattingXMLStreamWriter(factory.createXMLStreamWriter(writer));
    config.marshall(xmlwriter);
  }
  finally {
    writer.close();
  }
}
