{
  try {
    final BatchBuilder builder=updateContext.getBatchBuilder();
    final ConsoleHandlerService service=new ConsoleHandlerService();
    final BatchServiceBuilder<Handler> serviceBuilder=builder.addService(LogServices.handlerName(getName()),service);
    service.setLevel(Level.parse(getLevelName()));
    final Boolean autoFlush=getAutoflush();
    if (autoFlush != null)     service.setAutoflush(autoFlush.booleanValue());
    try {
      service.setEncoding(getEncoding());
    }
 catch (    UnsupportedEncodingException e) {
      handler.handleFailure(e,param);
      return;
    }
    service.setFormatterSpec(getFormatter());
    serviceBuilder.setInitialMode(ServiceController.Mode.ACTIVE);
    serviceBuilder.addListener(new UpdateResultHandler.ServiceStartListener<P>(handler,param));
  }
 catch (  Throwable t) {
    handler.handleFailure(t,param);
    return;
  }
}
