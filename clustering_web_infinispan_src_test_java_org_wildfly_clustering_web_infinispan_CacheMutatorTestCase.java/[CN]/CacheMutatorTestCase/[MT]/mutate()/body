{
  @SuppressWarnings("unchecked") AdvancedCache<Object,Object> cache=mock(AdvancedCache.class);
  Object id=new Object();
  Object value=new Object();
  Mutator mutator=new CacheMutator<Object,Object>(cache,new SimpleCacheInvoker(),id,value);
  when(cache.getAdvancedCache()).thenReturn(cache);
  when(cache.withFlags(Flag.IGNORE_RETURN_VALUES)).thenReturn(cache);
  mutator.mutate();
  verify(cache).replace(same(id),same(value));
  mutator.mutate();
  verify(cache,atMost(1)).replace(same(id),same(value));
}
