{
  for (  Callback current : callbacks) {
    if (current instanceof NameCallback) {
      NameCallback ncb=(NameCallback)current;
      String userName=ncb.getDefaultName();
      if ((allowAll || allowedUsersSet.contains(userName)) == false) {
        throw MESSAGES.invalidLocalUser(userName);
      }
    }
 else     if (current instanceof AuthorizeCallback) {
      AuthorizeCallback acb=(AuthorizeCallback)current;
      acb.setAuthorized(acb.getAuthenticationID().equals(acb.getAuthorizationID()));
    }
 else {
      throw new UnsupportedCallbackException(current);
    }
  }
}
