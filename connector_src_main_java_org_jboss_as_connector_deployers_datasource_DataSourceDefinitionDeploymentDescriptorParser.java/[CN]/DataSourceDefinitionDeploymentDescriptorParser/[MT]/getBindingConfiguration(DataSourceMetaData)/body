{
  String name=dataSource.getName();
  if (name == null || name.isEmpty()) {
    throw MESSAGES.elementAttributeMissing("<data-source>","name");
  }
  if (!name.startsWith("java:")) {
    name="java:comp/env/" + name;
  }
  final String className=dataSource.getClassName();
  if (className == null || className.equals(Object.class.getName())) {
    throw MESSAGES.elementAttributeMissing("<data-source>","className");
  }
  final String[] properties;
  if (dataSource.getProperties() == null) {
    properties=EMPTY_STRING_ARRAY;
  }
 else {
    properties=new String[dataSource.getProperties().size()];
    final Iterator<PropertyMetaData> it=dataSource.getProperties().iterator();
    for (int i=0; i < properties.length; ++i) {
      final PropertyMetaData prop=it.next();
      properties[i]=prop.getName() + "=" + prop.getValue();
    }
  }
  final DirectDataSourceInjectionSource directDataSourceInjectionSource=new DirectDataSourceInjectionSource(name);
  directDataSourceInjectionSource.setClassName(className);
  directDataSourceInjectionSource.setDatabaseName(dataSource.getDatabaseName());
  if (dataSource.getDescriptions() != null) {
    directDataSourceInjectionSource.setDescription(dataSource.getDescriptions().toString());
  }
  directDataSourceInjectionSource.setInitialPoolSize(dataSource.getInitialPoolSize());
  if (dataSource.getIsolationLevel() != null) {
    directDataSourceInjectionSource.setIsolationLevel(dataSource.getIsolationLevel().ordinal());
  }
  directDataSourceInjectionSource.setLoginTimeout(dataSource.getLoginTimeout());
  directDataSourceInjectionSource.setMaxIdleTime(dataSource.getMaxIdleTime());
  directDataSourceInjectionSource.setMaxStatements(dataSource.getMaxStatements());
  directDataSourceInjectionSource.setMaxPoolSize(dataSource.getMaxPoolSize());
  directDataSourceInjectionSource.setMinPoolSize(dataSource.getMinPoolSize());
  directDataSourceInjectionSource.setInitialPoolSize(dataSource.getInitialPoolSize());
  directDataSourceInjectionSource.setPassword(dataSource.getPassword());
  directDataSourceInjectionSource.setPortNumber(dataSource.getPortNumber());
  directDataSourceInjectionSource.setProperties(properties);
  directDataSourceInjectionSource.setServerName(dataSource.getServerName());
  directDataSourceInjectionSource.setTransactional(dataSource.getTransactional());
  directDataSourceInjectionSource.setUrl(dataSource.getUrl());
  directDataSourceInjectionSource.setUser(dataSource.getUser());
  final BindingConfiguration bindingDescription=new BindingConfiguration(name,directDataSourceInjectionSource);
  return bindingDescription;
}
