{
  final ModelControllerClient client=ModelControllerClient.Factory.create("localhost",9999);
  try {
    final ModelNode domainOp=new ModelNode();
    domainOp.get(OP).set(READ_RESOURCE_OPERATION);
    domainOp.get(OP_ADDR).setEmptyList();
    domainOp.get(RECURSIVE).set(true);
    ModelNode result=client.execute(domainOp);
    if (!SUCCESS.equals(result.get(OUTCOME).asString())) {
      throw new OperationFailedException(result.get(FAILURE_DESCRIPTION));
    }
    System.out.println("-- domain configuration");
    final ModelNode domainResult=result.get(RESULT).clone();
    domainResult.remove(HOST);
    System.out.println(domainResult);
    System.out.println("--");
    final ModelNode hostOp=new ModelNode();
    hostOp.get(OP).get(READ_RESOURCE_OPERATION);
    hostOp.get(OP_ADDR).setEmptyList().add(HOST,"local");
    hostOp.get(RECURSIVE).set(true);
    result=client.execute(hostOp);
    if (!SUCCESS.equals(result.get(OUTCOME).asString())) {
      throw new OperationFailedException(result.get(FAILURE_DESCRIPTION));
    }
    System.out.println("-- host configuration");
    final ModelNode hostResult=result.get(RESULT).clone();
    hostResult.remove(SERVER);
    System.out.println();
    System.out.println("--");
  }
  finally {
    StreamUtils.safeClose(client);
  }
}
