{
  boolean restartRequired=false;
  boolean applyToRuntime=context.isNormalServer();
  ModelNode resolvedValue=null;
  if (applyToRuntime) {
    validateResolvedValue(attributeName,newValue);
    resolvedValue=newValue.resolve();
    restartRequired=applyUpdateToRuntime(context,operation,attributeName,resolvedValue,currentValue);
    if (restartRequired) {
      context.reloadRequired();
    }
  }
  if (context.completeStep() != OperationContext.ResultAction.KEEP && applyToRuntime) {
    ModelNode valueToRestore=currentValue.resolve();
    try {
      revertUpdateToRuntime(context,operation,attributeName,valueToRestore,resolvedValue);
    }
 catch (    Exception e) {
      ServerLogger.ROOT_LOGGER.caughtExceptionRevertingOperation(e,getClass().getSimpleName(),operation.require(ModelDescriptionConstants.OP).asString(),PathAddress.pathAddress(operation.require(ModelDescriptionConstants.OP_ADDR)));
    }
    if (restartRequired) {
      context.revertReloadRequired();
    }
  }
}
