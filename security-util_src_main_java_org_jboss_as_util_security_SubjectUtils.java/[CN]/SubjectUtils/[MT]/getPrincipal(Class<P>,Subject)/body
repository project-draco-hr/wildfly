{
  for (  Principal principal : subject.getPrincipals()) {
    if (type.isInstance(principal)) {
      return type.cast(principal);
    }
  }
  return null;
}
