{
  ServiceController<?> controller=context.getController();
  ServiceContainer serviceContainer=controller.getServiceContainer();
  ServiceController<?> frameworkController=serviceContainer.getService(FrameworkService.SERVICE_NAME);
  frameworkController.setMode(Mode.IMMEDIATE);
  log.debugf("Installing deployment: %s",deployment);
  try {
    boolean autoStart=deployment.isAutoStart();
    deployment.setAutoStart(false);
    Bundle bundle=getDeployerService().deploy(deployment);
    deployment.addAttachment(Bundle.class,bundle);
    deployment.setAutoStart(autoStart);
  }
 catch (  Throwable t) {
    throw new StartException("Failed to install deployment: " + deployment,t);
  }
}
