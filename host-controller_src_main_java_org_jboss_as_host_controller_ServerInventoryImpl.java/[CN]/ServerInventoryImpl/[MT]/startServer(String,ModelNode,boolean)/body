{
  if (shutdown || connectionFinished) {
    throw HostControllerMessages.MESSAGES.hostAlreadyShutdown();
  }
  ManagedServer server=servers.get(serverName);
  if (server == null) {
    final byte[] authKey=new byte[16];
    new Random(new SecureRandom().nextLong()).nextBytes(authKey);
    final ManagedServer newServer=createManagedServer(serverName,authKey);
    server=servers.putIfAbsent(serverName,newServer);
    if (server == null) {
      server=newServer;
    }
  }
  server.start(createBootFactory(serverName,domainModel));
synchronized (shutdownCondition) {
    shutdownCondition.notifyAll();
  }
  if (blocking) {
    server.awaitState(ManagedServer.InternalState.SERVER_STARTED);
  }
 else {
    server.awaitState(ManagedServer.InternalState.SERVER_STARTING);
  }
  return server.getState();
}
