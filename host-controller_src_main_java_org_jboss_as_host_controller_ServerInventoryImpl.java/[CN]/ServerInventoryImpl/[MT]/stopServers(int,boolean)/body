{
  for (  final ManagedServer server : servers.values()) {
    server.stop();
  }
  if (blockUntilStopped) {
synchronized (shutdownCondition) {
      for (; ; ) {
        if (connectionFinished) {
          break;
        }
        int count=0;
        for (        final ManagedServer server : servers.values()) {
          final ServerStatus state=server.getState();
switch (state) {
case DISABLED:
case FAILED:
case STOPPED:
            break;
default :
          count++;
      }
    }
    if (count == 0) {
      break;
    }
    try {
      shutdownCondition.wait();
    }
 catch (    InterruptedException e) {
      Thread.currentThread().interrupt();
      break;
    }
  }
}
}
}
