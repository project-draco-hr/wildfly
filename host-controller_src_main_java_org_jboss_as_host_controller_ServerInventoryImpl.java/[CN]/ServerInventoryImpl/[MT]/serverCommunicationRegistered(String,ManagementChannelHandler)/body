{
  if (shutdown || connectionFinished) {
    throw HostControllerMessages.MESSAGES.hostAlreadyShutdown();
  }
  final String serverName=ManagedServer.getServerName(serverProcessName);
  final ManagedServer server=servers.get(serverName);
  if (server == null) {
    ROOT_LOGGER.noServerAvailable(serverName);
    return null;
  }
  try {
    final TransactionalProtocolClient client=server.channelRegistered(channelAssociation);
    final Channel channel=channelAssociation.getChannel();
    channel.addCloseHandler(new CloseHandler<Channel>(){
      public void handleClose(      final Channel closed,      final IOException exception){
        final boolean shuttingDown=shutdown || connectionFinished;
        if (server.callbackUnregistered(client,shuttingDown)) {
          domainController.unregisterRunningServer(server.getServerName());
        }
      }
    }
);
    return server.getProxyController();
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
