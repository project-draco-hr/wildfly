{
  Set<RealmUser> users=subject.getPrincipals(RealmUser.class);
  Set<Principal> principals=subject.getPrincipals();
  try {
    dirContext=getSearchContext();
    for (    RealmUser current : users) {
      principals.addAll(loadGroups(current));
    }
  }
 catch (  Exception e) {
    if (e instanceof IOException) {
      throw (IOException)e;
    }
    throw new IOException(e);
  }
 finally {
    safeClose(dirContext);
    dirContext=null;
  }
}
