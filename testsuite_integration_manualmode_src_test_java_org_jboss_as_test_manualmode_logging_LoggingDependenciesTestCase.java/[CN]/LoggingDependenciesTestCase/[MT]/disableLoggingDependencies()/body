{
  final ModelControllerClient client=TestSuiteEnvironment.getModelControllerClient();
  final ManagementClient managementClient=new ManagementClient(client,TestSuiteEnvironment.getServerAddress(),TestSuiteEnvironment.getServerPort(),"http-remoting");
  Assert.assertTrue("Container is not started",managementClient.isServerInRunningState());
  try {
    deployer.deploy(DEPLOYMENT);
    deployer.undeploy(DEPLOYMENT);
  }
 catch (  Exception ex) {
    safeClose(managementClient);
    safeClose(client);
    Assert.fail("Exception caught while deploying the application with dependency on log4j module.");
  }
  try {
    ModelNode op=Operations.createWriteAttributeOperation(LOGGING_SUBSYSTEM,API_DEPENDENCIES,false);
    validateResponse(op,client);
    container.stop(CONTAINER);
    container.start(CONTAINER);
    deployer.deploy(DEPLOYMENT);
  }
  finally {
    safeClose(managementClient);
    safeClose(client);
  }
}
