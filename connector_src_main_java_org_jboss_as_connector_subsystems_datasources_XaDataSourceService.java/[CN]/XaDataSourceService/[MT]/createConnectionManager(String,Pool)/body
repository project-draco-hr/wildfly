{
  Integer allocationRetry=null;
  Long allocationRetryWaitMillis=null;
  Boolean interleaving=null;
  Integer xaResourceTimeout=null;
  Boolean isSameRMOverride=null;
  Boolean wrapXAResource=null;
  Boolean padXid=null;
  if (dataSourceConfig.getTimeOut() != null) {
    allocationRetry=dataSourceConfig.getTimeOut().getAllocationRetry();
    allocationRetryWaitMillis=dataSourceConfig.getTimeOut().getAllocationRetryWaitMillis();
    xaResourceTimeout=dataSourceConfig.getTimeOut().getXaResourceTimeout();
  }
  if (dataSourceConfig.getXaPool() != null) {
    interleaving=dataSourceConfig.getXaPool().isInterleaving();
    isSameRMOverride=dataSourceConfig.getXaPool().isSameRmOverride();
    wrapXAResource=dataSourceConfig.getXaPool().isWrapXaDataSource();
    padXid=dataSourceConfig.getXaPool().isPadXid();
  }
  String securityDomain=dataSourceConfig.getSecurity() != null ? dataSourceConfig.getSecurity().getSecurityDomain() : null;
  TransactionSupport.TransactionSupportLevel tsl=TransactionSupport.TransactionSupportLevel.XATransaction;
  ConnectionManagerFactory cmf=new ConnectionManagerFactory();
  ConnectionManager cm=cmf.createTransactional(tsl,pool,null,securityDomain,allocationRetry,allocationRetryWaitMillis,getTransactionIntegration(),interleaving,xaResourceTimeout,isSameRMOverride,wrapXAResource,padXid);
  cm.setJndiName(jndiName);
  return cm;
}
