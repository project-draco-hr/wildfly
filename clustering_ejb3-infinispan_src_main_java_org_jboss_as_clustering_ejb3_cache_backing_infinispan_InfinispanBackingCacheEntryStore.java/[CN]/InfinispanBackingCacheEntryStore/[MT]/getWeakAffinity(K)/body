{
  if (this.registry == null)   return Affinity.NONE;
  Map.Entry<String,?> entry=null;
  Address location=this.locatePrimaryOwner(key);
  if ((location != null) && (this.nodeFactory != null)) {
    Node node=this.nodeFactory.createNode(location);
    entry=this.registry.getEntry(node);
  }
  if (entry == null) {
    entry=this.registry.getLocalEntry();
  }
  return (entry != null) ? new NodeAffinity(entry.getKey()) : Affinity.NONE;
}
