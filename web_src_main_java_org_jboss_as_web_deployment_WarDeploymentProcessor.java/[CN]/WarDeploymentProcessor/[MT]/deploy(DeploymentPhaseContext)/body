{
  final DeploymentUnit deploymentUnit=phaseContext.getDeploymentUnit();
  final WarMetaData metaData=deploymentUnit.getAttachment(WarMetaData.ATTACHMENT_KEY);
  if (metaData == null) {
    return;
  }
  Collection<String> hostNames=null;
  if (metaData.getMergedJBossWebMetaData() != null) {
    hostNames=metaData.getMergedJBossWebMetaData().getVirtualHosts();
  }
  if (hostNames == null || hostNames.isEmpty()) {
    hostNames=Collections.singleton(defaultHost);
  }
  String hostName=hostNames.iterator().next();
  if (hostName == null) {
    throw new IllegalStateException("null host name");
  }
  processDeployment(hostName,metaData,deploymentUnit,phaseContext.getServiceTarget());
}
