{
  this.assertTimerState();
  boolean startedInTx=timerState == TimerState.CREATED;
  if (timerState != TimerState.EXPIRED) {
    setTimerState(TimerState.CANCELED);
  }
  if (timerService.transactionActive() && !startedInTx) {
    final Transaction currentTx=this.timerService.getTransaction();
    this.registerTimerCancellationWithTx(currentTx);
  }
 else {
    this.cancelTimeout();
  }
  timerService.persistTimer(this);
}
