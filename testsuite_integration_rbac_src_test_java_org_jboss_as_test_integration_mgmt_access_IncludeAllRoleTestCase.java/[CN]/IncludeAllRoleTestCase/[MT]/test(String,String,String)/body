{
  ModelControllerClient mgmtClient=getManagementClient().getControllerClient();
  ModelControllerClient newUserClient=getClientForUser(userName);
  for (  String role : RbacUtil.allStandardRoles()) {
    assertIsCallerInRole(newUserClient,role,defaultRole.equals(role));
  }
  removeClientForUser(userName);
  setRoleMappingIncludeAll(mgmtClient,additionalRole,true);
  newUserClient=getClientForUser(userName);
  for (  String role : RbacUtil.allStandardRoles()) {
    assertIsCallerInRole(newUserClient,role,defaultRole.equals(role) || additionalRole.equals(role));
  }
  removeClientForUser(userName);
  setRoleMappingIncludeAll(mgmtClient,additionalRole,false);
  newUserClient=getClientForUser(userName);
  for (  String role : RbacUtil.allStandardRoles()) {
    assertIsCallerInRole(newUserClient,role,defaultRole.equals(role));
  }
  removeClientForUser(userName);
}
