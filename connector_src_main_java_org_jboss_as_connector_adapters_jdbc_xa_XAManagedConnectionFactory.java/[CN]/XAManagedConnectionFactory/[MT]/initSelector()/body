{
  if (urlProperty != null && urlProperty.length() > 0) {
    String urlsStr=xaProps.getProperty(urlProperty);
    if (urlsStr != null && urlsStr.trim().length() > 0 && urlDelimiter != null && urlDelimiter.trim().length() > 0) {
      List<XAData> xaDataList=new ArrayList<XAData>(2);
      Properties xaPropsCopy=new Properties();
      for (Iterator<?> i=xaProps.keySet().iterator(); i.hasNext(); ) {
        Object key=i.next();
        xaPropsCopy.put(key,xaProps.get(key));
      }
      int urlStart=0;
      int urlEnd=urlsStr.indexOf(urlDelimiter);
      while (urlEnd > 0) {
        String url=urlsStr.substring(urlStart,urlEnd);
        xaPropsCopy.setProperty(urlProperty,url);
        XADataSource xads=createXaDataSource(xaPropsCopy);
        xaDataList.add(new XAData(xads,url));
        urlStart=++urlEnd;
        urlEnd=urlsStr.indexOf(urlDelimiter,urlEnd);
        log.debug("added XA HA connection url: " + url);
      }
      if (urlStart != urlsStr.length()) {
        String url=urlsStr.substring(urlStart,urlsStr.length());
        xaPropsCopy.setProperty(urlProperty,url);
        XADataSource xads=createXaDataSource(xaPropsCopy);
        xaDataList.add(new XAData(xads,url));
        log.debug("added XA HA connection url: " + url);
      }
      if (getUrlSelectorStrategyClassName() == null) {
        xadsSelector=new XADataSelector(xaDataList);
        log.debug("Default URLSelectorStrategy is being used : " + xadsSelector);
      }
 else {
        xadsSelector=(URLSelectorStrategy)loadClass(getUrlSelectorStrategyClassName(),xaDataList);
        log.debug("Customized URLSelectorStrategy is being used : " + xadsSelector);
      }
    }
  }
}
