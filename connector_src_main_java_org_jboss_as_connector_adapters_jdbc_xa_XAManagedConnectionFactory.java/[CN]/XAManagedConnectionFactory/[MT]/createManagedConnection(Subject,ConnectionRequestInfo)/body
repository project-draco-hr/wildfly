{
  if (xadsSelector == null) {
    return getXAManagedConnection(subject,cri);
  }
  for (int i=0; i < xadsSelector.getCustomSortedUrls().size(); ++i) {
    XAData xaData=(XAData)xadsSelector.getUrlObject();
    if (log.isTraceEnabled())     log.trace("Trying to create an XA connection to " + xaData.url);
    try {
      return getXAManagedConnection(subject,cri);
    }
 catch (    ResourceException e) {
      log.warn("Failed to create an XA connection to " + xaData.url + ": "+ e.getMessage());
      xadsSelector.failedUrlObject(xaData);
    }
  }
  throw new ResourceException("Could not create connection using any of the URLs: " + xadsSelector.getAllUrlObjects());
}
