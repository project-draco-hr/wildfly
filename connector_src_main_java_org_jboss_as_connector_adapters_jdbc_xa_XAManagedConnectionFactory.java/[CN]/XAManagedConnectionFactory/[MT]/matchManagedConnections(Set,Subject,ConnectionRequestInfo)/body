{
  Properties newProps=getConnectionProperties(subject,cri);
  for (Iterator<?> i=mcs.iterator(); i.hasNext(); ) {
    Object o=i.next();
    if (o instanceof XAManagedConnection) {
      XAManagedConnection mc=(XAManagedConnection)o;
      if (mc.getProperties().equals(newProps)) {
        if ((getValidateOnMatch() && mc.checkValid()) || !getValidateOnMatch()) {
          return mc;
        }
      }
    }
  }
  return null;
}
