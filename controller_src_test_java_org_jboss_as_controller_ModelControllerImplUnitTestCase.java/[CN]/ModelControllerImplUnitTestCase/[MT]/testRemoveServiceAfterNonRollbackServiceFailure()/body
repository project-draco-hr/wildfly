{
  ModelNode operation=getOperation("bad-service",CHILD_ONE,"attribute1",5);
  operation.get(OPERATION_HEADERS,ROLLBACK_ON_RUNTIME_FAILURE).set(false);
  ModelNode result=controller.execute(operation,null,null,null);
  assertEquals(FAILED,result.get(OUTCOME).asString());
  assertTrue(result.hasDefined(FAILURE_DESCRIPTION));
  ServiceController<?> sc=container.getService(ServiceName.JBOSS.append("bad-service"));
  assertNotNull(sc);
  assertEquals(ServiceController.State.START_FAILED,sc.getState());
  result=controller.execute(getOperation("read-attribute",CHILD_ONE,"attribute1",1),null,null,null);
  assertEquals("success",result.get("outcome").asString());
  assertEquals(5,result.get("result").asInt());
  result=controller.execute(getOperation("remove-bad-service",CHILD_ONE,"attribute1",6),null,null,null);
  assertEquals(SUCCESS,result.get(OUTCOME).asString());
  sc=container.getService(ServiceName.JBOSS.append("bad-service"));
  if (sc != null) {
    assertEquals(ServiceController.Mode.REMOVE,sc.getMode());
  }
  operation=getOperation("read-attribute",CHILD_ONE,"attribute1",1);
  result=controller.execute(operation,null,null,null);
  assertEquals(FAILED,result.get(OUTCOME).asString());
}
