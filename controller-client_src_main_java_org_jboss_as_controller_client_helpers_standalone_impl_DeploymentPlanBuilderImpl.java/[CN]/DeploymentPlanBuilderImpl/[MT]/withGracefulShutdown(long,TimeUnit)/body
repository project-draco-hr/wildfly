{
  if (deploymentActions.size() > 0) {
    cleanup();
    throw ControllerClientLogger.ROOT_LOGGER.operationsNotAllowed(InitialDeploymentPlanBuilder.class.getSimpleName());
  }
  if (globalRollback) {
    cleanup();
    throw ControllerClientLogger.ROOT_LOGGER.globalRollbackNotCompatible();
  }
  long period=timeUnit.toMillis(timeout);
  if (shutdown && period != gracefulShutdownPeriod) {
    cleanup();
    throw ControllerClientLogger.ROOT_LOGGER.gracefulShutdownAlreadyConfigured(gracefulShutdownPeriod);
  }
  return new DeploymentPlanBuilderImpl(this,period);
}
