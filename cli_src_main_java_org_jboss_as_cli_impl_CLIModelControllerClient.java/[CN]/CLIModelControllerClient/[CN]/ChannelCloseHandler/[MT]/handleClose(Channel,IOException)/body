{
  if (CLIModelControllerClient.this.closed) {
    return;
  }
synchronized (lock) {
    if (strategy != null) {
      if (strategy != originalStrategy) {
        new Exception("Channel close handler " + strategy + " "+ originalStrategy).printStackTrace();
      }
      strategy=null;
      closeHandler.handleClose();
    }
    channelAssociation.handleChannelClosed(closed,exception);
    lock.notifyAll();
  }
  closed.getConnection().addCloseHandler(new CloseHandler<Connection>(){
    @Override public void handleClose(    Connection closed,    IOException exception){
      StreamUtils.safeClose(originalStrategy);
    }
  }
);
}
