{
  try {
    final Module module=deploymentUnitContext.getAttachment(Attachments.MODULE);
    ClassLoader moduleClassLoader=null;
    if (moduleName == null) {
      if (context.getLoader() == null || context.getLoader().getClassLoader() == null) {
        moduleClassLoader=module.getClassLoader();
      }
 else {
        moduleClassLoader=context.getLoader().getClassLoader();
      }
    }
 else {
      moduleClassLoader=module.getModule(ModuleIdentifier.create(moduleName)).getClassLoader();
    }
    Object instance=moduleClassLoader.loadClass(className).newInstance();
    if (params != null) {
      for (      ParamValueMetaData param : params) {
        IntrospectionUtils.setProperty(instance,param.getParamName(),param.getParamValue());
      }
    }
    return instance;
  }
 catch (  Throwable t) {
    WebLogger.WEB_LOGGER.componentInstanceCreationFailed(className,t);
    ok=false;
  }
  return null;
}
