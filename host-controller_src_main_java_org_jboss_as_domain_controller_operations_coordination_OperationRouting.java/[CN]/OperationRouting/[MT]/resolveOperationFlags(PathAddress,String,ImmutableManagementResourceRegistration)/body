{
  Set<OperationEntry.Flag> result=null;
  boolean validAddress=false;
  ImmutableManagementResourceRegistration targetReg=rootRegistration.getSubModel(address);
  if (targetReg != null) {
    validAddress=true;
    OperationEntry opE=targetReg.getOperationEntry(PathAddress.EMPTY_ADDRESS,operationName);
    result=opE == null ? null : opE.getFlags();
  }
  if (result == null && address.size() > 0) {
    PathElement pe=address.getLastElement();
    if (pe.isWildcard()) {
      String type=pe.getKey();
      PathAddress parent=address.subAddress(0,address.size() - 1);
      Set<PathElement> children=rootRegistration.getChildAddresses(parent);
      if (children != null) {
        Set<OperationEntry.Flag> found=null;
        for (        PathElement child : children) {
          if (type.equals(child.getKey())) {
            validAddress=true;
            OperationEntry oe=rootRegistration.getOperationEntry(parent.append(child),operationName);
            Set<OperationEntry.Flag> flags=oe == null ? null : oe.getFlags();
            if (flags == null || (found != null && !found.equals(flags))) {
              found=null;
              validAddress=false;
              break;
            }
            found=flags;
          }
        }
        result=found;
      }
    }
  }
  if (result == null) {
    if (validAddress) {
      throw new OperationFailedException(new ModelNode(ControllerLogger.ROOT_LOGGER.noHandlerForOperation(operationName,address)));
    }
 else {
      throw new OperationFailedException(new ModelNode(ControllerLogger.ROOT_LOGGER.noSuchResourceType(address)));
    }
  }
  return result;
}
