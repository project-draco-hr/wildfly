{
  final Set<String> groupNames=new TreeSet<String>();
  final Map<String,Set<HostServer>> groupToServerMap=new HashMap<String,Set<HostServer>>();
  for (  Map.Entry<ServerIdentity,ModelNode> entry : domainOperationContext.getServerResults().entrySet()) {
    final String serverGroup=entry.getKey().getServerGroupName();
    groupNames.add(serverGroup);
    final String hostName=entry.getKey().getHostName();
    final String serverName=entry.getKey().getServerName();
    if (!groupToServerMap.containsKey(serverGroup)) {
      groupToServerMap.put(serverGroup,new TreeSet<HostServer>());
    }
    groupToServerMap.get(serverGroup).add(new HostServer(hostName,serverName,entry.getValue()));
  }
  boolean serverGroupSuccess=false;
  for (  String groupName : groupNames) {
    final ModelNode groupNode=new ModelNode();
    if (domainOperationContext.isServerGroupRollback(groupName)) {
    }
 else {
      serverGroupSuccess=true;
    }
    for (    HostServer hostServer : groupToServerMap.get(groupName)) {
      groupNode.get(HOST,hostServer.hostName,hostServer.serverName,RESPONSE).set(hostServer.result);
    }
    context.getServerResults().get(groupName).set(groupNode);
  }
  if (!serverGroupSuccess) {
    context.getFailureDescription().set(MESSAGES.operationFailedOrRolledBack());
  }
}
