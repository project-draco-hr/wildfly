{
  try {
    ServiceName deploymentServiceName=DeploymentService.getServiceName(deploymentName);
    @SuppressWarnings("unchecked") final ServiceController<DeploymentService> controller=(ServiceController<DeploymentService>)serviceContainer.getService(deploymentServiceName);
    if (controller != null && controller.getMode() != ServiceController.Mode.REMOVE) {
      RedeploymentServiceTracker tracker=new RedeploymentServiceTracker(deploymentName);
      controller.addListener(tracker);
synchronized (tracker) {
        controller.setMode(ServiceController.Mode.REMOVE);
        try {
          tracker.wait();
        }
 catch (        InterruptedException e) {
          Thread.currentThread().interrupt();
          if (resultHandler != null) {
            resultHandler.handleFailure(e,param);
            return;
          }
        }
      }
    }
    deploy(deploymentName,runtimeName,deploymentHash,serviceContainer,resultHandler,param);
  }
 catch (  RuntimeException e) {
    if (resultHandler != null) {
      resultHandler.handleFailure(e,param);
    }
  }
}
