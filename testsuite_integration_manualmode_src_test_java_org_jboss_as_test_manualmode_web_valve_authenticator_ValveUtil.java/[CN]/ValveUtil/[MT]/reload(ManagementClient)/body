{
  ModelNode operation=new ModelNode();
  operation.get(OP).set("reload");
  try {
    applyUpdate(managementClient,operation);
  }
 catch (  Exception e) {
    log.error("Exception applying reload operation. This is probably fine, as the server probably shut down before the response was sent",e);
  }
  boolean reloaded=false;
  int i=0;
  while (!reloaded) {
    try {
      Thread.sleep(2000);
      if (managementClient.isServerInRunningState()) {
        reloaded=true;
      }
    }
 catch (    Throwable t) {
    }
 finally {
      if (!reloaded && i++ > 20) {
        throw new Exception("Server reloading failed");
      }
    }
  }
}
