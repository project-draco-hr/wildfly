{
  JChannel channel=new JChannel(this);
  TP transport=channel.getProtocolStack().getTransport();
  if (transport.isSingleton()) {
synchronized (transport) {
      this.init(transport);
    }
  }
 else {
    this.init(transport);
  }
  String address=transport.getBindAddressAsInetAddress().toString();
  int index=address.indexOf("/");
  channel.setName(InetSocketAddress.createUnresolved((index > 0) ? address.substring(0,index) : address.substring(1),transport.getBindPort()).toString());
  MBeanServer server=this.configuration.getMBeanServer();
  if (server != null) {
    try {
      this.channels.put(channel,id);
      JmxConfigurator.registerChannel(channel,server,id);
    }
 catch (    Exception e) {
      log.warn(e.getMessage(),e);
    }
    channel.addChannelListener(this);
  }
  return channel;
}
