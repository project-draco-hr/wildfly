{
  exchange.setResponseCode(status);
  final HeaderMap responseHeaders=exchange.getResponseHeaders();
  final String contentType=operationParameter.isEncode() ? Common.APPLICATION_DMR_ENCODED : Common.APPLICATION_JSON;
  responseHeaders.put(Headers.CONTENT_TYPE,contentType + "; charset=" + Common.UTF_8);
  writeCacheHeaders(exchange,status,operationParameter);
  if (operationParameter.isGet() && status == 200) {
    response=response.get(RESULT);
  }
  try {
    byte[] data=getResponseBytes(response,operationParameter);
    responseHeaders.put(Headers.CONTENT_LENGTH,data.length);
    exchange.getResponseSender().send(ByteBuffer.wrap(data));
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
