{
  Hashtable copy=new Hashtable();
  if (source instanceof Map) {
    copy.putAll((Map)source);
  }
 else {
    Enumeration keys=source.keys();
    while (keys.hasMoreElements()) {
      Object key=keys.nextElement();
      copy.put(key,source.get(key));
    }
  }
  return copy;
}
