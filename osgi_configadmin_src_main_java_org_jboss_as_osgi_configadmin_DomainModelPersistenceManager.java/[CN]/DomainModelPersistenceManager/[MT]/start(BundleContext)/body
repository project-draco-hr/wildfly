{
  osgiConfigAdminServiceTracker=new ServiceTracker(context,ConfigurationAdmin.class.getName(),null);
  osgiConfigAdminServiceTracker.open();
  ServiceReference sref=context.getServiceReference(ServiceContainer.class.getName());
  ServiceContainer serviceContainer=(ServiceContainer)context.getService(sref);
  ServiceController<?> controller=serviceContainer.getRequiredService(ConfigAdminService.SERVICE_NAME);
  jbossConfigAdminService=(ConfigAdminService)controller.getValue();
  jbossConfigAdminService.addListener(this);
  Hashtable props=new Hashtable();
  props.put(Constants.SERVICE_RANKING,Integer.MAX_VALUE);
  serviceRegistration=context.registerService(PersistenceManager.class.getName(),this,props);
  ConfigurationAdmin osgiConfigAdminService=(ConfigurationAdmin)osgiConfigAdminServiceTracker.waitForService(10000);
  for (  String pid : jbossConfigAdminService.getConfigurations()) {
    osgiConfigAdminService.getConfiguration(pid,null);
  }
}
