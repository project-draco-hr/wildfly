{
  ModuleIdentifier earModuleId=ModuleIdentifier.fromString("deployment.nested-bundle-as-module.ear:main");
  Module earModule=getModuleLoader().loadModule(earModuleId);
  Class<?> testClass=earModule.getClassLoader().loadClass(TEST_CLASS);
  ModuleClassLoader testClassLoader=(ModuleClassLoader)testClass.getClassLoader();
  Assert.assertEquals(earModuleId,testClassLoader.getModule().getIdentifier());
  try {
    testClassLoader.loadClass(TEST_CC);
    Assert.fail("ClassNotFoundException expected");
  }
 catch (  ClassNotFoundException ex) {
  }
  ModuleIdentifier bundleModuleId=ModuleIdentifier.fromString("deployment.nested-bundle-as-module.ear.nested-bundle.jar:main");
  Module bundleModule=getModuleLoader().loadModule(bundleModuleId);
  Class<?> classCC=bundleModule.getClassLoader().loadClass(TEST_CC);
  ModuleClassLoader classLoaderCC=(ModuleClassLoader)classCC.getClassLoader();
  Assert.assertEquals(bundleModuleId,classLoaderCC.getModule().getIdentifier());
}
