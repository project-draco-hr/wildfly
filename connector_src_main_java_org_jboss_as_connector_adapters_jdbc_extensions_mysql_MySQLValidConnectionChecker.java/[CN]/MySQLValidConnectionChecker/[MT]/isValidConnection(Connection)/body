{
  if (driverHasPingMethod) {
    Object[] params=new Object[]{pingTimeOut};
    try {
      ping.invoke(c,params);
    }
 catch (    Exception e) {
      if (e instanceof SQLException) {
        return (SQLException)e;
      }
 else {
        log.warn("Unexpected error in ping",e);
        return new SQLException("ping failed: " + e.toString());
      }
    }
  }
 else {
    Statement stmt=null;
    ResultSet rs=null;
    try {
      stmt=c.createStatement();
      rs=stmt.executeQuery("SELECT 1");
    }
 catch (    Exception e) {
      if (e instanceof SQLException) {
        return (SQLException)e;
      }
 else {
        log.warn("Unexpected error in ping (SELECT 1)",e);
        return new SQLException("ping (SELECT 1) failed: " + e.toString());
      }
    }
 finally {
      try {
        if (rs != null)         rs.close();
      }
 catch (      SQLException ignore) {
      }
      try {
        if (stmt != null)         stmt.close();
      }
 catch (      SQLException ignore) {
      }
    }
  }
  return null;
}
