{
  ModelNode model=context.createResource(PathAddress.EMPTY_ADDRESS).getModel();
  PrincipalResourceDefinition.TYPE.validateAndSet(operation,model);
  PrincipalResourceDefinition.REALM.validateAndSet(operation,model);
  PrincipalResourceDefinition.NAME.validateAndSet(operation,model);
  final String roleName=RoleMappingResourceDefinition.getRoleName(operation);
  final PrincipalType principalType=PrincipalResourceDefinition.getPrincipalType(context,model);
  final String realm=PrincipalResourceDefinition.getRealm(context,model);
  final String name=PrincipalResourceDefinition.getName(context,model);
  context.addStep(new OperationStepHandler(){
    @Override public void execute(    OperationContext context,    ModelNode operation) throws OperationFailedException {
      roleMapper.addPrincipal(roleName,principalType,matchType,name,realm,context.isBooting());
      context.stepCompleted();
    }
  }
,Stage.RUNTIME);
  context.stepCompleted();
}
