{
  final ModelNode compensatingOp=new ModelNode();
  compensatingOp.get(OP).set(COMPOSITE);
  compensatingOp.get(OP_ADDR).setEmptyList();
  final ModelNode compSteps=compensatingOp.get(STEPS);
  compSteps.setEmptyList();
synchronized (rollbackOps) {
    int rollbackIndex=0;
    for (int i=steps.size() - 1; i >= 0; i--) {
      Integer id=Integer.valueOf(i);
      final ModelNode compStep=rollbackOps.get(id);
      if (compStep != null && compStep.isDefined()) {
        compSteps.add(compStep);
        rollbackStepNames.put(id,getStepKey(rollbackIndex));
        rollbackIndex++;
      }
    }
  }
  compensatingOp.get(ROLLBACK_ON_RUNTIME_FAILURE).set(false);
  return compensatingOp;
}
