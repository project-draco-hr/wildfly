{
  try {
    final ByteArrayOutputStream baos=new ByteArrayOutputStream();
    try {
      BufferedOutputStream output=new BufferedOutputStream(baos);
      configurationPersister.marshallAsXml(model,output);
      output.close();
      baos.close();
    }
  finally {
      safeClose(baos);
    }
    String xml=new String(baos.toByteArray());
    ModelNode result=new ModelNode().set(xml);
    resultHandler.handleResultFragment(EMPTY,result);
    resultHandler.handleResultComplete(null);
  }
 catch (  Exception e) {
    e.printStackTrace();
    resultHandler.handleFailed(new ModelNode().set(e.getLocalizedMessage()));
  }
  return Cancellable.NULL;
}
