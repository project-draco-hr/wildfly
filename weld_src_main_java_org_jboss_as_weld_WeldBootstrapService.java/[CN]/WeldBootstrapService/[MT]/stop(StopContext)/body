{
  if (!started) {
    throw WeldMessages.MESSAGES.notStarted("WeldContainer");
  }
  WeldLogger.DEPLOYMENT_LOGGER.stoppingWeldService(deploymentName);
  ClassLoader oldTccl=WildFlySecurityManager.getCurrentContextClassLoaderPrivileged();
  try {
    WildFlySecurityManager.setCurrentContextClassLoaderPrivileged(deployment.getModule().getClassLoader());
    WeldProvider.containerShutDown(Container.instance(deploymentName));
    bootstrap.shutdown();
  }
  finally {
    WildFlySecurityManager.setCurrentContextClassLoaderPrivileged(oldTccl);
    ModuleGroupSingletonProvider.removeClassLoader(deployment.getModule().getClassLoader());
  }
  started=false;
}
