{
  final Resource resource=context.readResourceForUpdate(PathAddress.EMPTY_ADDRESS);
  final ModelNode model=resource.getModel();
  ModelNode dc=model.get(DOMAIN_CONTROLLER);
  dc.get(LOCAL).setEmptyObject();
  if (dc.has(REMOTE)) {
    dc.remove(REMOTE);
  }
  hostControllerInfo.setMasterDomainController(true);
  overallConfigPersister.initializeDomainConfigurationPersister(false);
  ContentRepository contentRepo=new DomainContentRepository(environment.getDomainDeploymentDir());
  hostControllerInfo.setContentRepository(contentRepo);
  DomainModelUtil.initializeMasterDomainRegistry(rootRegistration,overallConfigPersister.getDomainPersister(),contentRepo,fileRepository,domainController,registry);
  context.completeStep();
}
