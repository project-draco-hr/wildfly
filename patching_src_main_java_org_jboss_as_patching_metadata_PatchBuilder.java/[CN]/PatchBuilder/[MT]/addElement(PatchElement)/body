{
  this.elements.add(new PatchElementHolder(){
    @Override public PatchElement createElement(    PatchType patchType){
      final PatchType type=element.getProvider().getPatchType();
      if (type == null) {
        if (patchType == PatchType.CUMULATIVE) {
          ((PatchElementProviderImpl)element.getProvider()).upgrade();
        }
 else {
          ((PatchElementProviderImpl)element.getProvider()).oneOffPatch();
        }
      }
 else       if (patchType != PatchBuilder.this.patchType) {
        throw new RuntimeException("patch types don't match");
      }
      return element;
    }
  }
);
  return this;
}
