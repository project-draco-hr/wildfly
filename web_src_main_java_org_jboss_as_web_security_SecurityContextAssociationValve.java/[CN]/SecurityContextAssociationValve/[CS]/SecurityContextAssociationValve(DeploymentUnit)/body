{
  final WarMetaData warMetaData=deploymentUnit.getAttachment(WarMetaData.ATTACHMENT_KEY);
  JBossWebMetaData metaData=warMetaData.getMergedJBossWebMetaData();
  String securityDomain=SecurityUtil.unprefixSecurityDomain(metaData.getSecurityDomain());
  if (securityDomain == null) {
    securityDomain=SecurityConstants.DEFAULT_WEB_APPLICATION_POLICY;
  }
  String contextId=deploymentUnit.getName();
  if (deploymentUnit.getParent() != null) {
    contextId=deploymentUnit.getParent().getName() + "!" + contextId;
  }
  this.securityDomain=securityDomain;
  this.runAsIdentity=metaData.getRunAsIdentity();
  this.contextId=contextId;
}
