{
  writer.writeStartDocument();
  writer.writeStartElement(Element.DISTRIBUTION.name);
  writer.writeDefaultNamespace(DistributionXml.Namespace.DISTRIBUTION_1_0.getNamespace());
  final DistributionContentItem root=distribution.getRoot();
  final Collection<DistributionContentItem> children=root.getChildren();
  final Set<String> layers=distribution.getLayers();
  if (!layers.isEmpty()) {
    writer.writeStartElement(Element.LAYERS.name);
    for (    final String layerName : layers) {
      final Distribution.ProcessedLayer layer=distribution.getLayer(layerName);
      writeLayer(writer,layer,Element.LAYER);
    }
    writer.writeEndElement();
  }
  final Set<String> addOns=distribution.getAddOns();
  if (!addOns.isEmpty()) {
    writer.writeStartElement(Element.ADD_ONS.name);
    for (    final String addOnName : addOns) {
      final Distribution.ProcessedLayer addOn=distribution.getAddOn(addOnName);
      writeLayer(writer,addOn,Element.ADD_ON);
    }
    writer.writeEndElement();
  }
  writer.writeStartElement(Element.FILES.name);
  writeChildren(writer,children);
  writer.writeEndElement();
  writer.writeEndElement();
  writer.writeEndDocument();
}
