{
  if (PersistenceProviderAdapterRegistry.getPersistenceProviderAdaptor(persistenceProviderClass,adapterModule) == null) {
    try {
      Module module=moduleLoader.loadModule(ModuleIdentifier.fromString(adapterModule));
      final ServiceLoader<PersistenceProviderAdaptor> serviceLoader=module.loadService(PersistenceProviderAdaptor.class);
      if (serviceLoader != null) {
        PersistenceProviderAdaptor persistenceProviderAdaptor=null;
        for (        PersistenceProviderAdaptor adaptor : serviceLoader) {
          if (persistenceProviderAdaptor != null) {
            throw new DeploymentUnitProcessingException("persistence provider adapter module has more than one adapters" + adapterModule + "(class "+ persistenceProviderClass+ ")");
          }
          persistenceProviderAdaptor=adaptor;
        }
        if (persistenceProviderAdaptor != null) {
          persistenceProviderAdaptor.injectJtaManager(JtaManagerImpl.getInstance());
          PersistenceProviderAdapterRegistry.putPersistenceProviderAdaptor(persistenceProviderClass,adapterModule,persistenceProviderAdaptor);
        }
      }
    }
 catch (    ModuleLoadException e) {
      throw new DeploymentUnitProcessingException("persistence provider adapter module load error" + adapterModule + "(class "+ persistenceProviderClass+ ")",e);
    }
  }
}
