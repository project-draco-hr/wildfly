{
  final Map<String,Object> vaultOptions=new HashMap<String,Object>();
  String vaultClass=null;
  if (model.hasDefined(CODE)) {
    vaultClass=model.get(CODE).asString();
  }
  if (model.hasDefined(VAULT_OPTIONS)) {
    for (    Property vaultProp : model.get(VAULT_OPTIONS).asPropertyList()) {
      vaultOptions.put(vaultProp.getName(),vaultProp.getValue().asString());
    }
  }
  final String vaultFQN=vaultClass;
  SecurityVaultService vaultService=new SecurityVaultService(vaultFQN,vaultOptions);
  final ServiceTarget target=context.getServiceTarget();
  ServiceBuilder<SecurityVault> builder=target.addService(SecurityVaultService.SERVICE_NAME,vaultService);
  newControllers.add(builder.addListener(verificationHandler).setInitialMode(ServiceController.Mode.ACTIVE).install());
}
