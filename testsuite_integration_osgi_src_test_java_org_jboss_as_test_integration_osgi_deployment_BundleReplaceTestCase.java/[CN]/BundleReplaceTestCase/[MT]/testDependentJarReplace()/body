{
  ServerDeploymentHelper server=new ServerDeploymentHelper(managementClient.getControllerClient());
  String jarName=server.deploy(V200_JAR,deployer.getDeployment(V200_JAR));
  String webappName=server.deploy(WEBAPP_V200_WAR,deployer.getDeployment(WEBAPP_V200_WAR));
  try {
    String result=performCall("webapp-v200","simple",null);
    Assert.assertEquals("Revision deployment.v200.jar:main",result);
    result=performCall("webapp-v200","message.txt",null);
    Assert.assertEquals("Resource V2.0.0",result);
    jarName=server.replace(V200_JAR,V201_JAR,deployer.getDeployment(V201_JAR),true);
    result=performCall("webapp-v200","simple",null);
    Assert.assertEquals("Revision deployment.v200.jar:main",result);
    result=performCall("webapp-v200","message.txt",null);
    Assert.assertEquals("Resource V2.0.0",result);
  }
  finally {
    server.undeploy(webappName);
    server.undeploy(jarName);
  }
}
