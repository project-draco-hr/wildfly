{
  if (!patchIds.remove(patchId)) {
    if (!patchId.equals(cumulative)) {
      throw new IllegalStateException("cannot rollback not-applied patch " + patchId);
    }
  }
}
