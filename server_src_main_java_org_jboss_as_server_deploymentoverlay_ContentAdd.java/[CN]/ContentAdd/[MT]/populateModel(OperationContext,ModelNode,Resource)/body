{
  final PathAddress address=PathAddress.pathAddress(operation.get(OP_ADDR));
  final String path=address.getLastElement().getValue();
  final String name=address.getElement(address.size() - 2).getValue();
  ModelNode content=operation.get(CONTENT);
  final byte[] hash;
  if (content.hasDefined(HASH)) {
    managedContentValidator.validate(content);
    hash=content.require(HASH).asBytes();
    addFromHash(hash,name,path,context);
  }
 else {
    hash=addFromContentAdditionParameter(context,content);
    if (remoteRepository != null) {
      remoteRepository.getDeploymentFiles(hash);
    }
  }
  operation.get(CONTENT).set(hash);
  super.populateModel(context,operation,resource);
}
