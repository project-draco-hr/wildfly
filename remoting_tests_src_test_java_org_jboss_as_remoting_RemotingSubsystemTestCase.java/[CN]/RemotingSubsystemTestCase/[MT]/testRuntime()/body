{
  KernelServices services=createKernelServicesBuilder(createRuntimeAdditionalInitialization()).setSubsystemXml(getSubsystemXml()).build();
  ServiceController<Endpoint> endPointServiceController=(ServiceController<Endpoint>)services.getContainer().getRequiredService(RemotingServices.SUBSYSTEM_ENDPOINT);
  endPointServiceController.setMode(ServiceController.Mode.ACTIVE);
  Endpoint endpointService=endPointServiceController.getValue();
  assertNotNull("Endpoint service was null",endpointService);
  assertNotNull(endpointService.getName());
  ServiceName connectorServiceName=RemotingServices.serverServiceName("remoting-connector");
  ServiceController<?> remotingConnectorController=services.getContainer().getRequiredService(connectorServiceName);
  remotingConnectorController.setMode(ServiceController.Mode.ACTIVE);
  assertNotNull("Connector was null",remotingConnectorController);
  InjectedSocketBindingStreamServerService remotingConnector=(InjectedSocketBindingStreamServerService)remotingConnectorController.getService();
  assertEquals("remote",remotingConnector.getEndpointInjector().getValue().getName());
  ServiceController<?> httpConnectorController=services.getContainer().getRequiredService(RemotingHttpUpgradeService.UPGRADE_SERVICE_NAME.append("http-connector"));
  assertNotNull("Http connector was null",httpConnectorController);
  httpConnectorController.setMode(ServiceController.Mode.ACTIVE);
  InjectedSocketBindingStreamServerService httpConnector=(InjectedSocketBindingStreamServerService)remotingConnectorController.getService();
  assertEquals("remote",httpConnector.getEndpointInjector().getValue().getName());
}
