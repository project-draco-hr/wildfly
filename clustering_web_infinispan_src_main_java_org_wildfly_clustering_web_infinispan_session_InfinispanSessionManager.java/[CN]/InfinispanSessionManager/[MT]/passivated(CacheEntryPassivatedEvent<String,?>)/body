{
  if (event.isPre() && (event.getKey() instanceof String)) {
    String id=event.getKey();
    if (event.isOriginLocal()) {
      InfinispanWebLogger.ROOT_LOGGER.tracef("Session %s will be passivated",id);
      ImmutableSession session=this.factory.createSession(id,this.factory.findValue(id));
      ImmutableSessionAttributes attributes=session.getAttributes();
      HttpSessionEvent sessionEvent=new HttpSessionEvent(new ImmutableHttpSessionAdapter(session));
      for (      String attribute : attributes.getAttributeNames()) {
        Object value=attributes.getAttribute(attribute);
        if (value instanceof HttpSessionActivationListener) {
          HttpSessionActivationListener listener=(HttpSessionActivationListener)value;
          listener.sessionWillPassivate(sessionEvent);
        }
      }
    }
  }
}
