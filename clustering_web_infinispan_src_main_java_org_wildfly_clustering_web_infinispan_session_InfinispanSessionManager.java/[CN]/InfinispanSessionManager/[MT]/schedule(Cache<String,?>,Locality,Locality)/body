{
  for (  Object key : cache.getAdvancedCache().withFlags(Flag.CACHE_MODE_LOCAL,Flag.SKIP_CACHE_LOAD).keySet()) {
    if (this.accept(key)) {
      String sessionId=(String)key;
      if (!oldLocality.isLocal(sessionId) && newLocality.isLocal(sessionId)) {
        boolean started=cache.startBatch();
        try {
          V value=this.factory.findValue(sessionId);
          if (value != null) {
            ImmutableSession session=this.factory.createImmutableSession(sessionId,value);
            this.scheduler.schedule(session);
          }
        }
  finally {
          if (started) {
            cache.endBatch(false);
          }
        }
      }
    }
  }
}
