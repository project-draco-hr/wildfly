{
  StringBuffer sql=new StringBuffer(400);
  sql.append(SQLUtil.SELECT);
  if (keyCount > 1) {
    SQLUtil.getColumnNamesClause(myKeyFields,relationTableAlias,sql).append(SQLUtil.COMMA);
  }
  SQLUtil.getColumnNamesClause(relatedKeyFields,relationTableAlias,sql);
  if (preloadMask != null) {
    SQLUtil.appendColumnNamesClause(cmrField.getRelatedJDBCEntity().getTableFields(),preloadMask,relatedTableAlias,sql);
  }
  sql.append(SQLUtil.FROM).append(relationTable);
  if (join) {
    sql.append(' ').append(relationTableAlias).append(SQLUtil.COMMA).append(relatedTable).append(' ').append(relatedTableAlias);
  }
  sql.append(SQLUtil.WHERE);
  if (join) {
    sql.append('(');
    SQLUtil.getJoinClause(relatedKeyFields,relationTableAlias,cmrField.getRelatedJDBCEntity().getPrimaryKeyFields(),relatedTableAlias,sql).append(')').append(SQLUtil.AND).append('(');
  }
  String pkWhere=SQLUtil.getWhereClause(myKeyFields,relationTableAlias,new StringBuffer(50)).toString();
  for (int i=0; i < keyCount; i++) {
    if (i > 0)     sql.append(SQLUtil.OR);
    sql.append('(').append(pkWhere).append(')');
  }
  if (join)   sql.append(')');
  return sql.toString();
}
