{
  JDBCFunctionMappingMetaData selectTemplate=null;
  if (cmrField.getRelationMetaData().isTableMappingStyle()) {
    if (cmrField.getRelationMetaData().hasRowLocking()) {
      selectTemplate=cmrField.getRelationMetaData().getTypeMapping().getRowLockingTemplate();
      if (selectTemplate == null) {
        throw new IllegalStateException("row-locking is not allowed for this type of datastore");
      }
    }
  }
 else   if (cmrField.getRelatedCMRField().hasForeignKey()) {
    if (cmrField.getRelatedJDBCEntity().getMetaData().hasRowLocking()) {
      selectTemplate=cmrField.getRelatedJDBCEntity().getMetaData().getTypeMapping().getRowLockingTemplate();
      if (selectTemplate == null) {
        throw new IllegalStateException("row-locking is not allowed for this type of datastore");
      }
    }
  }
 else {
    if (entity.getMetaData().hasRowLocking()) {
      selectTemplate=entity.getMetaData().getTypeMapping().getRowLockingTemplate();
      if (selectTemplate == null) {
        throw new IllegalStateException("row-locking is not allowed for this type of datastore");
      }
    }
  }
  return selectTemplate;
}
