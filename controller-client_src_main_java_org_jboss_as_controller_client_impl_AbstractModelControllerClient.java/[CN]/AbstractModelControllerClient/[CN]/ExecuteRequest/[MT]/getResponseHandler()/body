{
  return new ManagementResponseHandler<ModelNode>(){
    @Override protected ModelNode readResponse(    final DataInput input) throws IOException {
      ROOT_LOGGER.tracef("Client reading response %d",getBatchId());
      try {
        ProtocolUtils.expectHeader(input,ModelControllerProtocol.PARAM_RESPONSE);
        ModelNode node=new ModelNode();
        node.readExternal(input);
        ROOT_LOGGER.tracef("Client read response %d successfully",getBatchId());
        return node;
      }
 catch (      Exception e) {
        ROOT_LOGGER.tracef(e,"Client read response %d with error",getBatchId());
        setError(e);
        if (e instanceof IOException) {
          throw (IOException)e;
        }
        if (e instanceof RuntimeException) {
          throw (RuntimeException)e;
        }
        throw new IOException(e);
      }
 finally {
        ManagementBatchIdManager.DEFAULT.freeBatchId(getBatchId());
        activeRequests.remove(getBatchId());
        executeRequestContext.done();
      }
    }
  }
;
}
