{
  final StopSignal stopSignal=new StopSignal();
  final Callable<Void> task=new StatefulSessionCreatingTask(stopSignal);
  final ExecutorService executorService=Executors.newFixedThreadPool(1);
  try {
    final Future<Void> futureResult=executorService.submit(task);
    final long waitTimeBeforeUndeployment=TimeoutUtil.adjust(250);
    logger.info("Sleeping for " + waitTimeBeforeUndeployment + " milli. sec to let the EJB sessions be created a few times, before undeploying it");
    Thread.sleep(waitTimeBeforeUndeployment);
    undeploy(ClusteringTestConstants.DEPLOYMENT_1);
    final long waitTimeAfterUndeployment=TimeoutUtil.adjust(500);
    logger.info("Sleeping for " + waitTimeAfterUndeployment + " milli. sec to let the EJB sessions be created, after the deployment has been undeployed from one of the nodes");
    Thread.sleep(waitTimeAfterUndeployment);
    stopSignal.stop=true;
    futureResult.get();
  }
  finally {
    executorService.shutdown();
  }
}
