{
  if (deployed == null) {
    return;
  }
  int count=deployed.get(container.getName());
  deployed.put(container.getName(),--count);
  if (count == 0 && afterClassRun) {
    for (int i=setupTasksInForce.size() - 1; i >= 0; i--) {
      try {
        setupTasksInForce.get(i).tearDown(managementClient.get(),container.getName());
      }
 catch (      Exception e) {
        log.error("Setup task failed during tear down. Offending class '" + setupTasksAll.get(i) + "'",e);
      }
    }
    active.remove(container.getName());
    deployed.remove(container.getName());
  }
  if (deployed.isEmpty()) {
    deployed=null;
    setupTasksAll.clear();
    setupTasksInForce.clear();
    afterClassRun=false;
  }
}
