{
  context.startSubsystemElement(Namespace.CURRENT.getUriString(),false);
  ModelNode node=context.getModelNode();
  if (isNonStandard(node,AUTHENTICATION_MANAGER_CLASS_NAME) || (node.hasDefined(DEEP_COPY_SUBJECT_MODE) && node.get(DEEP_COPY_SUBJECT_MODE).asBoolean()) || isNonStandard(node,DEFAULT_CALLBACK_HANDLER_CLASS_NAME)) {
    writer.writeEmptyElement(Element.SECURITY_MANAGEMENT.getLocalName());
    if (isNonStandard(node,AUTHENTICATION_MANAGER_CLASS_NAME)) {
      writeAttribute(writer,Attribute.AUTHENTICATION_MANAGER_CLASS_NAME,node.get(AUTHENTICATION_MANAGER_CLASS_NAME));
    }
    if (node.hasDefined(DEEP_COPY_SUBJECT_MODE) && node.get(DEEP_COPY_SUBJECT_MODE).asBoolean()) {
      writeAttribute(writer,Attribute.DEEP_COPY_SUBJECT_MODE,node.get(DEEP_COPY_SUBJECT_MODE));
    }
    if (isNonStandard(node,DEFAULT_CALLBACK_HANDLER_CLASS_NAME)) {
      writeAttribute(writer,Attribute.DEFAULT_CALLBACK_HANDLER_CLASS_NAME,node.get(DEFAULT_CALLBACK_HANDLER_CLASS_NAME));
    }
  }
  if (isNonStandard(node,SUBJECT_FACTORY_CLASS_NAME)) {
    writer.writeEmptyElement(Element.SUBJECT_FACTORY.getLocalName());
    writeAttribute(writer,Attribute.SUBJECT_FACTORY_CLASS_NAME,node.get(SUBJECT_FACTORY_CLASS_NAME));
  }
  if (node.hasDefined(JAAS_APPLICATION_POLICY) && node.get(JAAS_APPLICATION_POLICY).asInt() > 0) {
    writer.writeStartElement(Element.JAAS.getLocalName());
    for (    Property policy : node.get(JAAS_APPLICATION_POLICY).asPropertyList()) {
      writer.writeStartElement(Element.APPLICATION_POLICY.getLocalName());
      writer.writeAttribute(Attribute.NAME.getLocalName(),policy.getName());
      ModelNode policyDetails=policy.getValue();
      if (policyDetails.hasDefined(Attribute.EXTENDS.getLocalName())) {
        writer.writeAttribute(Attribute.EXTENDS.getLocalName(),policyDetails.get(Attribute.EXTENDS.getLocalName()).asString());
      }
      writeApplicationPolicyContent(writer,policyDetails);
      writer.writeEndElement();
    }
    writer.writeEndElement();
  }
  writer.writeEndElement();
}
