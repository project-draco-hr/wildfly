{
  Set<String> keys=new HashSet<String>(policyDetails.keys());
  keys.remove(Attribute.NAME.getLocalName());
  keys.remove(Attribute.EXTENDS.getLocalName());
  for (  String key : keys) {
    Element element=Element.forName(key);
switch (element) {
case AUTHENTICATION:
{
        writeAuthentication(writer,policyDetails.get(Element.AUTHENTICATION.getLocalName()));
        break;
      }
case AUTHORIZATION:
case ACL:
case AUDIT:
case IDENTITY_TRUST:
case MAPPING:
case AUTHENTICATION_JASPI:
{
      throw new UnsupportedOperationException("NYI: full marshalling of application policy");
    }
default :
  throw new IllegalStateException("Unexpected field " + element.getLocalName());
}
}
}
