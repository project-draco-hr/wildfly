{
  final String oldEncoding=this.encoding;
  this.encoding=encoding;
  final LogContextConfigurationImpl configuration=getConfiguration();
  configuration.addAction(new ConfigAction<Void>(){
    public Void validate() throws IllegalArgumentException {
      if (encoding != null) {
        try {
          Charset.forName(encoding);
        }
 catch (        Throwable t) {
          throw LoggingMessages.MESSAGES.unsupportedCharSet(encoding);
        }
      }
      return null;
    }
    public void applyPreCreate(    final Void param){
    }
    public void applyPostCreate(    final Void param){
      try {
        configuration.getHandlerRefs().get(getName()).setEncoding(encoding);
      }
 catch (      UnsupportedEncodingException e) {
        throw LoggingMessages.MESSAGES.failedToSetHandlerEncoding(e,encoding);
      }
    }
    public void rollback(){
      HandlerConfigurationImpl.this.encoding=oldEncoding;
    }
  }
);
}
