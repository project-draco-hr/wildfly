{
  final PathAddress address=PathAddress.pathAddress(operation.get(OP_ADDR));
  final String name=address.getLastElement().getValue();
  int bufferSize=BUFFER_SIZE.resolveModelAttribute(context,model).asInt();
  int bufferPerSlice=BUFFER_PER_SLICE.resolveModelAttribute(context,model).asInt();
  boolean direct=true;
  ModelNode directBuffersModel=DIRECT_BUFFERS.resolveModelAttribute(context,model);
  if (directBuffersModel.isDefined()) {
    direct=directBuffersModel.asBoolean();
  }
  final BufferPoolService service=new BufferPoolService(bufferSize,bufferPerSlice,direct);
  final ServiceBuilder<Pool<ByteBuffer>> serviceBuilder=context.getServiceTarget().addService(IOServices.BUFFER_POOL.append(name),service);
  serviceBuilder.setInitialMode(ServiceController.Mode.ACTIVE);
  final ServiceController<Pool<ByteBuffer>> serviceController=serviceBuilder.install();
  if (newControllers != null) {
    newControllers.add(serviceController);
  }
}
