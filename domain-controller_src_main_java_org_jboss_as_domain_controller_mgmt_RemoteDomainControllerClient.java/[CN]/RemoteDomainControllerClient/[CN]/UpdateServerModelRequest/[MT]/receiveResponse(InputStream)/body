{
  final Unmarshaller unmarshaller=getUnmarshaller();
  unmarshaller.start(createByteInput(input));
  ProtocolUtils.expectHeader(unmarshaller,HostControllerProtocol.PARAM_MODEL_UPDATE_RESPONSE_COUNT);
  int responseCount=unmarshaller.readInt();
  if (responseCount != updates.size()) {
    throw new IOException("Invalid host model update response.  Response count not equal to update count.");
  }
  final List<UpdateResultHandlerResponse<?>> responses=new ArrayList<UpdateResultHandlerResponse<?>>(responseCount);
  for (int i=0; i < responseCount; i++) {
    ProtocolUtils.expectHeader(unmarshaller,HostControllerProtocol.PARAM_MODEL_UPDATE_RESPONSE);
    final UpdateResultHandlerResponse<?> response=unmarshal(unmarshaller,UpdateResultHandlerResponse.class);
    responses.add(response);
  }
  unmarshaller.finish();
  return responses;
}
