{
  final Unmarshaller unmarshaller=getUnmarshaller();
  unmarshaller.start(createByteInput(input));
  ProtocolUtils.expectHeader(unmarshaller,ServerManagerProtocol.PARAM_MODEL_UPDATE_RESPONSE_COUNT);
  int responseCount=unmarshaller.readInt();
  if (responseCount != updates.size()) {
    throw new IOException("Invalid host model update response.  Response count not equal to update count.");
  }
  final List<ModelUpdateResponse<UpdateResultHandlerResponse<?>>> responses=new ArrayList<ModelUpdateResponse<UpdateResultHandlerResponse<?>>>(responseCount);
  for (int i=0; i < responseCount; i++) {
    ProtocolUtils.expectHeader(unmarshaller,ServerManagerProtocol.PARAM_MODEL_UPDATE_RESPONSE);
    @SuppressWarnings("unchecked") final ModelUpdateResponse<UpdateResultHandlerResponse<?>> response=unmarshal(unmarshaller,ModelUpdateResponse.class);
    responses.add(response);
  }
  unmarshaller.finish();
  return responses;
}
