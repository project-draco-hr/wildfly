{
  try {
    final ServiceTarget target=updateContext.getServiceTarget();
    final PeriodicRotatingFileHandlerService service=new PeriodicRotatingFileHandlerService();
    final ServiceBuilder<Handler> serviceBuilder=target.addService(LogServices.handlerName(getName()),service);
    final String relativeTo=getRelativeTo();
    if (relativeTo != null) {
      serviceBuilder.addDependency(AbstractPathService.pathNameOf(relativeTo),String.class,service.getRelativeToInjector());
    }
    service.setLevel(Level.parse(getLevelName()));
    final Boolean autoFlush=getAutoflush();
    if (autoFlush != null)     service.setAutoflush(autoFlush.booleanValue());
    service.setEncoding(getEncoding());
    service.setPath(getPath());
    service.setFormatterSpec(getFormatter());
    service.setSuffix(suffix);
    serviceBuilder.setInitialMode(ServiceController.Mode.ACTIVE);
    serviceBuilder.addListener(new UpdateResultHandler.ServiceStartListener<P>(handler,param));
    serviceBuilder.install();
  }
 catch (  Throwable t) {
    handler.handleFailure(t,param);
  }
}
