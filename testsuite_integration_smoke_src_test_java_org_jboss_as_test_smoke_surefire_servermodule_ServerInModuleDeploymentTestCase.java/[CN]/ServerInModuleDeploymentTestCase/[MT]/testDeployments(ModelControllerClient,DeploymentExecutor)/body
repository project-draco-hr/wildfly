{
  final MBeanServerConnection mbeanServer=JMXConnectorFactory.connect(new JMXServiceURL("service:jmx:remote://127.0.0.1:9999")).getMBeanServerConnection();
  final ObjectName name=new ObjectName("jboss.test:service=testdeployments");
  try {
    deploymentExecutor.initialDeploy();
    PollingUtils.retryWithTimeout(10000,new PollingUtils.WaitForMBeanTask(mbeanServer,name));
    Assert.assertNotNull(mbeanServer.getMBeanInfo(name));
    deploymentExecutor.fullReplace();
    PollingUtils.retryWithTimeout(10000,new PollingUtils.WaitForMBeanTask(mbeanServer,name));
    Assert.assertNotNull(mbeanServer.getMBeanInfo(name));
    deploymentExecutor.undeploy();
    try {
      long start=System.currentTimeMillis();
      while (System.currentTimeMillis() - start < 10000) {
        mbeanServer.getMBeanInfo(name);
        Thread.sleep(100);
      }
      Assert.fail("Should not have found MBean");
    }
 catch (    Exception expected) {
    }
  }
  finally {
  }
}
