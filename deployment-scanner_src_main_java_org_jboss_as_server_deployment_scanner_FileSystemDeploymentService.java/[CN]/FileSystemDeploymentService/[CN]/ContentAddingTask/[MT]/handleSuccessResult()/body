{
  final File doDeployMarker=new File(deploymentFile.getParent(),deploymentFile.getName() + DO_DEPLOY);
  if (!doDeployMarker.delete()) {
    log.errorf("Failed to delete deployment marker file %s",doDeployMarker.getAbsolutePath());
  }
  final File failedMarker=new File(deploymentFile.getParent(),deploymentFile.getName() + FAILED_DEPLOY);
  if (failedMarker.exists() && !failedMarker.delete()) {
    log.warnf("Unable to remove marger file %s",failedMarker);
  }
  final File deployedMarker=new File(deploymentFile.getParent(),deploymentFile.getName() + DEPLOYED);
  FileOutputStream fos=null;
  try {
    deployedMarker.createNewFile();
    fos=new FileOutputStream(deployedMarker);
    fos.write(deploymentFile.getName().getBytes());
  }
 catch (  IOException io) {
    log.errorf(io,"Caught exception writing deployment marker file %s",deployedMarker.getAbsolutePath());
  }
 finally {
    safeClose(fos);
  }
  if (deployed.containsKey(deploymentName)) {
    deployed.remove(deploymentName);
  }
  deployed.put(deploymentName,new DeploymentMarker(deployedMarker.lastModified()));
}
