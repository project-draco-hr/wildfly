{
  final Set<String> deploymentNames=getDeploymentNames();
  final File[] children=dir.listFiles();
  for (  File child : children) {
    final String fileName=child.getName();
    if (child.isDirectory()) {
      final int idx=fileName.lastIndexOf('.');
      if (idx == -1 || !ARCHIVES.contains(fileName.substring(idx))) {
        establishDeployedContentList(child);
      }
    }
 else     if (fileName.endsWith(DEPLOYED)) {
      final String deploymentName=fileName.substring(0,fileName.length() - DEPLOYED.length());
      if (deploymentNames.contains(deploymentName)) {
        deployed.put(deploymentName,new DeploymentMarker(child.lastModified()));
      }
 else {
        if (!child.delete()) {
          log.warnf("Cannot removed extraneous deployment marker file %s",fileName);
        }
      }
    }
  }
}
