{
  if (groups == null) {
    if (subject != null) {
      Set<GroupPrincipal> groupPrincipals=subject.getPrincipals(GroupPrincipal.class);
      Set<String> groups=new HashSet<String>(groupPrincipals.size());
      for (      Principal current : groupPrincipals) {
        groups.add(current.getName());
      }
      this.groups=Collections.unmodifiableSet(groups);
    }
 else {
      this.groups=Collections.emptySet();
    }
  }
  return groups;
}
