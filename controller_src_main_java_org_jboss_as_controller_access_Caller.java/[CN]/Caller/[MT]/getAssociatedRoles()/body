{
  if (roles == null) {
    if (subject != null) {
      Set<RolePrincipal> rolePrincipals=subject.getPrincipals(RolePrincipal.class);
      Set<String> roles=new HashSet<String>(rolePrincipals.size());
      for (      Principal current : rolePrincipals) {
        roles.add(current.getName());
      }
      this.roles=Collections.unmodifiableSet(roles);
    }
 else {
      this.roles=Collections.emptySet();
    }
  }
  return roles;
}
