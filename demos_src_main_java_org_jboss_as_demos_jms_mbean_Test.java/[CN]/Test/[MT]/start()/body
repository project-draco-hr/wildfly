{
  Module module=Module.forClass(Test.class);
  ClassLoader cl=Thread.currentThread().getContextClassLoader();
  Thread.currentThread().setContextClassLoader(module.getClassLoader());
  try {
    InitialContext ctx=new InitialContext();
    System.out.println(ctx.lookup("ConnectionFactory"));
    System.out.println(ctx.lookup("queue/test"));
    QueueConnectionFactory qcf=(QueueConnectionFactory)ctx.lookup("ConnectionFactory");
    conn=qcf.createQueueConnection();
    conn.start();
    queue=(Queue)ctx.lookup("queue/test");
    session=conn.createQueueSession(false,QueueSession.AUTO_ACKNOWLEDGE);
    QueueReceiver recv=session.createReceiver(queue);
    recv.setMessageListener(new ExampeMessageListener());
  }
  finally {
    Thread.currentThread().setContextClassLoader(cl);
  }
}
