{
  if (state != STARTED) {
    stopIgnored=true;
    if (log.isDebugEnabled()) {
      log.debug("Ignoring stop call; current state is " + getStateString());
    }
    return;
  }
  stopIgnored=false;
  state=STOPPING;
  if (log.isDebugEnabled()) {
    log.debug("Stopping " + jbossInternalDescription());
  }
  try {
    stopService();
  }
 catch (  Throwable e) {
    state=FAILED;
    log.warn("Stopping failed " + jbossInternalDescription(),e);
    return;
  }
  state=STOPPED;
  if (log.isDebugEnabled()) {
    log.debug("Stopped " + jbossInternalDescription());
  }
  if (destroyIgnored) {
    destroy();
  }
}
