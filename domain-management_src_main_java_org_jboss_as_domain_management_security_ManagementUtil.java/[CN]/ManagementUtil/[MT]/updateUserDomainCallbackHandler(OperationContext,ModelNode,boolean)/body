{
  UserDomainCallbackHandler cbh=getUserDomainCallbackHandler(context,operation);
  if (cbh != null) {
    PathAddress authAddress=getXmlAuthenticationAddress(operation);
    Resource root=forRollback ? context.getOriginalRootResource() : context.readResourceFromRoot(PathAddress.EMPTY_ADDRESS);
    ModelNode userMap;
    try {
      Resource authResource=root.navigate(authAddress);
      userMap=context.resolveExpressions(Resource.Tools.readModel(authResource));
    }
 catch (    Exception e) {
      userMap=new ModelNode().setEmptyObject();
    }
    cbh.setUserDomain(userMap);
  }
}
