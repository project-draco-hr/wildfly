{
  if (serverGroup.hasDefined(DEPLOYMENT)) {
    HostFileRepository remoteRepository=null;
    if (!domainController.getLocalHostInfo().isMasterDomainController()) {
      remoteRepository=domainController.getRemoteFileRepository();
    }
    for (    Property deployment : serverGroup.get(DEPLOYMENT).asPropertyList()) {
      String name=deployment.getName();
      ModelNode details=deployment.getValue();
      ModelNode domainDeployment=domainModel.require(DEPLOYMENT).require(name);
      ModelNode deploymentContent=domainDeployment.require(CONTENT).clone();
      if (remoteRepository != null) {
        for (        ModelNode content : deploymentContent.asList()) {
          if ((content.hasDefined(HASH))) {
            byte[] hash=content.require(HASH).asBytes();
            File[] files=domainController.getLocalFileRepository().getDeploymentFiles(hash);
            if (files == null || files.length == 0) {
              remoteRepository.getDeploymentFiles(hash);
            }
          }
        }
      }
      PathAddress addr=PathAddress.pathAddress(PathElement.pathElement(DEPLOYMENT,name));
      ModelNode addOp=Util.getEmptyOperation(ADD,addr.toModelNode());
      addOp.get(RUNTIME_NAME).set(details.get(RUNTIME_NAME));
      addOp.get(CONTENT).set(deploymentContent);
      if (!details.hasDefined(ENABLED)) {
        addOp.get(ENABLED).set(true);
      }
 else {
        addOp.get(ENABLED).set(details.get(ENABLED));
      }
      updates.add(addOp);
    }
  }
}
