{
  final String id=ctx.getState().getId();
  if (logging) {
    if (id.equals(PropertyListState.ID)) {
      --offset;
    }
    final StringBuilder buf=new StringBuilder();
    for (int i=0; i < offset; ++i) {
      buf.append(offsetStep);
    }
    buf.append("leaving '" + ctx.getCharacter() + "' "+ id);
    System.out.println(buf.toString());
  }
  if (ctx.isEndOfContent()) {
    return;
  }
  if (id.equals(TextState.ID)) {
    propBuf.setLength(0);
  }
 else   if (id.equals(PropertyState.ID)) {
    if (propStack != null && propStack.size() > 0) {
      final int propStackSize=propStack.size();
      final String mentioned=prop;
      if (propStackSize == 0) {
        prop=null;
      }
 else {
        prop=propStack.remove(propStackSize - 1);
      }
      if (mentionedPropStack.size() < propStackSize + 1) {
        final List<List<String>> tmp=mentionedPropStack;
        mentionedPropStack=new ArrayList<List<String>>(propStackSize + 1);
        mentionedPropStack.addAll(tmp);
        for (int i=mentionedPropStack.size(); i <= propStackSize; ++i) {
          mentionedPropStack.add(null);
        }
      }
 else       if (mentionedPropStack.size() > propStackSize + 1) {
        mentionedPropStack.set(propStackSize + 1,null);
      }
      List<String> mentionedProps=mentionedPropStack.get(propStackSize);
      if (mentionedProps == null) {
        mentionedProps=Collections.singletonList(mentioned);
        mentionedPropStack.set(propStackSize,mentionedProps);
      }
 else       if (mentionedProps.size() == 1) {
        List<String> tmp=mentionedProps;
        mentionedProps=new ArrayList<String>();
        mentionedProps.add(tmp.get(0));
        mentionedProps.add(mentioned);
        mentionedPropStack.set(propStackSize,mentionedProps);
      }
 else {
        mentionedProps.add(mentioned);
      }
    }
 else {
      if (mentionedPropStack.size() == 0) {
        mentionedPropStack=new ArrayList<List<String>>(1);
        mentionedPropStack.add(null);
      }
      List<String> mentionedProps=mentionedPropStack.get(0);
      if (mentionedProps == null) {
        mentionedProps=Collections.singletonList(prop);
        mentionedPropStack.set(0,mentionedProps);
      }
 else       if (mentionedProps.size() == 1) {
        List<String> tmp=mentionedProps;
        mentionedProps=new ArrayList<String>();
        mentionedProps.add(tmp.get(0));
        mentionedProps.add(prop);
        mentionedPropStack.set(0,mentionedProps);
      }
 else {
        mentionedProps.add(prop);
      }
      prop=null;
    }
  }
}
