{
  if (context instanceof RuntimeOperationContext) {
    RuntimeOperationContext.class.cast(context).executeRuntimeTask(new RuntimeTask(){
      public void execute(      RuntimeTaskContext context,      final ResultHandler resultHandler) throws OperationFailedException {
        final PathAddress address=PathAddress.pathAddress(operation.require(OP_ADDR));
        final String name=address.getLastElement().getValue();
        final String attributeName=operation.require(NAME).asString();
        final ServiceController<?> controller=context.getServiceRegistry().getService(WebSubsystemServices.JBOSS_WEB_CONNECTOR.append(name));
        if (controller != null) {
          try {
            final Connector connector=(Connector)controller.getValue();
            final int port=connector.getPort();
            final ModelNode result=new ModelNode();
            result.set("" + getAttribute("http-" + port,attributeName));
            resultHandler.handleResultFragment(new String[0],result);
            resultHandler.handleResultComplete();
          }
 catch (          Exception e) {
            throw new OperationFailedException(new ModelNode().set("failed to get metrics" + e.getMessage()));
          }
        }
      }
    }
,resultHandler);
  }
 else {
    resultHandler.handleResultFragment(NO_LOCATION,new ModelNode().set("no metrics available"));
    resultHandler.handleResultComplete();
  }
  return new BasicOperationResult();
}
