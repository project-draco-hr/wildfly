{
  final DataOutputStream outputStream=new DataOutputStream(this.channel.writeMessage());
  final ClusterTopologyWriter clusterTopologyWriter=new ClusterTopologyWriter();
  try {
    logger.debug("Writing out cluster formation message for " + clusters.length + " clusters, to channel "+ this.channel);
    clusterTopologyWriter.writeCompleteClusterTopology(outputStream,clusters);
  }
  finally {
    outputStream.close();
  }
}
