{
  final ServiceContainer serviceContainer=this.serviceContainer;
  final ConcurrentMap<VirtualFile,Deployment> deploymentMap=this.deploymentMap;
  final List<ServiceController<?>> serviceControllers=new ArrayList<ServiceController<?>>(deploymentRoots.length);
  for (  VirtualFile deploymentRoot : deploymentRoots) {
    final Deployment deployment=deploymentMap.remove(deploymentRoot);
    if (deployment == null)     continue;
    final ServiceController<?> serviceController=serviceContainer.getService(deployment.deploymentServiceName);
    if (serviceController == null)     throw new DeploymentException("Failed to undeploy " + deploymentRoot + ". Deployment service does not exist.");
    serviceControllers.add(serviceController);
  }
  ServiceUtils.undeployAll(new Runnable(){
    @Override public void run(){
    }
  }
,serviceControllers);
}
