{
  final DeploymentUnit deploymentUnit=phaseContext.getDeploymentUnit();
  final DelegatingClassFileTransformer transformer=deploymentUnit.getAttachment(DelegatingClassFileTransformer.ATTACHMENT_KEY);
  final ModuleSpecification moduleSpecification=deploymentUnit.getAttachment(Attachments.MODULE_SPECIFICATION);
  final Module module=deploymentUnit.getAttachment(Attachments.MODULE);
  if (module == null || transformer == null) {
    return;
  }
  try {
    for (    String transformerClassName : moduleSpecification.getClassFileTransformers()) {
      transformer.addTransformer((ClassFileTransformer)module.getClassLoader().loadClass(transformerClassName).newInstance());
    }
    transformer.setActive(true);
  }
 catch (  Exception e) {
    throw ServerLogger.ROOT_LOGGER.failedToInstantiateClassFileTransformer(ClassFileTransformer.class.getSimpleName(),e);
  }
}
