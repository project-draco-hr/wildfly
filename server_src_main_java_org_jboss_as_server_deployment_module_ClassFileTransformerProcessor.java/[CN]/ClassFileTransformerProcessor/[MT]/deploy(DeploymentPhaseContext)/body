{
  try {
    DeploymentUnit deploymentUnit=phaseContext.getDeploymentUnit();
    DelegatingClassFileTransformer transformer=deploymentUnit.getAttachment(DelegatingClassFileTransformer.ATTACHMENT_KEY);
    if (transformer != null) {
      Module module=deploymentUnit.getAttachment(Attachments.MODULE);
      ModuleSpecification moduleSpecification=deploymentUnit.getAttachment(Attachments.MODULE_SPECIFICATION);
      for (      String transformerClassName : moduleSpecification.getClassFileTransformers()) {
        transformer.addTransformer((ClassFileTransformer)module.getClassLoader().loadClass(transformerClassName).newInstance());
      }
      transformer.setActive(true);
    }
  }
 catch (  Exception e) {
    throw ServerMessages.MESSAGES.failedToInstantiateClassFileTransformer(ClassFileTransformer.class.getSimpleName(),e);
  }
}
