{
  final ModelNode modelNode=context.getModelNode();
  writer.writeStartDocument();
  writer.writeStartElement(Element.HOST.getLocalName());
  if (modelNode.hasDefined(NAME)) {
    HostResourceDefinition.NAME.marshallAsAttribute(modelNode,writer);
  }
  writer.writeDefaultNamespace(Namespace.CURRENT.getUriString());
  writeNamespaces(writer,modelNode);
  writeSchemaLocation(writer,modelNode);
  writeNewLine(writer);
  if (modelNode.hasDefined(SYSTEM_PROPERTY)) {
    writeProperties(writer,modelNode.get(SYSTEM_PROPERTY),Element.SYSTEM_PROPERTIES,false);
    writeNewLine(writer);
  }
  if (modelNode.hasDefined(PATH)) {
    writePaths(writer,modelNode.get(PATH),false);
    writeNewLine(writer);
  }
  boolean hasCoreServices=modelNode.hasDefined(CORE_SERVICE);
  if (hasCoreServices && modelNode.get(CORE_SERVICE).hasDefined(VAULT)) {
    writeVault(writer,modelNode.get(CORE_SERVICE,VAULT));
    writeNewLine(writer);
  }
  if (hasCoreServices) {
    ManagementXml managementXml=new ManagementXml(new ManagementXmlDelegate());
    managementXml.writeManagement(writer,modelNode.get(CORE_SERVICE,MANAGEMENT),true);
    writeNewLine(writer);
  }
  if (modelNode.hasDefined(DOMAIN_CONTROLLER)) {
    ModelNode ignoredResources=null;
    ModelNode discoveryOptionsOrdering=null;
    ModelNode staticDiscoveryOptions=null;
    ModelNode discoveryOptions=null;
    if (hasCoreServices && modelNode.get(CORE_SERVICE).hasDefined(IGNORED_RESOURCES) && modelNode.get(CORE_SERVICE,IGNORED_RESOURCES).hasDefined(IGNORED_RESOURCE_TYPE)) {
      ignoredResources=modelNode.get(CORE_SERVICE,IGNORED_RESOURCES,IGNORED_RESOURCE_TYPE);
    }
    if (hasCoreServices && modelNode.get(CORE_SERVICE).hasDefined(DISCOVERY_OPTIONS) && modelNode.get(CORE_SERVICE,DISCOVERY_OPTIONS).hasDefined(DISCOVERY_OPTIONS)) {
      discoveryOptionsOrdering=modelNode.get(CORE_SERVICE,DISCOVERY_OPTIONS,DISCOVERY_OPTIONS);
    }
    if (hasCoreServices && modelNode.get(CORE_SERVICE).hasDefined(DISCOVERY_OPTIONS) && modelNode.get(CORE_SERVICE,DISCOVERY_OPTIONS).hasDefined(STATIC_DISCOVERY)) {
      staticDiscoveryOptions=modelNode.get(CORE_SERVICE,DISCOVERY_OPTIONS,STATIC_DISCOVERY);
    }
    if (hasCoreServices && modelNode.get(CORE_SERVICE).hasDefined(DISCOVERY_OPTIONS) && modelNode.get(CORE_SERVICE,DISCOVERY_OPTIONS).hasDefined(DISCOVERY_OPTION)) {
      discoveryOptions=modelNode.get(CORE_SERVICE,DISCOVERY_OPTIONS,DISCOVERY_OPTION);
    }
    writeDomainController(writer,modelNode.get(DOMAIN_CONTROLLER),ignoredResources,discoveryOptionsOrdering,staticDiscoveryOptions,discoveryOptions);
    writeNewLine(writer);
  }
  if (modelNode.hasDefined(INTERFACE)) {
    writeInterfaces(writer,modelNode.get(INTERFACE));
    writeNewLine(writer);
  }
  if (modelNode.hasDefined(JVM)) {
    writer.writeStartElement(Element.JVMS.getLocalName());
    for (    final Property jvm : modelNode.get(JVM).asPropertyList()) {
      JvmXml.writeJVMElement(writer,jvm.getName(),jvm.getValue());
    }
    writer.writeEndElement();
    writeNewLine(writer);
  }
  if (modelNode.hasDefined(SERVER_CONFIG)) {
    writer.writeStartElement(Element.SERVERS.getLocalName());
    HostResourceDefinition.DIRECTORY_GROUPING.marshallAsAttribute(modelNode,writer);
    writeServers(writer,modelNode.get(SERVER_CONFIG));
    writeNewLine(writer);
    writer.writeEndElement();
  }
  writer.writeEndElement();
  writeNewLine(writer);
  writer.writeEndDocument();
}
