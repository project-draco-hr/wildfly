{
  boolean wildcard=getPathElement().isWildcard();
  model=wildcard ? model.get(getPathElement().getKey()) : model.get(getPathElement().getKeyValuePair());
  if (!model.isDefined() && !useValueAsElementName()) {
    return;
  }
  boolean writeWrapper=getXmlWrapperElement() != null;
  if (writeWrapper) {
    writer.writeStartElement(getXmlWrapperElement());
  }
  if (wildcard) {
    for (    Property p : model.asPropertyList()) {
      if (useValueAsElementName()) {
        writer.writeStartElement(p.getName());
      }
 else {
        writer.writeStartElement(getXmlElementName());
        writer.writeAttribute(NAME,p.getName());
      }
      for (      AttributeDefinition def : getAttributes()) {
        def.getAttributeMarshaller().marshallAsAttribute(def,p.getValue(),false,writer);
      }
      persistChildren(writer,p.getValue());
      writer.writeEndElement();
    }
  }
 else {
    if (useValueAsElementName()) {
      writer.writeStartElement(getPathElement().getValue());
    }
 else {
      writer.writeStartElement(getXmlElementName());
    }
    for (    AttributeDefinition def : getAttributes()) {
      def.getAttributeMarshaller().marshallAsAttribute(def,model,false,writer);
    }
    persistChildren(writer,model);
    writer.writeEndElement();
  }
  if (writeWrapper) {
    writer.writeEndElement();
  }
}
