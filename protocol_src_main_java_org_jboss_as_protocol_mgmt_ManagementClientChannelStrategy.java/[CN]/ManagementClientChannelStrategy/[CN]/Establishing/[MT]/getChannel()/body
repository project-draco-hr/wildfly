{
  try {
    final ProtocolChannelClient.Configuration<ManagementChannel> configuration=new ProtocolChannelClient.Configuration<ManagementChannel>();
    addConfigurationProperties(configuration);
    configuration.setUri(new URI("remote://" + hostName + ":"+ port));
    configuration.setChannelFactory(new ManagementChannelFactory());
    client=ProtocolChannelClient.create(configuration);
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
  for (int i=0; i < 20; i++) {
    try {
      client.connect();
      break;
    }
 catch (    ConnectException e) {
    }
catch (    IOException e) {
      throw new RuntimeException(e);
    }
  }
  try {
    channel=client.openChannel("management");
    channel.setOperationHandler(handler);
    channel.startReceiving();
    return channel;
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
