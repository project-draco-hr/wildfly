{
  try {
    final ProtocolChannelClient.Configuration configuration=new ProtocolChannelClient.Configuration();
    configuration.setEndpointName("endpoint");
    configuration.setUriScheme("remote");
    configuration.setUri(new URI("remote://" + hostName + ":"+ port));
    configuration.setExecutor(executorService);
    configuration.setChannelReceiverFactory(new ManagementChannelReceiverFactory());
    client=ProtocolChannelClient.create(configuration);
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
  for (int i=0; i < 20; i++) {
    try {
      client.connect();
      break;
    }
 catch (    ConnectException e) {
    }
catch (    IOException e) {
      throw new RuntimeException(e);
    }
  }
  try {
    channel=client.openChannel("management");
    channel.getReceiver(ManagementChannelReceiver.class).setOperationHandler(handler);
    channel.startReceiving();
    return channel;
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
}
