{
  final ServiceContainer serviceContainer=context.getController().getServiceContainer();
  final BatchBuilder batchBuilder=serviceContainer.batchBuilder();
  batchBuilder.addListener(serverStartupListener);
  final BootUpdateContext updateContext=new BootUpdateContext(){
    public BatchBuilder getBatchBuilder(){
      return batchBuilder;
    }
    public ServiceContainer getServiceContainer(){
      return serviceContainer;
    }
    public void addDeploymentProcessor(    DeploymentUnitProcessor processor,    long priority){
      throw new UnsupportedOperationException("Deployments are not allowed to add deployment unit processors");
    }
  }
;
  for (  AbstractServerModelUpdate<?> update : updates) {
    if (update.isDeploymentUpdate()) {
      update.applyUpdateBootAction(updateContext);
    }
  }
  try {
    batchBuilder.install();
    serverStartupListener.finish();
  }
 catch (  ServiceRegistryException e) {
    throw new IllegalStateException("Failed to install deployment services",e);
  }
}
