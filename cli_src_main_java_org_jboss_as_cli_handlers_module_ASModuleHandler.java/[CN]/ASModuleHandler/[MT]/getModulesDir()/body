{
  if (modulesDir != null) {
    return modulesDir;
  }
  final String modulesDirStr=WildFlySecurityManager.getEnvPropertyPrivileged(JBOSS_HOME,null);
  if (modulesDirStr == null) {
    throw new CommandLineException(JBOSS_HOME + " environment variable is not set.");
  }
  modulesDir=new File(modulesDirStr,"modules");
  if (!modulesDir.exists()) {
    throw new CommandLineException("Failed to locate the modules dir on the filesystem: " + modulesDir.getAbsolutePath());
  }
  return modulesDir;
}
