{
  this.standalone=standalone;
  if (props == null) {
    throw new IllegalArgumentException("props is null");
  }
  if (processName == null && !standalone) {
    throw new IllegalArgumentException("processName is null");
  }
  this.processName=processName;
  homeDir=getFileFromProperty(HOME_DIR,props);
  if (homeDir == null)   throw new IllegalStateException("Missing configuration value for: " + HOME_DIR);
  System.setProperty(HOME_DIR,homeDir.getAbsolutePath());
  File tmp=getFileFromProperty(MODULES_DIR,props);
  if (tmp == null) {
    tmp=new File(homeDir,"modules");
  }
  modulesDir=tmp;
  System.setProperty(MODULES_DIR,modulesDir.getAbsolutePath());
  tmp=getFileFromProperty(SERVER_BASE_DIR,props);
  if (tmp == null) {
    tmp=new File(homeDir,"standalone");
  }
  serverBaseDir=tmp;
  System.setProperty(SERVER_BASE_DIR,serverBaseDir.getAbsolutePath());
  tmp=getFileFromProperty(SERVER_CONFIG_DIR,props);
  if (tmp == null) {
    tmp=new File(serverBaseDir,"configuration");
  }
  serverConfigurationDir=tmp;
  System.setProperty(SERVER_CONFIG_DIR,serverConfigurationDir.getAbsolutePath());
  tmp=getFileFromProperty(SERVER_DATA_DIR,props);
  if (tmp == null) {
    tmp=new File(serverBaseDir,"data");
  }
  serverDataDir=tmp;
  System.setProperty(SERVER_DATA_DIR,serverDataDir.getAbsolutePath());
  tmp=getFileFromProperty(SERVER_DEPLOY_DIR,props);
  if (tmp == null) {
    tmp=new File(serverDataDir,"content");
  }
  serverDeployDir=tmp;
  System.setProperty(SERVER_DEPLOY_DIR,serverDeployDir.getAbsolutePath());
  tmp=getFileFromProperty(SERVER_LOG_DIR,props);
  if (tmp == null) {
    tmp=new File(serverBaseDir,"log");
  }
  serverLogDir=tmp;
  System.setProperty(SERVER_LOG_DIR,serverLogDir.getAbsolutePath());
  tmp=getFileFromProperty(SERVER_TEMP_DIR,props);
  if (tmp == null) {
    tmp=new File(serverBaseDir,"tmp");
  }
  serverTempDir=tmp;
  System.setProperty(SERVER_TEMP_DIR,serverTempDir.getAbsolutePath());
}
