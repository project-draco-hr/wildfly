{
  final Archive<?> archive=event.getDeployment().getArchive();
  if (archive instanceof LibraryContainer) {
    JavaArchive jar=ShrinkWrap.create(JavaArchive.class,"jbossInContainerSetupObserverExtensionSupportClasses.jar");
    jar.addClasses(InContainerExtension.class,InContainerManagementClientProvider.class,ManagementClient.class);
    jar.addAsServiceProvider(Extension.class,InContainerExtension.class);
    ((LibraryContainer)archive).addAsLibrary(jar);
  }
 else   if (archive instanceof ClassContainer) {
    ((ClassContainer)archive).addClasses(InContainerExtension.class,InContainerManagementClientProvider.class,ManagementClient.class);
    ((ManifestContainer)archive).addAsServiceProvider(Extension.class,InContainerExtension.class);
  }
}
