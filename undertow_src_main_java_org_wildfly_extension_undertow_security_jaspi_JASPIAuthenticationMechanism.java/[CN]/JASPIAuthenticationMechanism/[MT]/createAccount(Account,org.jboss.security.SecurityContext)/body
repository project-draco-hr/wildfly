{
  if (jbossSct == null) {
    throw MESSAGES.nullParamter("org.jboss.security.SecurityContext");
  }
  Principal userPrincipal=jbossSct.getUtil().getUserPrincipal();
  if (userPrincipal == null) {
    return null;
  }
  if (cachedAccount != null && cachedAccount.getPrincipal() == userPrincipal) {
    jbossSct.getUtil().createSubjectInfo(userPrincipal,((AccountImpl)cachedAccount).getCredential(),null);
    RoleGroup roleGroup=new SimpleRoleGroup(SecurityConstants.ROLES_IDENTIFIER);
    for (    String role : cachedAccount.getRoles())     roleGroup.addRole(new SimpleRole(role));
    jbossSct.getUtil().setRoles(roleGroup);
    return cachedAccount;
  }
  Set<String> stringRoles=new HashSet<String>();
  RoleGroup roleGroup=jbossSct.getUtil().getRoles();
  if (roleGroup != null) {
    for (    Role role : roleGroup.getRoles()) {
      stringRoles.add(role.getRoleName());
    }
  }
  Object credential=jbossSct.getUtil().getCredential();
  return new AccountImpl(userPrincipal,stringRoles,credential);
}
