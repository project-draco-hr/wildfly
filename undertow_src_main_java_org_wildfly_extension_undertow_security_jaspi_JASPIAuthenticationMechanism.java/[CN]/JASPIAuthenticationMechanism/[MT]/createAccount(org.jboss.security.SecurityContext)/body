{
  if (jbossSct == null) {
    throw MESSAGES.nullParamter("org.jboss.security.SecurityContext");
  }
  Principal userPrincipal=jbossSct.getUtil().getUserPrincipal();
  if (userPrincipal == null) {
    return null;
  }
  Set<String> stringRoles=new HashSet<String>();
  RoleGroup roleGroup=jbossSct.getUtil().getRoles();
  if (roleGroup != null) {
    for (    Role role : roleGroup.getRoles()) {
      stringRoles.add(role.getRoleName());
    }
  }
  Object credential=jbossSct.getUtil().getCredential();
  return new AccountImpl(userPrincipal,stringRoles,credential);
}
