{
  final Unmarshaller unmarshaller=getUnmarshaller();
  unmarshaller.start(Marshalling.createByteInput(input));
  try {
    expectHeader(unmarshaller,DomainControllerProtocol.PARAM_DOMAIN_MODEL);
    log.infof("Registered with remote domain controller");
    final DomainModel domainModel=unmarshal(unmarshaller,DomainModel.class);
    unmarshaller.finish();
    return domainModel;
  }
  finally {
    safeFinish(unmarshaller);
  }
}
