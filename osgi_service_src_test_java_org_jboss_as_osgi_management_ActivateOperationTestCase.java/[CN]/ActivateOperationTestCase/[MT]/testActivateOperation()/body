{
  ModelNode activateOp=new ModelNode();
  activateOp.get(ModelDescriptionConstants.OP_ADDR).add(ModelDescriptionConstants.SUBSYSTEM,"osgi");
  activateOp.get(ModelDescriptionConstants.OP).set(ModelConstants.ACTIVATE);
  ServiceController sc=Mockito.mock(ServiceController.class);
  Mockito.when(sc.getState()).thenReturn(State.UP);
  ServiceRegistry sr=Mockito.mock(ServiceRegistry.class);
  Mockito.when(sr.getRequiredService(Services.FRAMEWORK_ACTIVE)).thenReturn(sc);
  OperationContext context=Mockito.mock(OperationContext.class);
  Mockito.when(context.getServiceRegistry(true)).thenReturn(sr);
  ActivateOperationHandler.INSTANCE.executeRuntimeStep(context,activateOp);
  Mockito.verify(sc).setMode(Mode.ACTIVE);
  Mockito.verify(context).completeStep(OperationContext.RollbackHandler.NOOP_ROLLBACK_HANDLER);
}
