{
  this.persister=persister;
  ByteArrayOutputStream output=new ByteArrayOutputStream(1024 * 8);
  try {
    try {
      persister.marshallAsXml(model,output);
    }
  finally {
      try {
        output.close();
      }
 catch (      Exception ignore) {
      }
      bytes=output.toByteArray();
    }
  }
 catch (  Exception e) {
    throw new ConfigurationPersistenceException("Failed to marshal configuration",e);
  }
}
