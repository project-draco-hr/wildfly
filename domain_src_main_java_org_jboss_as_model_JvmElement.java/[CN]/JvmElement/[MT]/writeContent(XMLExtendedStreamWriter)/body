{
  streamWriter.writeAttribute(Attribute.NAME.getLocalName(),name);
  if (javaHome != null) {
    streamWriter.writeAttribute(Attribute.JAVA_HOME.getLocalName(),javaHome);
  }
  if (type != null) {
    streamWriter.writeAttribute(Attribute.TYPE.getLocalName(),type.toString());
  }
  if (debugEnabled != null) {
    streamWriter.writeAttribute(Attribute.DEBUG_ENABLED.getLocalName(),debugEnabled.toString());
  }
  if (debugOptions != null) {
    streamWriter.writeAttribute(Attribute.DEBUG_OPTIONS.getLocalName(),debugOptions.toString());
  }
  if (envClasspathIgnored != null) {
    streamWriter.writeAttribute(Attribute.ENV_CLASSPATH_IGNORED.getLocalName(),envClasspathIgnored.toString());
  }
  if (heapSize != null || maxHeap != null) {
    streamWriter.writeStartElement(Element.HEAP.getLocalName());
    if (heapSize != null)     streamWriter.writeAttribute(Attribute.SIZE.getLocalName(),heapSize);
    if (maxHeap != null)     streamWriter.writeAttribute(Attribute.MAX_SIZE.getLocalName(),maxHeap);
    streamWriter.writeEndElement();
  }
  if (permgenSize != null || maxPermgen != null) {
    streamWriter.writeStartElement(Element.PERMGEN.getLocalName());
    if (permgenSize != null)     streamWriter.writeAttribute(Attribute.SIZE.getLocalName(),permgenSize);
    if (maxPermgen != null)     streamWriter.writeAttribute(Attribute.MAX_SIZE.getLocalName(),permgenSize);
    streamWriter.writeEndElement();
  }
  if (stack != null) {
    streamWriter.writeStartElement(Element.STACK.getLocalName());
    streamWriter.writeAttribute(Attribute.SIZE.getLocalName(),stack);
    streamWriter.writeEndElement();
  }
  if (agentLib != null) {
    streamWriter.writeStartElement(Element.AGENT_LIB.getLocalName());
    streamWriter.writeAttribute(Attribute.VALUE.getLocalName(),agentLib);
    streamWriter.writeEndElement();
  }
  if (agentPath != null) {
    streamWriter.writeStartElement(Element.AGENT_PATH.getLocalName());
    streamWriter.writeAttribute(Attribute.VALUE.getLocalName(),agentPath);
    streamWriter.writeEndElement();
  }
  if (javaagent != null) {
    streamWriter.writeStartElement(Element.JAVA_AGENT.getLocalName());
    streamWriter.writeAttribute(Attribute.VALUE.getLocalName(),javaagent);
    streamWriter.writeEndElement();
  }
  if (environmentVariables != null && environmentVariables.size() > 0) {
    streamWriter.writeStartElement(Element.ENVIRONMENT_VARIABLES.getLocalName());
    environmentVariables.writeContent(streamWriter);
  }
  if (systemProperties != null && systemProperties.size() > 0) {
    streamWriter.writeStartElement(Element.SYSTEM_PROPERTIES.getLocalName());
    systemProperties.writeContent(streamWriter);
  }
}
