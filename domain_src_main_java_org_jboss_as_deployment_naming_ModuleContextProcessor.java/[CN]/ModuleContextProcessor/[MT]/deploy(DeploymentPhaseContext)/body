{
  final ServiceTarget serviceTarget=phaseContext.getBatchBuilder();
  final ServiceName moduleContextServiceName=ContextNames.GLOBAL_CONTEXT_SERVICE_NAME.append(phaseContext.getName());
  final JndiName moduleContextJndiName=ContextNames.GLOBAL_CONTEXT_NAME.append(phaseContext.getName());
  final ContextService contextService=new ContextService(moduleContextJndiName);
  serviceTarget.addService(moduleContextServiceName,contextService).addDependency(ContextNames.GLOBAL_CONTEXT_SERVICE_NAME,Context.class,contextService.getParentContextInjector()).install();
  phaseContext.putAttachment(ModuleContextConfig.ATTACHMENT_KEY,new ModuleContextConfig(moduleContextServiceName,moduleContextJndiName));
}
