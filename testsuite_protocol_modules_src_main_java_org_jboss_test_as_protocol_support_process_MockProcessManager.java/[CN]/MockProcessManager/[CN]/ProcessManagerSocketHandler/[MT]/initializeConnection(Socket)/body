{
  InputStream in=socket.getInputStream();
  StringBuilder sb=new StringBuilder();
  Status status=StreamUtils.readWord(in,sb);
  if (status != Status.MORE) {
    throw new InitialSocketRequestException("Process acceptor: received '" + sb.toString() + "' but no more");
  }
  if (!sb.toString().equals("CONNECTED")) {
    throw new InitialSocketRequestException("Process acceptor: received unknown start command '" + sb.toString() + "'");
  }
  sb=new StringBuilder();
  while (status == Status.MORE) {
    status=StreamUtils.readWord(in,sb);
  }
  String processName=sb.toString();
  SocketConnection conn=SocketConnection.accepted(socket);
  if (processName.equals("ServerManager")) {
    serverManager.setPmConnection(conn);
    serveManagerLatch.countDown();
  }
 else {
    MockManagedProcess process=serverProcesses.get(processName);
    if (process != null) {
      process.setPmConnection(conn);
    }
  }
  if (newConnectionListener != null)   newConnectionListener.acceptedConnection(processName,conn);
  log.info("PM got connection from " + processName);
}
