{
  String[] mechanisms=null;
  String listed;
  if (saslOptions != null && (listed=saslOptions.get(Options.SASL_DISALLOWED_MECHANISMS.getName())) != null) {
    String[] split=listed.split(" ");
    if (isLocal) {
      mechanisms=new String[split.length + 1];
      mechanisms[0]=JBOSS_LOCAL_USER;
      System.arraycopy(split,0,mechanisms,1,split.length);
    }
 else {
      mechanisms=split;
    }
  }
 else   if (!isLocal) {
    mechanisms=new String[]{JBOSS_LOCAL_USER};
  }
  if (mechanisms != null) {
    builder.set(Options.SASL_DISALLOWED_MECHANISMS,Sequence.of(mechanisms));
  }
  if (saslOptions != null && (listed=saslOptions.get(Options.SASL_MECHANISMS.getName())) != null) {
    String[] split=listed.split(" ");
    if (split.length > 0) {
      builder.set(Options.SASL_MECHANISMS,Sequence.of(split));
    }
  }
}
