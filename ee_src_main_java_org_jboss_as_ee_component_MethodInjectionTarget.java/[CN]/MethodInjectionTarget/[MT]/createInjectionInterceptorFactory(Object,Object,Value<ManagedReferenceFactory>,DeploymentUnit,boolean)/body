{
  final String name=getName();
  final String className=getClassName();
  final String paramType=getDeclaredValueClassName();
  final Module module=deploymentUnit.getAttachment(MODULE);
  final ModuleClassLoader classLoader=module.getClassLoader();
  final DeploymentReflectionIndex reflectionIndex=deploymentUnit.getAttachment(REFLECTION_INDEX);
  final ClassReflectionIndex<?> classIndex;
  try {
    classIndex=reflectionIndex.getClassIndex(Class.forName(className,false,classLoader));
  }
 catch (  ClassNotFoundException e) {
    throw new DeploymentUnitProcessingException(e);
  }
  Collection<Method> methods;
  if (paramType != null) {
    methods=ClassReflectionIndexUtil.findMethods(reflectionIndex,classIndex,name,paramType);
  }
 else {
    methods=ClassReflectionIndexUtil.findAllMethods(reflectionIndex,classIndex,name,1);
  }
  Iterator<Method> iterator=methods.iterator();
  if (!iterator.hasNext()) {
    throw new DeploymentUnitProcessingException("No matching method found for method " + name + "("+ paramType+ ")"+ " on "+ className);
  }
  Method method=iterator.next();
  if (iterator.hasNext()) {
    throw new DeploymentUnitProcessingException("More than one matching method found for method '" + name + "("+ paramType+ ")"+ " on "+ className);
  }
  return new ManagedReferenceMethodInjectionInterceptorFactory(targetContextKey,valueContextKey,factoryValue,method,optional);
}
