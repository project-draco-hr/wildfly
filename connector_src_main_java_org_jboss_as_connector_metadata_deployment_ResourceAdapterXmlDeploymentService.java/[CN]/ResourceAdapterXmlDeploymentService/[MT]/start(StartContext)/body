{
  try {
    Connector cmd=mdr.getValue().getResourceAdapter(deployment);
    IronJacamar ijmd=mdr.getValue().getIronJacamar(deployment);
    File root=mdr.getValue().getRoot(deployment);
    cmd=(new Merger()).mergeConnectorWithCommonIronJacamar(raxml,cmd);
    final ServiceContainer container=context.getController().getServiceContainer();
    final AS7RaXmlDeployer raDeployer=new AS7RaXmlDeployer(context.getChildTarget(),connectorXmlDescriptor.getUrl(),raName,root,module.getClassLoader(),cmd,raxml,ijmd);
    raDeployer.setConfiguration(config.getValue());
    try {
      WritableServiceBasedNamingStore.pushOwner(container.subTarget());
      ClassLoader old=SecurityActions.getThreadContextClassLoader();
      try {
        SecurityActions.setThreadContextClassLoader(module.getClassLoader());
        raxmlDeployment=raDeployer.doDeploy();
      }
  finally {
        SecurityActions.setThreadContextClassLoader(old);
        WritableServiceBasedNamingStore.popOwner();
      }
    }
 catch (    Throwable t) {
      throw MESSAGES.failedToStartRaDeployment(t,raName);
    }
    value=new ResourceAdapterDeployment(raxmlDeployment);
    managementRepository.getValue().getConnectors().add(value.getDeployment().getConnector());
    registry.getValue().registerResourceAdapterDeployment(value);
    ServiceName raServiceName=ConnectorServices.registerResourceAdapter(raName);
    context.getChildTarget().addService(raServiceName,new ResourceAdapterService(raName,raServiceName,value.getDeployment().getResourceAdapter())).addDependency(deploymentServiceName).setInitialMode(ServiceController.Mode.ACTIVE).install();
  }
 catch (  Exception e) {
    throw new StartException(e);
  }
}
