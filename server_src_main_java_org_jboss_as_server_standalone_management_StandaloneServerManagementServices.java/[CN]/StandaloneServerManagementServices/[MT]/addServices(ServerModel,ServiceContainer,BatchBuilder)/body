{
  ManagementElement managementElement=serverModel.getManagementElement();
  if (managementElement != null) {
    final ManagementCommunicationService managementCommunicationService=new ManagementCommunicationService();
    batchBuilder.addService(ManagementCommunicationService.SERVICE_NAME,managementCommunicationService).addDependency(NetworkInterfaceService.JBOSS_NETWORK_INTERFACE.append(managementElement.getInterfaceName()),NetworkInterfaceBinding.class,managementCommunicationService.getInterfaceInjector()).addInjection(managementCommunicationService.getPortInjector(),managementElement.getPort()).addInjection(managementCommunicationService.getExecutorServiceInjector(),Executors.newCachedThreadPool()).addInjection(managementCommunicationService.getThreadFactoryInjector(),Executors.defaultThreadFactory()).setInitialMode(ServiceController.Mode.ACTIVE).install();
    final ServerControllerOperationHandler clientOperationHandler=new ServerControllerOperationHandler(container);
    batchBuilder.addService(ServerControllerOperationHandler.SERVICE_NAME,clientOperationHandler).addDependency(ServerController.SERVICE_NAME,ServerController.class,clientOperationHandler.getServerControllerInjector()).addDependency(ManagementCommunicationService.SERVICE_NAME,ManagementCommunicationService.class,new ManagementCommunicationServiceInjector(clientOperationHandler)).addDependency(ServerConfigurationPersister.SERVICE_NAME,ServerConfigurationPersister.class,clientOperationHandler.getConfigurationPersisterValue()).addDependency(ServerDeploymentRepository.SERVICE_NAME,ServerDeploymentRepository.class,clientOperationHandler.getDeploymentRepositoryInjector()).addDependency(ServerDeploymentManager.SERVICE_NAME_LOCAL,ServerDeploymentManager.class,clientOperationHandler.getDeploymentManagerInjector()).addDependency(ShutdownHandler.SERVICE_NAME,ShutdownHandler.class,clientOperationHandler.getShutdownHandlerValue()).addInjection(clientOperationHandler.getExecutorValue(),Executors.newCachedThreadPool()).setInitialMode(ServiceController.Mode.ACTIVE).install();
  }
}
