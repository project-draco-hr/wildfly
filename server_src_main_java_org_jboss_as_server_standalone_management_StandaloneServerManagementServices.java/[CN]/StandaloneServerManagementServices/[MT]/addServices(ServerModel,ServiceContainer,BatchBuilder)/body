{
  ManagementElement managementElement=serverModel.getManagementElement();
  if (managementElement != null) {
    final ServerControllerImpl serverController=new ServerControllerImpl(container,serverModel);
    batchBuilder.addService(ServerController.SERVICE_NAME,serverController);
    final ManagementCommunicationService managementCommunicationService=new ManagementCommunicationService();
    batchBuilder.addService(ManagementCommunicationService.SERVICE_NAME,managementCommunicationService).addDependency(NetworkInterfaceService.JBOSS_NETWORK_INTERFACE.append(managementElement.getInterfaceName()),NetworkInterfaceBinding.class,managementCommunicationService.getInterfaceInjector()).addInjection(managementCommunicationService.getPortInjector(),managementElement.getPort()).addInjection(managementCommunicationService.getExecutorServiceInjector(),Executors.newCachedThreadPool()).addInjection(managementCommunicationService.getThreadFactoryInjector(),Executors.defaultThreadFactory()).setInitialMode(ServiceController.Mode.ACTIVE);
    final ServerControllerOperationHandler serverControllerOperationHandler=new ServerControllerOperationHandler();
    batchBuilder.addService(ServerControllerOperationHandler.SERVICE_NAME,serverControllerOperationHandler).addDependency(ServerController.SERVICE_NAME,ServerController.class,serverControllerOperationHandler.getServerControllerInjector()).addDependency(ManagementCommunicationService.SERVICE_NAME,ManagementCommunicationService.class,new ManagementCommunicationServiceInjector(serverControllerOperationHandler)).setInitialMode(ServiceController.Mode.ACTIVE);
  }
}
