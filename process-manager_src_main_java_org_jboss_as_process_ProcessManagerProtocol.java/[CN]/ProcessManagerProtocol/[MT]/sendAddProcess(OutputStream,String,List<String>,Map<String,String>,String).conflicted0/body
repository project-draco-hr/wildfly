{
  if (processName == null) {
    throw new IllegalArgumentException("processName is null");
  }
  if (command == null) {
    throw new IllegalArgumentException("command is null");
  }
  if (env == null) {
    throw new IllegalArgumentException("env is null");
  }
  if (workingDirectory == null) {
    throw new IllegalArgumentException("workingDirectory is null");
  }
  final StringBuilder b=new StringBuilder(256);
  b.append(this).append('\0');
  b.append(processName).append('\0');
  b.append(workingDirectory).append('\0');
  b.append(command.size()).append('\0');
  for (  String str : command) {
    b.append(str).append('\0');
  }
  b.append(env.size());
  for (  Map.Entry<String,String> entry : env.entrySet()) {
    final String key=entry.getKey();
    if (key != null) {
      b.append('\0').append(key);
      final String value=entry.getValue();
      b.append('\0');
      if (value != null)       b.append(value);
    }
  }
  b.append('\n');
synchronized (output) {
    StreamUtils.writeString(output,b);
    output.flush();
  }
}
