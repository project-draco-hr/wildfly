{
  if (!(permission instanceof JndiPermission))   return false;
  JndiPermission fp=(JndiPermission)permission;
  int desired=fp.getMask();
  int effective=0;
  int needed=desired;
synchronized (this) {
    for (    JndiPermission x : perms) {
      if (((needed & x.getMask()) != 0) && x.impliesIgnoreMask(fp)) {
        effective|=x.getMask();
        if ((effective & desired) == desired)         return true;
        needed=(desired ^ effective);
      }
    }
  }
  return false;
}
