{
  int streamIndex=operation.get(INPUT_STREAM_INDEX).asInt();
  if (streamIndex > context.getInputStreams().size() - 1) {
    throw new IllegalArgumentException("Invalid " + INPUT_STREAM_INDEX + "="+ streamIndex+ ", the maximum index is "+ (context.getInputStreams().size() - 1));
  }
  InputStream in=context.getInputStreams().get(streamIndex);
  if (in == null) {
    throw new IllegalStateException("Null stream at index " + streamIndex);
  }
  return in;
}
