{
  final JavaArchive archive=ShrinkWrap.create(JavaArchive.class,TARGET_MODULE_NAME);
  archive.addClasses(Echo.class,EchoService.class,TargetModuleActivator.class);
  String activatorPath="META-INF/services/" + ServiceActivator.class.getName();
  archive.addAsResource(OSGiTestHelper.getResourceFile("osgi/xservice/target-module/" + activatorPath),activatorPath);
  archive.setManifest(new Asset(){
    public InputStream openStream(){
      ManifestBuilder builder=ManifestBuilder.newInstance();
      builder.addManifestHeader("Dependencies","org.jboss.modules,org.jboss.logging");
      return builder.openStream();
    }
  }
);
  return archive;
}
