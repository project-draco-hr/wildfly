{
  try {
    if (serviceContainer == null) {
      throw new DeployException("ServiceContainer not provided");
    }
    this.serviceContainer=serviceContainer;
    HashMap<String,org.jboss.jca.common.api.metadata.ds.Driver> drivers=new HashMap<String,org.jboss.jca.common.api.metadata.ds.Driver>(1);
    DataSources dataSources=null;
    if (dataSourceConfig != null) {
      InstalledDriver installedDriver=driverRegistry.getValue().getInstalledDriver(dataSourceConfig.getDriver());
      org.jboss.jca.common.api.metadata.ds.Driver driver=new DriverImpl(installedDriver.getDriverName(),installedDriver.getMajorVersion(),installedDriver.getMinorVersion(),installedDriver.getModuleName().getName(),installedDriver.getDriverClassName(),installedDriver.getXaDataSourceClassName());
      drivers.put(driver.getName(),driver);
      dataSources=new DatasourcesImpl(Arrays.asList(dataSourceConfig),null,drivers);
    }
 else     if (xaDataSourceConfig != null) {
      InstalledDriver installedDriver=driverRegistry.getValue().getInstalledDriver(xaDataSourceConfig.getDriver());
      org.jboss.jca.common.api.metadata.ds.Driver driver=new DriverImpl(installedDriver.getDriverName(),installedDriver.getMajorVersion(),installedDriver.getMinorVersion(),installedDriver.getModuleName().getName(),installedDriver.getDriverClassName(),installedDriver.getXaDataSourceClassName());
      drivers.put(driver.getName(),driver);
      dataSources=new DatasourcesImpl(null,Arrays.asList(xaDataSourceConfig),drivers);
    }
    CommonDeployment c=createObjectsAndInjectValue(new URL("file://DataSourceDeployment"),jndiName,"uniqueJdbcLocalId","uniqueJdbcXAId",dataSources,AbstractDataSourceService.class.getClassLoader());
    return c;
  }
 catch (  MalformedURLException e) {
    throw new DeployException("unable to deploy",e);
  }
catch (  ValidateException e) {
    throw new DeployException("unable to validate and deploy ds or xads",e);
  }
}
