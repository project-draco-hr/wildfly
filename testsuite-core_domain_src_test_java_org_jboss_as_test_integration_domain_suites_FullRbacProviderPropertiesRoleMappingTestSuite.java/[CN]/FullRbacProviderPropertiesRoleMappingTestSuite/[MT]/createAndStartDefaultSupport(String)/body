{
  try {
    final DomainTestSupport.Configuration configuration=DomainTestSupport.Configuration.create(testName,"domain-configs/domain-rbac.rbac","host-configs/host-master-rbac-properties.xml","host-configs/host-slave-rbac-properties.xml");
    String mgmtUserProperties=WildFlyManagedConfiguration.loadConfigFileFromContextClassLoader("mgmt-users/mgmt-users.properties");
    String mgmtGroupsProperties=WildFlyManagedConfiguration.loadConfigFileFromContextClassLoader("mgmt-users/mgmt-groups.properties");
    configuration.getMasterConfiguration().setMgmtUsersFile(mgmtUserProperties);
    configuration.getSlaveConfiguration().setMgmtUsersFile(mgmtUserProperties);
    configuration.getMasterConfiguration().setMgmtGroupsFile(mgmtGroupsProperties);
    configuration.getSlaveConfiguration().setMgmtGroupsFile(mgmtGroupsProperties);
    final DomainTestSupport testSupport=DomainTestSupport.create(configuration);
    testSupport.start();
    ExtensionSetup.initializeTestExtension(testSupport);
    ExtensionSetup.addExtensionAndSubsystem(testSupport);
    return testSupport;
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
}
