{
  final DeploymentUnit unit=phaseContext.getDeploymentUnit();
  final CompositeIndex index=unit.getAttachment(org.jboss.as.server.deployment.Attachments.COMPOSITE_ANNOTATION_INDEX);
  final List<AnnotationInstance> webServiceRefAnnotations=index.getAnnotations(WEB_SERVICE_REF_ANNOTATION_NAME);
  for (  final AnnotationInstance annotation : webServiceRefAnnotations) {
    final AnnotationTarget annotationTarget=annotation.target();
    final WSRefAnnotationWrapper annotationWrapper=new WSRefAnnotationWrapper(annotation);
    if (annotationTarget instanceof FieldInfo) {
      processFieldRef(unit,annotationWrapper,(FieldInfo)annotationTarget);
    }
 else     if (annotationTarget instanceof MethodInfo) {
      processMethodRef(unit,annotationWrapper,(MethodInfo)annotationTarget);
    }
 else     if (annotationTarget instanceof ClassInfo) {
      processClassRef(unit,annotationWrapper,(ClassInfo)annotationTarget);
    }
  }
  final List<AnnotationInstance> webServiceRefsAnnotations=index.getAnnotations(WEB_SERVICE_REFS_ANNOTATION_NAME);
  for (  final AnnotationInstance outerAnnotation : webServiceRefsAnnotations) {
    final AnnotationTarget annotationTarget=outerAnnotation.target();
    if (annotationTarget instanceof ClassInfo) {
      final AnnotationInstance[] values=outerAnnotation.value("value").asNestedArray();
      for (      final AnnotationInstance annotation : values) {
        final WSRefAnnotationWrapper annotationWrapper=new WSRefAnnotationWrapper(annotation);
        processClassRef(unit,annotationWrapper,(ClassInfo)annotationTarget);
      }
    }
  }
}
