{
  if (reference instanceof ModularReference) {
    return factoryFromModularReference(ModularReference.class.cast(reference),environment);
  }
 else   if (reference instanceof ReferenceWithClassLoader) {
    return factoryFromReferenceClassLoader(ReferenceWithClassLoader.class.cast(reference),environment);
  }
  return factoryFromReference(reference,getClassLoader(),environment);
}
