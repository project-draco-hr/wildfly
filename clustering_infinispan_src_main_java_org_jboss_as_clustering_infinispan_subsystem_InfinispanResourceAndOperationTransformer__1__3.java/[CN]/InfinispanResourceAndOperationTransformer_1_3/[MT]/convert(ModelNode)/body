{
  boolean segmentExpression=false;
  if (model.has(ModelKeys.SEGMENTS)) {
    if (model.hasDefined(ModelKeys.SEGMENTS)) {
      ModelNode segments=model.get(ModelKeys.SEGMENTS);
      segmentExpression=isExpression(segments);
      if (!segmentExpression) {
        int segmentsValue=Integer.parseInt(segments.asString());
        int virtualNodes=(segmentsValue / SEGMENTS_PER_VIRTUAL_NODE) + 1;
        model.get(ModelKeys.VIRTUAL_NODES).set(Integer.toString(virtualNodes));
      }
 else {
        model.get(ModelKeys.VIRTUAL_NODES).set(segments);
      }
    }
    model.remove(ModelKeys.SEGMENTS);
  }
  return segmentExpression;
}
