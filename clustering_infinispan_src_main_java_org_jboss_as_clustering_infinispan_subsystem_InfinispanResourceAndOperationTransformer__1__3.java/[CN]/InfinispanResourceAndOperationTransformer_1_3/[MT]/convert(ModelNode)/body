{
  if (model.has(ModelKeys.SEGMENTS)) {
    ModelNode segments=model.get(ModelKeys.SEGMENTS);
    if (segments.isDefined() && !isExpression(segments)) {
      int segmentsValue=Integer.parseInt(segments.asString());
      int virtualNodes=(segmentsValue / SEGMENTS_PER_VIRTUAL_NODE) + 1;
      model.get(ModelKeys.VIRTUAL_NODES).set(Integer.toString(virtualNodes));
    }
    model.remove(ModelKeys.SEGMENTS);
  }
}
