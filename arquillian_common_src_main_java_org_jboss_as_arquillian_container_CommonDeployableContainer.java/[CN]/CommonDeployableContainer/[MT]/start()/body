{
  if (containerConfig.getUsername() != null) {
    Authentication.username=containerConfig.getUsername();
    Authentication.password=containerConfig.getPassword();
  }
  ModelControllerClient modelControllerClient=null;
  try {
    modelControllerClient=ModelControllerClient.Factory.create(containerConfig.getManagementProtocol(),containerConfig.getManagementAddress(),containerConfig.getManagementPort(),getCallbackHandler());
  }
 catch (  UnknownHostException e) {
    throw new RuntimeException(e);
  }
  ManagementClient client=new ManagementClient(modelControllerClient,containerConfig.getManagementAddress(),containerConfig.getManagementPort(),containerConfig.getManagementProtocol());
  managementClient.set(client);
  ArchiveDeployer deployer=new ArchiveDeployer(modelControllerClient);
  archiveDeployer.set(deployer);
  try {
    final Properties jndiProps=new Properties();
    jndiProps.setProperty(Context.URL_PKG_PREFIXES,JBOSS_URL_PKG_PREFIX);
    jndiContext.set(new InitialContext(jndiProps));
  }
 catch (  final NamingException ne) {
    throw new LifecycleException("Could not set JNDI Naming Context",ne);
  }
  try {
    startInternal();
  }
 catch (  LifecycleException e) {
    safeCloseClient();
    throw e;
  }
}
