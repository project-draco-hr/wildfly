{
  if (containerConfig.getUsername() != null) {
    Authentication.username=containerConfig.getUsername();
    Authentication.password=containerConfig.getPassword();
  }
  ModelControllerClient modelControllerClient=ModelControllerClient.Factory.create(containerConfig.getManagementAddress(),containerConfig.getManagementPort(),getCallbackHandler());
  managementClient=new ManagementClient(modelControllerClient,containerConfig.getManagementAddress().getHostAddress(),containerConfig.getManagementPort());
  managementClientInst.set(managementClient);
  archiveDeployerInst.set(new ArchiveDeployer(ServerDeploymentManager.Factory.create(modelControllerClient)));
  try {
    final Properties jndiProps=new Properties();
    jndiProps.setProperty(Context.URL_PKG_PREFIXES,JBOSS_URL_PKG_PREFIX);
    jndiContext.set(new InitialContext(jndiProps));
  }
 catch (  final NamingException ne) {
    throw new LifecycleException("Could not set JNDI Naming Context",ne);
  }
  try {
    startInternal();
  }
 catch (  LifecycleException e) {
    safeCloseClient();
    throw e;
  }
}
