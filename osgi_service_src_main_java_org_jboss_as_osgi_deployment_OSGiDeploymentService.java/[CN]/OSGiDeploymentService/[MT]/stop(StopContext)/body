{
  log.tracef("Uninstalling deployment: %s",deployment);
  try {
    BundleManager bundleManager=injectedBundleManager.getValue();
    bundleManager.uninstallBundle(deployment);
  }
 catch (  Throwable t) {
    log.errorf(t,"Failed to uninstall deployment: %s",deployment);
  }
  ServiceName serviceName=Services.JBOSS_DEPLOYMENT.append(context.getController().getName().getSimpleName());
  ServiceController<?> controller=context.getController().getServiceContainer().getService(serviceName);
  if (controller != null) {
    controller.setMode(Mode.REMOVE);
  }
}
