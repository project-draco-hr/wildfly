{
  final ImmutableManagementResourceRegistration registration=getMBeanRegistration(address,reg);
  final DescriptionProvider provider=registration.getModelDescription(PathAddress.EMPTY_ADDRESS);
  if (provider == null) {
    throw JmxLogger.ROOT_LOGGER.descriptionProviderNotFound(address);
  }
  final ModelNode description=provider.getModelDescription(null);
  final String attributeName=findAttributeName(description.get(ATTRIBUTES),attribute.getName());
  if (!standalone) {
    throw JmxLogger.ROOT_LOGGER.attributeNotWritable(attribute);
  }
  if (!accessControl.isWritableAttribute(attributeName)) {
    throw JmxLogger.ROOT_LOGGER.notAuthorizedToWriteAttribute(attributeName);
  }
  ModelNode op=new ModelNode();
  op.get(OP).set(WRITE_ATTRIBUTE_OPERATION);
  op.get(OP_ADDR).set(address.toModelNode());
  op.get(NAME).set(attributeName);
  try {
    op.get(VALUE).set(converters.toModelNode(description.require(ATTRIBUTES).require(attributeName),attribute.getValue()));
  }
 catch (  ClassCastException e) {
    throw JmxLogger.ROOT_LOGGER.invalidAttributeType(e,attribute.getName());
  }
  ModelNode result=execute(op);
  String error=getFailureDescription(result);
  if (error != null) {
    if (isVaultExpression(attribute.getValue()) && error.contains(AUTHORIZED_ERROR)) {
      throw JmxLogger.ROOT_LOGGER.notAuthorizedToWriteAttribute(attributeName);
    }
    throw new InvalidAttributeValueException(error);
  }
}
