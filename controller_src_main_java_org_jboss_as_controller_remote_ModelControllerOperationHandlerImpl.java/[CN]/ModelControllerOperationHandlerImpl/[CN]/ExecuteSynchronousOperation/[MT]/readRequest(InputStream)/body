{
  super.readRequest(inputStream);
  int cmd=inputStream.read();
  if (cmd == ModelControllerClientProtocol.PARAM_REQUEST_END) {
    return;
  }
  if (cmd != ModelControllerClientProtocol.PARAM_INPUT_STREAM) {
    throw new IllegalArgumentException("Expected " + ModelControllerClientProtocol.PARAM_INPUT_STREAM + " received "+ cmd);
  }
  ByteArrayOutputStream bout=new ByteArrayOutputStream();
  try {
    byte[] buffer=new byte[8192];
    int read;
    while ((read=inputStream.read(buffer)) != -1) {
      bout.write(buffer,0,read);
    }
  }
  finally {
    StreamUtils.safeClose(inputStream);
  }
  builder.addInputStream(new ByteArrayInputStream(bout.toByteArray()));
  expectHeader(inputStream,ModelControllerClientProtocol.PARAM_REQUEST_END);
}
