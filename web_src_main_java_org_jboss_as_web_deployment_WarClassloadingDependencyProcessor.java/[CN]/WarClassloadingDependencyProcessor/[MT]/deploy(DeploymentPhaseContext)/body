{
  final DeploymentUnit deploymentUnit=phaseContext.getDeploymentUnit();
  final ModuleSpecification moduleSpecification=deploymentUnit.getAttachment(Attachments.MODULE_SPECIFICATION);
  if (!DeploymentTypeMarker.isType(DeploymentType.WAR,deploymentUnit)) {
    return;
  }
  final ModuleLoader moduleLoader=Module.getSystemModuleLoader();
  final ModuleLoader deploymentModuleLoader=deploymentUnit.getAttachment(Attachments.SERVICE_MODULE_LOADER);
  moduleSpecification.addDependency(new ModuleDependency(moduleLoader,JAVAX_EE_API,false,false,false));
  moduleSpecification.addDependency(new ModuleDependency(moduleLoader,JBOSS_WEB,false,false,false));
  moduleSpecification.addDependency(new ModuleDependency(moduleLoader,LOG,false,false,false));
  if (deploymentUnit.getParent() != null) {
    final DeploymentUnit parent=deploymentUnit.getParent();
    final ModuleIdentifier parentModule=parent.getAttachment(Attachments.MODULE_IDENTIFIER);
    if (parentModule != null) {
      moduleSpecification.addDependency(new ModuleDependency(deploymentModuleLoader,parentModule,false,false,false));
    }
  }
}
