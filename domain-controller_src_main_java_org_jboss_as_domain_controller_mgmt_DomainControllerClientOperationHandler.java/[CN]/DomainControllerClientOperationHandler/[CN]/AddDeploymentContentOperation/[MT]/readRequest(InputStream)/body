{
  ByteDataInput input=null;
  try {
    input=new SimpleByteDataInput(inputStream);
    expectHeader(input,DomainClientProtocol.PARAM_DEPLOYMENT_NAME);
    final String deploymentName=input.readUTF();
    expectHeader(input,DomainClientProtocol.PARAM_DEPLOYMENT_RUNTIME_NAME);
    final String deploymentRuntimeName=input.readUTF();
    expectHeader(input,DomainClientProtocol.PARAM_DEPLOYMENT_CONTENT);
    final ChunkyByteInput contentInput=new ChunkyByteInput(input);
    try {
      deploymentHash=deploymentRepository.addDeploymentContent(deploymentName,deploymentRuntimeName,contentInput);
    }
  finally {
      contentInput.close();
    }
  }
  finally {
    safeClose(input);
  }
}
