{
  List<DomainUpdateResult<?>> responses=new ArrayList<DomainUpdateResult<?>>(updates.size());
  for (  AbstractDomainModelUpdate<?> update : updates) {
    responses.add(processUpdate(update));
  }
  final Marshaller marshaller=getMarshaller();
  marshaller.start(createByteOutput(output));
  marshaller.writeByte(DomainClientProtocol.RETURN_APPLY_UPDATES_RESULT_COUNT);
  marshaller.writeInt(responses.size());
  for (  DomainUpdateResult<?> response : responses) {
    marshaller.writeByte(DomainClientProtocol.RETURN_APPLY_UPDATE);
    marshaller.writeObject(response);
  }
  marshaller.finish();
}
