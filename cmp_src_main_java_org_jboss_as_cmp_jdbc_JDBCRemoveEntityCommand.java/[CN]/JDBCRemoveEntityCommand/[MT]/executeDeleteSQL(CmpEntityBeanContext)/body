{
  Object key=ctx.getPrimaryKeyUnchecked();
  Connection con=null;
  PreparedStatement ps=null;
  int rowsAffected=0;
  try {
    if (log.isDebugEnabled())     log.debug("Executing SQL: " + removeEntitySQL);
    con=entity.getDataSource().getConnection();
    ps=con.prepareStatement(removeEntitySQL);
    entity.setPrimaryKeyParameters(ps,1,key);
    rowsAffected=ps.executeUpdate();
  }
 catch (  Exception e) {
    throw MESSAGES.couldNotRemoveEntity(key,e);
  }
 finally {
    JDBCUtil.safeClose(ps);
    JDBCUtil.safeClose(con);
  }
  if (rowsAffected == 0) {
    throw MESSAGES.couldNotRemoveEntityNoRows(key);
  }
  if (log.isTraceEnabled())   log.trace("Remove: Rows affected = " + rowsAffected);
}
