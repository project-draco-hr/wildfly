{
  log.info("Enter testStoppedManager");
  ++testCount;
  JBossWebMetaData webMetaData=SessionTestUtil.createWebMetaData(100);
  cacheContainer=SessionTestUtil.createCacheContainer(true,null,false,false);
  manager=SessionTestUtil.createManager(webMetaData,"test" + testCount,30,cacheContainer,null);
  manager.start();
  stopManager=true;
  Session sess1=createAndUseSession(manager,"1",true,true);
  Session sess2=createAndUseSession(manager,"2",true,true);
  Session[] sessions=manager.findSessions();
  assertNotNull(sessions);
  assertEquals(2,sessions.length);
  manager.stop();
  stopManager=false;
  assertNull(manager.findSession("1"));
  assertNull(manager.findSession("2"));
  assertNull(manager.findSessions());
  assertNull(manager.createEmptySession());
  assertNull(manager.createSession("3",new Random()));
  assertFalse(sess1.isValid());
  assertFalse(sess2.isValid());
  manager.add(sess1);
  assertFalse(sess1.isValid());
  manager.remove(sess2);
}
