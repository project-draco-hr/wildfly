{
  Manager mgr=manager;
  Session sess=mgr.findSession(id);
  assertNull("session does not exist",sess);
  try {
    sess=mgr.createSession(id,new Random());
    if (!canCreate)     fail("Could not create session" + id);
  }
 catch (  IllegalStateException ise) {
    if (canCreate) {
      log.error("Failed to create session " + id,ise);
      fail("Could create session " + id);
    }
  }
  if (access) {
    sess.access();
    sess.getSession().setAttribute("test","test");
    manager.storeSession(sess);
    sess.endAccess();
  }
  return sess;
}
