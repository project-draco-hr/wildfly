{
  String realmName=PathAddress.pathAddress(operation.require(ModelDescriptionConstants.OP_ADDR)).getLastElement().getValue();
  final Resource resource=context.readResource(PathAddress.EMPTY_ADDRESS);
  Set<String> children=resource.getChildrenNames(ModelDescriptionConstants.AUTHENTICATION);
  int max=children.contains(ModelDescriptionConstants.TRUSTSTORE) ? 2 : 1;
  if (children.size() > max) {
    Set<String> invalid=new HashSet<String>(children);
    invalid.remove(ModelDescriptionConstants.TRUSTSTORE);
    throw DomainManagementMessages.MESSAGES.multipleAuthenticationMechanismsDefined(realmName,invalid);
  }
  context.completeStep(OperationContext.RollbackHandler.NOOP_ROLLBACK_HANDLER);
}
