{
  ResourceDescriptor descriptor=new ResourceDescriptor(this.getResourceDescriptionResolver()).addAttributes(Attribute.class);
  ResourceServiceHandler handler=new SimpleResourceServiceHandler<>(new ProtocolConfigurationBuilderFactory());
  new RestartParentResourceStepHandler<ChannelFactory>(new AddStepHandler(descriptor,handler),this.parentBuilderFactory){
    @Override protected void updateModel(    OperationContext context,    ModelNode operation) throws OperationFailedException {
      super.updateModel(context,operation);
      if (ForkProtocolResourceDefinition.this.allowRuntimeOnlyRegistration && (context.getRunningMode() == RunningMode.NORMAL)) {
        context.addStep(new ForkProtocolResourceRegistrationHandler(),OperationContext.Stage.MODEL);
      }
    }
  }
.register(registration);
  new RestartParentResourceStepHandler<>(new RemoveStepHandler(descriptor,handler),this.parentBuilderFactory).register(registration);
}
