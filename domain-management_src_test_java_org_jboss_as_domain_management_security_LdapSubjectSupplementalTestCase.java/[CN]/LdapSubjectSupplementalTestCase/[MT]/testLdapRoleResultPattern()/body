{
  RealmUser realmUser=new RealmUser("TestRealm","Jack.Carter");
  HashSet<Principal> principalSet=new HashSet<Principal>();
  principalSet.add(realmUser);
  Subject subject=new Subject(false,principalSet,new HashSet<Object>(),new HashSet<Object>());
  TestLdapSubjectSupplemental subjectSupplemental=new TestLdapSubjectSupplemental(false,null,null,null,"",null,"=([^,]+)",1,"{0}-{2}");
  subjectSupplemental.supplementSubject(subject);
  Set<Principal> principals=subject.getPrincipals();
  Assert.assertTrue(principals.contains(new RealmGroup("admin-jboss")));
  Assert.assertTrue(principals.contains(new RealmGroup("emeaadmin-jboss")));
  Assert.assertEquals(3,principals.size());
  subject=new Subject(false,principalSet,new HashSet<Object>(),new HashSet<Object>());
  subjectSupplemental=new TestLdapSubjectSupplemental(false,null,null,null,"",null,"=([^,]+)",1,"");
  subjectSupplemental.supplementSubject(subject);
  principals=subject.getPrincipals();
  Assert.assertEquals(1,principals.size());
  subject=new Subject(false,principalSet,new HashSet<Object>(),new HashSet<Object>());
  subjectSupplemental=new TestLdapSubjectSupplemental(false,null,null,null,"",null,"=([^,]+)",1,"{0}");
  subjectSupplemental.supplementSubject(subject);
  principals=subject.getPrincipals();
  Assert.assertTrue(principals.contains(new RealmGroup("admin")));
  Assert.assertTrue(principals.contains(new RealmGroup("emeaadmin")));
  Assert.assertEquals(3,principals.size());
  subject=new Subject(false,principalSet,new HashSet<Object>(),new HashSet<Object>());
  subjectSupplemental=new TestLdapSubjectSupplemental(false,null,null,null,"",null,"=([^,]+)",1,"{9}");
  subjectSupplemental.supplementSubject(subject);
  principals=subject.getPrincipals();
  Assert.assertEquals(1,principals.size());
  subject=new Subject(false,principalSet,new HashSet<Object>(),new HashSet<Object>());
  subjectSupplemental=new TestLdapSubjectSupplemental(false,null,null,null,"",null,"=([^,]+)",1,"test");
  subjectSupplemental.supplementSubject(subject);
  principals=subject.getPrincipals();
  Assert.assertEquals(1,principals.size());
}
