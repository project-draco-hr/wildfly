{
  RealmUser realmUser=new RealmUser("TestRealm","Jack.Carter");
  HashSet<Principal> principalSet=new HashSet<Principal>();
  principalSet.add(realmUser);
  Subject subject=new Subject(false,principalSet,new HashSet<Object>(),new HashSet<Object>());
  TestLdapSubjectSupplemental subjectSupplemental=new TestLdapSubjectSupplemental(false,null,null,null,"",null,"=([^,]+)",1,null);
  subjectSupplemental.supplementSubject(subject);
  Set<Principal> principals=subject.getPrincipals();
  Assert.assertTrue(principals.contains(new RealmRole("admin")));
  Assert.assertTrue(principals.contains(new RealmRole("emeaadmin")));
  Assert.assertEquals(3,principals.size());
  subject=new Subject(false,principalSet,new HashSet<Object>(),new HashSet<Object>());
  subjectSupplemental=new TestLdapSubjectSupplemental(false,null,null,null,"",null,"",1,null);
  subjectSupplemental.supplementSubject(subject);
  principals=subject.getPrincipals();
  Assert.assertEquals(1,principals.size());
  subject=new Subject(false,principalSet,new HashSet<Object>(),new HashSet<Object>());
  subjectSupplemental=new TestLdapSubjectSupplemental(false,null,null,null,"",null,"{[]]]]]",1,null);
  subjectSupplemental.supplementSubject(subject);
  principals=subject.getPrincipals();
  Assert.assertEquals(1,principals.size());
  subject=new Subject(false,principalSet,new HashSet<Object>(),new HashSet<Object>());
  subjectSupplemental=new TestLdapSubjectSupplemental(false,null,null,null,"",null,"=([^,]+)",9,null);
  subjectSupplemental.supplementSubject(subject);
  principals=subject.getPrincipals();
  Assert.assertEquals(1,principals.size());
}
