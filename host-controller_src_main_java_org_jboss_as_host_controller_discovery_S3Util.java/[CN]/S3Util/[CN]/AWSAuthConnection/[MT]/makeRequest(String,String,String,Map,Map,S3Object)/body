{
  CallingFormat format=Utils.getCallingFormatForBucket(this.callingFormat,bucket);
  if (isSecure && format != CallingFormat.getPathCallingFormat() && bucket.contains(".")) {
    System.err.println("You are making an SSL connection, however, the bucket contains periods and the wildcard certificate will not match by default.  Please consider using HTTP.");
  }
  URL url=format.getURL(isSecure,server,this.port,bucket,key,pathArgs);
  HttpURLConnection connection=(HttpURLConnection)url.openConnection();
  connection.setRequestMethod(method);
  if (!connection.getInstanceFollowRedirects() && format.supportsLocatedBuckets())   throw HostControllerLogger.ROOT_LOGGER.httpRedirectSupportRequired();
  addHeaders(connection,headers);
  if (object != null)   addMetadataHeaders(connection,object.metadata);
  addAuthHeader(connection,method,bucket,key,pathArgs);
  return connection;
}
