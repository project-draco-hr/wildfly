{
  final DeploymentUnit deploymentUnit=phaseContext.getDeploymentUnit();
  final EEApplicationDescription applicationDescription=deploymentUnit.getAttachment(EE_APPLICATION_DESCRIPTION);
  final ResourceRoot deploymentRoot=deploymentUnit.getAttachment(Attachments.DEPLOYMENT_ROOT);
  final Set<ViewDescription> componentsForViewName=applicationDescription.getComponents(beanName,typeName,deploymentRoot.getRoot());
  if (componentsForViewName.isEmpty()) {
    throw new DeploymentUnitProcessingException("No component found for type '" + typeName + "' with name "+ beanName);
  }
  if (componentsForViewName.size() > 1) {
    throw new DeploymentUnitProcessingException("More than 1 component found for type '" + typeName + "' and bean name "+ beanName);
  }
  ViewDescription description=componentsForViewName.iterator().next();
  serviceBuilder.addDependency(description.getServiceName(),ComponentView.class,new ViewManagedReferenceFactory.Injector(injector));
}
