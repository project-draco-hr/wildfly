{
  final DeploymentUnit deploymentUnit=phaseContext.getDeploymentUnit();
  final EEApplicationDescription applicationDescription=deploymentUnit.getAttachment(EE_APPLICATION_DESCRIPTION);
  final Set<ViewDescription> componentsForViewName=applicationDescription.getComponentsForViewName(typeName);
  if (componentsForViewName.isEmpty()) {
    throw new DeploymentUnitProcessingException("No component found for type '" + typeName + "'");
  }
  for (  ViewDescription description : componentsForViewName) {
    if (beanName.equals(description.getComponentDescription().getComponentName())) {
      serviceBuilder.addDependency(description.getServiceName(),ComponentView.class,new ViewManagedReferenceFactory.Injector(injector));
      return;
    }
  }
  throw new DeploymentUnitProcessingException("No component found for type '" + typeName + "' and bean name '"+ beanName+ "'");
}
