{
  Map<String,Map<String,Set<String>>> configuredConstraints=new HashMap<String,Map<String,Set<String>>>();
  if (constraint.hasDefined(SENSITIVITY_CLASSIFICATION)) {
    ModelNode sensitivityParent=constraint.require(SENSITIVITY_CLASSIFICATION);
    if (sensitivityParent.hasDefined(TYPE)) {
      for (      Property typeProperty : sensitivityParent.get(TYPE).asPropertyList()) {
        if (typeProperty.getValue().hasDefined(CLASSIFICATION)) {
          for (          Property sensitivityProperty : typeProperty.getValue().get(CLASSIFICATION).asPropertyList()) {
            ModelNode classification=sensitivityProperty.getValue();
            if (classification.hasDefined(SensitivityResourceDefinition.CONFIGURED_REQUIRES_ADDRESSABLE.getName()) || classification.hasDefined(SensitivityResourceDefinition.CONFIGURED_REQUIRES_WRITE.getName()) || classification.hasDefined(SensitivityResourceDefinition.CONFIGURED_REQUIRES_READ.getName())) {
              Map<String,Set<String>> constraintMap=configuredConstraints.get(SENSITIVITY_CLASSIFICATION);
              if (constraintMap == null) {
                constraintMap=new TreeMap<String,Set<String>>();
                configuredConstraints.put(SENSITIVITY_CLASSIFICATION,constraintMap);
              }
              Set<String> types=constraintMap.get(typeProperty.getName());
              if (types == null) {
                types=new TreeSet<String>();
                constraintMap.put(typeProperty.getName(),types);
              }
              types.add(sensitivityProperty.getName());
            }
          }
        }
      }
    }
  }
  return configuredConstraints;
}
