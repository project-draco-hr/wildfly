{
  String elementName=principal.require(TYPE).asString().equalsIgnoreCase(GROUP) ? Element.GROUP.getLocalName() : Element.USER.getLocalName();
  writer.writeStartElement(elementName);
  String realm=principal.get(REALM).isDefined() ? principal.require(REALM).asString() : null;
  String name=principal.require(NAME).asString();
  String expectedAlias=generateAlias(elementName,name,realm);
  if (alias.equals(expectedAlias) == false) {
    writeAttribute(writer,Attribute.ALIAS,alias);
  }
  PrincipalResourceDefinition.REALM.marshallAsAttribute(principal,writer);
  PrincipalResourceDefinition.NAME.marshallAsAttribute(principal,writer);
  writer.writeEndElement();
}
