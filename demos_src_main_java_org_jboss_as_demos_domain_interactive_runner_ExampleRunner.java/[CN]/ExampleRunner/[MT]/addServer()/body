{
  addCount++;
  stdout.println("Enter the name of the new server, or [C] to cancel:");
  String serverName=readStdIn();
  if ("C".equals(serverName.toUpperCase()))   return continuePrompt();
  String hostController=null;
  List<String> hostControllers=client.getHostControllerNames();
  if (hostControllers.size() == 1) {
    hostController=hostControllers.get(0);
  }
 else {
    do {
      stdout.println("Choose a Host Controller for the new Server:");
      Map<String,Object> choices=writeMenuBody(hostControllers);
      stdout.println("[C]   Cancel");
      String choice=readStdIn();
      if ("C".equals(choice.toUpperCase())) {
        return continuePrompt();
      }
      Object obj=choices.get(choice);
      if (obj == null) {
        stdout.println(choice + " is not a valid selection");
      }
 else {
        hostController=obj.toString();
      }
    }
 while (hostController == null);
  }
  String serverGroup=null;
  List<String> serverGroups=getServerGroupNames();
  do {
    stdout.println("Choose a Server Group for the new Server:");
    Map<String,Object> choices=writeMenuBody(serverGroups);
    stdout.println("[C]   Cancel");
    String choice=readStdIn();
    if ("C".equals(choice.toUpperCase())) {
      return continuePrompt();
    }
    Object obj=choices.get(choice);
    if (obj == null) {
      stdout.println(choice + " is not a valid selection");
    }
 else {
      serverGroup=obj.toString();
    }
  }
 while (serverGroup == null);
  stdout.println("\nCreating new server: " + serverName + " on host controller "+ hostController+ " in server group: "+ serverGroup);
  List<AbstractHostModelUpdate<?>> updates=new ArrayList<AbstractHostModelUpdate<?>>(2);
  updates.add(new HostServerAdd(serverName,serverGroup));
  updates.add(HostServerUpdate.create(serverName,new ServerElementSocketBindingGroupUpdate("standard-sockets")));
  addCount++;
  updates.add(HostServerUpdate.create(serverName,new ServerElementSocketBindingPortOffsetUpdate(addCount * 1000)));
  List<HostUpdateResult<?>> results=client.applyHostUpdates(hostController,updates);
  HostUpdateResult<?> result=results.get(0);
  System.out.println("Add success: " + result.isSuccess());
  if (result.isSuccess()) {
    System.out.println("Starting server " + serverName);
    ServerStatus status=client.startServer(hostController,serverName);
    System.out.println("Start executed. Server status is " + status);
  }
  return continuePrompt();
}
