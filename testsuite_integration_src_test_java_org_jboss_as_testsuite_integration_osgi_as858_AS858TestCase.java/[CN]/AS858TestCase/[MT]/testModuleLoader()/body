{
  ModuleIdentifier identifier=ModuleIdentifier.create("deployment.as858.test");
  try {
    ServiceController<?> controller=serviceContainer.getService(Services.MODULE_LOADER_PROVIDER);
    ModuleLoaderProvider loaderProvider=(ModuleLoaderProvider)controller.getValue();
    ModuleSpec moduleSpec=ModuleSpec.build(identifier).create();
    loaderProvider.addModule(moduleSpec);
    Module module=loaderProvider.getModuleLoader().loadModule(identifier);
    assertEquals(identifier,module.getIdentifier());
  }
  finally {
    ServiceController<?> controller=serviceContainer.getService(ServiceName.JBOSS.append("module","spec","service",identifier.getName(),identifier.getSlot()));
    if (controller != null) {
      controller.setMode(ServiceController.Mode.REMOVE);
    }
    controller=serviceContainer.getService(ServiceName.JBOSS.append("module","information","service",identifier.getName(),identifier.getSlot()));
    if (controller != null) {
      controller.setMode(ServiceController.Mode.REMOVE);
    }
  }
}
