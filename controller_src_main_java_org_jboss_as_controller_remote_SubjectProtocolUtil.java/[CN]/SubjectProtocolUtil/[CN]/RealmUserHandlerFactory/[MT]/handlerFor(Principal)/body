{
  if (principal instanceof RealmUser) {
    return new PrincipalWriter(){
      @Override public void write(      DataOutput out) throws IOException {
        RealmUser user=(RealmUser)principal;
        out.write(REALM_USER_PRINCIPAL);
        String realm=user.getRealm();
        if (realm != null) {
          out.write(REALM_PARAM);
          out.writeUTF(realm);
        }
        out.write(NAME_PARAM);
        out.writeUTF(user.getName());
      }
    }
;
  }
  return null;
}
