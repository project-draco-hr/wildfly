{
synchronized (lock) {
    for (    Connection connection : managedConnections) {
      try {
        final OutputStream os=connection.writeMessage();
        try {
          os.write(Protocol.OPERATION_FAILED);
          os.write(operationType.getCode());
          StreamUtils.writeUTFZBytes(os,processName);
          os.close();
        }
  finally {
          StreamUtils.safeClose(os);
        }
      }
 catch (      IOException e) {
        ProcessLogger.ROOT_LOGGER.failedToWriteMessage("OPERATION_FAILED",e);
        removeManagedConnection(connection);
      }
    }
  }
}
