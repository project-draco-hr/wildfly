{
synchronized (lock) {
    if (shutdown) {
      return;
    }
    ROOT_LOGGER.shuttingDown();
    shutdown=true;
    final ManagedProcess hc=processes.get(Main.HOST_CONTROLLER_PROCESS_NAME);
    if (hc != null && hc.isRunning()) {
      hc.shutdown();
      while (processes.containsKey(Main.HOST_CONTROLLER_PROCESS_NAME)) {
        try {
          lock.wait();
        }
 catch (        InterruptedException e) {
        }
      }
    }
    for (    ManagedProcess process : processes.values()) {
      process.shutdown();
    }
    while (!processes.isEmpty()) {
      try {
        lock.wait();
      }
 catch (      InterruptedException e) {
      }
    }
    ROOT_LOGGER.shutdownComplete();
  }
}
