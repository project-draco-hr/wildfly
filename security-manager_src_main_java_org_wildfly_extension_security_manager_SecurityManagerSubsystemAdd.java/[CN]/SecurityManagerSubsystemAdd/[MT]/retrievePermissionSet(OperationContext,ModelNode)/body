{
  final List<PermissionFactory> permissions=new ArrayList<PermissionFactory>();
  if (node != null && node.hasDefined(PERMISSION)) {
    for (    Property property : node.get(PERMISSION).asPropertyList()) {
      ModelNode permissionNode=property.getValue();
      String permissionClass=PermissionResourceDefinition.CLASS.resolveModelAttribute(context,permissionNode).asString();
      String permissionName=null;
      if (permissionNode.hasDefined(PERMISSION_NAME))       permissionName=PermissionResourceDefinition.NAME.resolveModelAttribute(context,permissionNode).asString();
      String permissionActions=null;
      if (permissionNode.hasDefined(PERMISSION_ACTIONS))       permissionActions=PermissionResourceDefinition.ACTIONS.resolveModelAttribute(context,permissionNode).asString();
      String moduleName=null;
      if (permissionNode.hasDefined(PERMISSION_MODULE)) {
        moduleName=PermissionResourceDefinition.MODULE.resolveModelAttribute(context,permissionNode).asString();
      }
      ClassLoader cl=WildFlySecurityManager.getClassLoaderPrivileged(this.getClass());
      if (moduleName != null) {
        try {
          cl=Module.getBootModuleLoader().loadModule(ModuleIdentifier.create(moduleName)).getClassLoader();
        }
 catch (        ModuleLoadException e) {
          throw new OperationFailedException(e);
        }
      }
      permissions.add(new LoadedPermissionFactory(cl,permissionClass,permissionName,permissionActions));
    }
  }
  return permissions;
}
