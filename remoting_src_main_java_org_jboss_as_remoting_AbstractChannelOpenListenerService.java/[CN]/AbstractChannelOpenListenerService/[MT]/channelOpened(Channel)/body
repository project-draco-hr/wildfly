{
  if (closed) {
    throw new IllegalStateException("shutting down.");
  }
  final T createdChannel=createChannel(channel);
  channels.add(createdChannel);
  channel.addCloseHandler(new CloseHandler<Channel>(){
    public void handleClose(    final Channel closed,    final IOException exception){
      channels.remove(createdChannel);
      log.tracef("Handling close for %s",createdChannel);
    }
  }
);
}
