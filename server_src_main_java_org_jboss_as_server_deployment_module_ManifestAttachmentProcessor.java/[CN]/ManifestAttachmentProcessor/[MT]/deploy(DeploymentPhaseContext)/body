{
  final DeploymentUnit deploymentUnit=phaseContext.getDeploymentUnit();
  List<ResourceRoot> resourceRoots=DeploymentUtils.allResourceRoots(deploymentUnit);
  for (  ResourceRoot resourceRoot : resourceRoots) {
    Manifest manifest=resourceRoot.getAttachment(Attachments.MANIFEST);
    if (manifest != null)     continue;
    final VirtualFile deploymentRoot=resourceRoot.getRoot();
    try {
      manifest=VFSUtils.getManifest(deploymentRoot);
      if (manifest != null)       resourceRoot.putAttachment(Attachments.MANIFEST,manifest);
    }
 catch (    IOException e) {
      throw new DeploymentUnitProcessingException("Failed to get manifest for deployment " + deploymentRoot,e);
    }
  }
}
