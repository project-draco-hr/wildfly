{
  boolean success=true;
  JDBCAbstractCMRFieldBridge[] cmrFields=entity.getCMRFields();
  for (int i=0; i < cmrFields.length; ++i) {
    JDBCAbstractCMRFieldBridge cmrField=cmrFields[i];
    JDBCRelationMetaData relationMetaData=cmrField.getMetaData().getRelationMetaData();
    if (relationMetaData.isTableMappingStyle() && !relationMetaData.isTableDropped()) {
      if (relationMetaData.getRemoveTable()) {
        final boolean dropped=dropTable(manager.getDataSource(relationMetaData.getDataSourceName()),cmrField.getQualifiedTableName());
        if (!dropped) {
          success=false;
        }
 else {
          relationMetaData.setTableDropped();
        }
      }
    }
  }
  if (entityMetaData.getRemoveTable()) {
    boolean dropped=dropTable(entity.getDataSource(),entity.getQualifiedTableName());
    if (!dropped) {
      success=false;
    }
  }
  return success;
}
