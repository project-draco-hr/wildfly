{
  final PathAddress address=PathAddress.pathAddress(operation.get(OP_ADDR));
  final String name=address.getLastElement().getValue();
  final ServiceTarget target=context.getServiceTarget();
  final ConnectorService connectorService=new ConnectorService();
  connectorService.setOptionMap(createOptionMap(operation));
  final ServiceName connectorName=RemotingServices.connectorServiceName(name);
  try {
    newControllers.add(target.addService(connectorName,connectorService).addDependency(connectorName.append("auth-provider"),ServerAuthenticationProvider.class,connectorService.getAuthenticationProviderInjector()).addDependency(RemotingServices.ENDPOINT,Endpoint.class,connectorService.getEndpointInjector()).addListener(verificationHandler).setInitialMode(ServiceController.Mode.ACTIVE).install());
  }
 catch (  ServiceRegistryException e) {
    throw new OperationFailedException(new ModelNode().set(e.getLocalizedMessage()));
  }
}
