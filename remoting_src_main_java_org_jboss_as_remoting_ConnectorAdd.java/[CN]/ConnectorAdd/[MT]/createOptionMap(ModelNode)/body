{
  final OptionMap.Builder builder=OptionMap.builder();
  if (parameters.hasDefined(SASL)) {
    final ModelNode sasl=parameters.require(SASL);
    builder.set(Options.SASL_SERVER_AUTH,sasl.get(SERVER_AUTH).asBoolean());
    builder.set(Options.SASL_STRENGTH,SaslStrength.valueOf(sasl.get(STRENGTH).asString()));
    builder.set(Options.SASL_QOP,Sequence.of(asQopSet(sasl.get(QOP))));
    builder.set(Options.SASL_MECHANISMS,Sequence.of(asStringSet(sasl.get(INCLUDE_MECHANISMS))));
    if (sasl.hasDefined(POLICY)) {
      final ModelNode policy=sasl.require(POLICY);
      builder.set(Options.SASL_POLICY_FORWARD_SECRECY,policy.get(FORWARD_SECRECY).asBoolean());
      builder.set(Options.SASL_POLICY_NOACTIVE,policy.get(NO_ACTIVE).asBoolean());
      builder.set(Options.SASL_POLICY_NOANONYMOUS,policy.get(NO_ANONYMOUS).asBoolean());
      builder.set(Options.SASL_POLICY_NODICTIONARY,policy.get(NO_DICTIONARY).asBoolean());
      builder.set(Options.SASL_POLICY_NOPLAINTEXT,policy.get(NO_PLAINTEXT).asBoolean());
      builder.set(Options.SASL_POLICY_PASS_CREDENTIALS,policy.get(PASS_CREDENTIALS).asBoolean());
    }
  }
  return builder.getMap();
}
