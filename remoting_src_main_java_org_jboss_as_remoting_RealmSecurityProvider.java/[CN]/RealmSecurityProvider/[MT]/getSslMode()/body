{
  if (realm == null || realm.getSSLContext() == null) {
    return SslMode.OFF;
  }
  if (realm.hasTrustStore()) {
    return SslMode.CLIENT_AUTH_REQUESTED;
  }
  return SslMode.TRANSPORT_ONLY;
}
