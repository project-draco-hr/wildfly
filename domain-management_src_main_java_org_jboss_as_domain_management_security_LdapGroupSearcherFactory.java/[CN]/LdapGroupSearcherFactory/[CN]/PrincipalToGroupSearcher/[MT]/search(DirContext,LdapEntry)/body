{
  Set<LdapEntry> foundEntries=new HashSet<LdapEntry>();
  Attributes groups=dirContext.getAttributes(entry.getDistinguishedName(),new String[]{groupAttribute});
  Attribute groupRef=groups.get(groupAttribute);
  if (groupRef != null && groupRef.size() > 0) {
    NamingEnumeration<String> groupRefValues=(NamingEnumeration<String>)groupRef.getAll();
    while (groupRefValues.hasMore()) {
      String distingushedName=groupRefValues.next();
      SECURITY_LOGGER.tracef("Group found with distinguishedName=%s",distingushedName);
      String simpleName=null;
      if (groupNameAttribute != null) {
        Attributes groupNameAttrs=dirContext.getAttributes(distingushedName,new String[]{groupNameAttribute});
        Attribute groupNameAttr=groupNameAttrs.get(groupNameAttribute);
        simpleName=(String)groupNameAttr.get();
        SECURITY_LOGGER.tracef("simpleName %s loaded for group with distinguishedName=%s",simpleName,distingushedName);
      }
 else {
        SECURITY_LOGGER.trace("No groupNameAttribute to load simpleName");
      }
      foundEntries.add(new LdapEntry(simpleName,distingushedName));
    }
  }
 else {
    SECURITY_LOGGER.tracef("No groups found for %s",entry);
  }
  return foundEntries.toArray(new LdapEntry[foundEntries.size()]);
}
