{
  assertNotBuilt();
  built=true;
  ModelNode add=new ModelNode();
  add.get(OP).set(ADD);
  add.get(ADDRESS).set(parent.getRealmAddress().add(AUTHORIZATION,LDAP));
  if (connection != null) {
    add.get(CONNECTION).set(connection);
  }
  if (baseDN != null) {
    add.get(BASE_DN).set(baseDN);
  }
  if (recursive) {
    add.get(RECURSIVE).set(true);
  }
  if (usernameAttribute != null) {
    add.get(USERNAME_ATTRIBUTE).set(usernameAttribute);
  }
  if (groupsDN != null) {
    add.get(GROUPS_DN).set(groupsDN);
  }
  if (pattern != null) {
    add.get(PATTERN).set(pattern);
  }
  if (resultPattern != null) {
    add.get(RESULT_PATTERN).set(resultPattern);
  }
  if (group > 0) {
    add.get(GROUP).set(group);
  }
  if (reverseGroup) {
    add.get(REVERSE_GROUP).set(true);
  }
  parent.setChildStep(add);
  return parent;
}
