{
  if (createTable) {
    createTableIfNotExists(tableName);
  }
  Connection con=null;
  Statement st=null;
  ResultSet rs=null;
  try {
    String sql="select " + idColumnName + " from "+ tableName+ " where "+ sequenceColumn+ "='"+ sequenceName+ "'";
    log.debug("Executing SQL: " + sql);
    con=ds.getConnection();
    st=con.createStatement();
    rs=st.executeQuery(sql);
    if (!rs.next()) {
      sql="insert into " + tableName + "("+ sequenceColumn+ ", "+ idColumnName+ ") values ('"+ sequenceName+ "', 0)";
      log.debug("Executing SQL: " + sql);
      final Statement insertSt=con.createStatement();
      try {
        final int i=insertSt.executeUpdate(sql);
        if (i != 1) {
          throw new SQLException("Expected one updated row but got: " + i);
        }
      }
  finally {
        JDBCUtil.safeClose(insertSt);
      }
    }
 else {
      HiLoKeyGenerator.setHighestHi(rs.getLong(1));
    }
  }
  finally {
    JDBCUtil.safeClose(rs);
    JDBCUtil.safeClose(st);
    JDBCUtil.safeClose(con);
  }
}
