{
  String ROTATE_ON_RESTART="";
  final String oldMessage="SizeAppenderRestartTestCase - This is old message";
  final String newMessage="SizeAppenderRestartTestCase - This is new message";
  long fileSize=0L;
  ModelNode op=Operations.createWriteAttributeOperation(SIZE_HANDLER_ADDRESS,"append",false);
  validateResponse(op);
  op=Operations.createWriteAttributeOperation(SIZE_HANDLER_ADDRESS,ROTATE_ON_RESTART,true);
  validateResponse(op);
  clearLogs(logFile);
  restartServer();
  for (int i=0; i < 100; i++) {
    makeLog(oldMessage,url);
  }
  checkLogs(oldMessage,true);
  fileSize=logFile.length();
  restartServer();
  makeLog(newMessage,url);
  checkLogs(newMessage,true);
  int count=0;
  for (  File file : logFile.getParentFile().listFiles()) {
    if (file.getName().contains(logFile.getName())) {
      count++;
      if (file.getName().equals(logFile.getName() + ".1")) {
        Assert.assertEquals("Size of file after rotation should not differ",fileSize,file.length());
        checkLogs(oldMessage,true,file);
      }
    }
  }
  Assert.assertEquals("There should be two log files",2,count);
}
