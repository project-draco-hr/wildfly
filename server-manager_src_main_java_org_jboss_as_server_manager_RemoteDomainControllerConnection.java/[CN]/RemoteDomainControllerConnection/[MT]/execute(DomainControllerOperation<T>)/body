{
  Socket socket=null;
  try {
    socket=new Socket(dcAddress,dcPort);
    SimpleDataInput intput=new SimpleDataInput(Marshalling.createByteInput(socket.getInputStream()));
    SimpleDataOutput output=new SimpleDataOutput(Marshalling.createByteOutput(socket.getOutputStream()));
    final ManagementRequestProtocolHeader managementRequestHeader=new ManagementRequestProtocolHeader(ManagementProtocol.VERSION,ManagementProtocol.DOMAIN_CONTROLLER_REQUEST);
    managementRequestHeader.write(output);
    output.flush();
    final ManagementResponseProtocolHeader responseHeader=new ManagementResponseProtocolHeader(intput);
    return operation.execute(responseHeader.getVersion(),serverManagerId,output,intput);
  }
 catch (  Throwable t) {
    throw new RuntimeException("Failed to execute server manager request " + operation,t);
  }
 finally {
    safeClose(socket);
  }
}
