{
  Socket socket=null;
  Marshaller marshaller=null;
  Unmarshaller unmarshaller=null;
  try {
    socket=new Socket(dcAddress,dcPort);
    final InputStream socketIn=new BufferedInputStream(socket.getInputStream());
    final OutputStream socketOut=new BufferedOutputStream(socket.getOutputStream());
    socketOut.write(ManagementOperationHandler.SIGNATURE);
    socketOut.write(DomainControllerOperationHandler.DOMAIN_CONTROLLER_HANDLER);
    marshaller=MARSHALLER_FACTORY.createMarshaller(CONFIG);
    marshaller.start(Marshalling.createByteOutput(socketOut));
    marshaller.writeUTF(serverManagerId);
    marshaller.writeByte(operatation.getCommandByte());
    operatation.sendRequest(marshaller);
    marshaller.finish();
    unmarshaller=MARSHALLER_FACTORY.createUnmarshaller(CONFIG);
    unmarshaller.start(Marshalling.createByteInput(socketIn));
    final T result=operatation.readResponse(unmarshaller);
    unmarshaller.finish();
    return result;
  }
 catch (  Throwable t) {
    throw new RuntimeException("Failed to execute server manager request " + operatation,t);
  }
 finally {
    safeClose(marshaller);
    safeClose(unmarshaller);
    safeClose(socket);
  }
}
