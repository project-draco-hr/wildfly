{
  consoleOut=new ByteArrayOutputStream();
  final char[] password=getPassword() == null ? null : getPassword().toCharArray();
  System.setProperty("jreadline.terminal","org.jboss.jreadline.terminal.TestTerminal");
  ctx=CLITestUtil.getCommandContext(TestSuiteEnvironment.getServerAddress(),TestSuiteEnvironment.getServerPort(),getUsername(),password,createConsoleInput(),consoleOut);
  if (!connect) {
    return;
  }
  Assert.assertTrue(sendConnect(cliAddress));
}
