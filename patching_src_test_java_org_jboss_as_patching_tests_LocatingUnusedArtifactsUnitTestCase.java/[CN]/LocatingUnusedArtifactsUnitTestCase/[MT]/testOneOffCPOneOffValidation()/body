{
  installOneOffCpOneOff();
  final Context ctx=getContext();
  PatchingHistoryRoot.State history=PatchingHistoryRoot.getInstance().getState(ctx);
  PatchArtifact.State patch=history.getLastAppliedPatch(ctx);
  assertPatch(ctx,patch,ONE_OFF_2_ID,PatchType.ONE_OFF);
  assertTrue(patch.hasPrevious(ctx));
  patch=patch.getPrevious(ctx);
  assertPatch(ctx,patch,CP_1_ID,PatchType.CUMULATIVE);
  assertTrue(patch.hasPrevious(ctx));
  patch=patch.getPrevious(ctx);
  assertPatch(ctx,patch,ONE_OFF_1_ID,PatchType.ONE_OFF);
  assertNoPrevious(ctx,patch);
  assertNoGarbage(ctx);
}
