{
  final DeploymentUnit deploymentUnit=phaseContext.getDeploymentUnit();
  final EEModuleDescription module=deploymentUnit.getAttachment(org.jboss.as.ee.component.Attachments.EE_MODULE_DESCRIPTION);
  final ResourceRoot deploymentRoot=deploymentUnit.getAttachment(Attachments.DEPLOYMENT_ROOT);
  if (module == null) {
    return;
  }
  if (deploymentUnit.getParent() != null) {
    final EEModuleDescription parentDescription=deploymentUnit.getAttachment(org.jboss.as.ee.component.Attachments.EE_MODULE_DESCRIPTION);
    module.setDistinctName(parentDescription.getDistinctName());
    return;
  }
  final Manifest manifest=deploymentRoot.getAttachment(Attachments.MANIFEST);
  if (manifest == null) {
    return;
  }
  final String name=manifest.getMainAttributes().getValue(DISTINCT_NAME);
  if (name == null) {
    return;
  }
  if (!name.trim().isEmpty()) {
    module.setDistinctName(name.trim());
  }
}
