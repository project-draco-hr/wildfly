{
  for (  T channel : channels) {
    try {
      channel.writeShutdown();
    }
 catch (    IOException ignore) {
    }
  }
  channels.clear();
  IoUtils.safeClose(connection);
  if (startedEndpoint) {
    IoUtils.safeClose(providerRegistration);
    IoUtils.safeClose(endpoint);
  }
}
