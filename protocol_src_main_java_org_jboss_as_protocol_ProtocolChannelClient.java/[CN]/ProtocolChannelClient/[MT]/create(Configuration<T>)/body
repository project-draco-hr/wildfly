{
  if (configuration == null) {
    throw MESSAGES.nullVar("configuration");
  }
  configuration.validate();
  final Endpoint endpoint;
  if (configuration.getEndpoint() != null) {
    endpoint=configuration.getEndpoint();
    return new ProtocolChannelClient<T>(false,endpoint,null,configuration.getUri(),configuration.getChannelFactory(),configuration.getConnectTimeout());
  }
 else {
    endpoint=Remoting.createEndpoint(configuration.getEndpointName(),configuration.getExecutor(),configuration.getOptionMap());
    Xnio xnio=Xnio.getInstance();
    Registration providerRegistration=endpoint.addConnectionProvider(configuration.getUri().getScheme(),new RemoteConnectionProviderFactory(xnio),OptionMap.create(Options.SSL_ENABLED,false));
    return new ProtocolChannelClient<T>(true,endpoint,providerRegistration,configuration.getUri(),configuration.getChannelFactory(),configuration.getConnectTimeout());
  }
}
