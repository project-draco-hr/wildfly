{
  if (crossCtxSessions != null) {
    crossCtxSessions.put(session,mgr);
  }
 else   if (soleManager == null) {
    soleManager=mgr;
    soleSession=session;
  }
 else   if (!mgr.equals(soleManager)) {
    crossCtxSessions=new HashMap<ClusteredSession<? extends OutgoingDistributableSessionData>,SnapshotManager>();
    crossCtxSessions.put(soleSession,soleManager);
    crossCtxSessions.put(session,mgr);
    soleManager=null;
    soleSession=null;
  }
 else {
    soleSession=session;
  }
}
