{
  assertTrue(sharedState.get());
  ModelNode step1=getOperation("good","attr1",2);
  ModelNode step2=getOperation("good-service","attr2",1);
  ModelNode result=controller.execute(getCompositeOperation(null,step1,step2),null,ModelControllerImplUnitTestCase.RollbackTransactionControl.INSTANCE,null);
  System.out.println(result);
  Assert.assertEquals("failed",result.get("outcome").asString());
  assertTrue(result.hasDefined(FAILURE_DESCRIPTION));
  assertTrue(sharedState.get());
  ServiceController<?> sc=container.getService(ServiceName.JBOSS.append("bad-service"));
  if (sc != null) {
    Assert.assertEquals(ServiceController.Mode.REMOVE,sc.getMode());
  }
  Assert.assertEquals(1,controller.execute(getOperation("good","attr1",3),null,null,null).get("result").asInt());
  Assert.assertEquals(2,controller.execute(getOperation("good","attr2",3),null,null,null).get("result").asInt());
}
