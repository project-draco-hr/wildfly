{
  final String archiveName=securityDomainName + ".war";
  LOGGER.info("Creating " + archiveName);
  final WebArchive war=ShrinkWrap.create(WebArchive.class,archiveName);
  war.addClasses(SimpleSecuredServlet.class,SimpleServlet.class,FailureAuthModule.class,SuccessAuthModule.class);
  war.addAsWebInfResource(new StringAsset(SecurityTestConstants.WEB_XML_BASIC_AUTHN),"web.xml");
  war.addAsWebInfResource(new StringAsset("<jboss-web>" + "<security-domain>" + securityDomainName + "</security-domain>"+ "<valve><class-name>"+ WebJASPIAuthenticator.class.getName()+ "</class-name></valve>"+ "</jboss-web>"),"jboss-web.xml");
  war.addAsResource(new StringAsset("jduke=theduke\ntester=password"),"users.properties");
  war.addAsResource(new StringAsset("jduke=Authenticated,JBossAdmin\ntester=Authenticated"),"roles.properties");
  if (LOGGER.isInfoEnabled()) {
    LOGGER.info(war.toString(true));
  }
  return war;
}
