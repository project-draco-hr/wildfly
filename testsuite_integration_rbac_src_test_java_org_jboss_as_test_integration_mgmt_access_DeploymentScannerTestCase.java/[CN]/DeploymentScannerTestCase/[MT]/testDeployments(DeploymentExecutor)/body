{
  final MBeanServerConnection mbeanServer=JMXConnectorFactory.connect(managementClient.getRemoteJMXURL()).getMBeanServerConnection();
  final ObjectName name=new ObjectName("jboss.test:service=testdeployments");
  deploymentExecutor.initialDeploy();
  Assert.assertNotNull(mbeanServer.getMBeanInfo(name));
  deploymentExecutor.undeploy();
  try {
    long start=System.currentTimeMillis();
    while (System.currentTimeMillis() - start < 10000) {
      mbeanServer.getMBeanInfo(name);
      Thread.sleep(100);
    }
    Assert.fail("Should not have found MBean");
  }
 catch (  Exception expected) {
  }
}
