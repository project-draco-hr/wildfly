{
  SecurityModuleConfiguration ldapLoginModule=new SecurityModuleConfiguration(){
    public String getName(){
      return "LdapExtended";
    }
    public String getFlag(){
      return "sufficient";
    }
    public Map<String,String> getOptions(){
      Map<String,String> moduleOptions=new HashMap<String,String>();
      moduleOptions.put("java.naming.factory.initial","com.sun.jndi.ldap.LdapCtxFactory");
      moduleOptions.put("java.naming.provider.url",getLDAPProviderUrl(managementClient));
      moduleOptions.put("java.naming.security.authentication","simple");
      moduleOptions.put("bindDN",SECURITY_PRINCIPAL);
      moduleOptions.put("bindCredential",SECURITY_CREDENTIALS);
      moduleOptions.put("baseCtxDN","ou=People,o=example2,dc=jboss,dc=org");
      moduleOptions.put("baseFilter","(uid={0})");
      moduleOptions.put("rolesCtxDN","ou=Roles,o=example2,dc=jboss,dc=org");
      moduleOptions.put("roleFilter","(cn={0})");
      moduleOptions.put("roleAttributeID","description");
      moduleOptions.put("roleAttributeIsDN","true");
      moduleOptions.put("roleNameAttributeID","cn");
      moduleOptions.put("roleRecursion","0");
      return moduleOptions;
    }
  }
;
  return new SecurityModuleConfiguration[]{ldapLoginModule};
}
