{
  IllegalStateException ise=null;
  boolean connected=false;
  final long timeout=30000;
  final long endTime=System.currentTimeMillis() + timeout;
  int retries=0;
  while (!connected) {
    try {
      connect();
      connected=true;
      break;
    }
 catch (    IllegalStateException e) {
      Throwable cause=e;
      while ((cause=cause.getCause()) != null) {
        if (cause instanceof SaslException) {
          throw MESSAGES.authenticationFailureUnableToConnect(cause);
        }
      }
      if (System.currentTimeMillis() > endTime) {
        throw MESSAGES.connectionToMasterTimeout(e,retries,timeout);
      }
      ise=e;
      try {
        ReconnectPolicy.CONNECT.wait(retries);
      }
 catch (      InterruptedException ie) {
        throw MESSAGES.connectionToMasterInterrupted();
      }
    }
catch (    HostAlreadyExistsException e) {
      throw new IllegalStateException(e.getMessage());
    }
  }
  this.connected.set(true);
  registered.set(true);
}
