{
  RemoteDomainConnectionService service=new RemoteDomainConnectionService(controller,extensionRegistry,localHostControllerInfo,productConfig,remoteFileRepository,ignoredDomainResourceRegistry,operationExecutor,domainController,hostControllerEnvironment,executor,currentRunningMode);
  ServiceBuilder<MasterDomainControllerClient> builder=serviceTarget.addService(MasterDomainControllerClient.SERVICE_NAME,service).addDependency(ManagementRemotingServices.MANAGEMENT_ENDPOINT,Endpoint.class,service.endpointInjector).addDependency(ServerInventoryService.SERVICE_NAME,ServerInventory.class,service.serverInventoryInjector).setInitialMode(ServiceController.Mode.ACTIVE);
  if (securityRealm != null) {
    SecurityRealm.ServiceUtil.addDependency(builder,service.securityRealmInjector,securityRealm,false);
  }
  builder.install();
  return service.futureClient;
}
