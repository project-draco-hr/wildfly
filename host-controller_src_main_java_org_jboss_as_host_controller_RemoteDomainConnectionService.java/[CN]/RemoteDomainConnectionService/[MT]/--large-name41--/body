{
  RemoteDomainConnectionService service=new RemoteDomainConnectionService(controller,extensionRegistry,localHostControllerInfo,productConfig,remoteFileRepository,ignoredDomainResourceRegistry,operationExecutor,domainController,hostControllerEnvironment);
  ServiceBuilder<MasterDomainControllerClient> builder=serviceTarget.addService(MasterDomainControllerClient.SERVICE_NAME,service).addDependency(ManagementRemotingServices.MANAGEMENT_ENDPOINT,Endpoint.class,service.endpointInjector).addDependency(ServerInventoryService.SERVICE_NAME,ServerInventory.class,service.serverInventoryInjector).setInitialMode(ServiceController.Mode.ACTIVE);
  if (securityRealm != null) {
    ServiceName realmName=SecurityRealmService.BASE_SERVICE_NAME.append(securityRealm);
    builder.addDependency(realmName,SecurityRealm.class,service.securityRealmInjector);
  }
  builder.install();
  return service.futureClient;
}
