{
  RemoteDomainConnectionService service;
  try {
    service=new RemoteDomainConnectionService(controller,localHostName,InetAddress.getByName(remoteDcHost),remoteDcPort,remoteFileRepository);
  }
 catch (  UnknownHostException e) {
    throw new RuntimeException(e);
  }
  ServiceBuilder builder=serviceTarget.addService(MasterDomainControllerClient.SERVICE_NAME,service).addDependency(ManagementRemotingServices.MANAGEMENT_ENDPOINT,Endpoint.class,service.endpointInjector).setInitialMode(ServiceController.Mode.ACTIVE);
  if (securityRealm != null) {
    ServiceName realmName=SecurityRealmService.BASE_SERVICE_NAME.append(securityRealm);
    builder.addDependency(realmName,SecurityRealm.class,service.securityRealmInjector);
  }
  builder.install();
  return service.futureClient;
}
