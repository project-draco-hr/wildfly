def getPreferredHashAlgorithm(self):
    checksum = 'md5'
    try:
        fp = open('/proc/sys/crypto/fips_enabled', 'r')
    except:
        return checksum
    fips_enabled = fp.read()
    if (fips_enabled.find('1') >= 0):
        checksum = 'sha256'
    fp.close()
    return checksum
