{
  final ModelNode newModel=Resource.Tools.readModel(resource);
  final ConfigurationPersister.PersistenceResource delegate=persister.store(newModel,affectedAddresses);
  return new ConfigurationPersister.PersistenceResource(){
    @Override public void commit(){
      if (hostServerGroupTracker != null) {
        hostServerGroupTracker.invalidate();
      }
      model.set(resource);
      delegate.commit();
    }
    @Override public void rollback(){
      delegate.rollback();
    }
  }
;
}
