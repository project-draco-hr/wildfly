{
  final Integer operationID=new Random(new SecureRandom().nextLong()).nextInt();
  EnumSet<OperationContextImpl.ContextFlag> contextFlags=rollbackOnRuntimeFailure ? EnumSet.of(OperationContextImpl.ContextFlag.ROLLBACK_ON_FAIL) : EnumSet.noneOf(OperationContextImpl.ContextFlag.class);
  final OperationContextImpl context=new OperationContextImpl(this,processType,runningModeControl.getRunningMode(),contextFlags,handler,null,model,control,processState,auditLogger,bootingFlag.get(),operationID,null);
  List<ParsedBootOp> postExtensionOps=organizeBootOperations(bootList,context,operationID);
  OperationContext.ResultAction resultAction=context.executeOperation();
  if (resultAction == OperationContext.ResultAction.KEEP && postExtensionOps != null) {
    final OperationContextImpl postExtContext=new OperationContextImpl(this,processType,runningModeControl.getRunningMode(),contextFlags,handler,null,model,control,processState,auditLogger,bootingFlag.get(),operationID,null);
    for (    ParsedBootOp parsedOp : postExtensionOps) {
      final OperationStepHandler stepHandler=parsedOp.handler == null ? rootRegistration.getOperationHandler(parsedOp.address,parsedOp.operationName) : parsedOp.handler;
      if (stepHandler == null) {
        logNoHandler(parsedOp);
        postExtContext.setRollbackOnly();
        break;
      }
 else {
        postExtContext.addStep(parsedOp.response,parsedOp.operation,stepHandler,OperationContext.Stage.MODEL);
      }
    }
    resultAction=postExtContext.executeOperation();
  }
  return resultAction == OperationContext.ResultAction.KEEP;
}
