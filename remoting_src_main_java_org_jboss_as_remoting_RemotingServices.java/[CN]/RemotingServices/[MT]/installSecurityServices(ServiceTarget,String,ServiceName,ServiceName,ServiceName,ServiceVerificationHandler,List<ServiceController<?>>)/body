{
  final ServiceName authProviderName=RealmAuthenticationProviderService.createName(connectorName);
  final ServiceName optionMapName=RealmOptionMapService.createName(connectorName);
  final RealmAuthenticationProviderService raps=new RealmAuthenticationProviderService();
  ServiceBuilder<?> builder=serviceTarget.addService(authProviderName,raps);
  if (securityRealmName != null) {
    builder.addDependency(securityRealmName,SecurityRealm.class,raps.getSecurityRealmInjectedValue());
  }
  if (serverCallbackServiceName != null) {
    builder.addDependency(serverCallbackServiceName,CallbackHandler.class,raps.getServerCallbackValue());
  }
  builder.addDependency(tmpDirService,String.class,raps.getTmpDirValue());
  addController(newControllers,verificationHandler,builder);
  RealmOptionMapService roms=new RealmOptionMapService();
  builder=serviceTarget.addService(optionMapName,roms).addDependency(authProviderName,RealmAuthenticationProvider.class,roms.getRealmAuthenticationProviderInjectedValue());
  addController(newControllers,verificationHandler,builder);
}
