{
  final ServiceName securityProviderName=RealmSecurityProviderService.createName(connectorName);
  final RealmSecurityProviderService rsps=new RealmSecurityProviderService();
  ServiceBuilder<?> builder=serviceTarget.addService(securityProviderName,rsps);
  if (realmName != null) {
    SecurityRealm.ServiceUtil.addDependency(builder,rsps.getSecurityRealmInjectedValue(),realmName,false);
  }
  if (serverCallbackServiceName != null) {
    builder.addDependency(serverCallbackServiceName,CallbackHandler.class,rsps.getServerCallbackValue());
  }
  builder.addDependency(tmpDirService,String.class,rsps.getTmpDirValue());
  addController(newControllers,verificationHandler,builder);
}
