{
  if (tm == null) {
    try {
      Context ctx=new InitialContext();
      tm=(TransactionManager)ctx.lookup("java:jboss/TransactionManager");
    }
 catch (    NamingException e) {
      throw new NestedRuntimeException("java:jboss/TransactionManager lookup failed",e);
    }
  }
  return tm;
}
