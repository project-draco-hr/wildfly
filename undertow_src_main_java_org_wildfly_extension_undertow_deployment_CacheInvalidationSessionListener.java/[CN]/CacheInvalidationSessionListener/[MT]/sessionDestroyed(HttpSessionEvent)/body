{
  ServletRequestContext src=ServletRequestContext.current();
  if (src != null) {
    Account account=src.getExchange().getSecurityContext().getAuthenticatedAccount();
    if (account != null) {
      clearAccount(account);
    }
  }
  if (se.getSession() instanceof HttpSessionImpl) {
    final HttpSessionImpl impl=(HttpSessionImpl)se.getSession();
    Session session;
    if (WildFlySecurityManager.isChecking()) {
      session=WildFlySecurityManager.doChecked(new PrivilegedAction<Session>(){
        @Override public Session run(){
          return impl.getSession();
        }
      }
);
    }
 else {
      session=impl.getSession();
    }
    if (session != null) {
      AuthenticatedSessionManager.AuthenticatedSession authenticatedSession=(AuthenticatedSessionManager.AuthenticatedSession)session.getAttribute(CachedAuthenticatedSessionHandler.class.getName() + ".AuthenticatedSession");
      if (authenticatedSession != null) {
        clearAccount(authenticatedSession.getAccount());
      }
    }
  }
}
