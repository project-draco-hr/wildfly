{
  ModelNode recursiveModel=Resource.Tools.readModel(context.readResource(PathAddress.EMPTY_ADDRESS));
  String resolvedDomain=getDomainName(context,recursiveModel,CommonAttributes.RESOLVED);
  String expressionsDomain=getDomainName(context,recursiveModel,CommonAttributes.EXPRESSION);
  boolean legacyWithProperPropertyFormat=false;
  if (model.hasDefined(CommonAttributes.PROPER_PROPERTY_FORMAT)) {
    legacyWithProperPropertyFormat=ExposeModelResourceExpression.DOMAIN_NAME.resolveModelAttribute(context,recursiveModel).asBoolean();
  }
  boolean coreMBeanSensitivity=JMXSubsystemRootResource.CORE_MBEAN_SENSITIVITY.resolveModelAttribute(context,recursiveModel).asBoolean();
  boolean forStandalone=context.getProcessType() == ProcessType.STANDALONE_SERVER;
  ServiceController<?> controller=verificationHandler != null ? MBeanServerService.addService(context.getServiceTarget(),resolvedDomain,expressionsDomain,legacyWithProperPropertyFormat,coreMBeanSensitivity,auditLoggerInfo,authorizer,forStandalone,verificationHandler) : MBeanServerService.addService(context.getServiceTarget(),resolvedDomain,expressionsDomain,legacyWithProperPropertyFormat,coreMBeanSensitivity,auditLoggerInfo,authorizer,forStandalone);
  if (newControllers != null) {
    newControllers.add(controller);
  }
}
