{
  String addOnName=randomString();
  installAddOn(env.getModuleRoot(),addOnName);
  TestUtils.tree(env.getInstalledImage().getJbossHome());
  InstalledIdentity installedIdentity=loadInstalledIdentity();
  Collection<AddOn> addOns=installedIdentity.getAddOns();
  assertEquals(1,addOns.size());
  AddOn addOn=addOns.iterator().next();
  assertEquals(addOnName,addOn.getName());
  PatchableTarget.TargetInfo targetInfo=addOn.loadTargetInfo();
  assertEquals(BASE,targetInfo.getCumulativePatchID());
  assertTrue(targetInfo.getPatchIDs().isEmpty());
  DirectoryStructure directoryStructure=targetInfo.getDirectoryStructure();
  assertEquals(newFile(env.getModuleRoot(),"system",ADD_ONS,addOnName),directoryStructure.getModuleRoot());
  assertNull(directoryStructure.getBundleRepositoryRoot());
}
