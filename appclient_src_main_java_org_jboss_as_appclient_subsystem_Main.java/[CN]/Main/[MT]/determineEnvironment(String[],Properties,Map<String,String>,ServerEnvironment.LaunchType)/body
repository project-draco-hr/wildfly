{
  List<String> clientArguments=new ArrayList<String>();
  ParsedOptions ret=new ParsedOptions();
  ret.clientArguments=clientArguments;
  final int argsLength=args.length;
  String serverConfig=null;
  boolean clientArgs=false;
  for (int i=0; i < argsLength; i++) {
    final String arg=args[i];
    try {
      if (clientArgs) {
        clientArguments.add(arg);
      }
 else       if (CommandLineConstants.VERSION.equals(arg) || CommandLineConstants.SHORT_VERSION.equals(arg) || CommandLineConstants.OLD_VERSION.equals(arg)|| CommandLineConstants.OLD_SHORT_VERSION.equals(arg)) {
        System.out.println("JBoss Application Server " + getVersionString());
        return null;
      }
 else       if (CommandLineConstants.HELP.equals(arg) || CommandLineConstants.SHORT_HELP.equals(arg) || CommandLineConstants.OLD_HELP.equals(arg)) {
        usage();
        return null;
      }
 else       if (CommandLineConstants.PROPERTIES.equals(arg) || CommandLineConstants.OLD_PROPERTIES.equals(arg) || CommandLineConstants.SHORT_PROPERTIES.equals(arg)) {
        if (!processProperties(arg,args[++i])) {
          return null;
        }
      }
 else       if (arg.startsWith(CommandLineConstants.PROPERTIES)) {
        String urlSpec=parseValue(arg,CommandLineConstants.PROPERTIES);
        if (urlSpec == null || !processProperties(arg,urlSpec)) {
          return null;
        }
      }
 else       if (arg.startsWith(CommandLineConstants.SHORT_PROPERTIES)) {
        String urlSpec=parseValue(arg,CommandLineConstants.SHORT_PROPERTIES);
        if (urlSpec == null || !processProperties(arg,urlSpec)) {
          return null;
        }
      }
 else       if (arg.startsWith(CommandLineConstants.OLD_PROPERTIES)) {
        String urlSpec=parseValue(arg,CommandLineConstants.OLD_PROPERTIES);
        if (urlSpec == null || !processProperties(arg,urlSpec)) {
          return null;
        }
      }
 else       if (arg.startsWith(CommandLineConstants.SYS_PROP)) {
        String name, value;
        int idx=arg.indexOf("=");
        if (idx == -1) {
          name=arg.substring(2);
          value="true";
        }
 else {
          name=arg.substring(2,idx);
          value=arg.substring(idx + 1,arg.length());
        }
        systemProperties.setProperty(name,value);
        SecurityActions.setSystemProperty(name,value);
      }
 else       if (arg.startsWith(CommandLineConstants.CLASSPATH)) {
        String classPath=parseValue(arg,CommandLineConstants.CLASSPATH);
        ret.additionalClassPath=classPath;
      }
 else {
        clientArgs=true;
        clientArguments.add(arg);
      }
    }
 catch (    IndexOutOfBoundsException e) {
      System.err.printf("Argument expected for option %s\n",arg);
      usage();
      return null;
    }
  }
  ret.environment=new ServerEnvironment(systemProperties,systemEnvironment,serverConfig,launchType);
  return ret;
}
