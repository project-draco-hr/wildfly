{
  final ModelNode operation=new ModelNode();
  operation.get(OP).set(READ_CHILDREN_NAMES_OPERATION);
  operation.get(OP_ADDR).setEmptyList();
  operation.get(CHILD_TYPE).set(HOST);
  final ModelNode host=new ModelNode().set(hostName);
  final long timeout=30L;
  final TimeUnit timeUnit=TimeUnit.SECONDS;
  final long deadline=System.currentTimeMillis() + timeUnit.toMillis(timeout);
  for (; ; ) {
    final long remaining=deadline - System.currentTimeMillis();
    final ModelNode result=client.execute(operation);
    if (result.get(RESULT).asList().contains(host)) {
      return;
    }
    if (remaining <= 0) {
      Assert.fail(hostName + " did not register within 30 seconds");
    }
    try {
      TimeUnit.SECONDS.sleep(1);
    }
 catch (    InterruptedException e) {
      Thread.currentThread().interrupt();
      Assert.fail("Interrupted while waiting for registration of host " + hostName);
    }
  }
}
