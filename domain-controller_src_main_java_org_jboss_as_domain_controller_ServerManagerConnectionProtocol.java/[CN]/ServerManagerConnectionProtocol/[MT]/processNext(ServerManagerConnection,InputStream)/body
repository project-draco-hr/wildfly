{
  Unmarshaller unmarshaller=null;
  try {
    final byte commandByte;
    try {
      commandByte=(byte)inputStream.read();
    }
 catch (    SocketException e) {
      return false;
    }
    if (commandByte == -1) {
      return false;
    }
    unmarshaller=MARSHALLER_FACTORY.createUnmarshaller(CONFIG);
    unmarshaller.start(Marshalling.createByteInput(inputStream));
    final IncomingCommand command=IncomingCommand.commandFor(commandByte);
    if (command == null) {
      throw new RuntimeException("Invalid command byte received: " + commandByte);
    }
    command.execute(serverManagerConnection,unmarshaller);
    unmarshaller.finish();
    return true;
  }
  finally {
    safeClose(unmarshaller);
  }
}
