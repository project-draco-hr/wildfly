{
  DeploymentUnit depUnit=phaseContext.getDeploymentUnit();
  if (depUnit.hasAttachment(Attachments.OSGI_METADATA))   return;
  VirtualFile virtualFile=depUnit.getAttachment(Attachments.DEPLOYMENT_ROOT).getRoot();
  VirtualFile xserviceFile=virtualFile.getChild(XSERVICE_PROPERTIES_NAME);
  if (xserviceFile.exists() == false)   return;
  try {
    Properties props=new Properties();
    props.load(xserviceFile.openStream());
    OSGiMetaData metadata=OSGiMetaDataBuilder.load(props);
    depUnit.putAttachment(Attachments.OSGI_METADATA,metadata);
  }
 catch (  IOException ex) {
    throw MESSAGES.cannotParseOSGiMetadata(ex,xserviceFile);
  }
}
