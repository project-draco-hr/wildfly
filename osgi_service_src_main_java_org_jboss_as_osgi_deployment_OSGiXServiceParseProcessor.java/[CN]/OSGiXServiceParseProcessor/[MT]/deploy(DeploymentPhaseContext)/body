{
  final DeploymentUnit deploymentUnit=phaseContext.getDeploymentUnit();
  OSGiMetaData metadata=OSGiMetaDataAttachment.getOSGiMetaData(deploymentUnit);
  if (metadata != null)   return;
  VirtualFile virtualFile=deploymentUnit.getAttachment(Attachments.DEPLOYMENT_ROOT).getRoot();
  VirtualFile xserviceFile=virtualFile.getChild(XSERVICE_PROPERTIES_NAME);
  if (xserviceFile.exists() == false)   return;
  try {
    metadata=OSGiMetaDataBuilder.load(xserviceFile.openStream());
    OSGiMetaDataAttachment.attachOSGiMetaData(deploymentUnit,metadata);
  }
 catch (  IOException ex) {
    throw new DeploymentUnitProcessingException("Cannot parse: " + xserviceFile);
  }
}
