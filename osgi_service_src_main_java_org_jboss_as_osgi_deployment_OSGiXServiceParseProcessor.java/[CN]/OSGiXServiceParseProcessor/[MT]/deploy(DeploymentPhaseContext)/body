{
  final DeploymentUnit depUnit=phaseContext.getDeploymentUnit();
  OSGiMetaData metadata=depUnit.getAttachment(OSGiConstants.OSGI_METADATA_KEY);
  if (metadata != null)   return;
  VirtualFile virtualFile=depUnit.getAttachment(Attachments.DEPLOYMENT_ROOT).getRoot();
  VirtualFile xserviceFile=virtualFile.getChild(XSERVICE_PROPERTIES_NAME);
  if (xserviceFile.exists() == false)   return;
  try {
    metadata=OSGiMetaDataBuilder.load(xserviceFile.openStream());
    depUnit.putAttachment(OSGiConstants.OSGI_METADATA_KEY,metadata);
  }
 catch (  IOException ex) {
    throw MESSAGES.cannotParseOSGiMetadata(ex,xserviceFile);
  }
}
