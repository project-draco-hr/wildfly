{
  if (values.isSilentOrNonInteractive() == false) {
    theConsole.printf(NEW_LINE);
    theConsole.printf(MESSAGES.enterNewUserDetails());
    theConsole.printf(NEW_LINE);
    values.password=null;
    theConsole.printf(MESSAGES.realmPrompt(values.realm));
    String temp=theConsole.readLine(" : ");
    if (temp == null) {
      theConsole.printf(NEW_LINE);
      return null;
    }
    if (temp.length() > 0) {
      values.realm=temp;
    }
    String existingUsername=values.userName;
    String usernamePrompt=existingUsername == null ? MESSAGES.usernamePrompt() : MESSAGES.usernamePrompt(existingUsername);
    theConsole.printf(usernamePrompt);
    temp=theConsole.readLine(" : ");
    if (temp != null && temp.length() > 0) {
      existingUsername=temp;
    }
    if (temp == null || existingUsername == null || existingUsername.length() == 0) {
      return new ErrorState(MESSAGES.noUsernameExiting());
    }
    values.userName=existingUsername;
    theConsole.printf(MESSAGES.passwordPrompt());
    char[] tempChar=theConsole.readPassword(" : ");
    if (tempChar == null || tempChar.length == 0) {
      return new ErrorState(MESSAGES.noPasswordExiting());
    }
    theConsole.printf(MESSAGES.passwordConfirmationPrompt());
    char[] secondTempChar=theConsole.readPassword(" : ");
    if (secondTempChar == null) {
      secondTempChar=new char[0];
    }
    if (Arrays.equals(tempChar,secondTempChar) == false) {
      return new ErrorState(MESSAGES.passwordMisMatch(),this);
    }
    values.password=tempChar;
    if (!values.management) {
      theConsole.printf(MESSAGES.rolesPrompt());
      values.roles=theConsole.readLine(" : ");
    }
  }
  return new WeakCheckState(values);
}
