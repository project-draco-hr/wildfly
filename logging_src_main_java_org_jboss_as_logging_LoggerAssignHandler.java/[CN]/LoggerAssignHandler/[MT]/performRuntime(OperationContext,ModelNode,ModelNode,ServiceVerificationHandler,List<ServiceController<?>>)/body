{
  String loggerName=getLoggerName(operation);
  String handlerName=getHandlerName(operation);
  final ServiceRegistry serviceRegistry=context.getServiceRegistry(false);
  ServiceController<?> loggerHandlerController=serviceRegistry.getService(LogServices.loggerHandlerName(loggerName,handlerName));
  final ServiceController<Handler> handlerController=(ServiceController<Handler>)serviceRegistry.getService(LogServices.handlerName(handlerName));
  if (loggerHandlerController != null) {
    throw createFailureMessage(MESSAGES.handlerAlreadyDefined(handlerName));
  }
  if (handlerController == null)   throw createFailureMessage(MESSAGES.handlerNotFound(handlerName));
  ServiceTarget target=context.getServiceTarget();
  LoggerHandlerService service=new LoggerHandlerService(loggerName);
  ServiceBuilder<Logger> builder=target.addService(LogServices.loggerHandlerName(loggerName,handlerName),service);
  builder.addDependency(LogServices.loggerName(loggerName));
  builder.addDependency(LogServices.handlerName(handlerName),Handler.class,service.getHandlerInjector());
  builder.addListener(verificationHandler);
  newControllers.add(builder.install());
}
