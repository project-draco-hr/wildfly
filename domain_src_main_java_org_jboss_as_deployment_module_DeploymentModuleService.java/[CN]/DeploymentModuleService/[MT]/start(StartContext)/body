{
  final ModuleConfig moduleConfig=this.moduleConfig;
  final ModuleSpec.Builder specBuilder=ModuleSpec.build(moduleConfig.getIdentifier());
  for (  ModuleConfig.ResourceRoot resource : moduleConfig.getResources()) {
    try {
      specBuilder.addResourceRoot(new VFSResourceLoader(specBuilder.getIdentifier(),resource.getRoot(),resource.getRootName()));
    }
 catch (    IOException e) {
      throw new StartException("Failed to create VFSResourceLoader for root [" + resource.getRootName() + "]",e);
    }
  }
  final ModuleConfig.Dependency[] dependencies=moduleConfig.getDependencies();
  for (  ModuleConfig.Dependency dependency : dependencies) {
    specBuilder.addModuleDependency(ModuleDependencySpec.build(dependency.getIdentifier()).setExportFilter(dependency.isExport() ? PathFilters.acceptAll() : PathFilters.rejectAll()).setOptional(dependency.isOptional()).create());
  }
  final ModuleSpec moduleSpec=specBuilder.create();
  final DeploymentModuleLoader deploymentModuleLoader=this.deploymentModuleLoader.getValue();
  deploymentModuleLoader.addModuleSpec(moduleSpec);
}
