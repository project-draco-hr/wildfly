{
  JavaArchive persistenceProvider=ShrinkWrap.create(JavaArchive.class,ARCHIVE_NAME + ".jar");
  persistenceProvider.addClasses(TestEntityManagerFactory.class,TestEntityManager.class,TestPersistenceProvider.class);
  persistenceProvider.addAsResource(new StringAsset("org.jboss.as.test.integration.jpa.mockprovider.txtimeout.TestPersistenceProvider"),"META-INF/services/javax.persistence.spi.PersistenceProvider");
  EnterpriseArchive ear=ShrinkWrap.create(EnterpriseArchive.class,ARCHIVE_NAME + ".ear");
  JavaArchive ejbjar=ShrinkWrap.create(JavaArchive.class,"ejbjar.jar");
  ejbjar.addPackage("org.jboss.tm");
  ejbjar.addAsManifestResource(emptyEjbJar(),"ejb-jar.xml");
  ejbjar.addClasses(TxTimeoutTestCase.class,SFSB1.class);
  ejbjar.addAsManifestResource(TxTimeoutTestCase.class.getPackage(),"persistence.xml","persistence.xml");
  ear.addAsModule(ejbjar);
  JavaArchive lib=ShrinkWrap.create(JavaArchive.class,"lib.jar");
  lib.addClasses(Employee.class,TxTimeoutTestCase.class);
  ear.addAsLibraries(lib,persistenceProvider);
  ear.addAsManifestResource(new StringAsset("<jboss-deployment-structure>" + " <deployment>" + " <dependencies>"+ " <module name=\"org.jboss.jboss-transaction-spi\" />"+ " </dependencies>"+ " </deployment>"+ "</jboss-deployment-structure>"),"jboss-deployment-structure.xml");
  return ear;
}
