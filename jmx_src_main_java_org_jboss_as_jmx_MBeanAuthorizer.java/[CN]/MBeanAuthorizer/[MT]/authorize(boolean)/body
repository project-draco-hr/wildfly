{
  Caller caller;
  if (WildFlySecurityManager.isChecking()) {
    caller=WildFlySecurityManager.doChecked(GET_SUBJECT_ACTION);
  }
 else {
    caller=GET_SUBJECT_ACTION.run();
  }
  Set<String> roles=roleMapper.mapRoles(caller,null,null,(TargetAttribute)null);
  if (nonManagementMbeansSensitive) {
    authorize(roles,StandardRole.SUPERUSER,StandardRole.ADMINISTRATOR);
  }
 else {
    if (readOnly) {
      authorize(roles,StandardRole.SUPERUSER,StandardRole.ADMINISTRATOR,StandardRole.OPERATOR,StandardRole.MAINTAINER,StandardRole.AUDITOR,StandardRole.MONITOR);
    }
 else {
      authorize(roles,StandardRole.SUPERUSER,StandardRole.ADMINISTRATOR,StandardRole.OPERATOR,StandardRole.MAINTAINER);
    }
  }
}
