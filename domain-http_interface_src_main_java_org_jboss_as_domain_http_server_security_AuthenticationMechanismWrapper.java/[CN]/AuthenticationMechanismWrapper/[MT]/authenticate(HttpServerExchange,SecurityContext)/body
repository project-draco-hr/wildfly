{
  try {
    InetAddress inetAddress=null;
    SocketAddress address=exchange.getConnection().getPeerAddress();
    if (address instanceof InetSocketAddress) {
      inetAddress=((InetSocketAddress)address).getAddress();
    }
    RealmIdentityManager.setRequestSpecific(mechanism,inetAddress);
    return wrapped.authenticate(exchange,securityContext);
  }
  finally {
    RealmIdentityManager.clearRequestSpecific();
  }
}
