{
  final ModuleIdentifier logModuleId=ModuleIdentifier.create(MODULE_ID_LOGMANAGER);
  final Module logModule;
  try {
    logModule=moduleLoader.loadModule(logModuleId);
  }
 catch (  final ModuleLoadException mle) {
    throw new RuntimeException("Could not load logging module",mle);
  }
  final ModuleClassLoader logModuleClassLoader=logModule.getClassLoader();
  final ClassLoader tccl=SecurityActions.getContextClassLoader();
  try {
    SecurityActions.setContextClassLoader(logModuleClassLoader);
    SecurityActions.setSystemProperty(SYSPROP_KEY_LOGMANAGER,SYSPROP_VALUE_JBOSS_LOGMANAGER);
    final Class<?> actualLogManagerClass=LogManager.getLogManager().getClass();
    if (actualLogManagerClass == LogManager.class) {
      System.err.println("Could not load JBoss LogManager; the LogManager or Logging subsystem has likely been accessed prior to this initialization.");
    }
 else {
      Module.setModuleLogger(new JDKModuleLogger());
    }
  }
  finally {
    SecurityActions.setContextClassLoader(tccl);
  }
}
