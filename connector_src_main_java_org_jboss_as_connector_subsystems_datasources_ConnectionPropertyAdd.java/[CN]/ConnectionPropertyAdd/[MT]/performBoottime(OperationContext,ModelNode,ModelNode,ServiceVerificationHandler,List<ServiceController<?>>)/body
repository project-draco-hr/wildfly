{
  final String configPropertyValue=CONNECTION_PROPERTY_VALUE.validateResolvedOperation(recoveryEnvModel).asString();
  final ModelNode address=operation.require(OP_ADDR);
  PathAddress path=PathAddress.pathAddress(address);
  final String jndiName=path.getElement(path.size() - 2).getValue();
  final String configPropertyName=PathAddress.pathAddress(address).getLastElement().getValue();
  ServiceName serviceName=DataSourceConfigService.SERVICE_NAME_BASE.append(jndiName).append(configPropertyName);
  ServiceName dsServiceName=DataSourceConfigService.SERVICE_NAME_BASE.append(jndiName);
  final ServiceTarget serviceTarget=context.getServiceTarget();
  final ConnectionPropertiesService service=new ConnectionPropertiesService(configPropertyName,configPropertyValue);
  ServiceController<?> controller=serviceTarget.addService(serviceName,service).setInitialMode(ServiceController.Mode.ACTIVE).addDependency(dsServiceName,ModifiableDataSource.class,service.getAOInjector()).addListener(verificationHandler).install();
  context.addStep(verificationHandler,OperationContext.Stage.VERIFY);
}
