{
  ModelNode op;
  ModelNode address=getSubsystemAddress();
  address.add(new ModelNode().set(ModelConstants.CONFIGURATION,pid));
  Dictionary<String,String> oldConfig=getConfiguration(pid);
  if (oldConfig != null) {
    op=Util.getEmptyOperation(ModelConstants.UPDATE,address);
  }
 else {
    op=Util.getEmptyOperation(ModelDescriptionConstants.ADD,address);
  }
  ModelNode entries=new ModelNode();
  Enumeration<String> keys=newConfig.keys();
  while (keys.hasMoreElements()) {
    String key=keys.nextElement();
    entries.get(key).set(newConfig.get(key));
  }
  entries.get(SOURCE_PROPERTY_KEY).set(FROM_NONDMR_SOURCE_VALUE);
  op.get(ModelConstants.ENTRIES).set(entries);
  try {
    ModelNode node=controllerClient.execute(op);
    ModelNode outcome=node.get(ModelDescriptionConstants.OUTCOME);
    if (ModelDescriptionConstants.SUCCESS.equals(outcome.asString())) {
      putConfigurationInternal(pid,newConfig);
    }
 else {
      ROOT_LOGGER.cannotAddConfiguration(pid,node);
    }
  }
 catch (  IOException ex) {
    ROOT_LOGGER.cannotAddConfiguration(ex,pid);
  }
  return oldConfig;
}
