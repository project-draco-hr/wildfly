{
  final ExternalContexts externalContexts=deploymentUnit.getAttachment(Attachments.EXTERNAL_CONTEXTS);
  final ServiceName parentExternalContextServiceName=externalContexts != null ? externalContexts.getParentExternalContext(getBinderServiceName()) : null;
  final ServiceName dependencyServiceName=parentExternalContextServiceName == null ? getBinderServiceName() : parentExternalContextServiceName;
  serviceBuilder.addDependency(dependencyServiceName);
  final Injector<NamingStore> lookupInjector=new Injector<NamingStore>(){
    @Override public void uninject(){
      targetInjector.uninject();
    }
    @Override public void inject(    final NamingStore value) throws InjectionException {
      final NamingContext storeBaseContext=new NamingContext(value,null);
      final ManagedReferenceFactory factory=new ManagedReferenceFactory(){
        @Override public ManagedReference getReference(){
          Object bindValue=null;
          try {
            bindValue=storeBaseContext.lookup(getBindName());
          }
 catch (          NamingException e) {
            throw MESSAGES.resourceLookupForInjectionFailed(getAbsoluteJndiName(),e);
          }
          return new ImmediateManagedReference(bindValue);
        }
      }
;
      targetInjector.inject(factory);
    }
  }
;
  serviceBuilder.addDependency(getParentContextServiceName(),NamingStore.class,lookupInjector);
}
