{
  ServerEnvironment env;
  try {
    env=serverEnvironment.getValue();
  }
 catch (  IllegalStateException ise) {
    throw new StartException(ServerEnvironment.class.getSimpleName() + " was not injected");
  }
  if (env.isStandalone()) {
    File configDir=env.getServerConfigurationDir();
    if (configDir.exists()) {
      if (!configDir.isDirectory()) {
        throw new StartException(configDir.getAbsolutePath() + " is not a directory");
      }
 else       if (!configDir.canWrite()) {
        throw new StartException(configDir.getAbsolutePath() + " is not a writable");
      }
    }
 else     if (!configDir.mkdirs()) {
      throw new StartException("Cannot create directory " + configDir.getAbsolutePath());
    }
    configFile=new File(configDir,"standalone.xml");
    if (configFile.exists()) {
      if (configFile.isDirectory()) {
        throw new StartException(configFile.getAbsolutePath() + " is a directory");
      }
 else       if (!configDir.canWrite()) {
        throw new StartException(configFile.getAbsolutePath() + " is not a writable");
      }
    }
  }
}
