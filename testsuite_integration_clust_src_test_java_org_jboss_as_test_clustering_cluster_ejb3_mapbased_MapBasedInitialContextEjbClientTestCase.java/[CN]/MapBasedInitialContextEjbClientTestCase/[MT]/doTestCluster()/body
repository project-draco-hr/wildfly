{
  controller.start(CONTAINER_1);
  controller.start(CONTAINER_2);
  deployer.deploy("dep2");
  deployer.deploy("dep1");
  Thread.sleep(5000);
  Context ctx=new InitialContext(getEjbClientProperties(System.getProperty("node0","127.0.0.1"),4447));
  String lookupName="ejb:/" + ARCHIVE_NAME + "/"+ StatefulBean.class.getSimpleName()+ "!"+ StatefulIface.class.getCanonicalName()+ "?stateful";
  StatefulIface beanStateful=(StatefulIface)ctx.lookup(lookupName);
  beanStateful.setNumber(20);
  controller.stop(CONTAINER_1);
  Assert.assertEquals("Unexpected return value from EJB call",20,beanStateful.getNumber());
  ctx.close();
  if (controller.isStarted(CONTAINER_1))   controller.stop(CONTAINER_1);
  if (controller.isStarted(CONTAINER_2))   controller.stop(CONTAINER_2);
}
