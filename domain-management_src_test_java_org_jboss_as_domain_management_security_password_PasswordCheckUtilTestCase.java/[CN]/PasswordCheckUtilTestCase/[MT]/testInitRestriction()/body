{
  final URL resource=PasswordCheckUtilTestCase.class.getResource("add-user.properties");
  File configFile=new File(resource.toURI());
  System.setProperty(AddUser.CONFIG_FILE,configFile.getAbsolutePath());
  final List<PasswordRestriction> passwordRestrictions=new PasswordCheckUtil().getPasswordRestrictions("ggrossetie");
  assertPasswordRejected(passwordRestrictions,"ggrossetie","Password must not match username");
  assertPasswordRejected(passwordRestrictions,"abc12","Password must have at least 8 characters");
  assertPasswordRejected(passwordRestrictions,"abcdefgh","Password must have at least 2 digits");
  assertPasswordRejected(passwordRestrictions,"abcdefgh1","Password must have at least 2 digits");
  assertPasswordRejected(passwordRestrictions,"root","Password must not be 'root'");
  assertPasswordRejected(passwordRestrictions,"admin","Password must not be 'admin'");
  assertPasswordRejected(passwordRestrictions,"administrator","Password must not be 'administrator'");
  assertPasswordAccepted(passwordRestrictions,"abcdefgh12","Password is valid");
}
