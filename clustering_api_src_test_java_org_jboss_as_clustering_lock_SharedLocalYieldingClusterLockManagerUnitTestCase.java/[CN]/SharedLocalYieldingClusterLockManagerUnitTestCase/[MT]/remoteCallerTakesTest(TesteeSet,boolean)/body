{
  assertEquals(LockResult.NEW_LOCK,ts.testee.lock("test",1000,true));
  CountDownLatch readyLatch=new CountDownLatch(1);
  CountDownLatch endLatch=new CountDownLatch(1);
  RemoteLocker locker=new RemoteLocker(ts,node2,readyLatch,endLatch);
  Executors.newSingleThreadExecutor().execute(locker);
  boolean gotLatch=readyLatch.await(5,TimeUnit.SECONDS);
  assertTrue("timed out waiting for ready latch",gotLatch);
  Thread.sleep(500);
  ts.testee.unlock("test",localRemoves);
  gotLatch=endLatch.await(5,TimeUnit.SECONDS);
  assertTrue("timed out waiting for end latch",gotLatch);
  if (locker.exception != null) {
    throw locker.exception;
  }
  assertNotNull(locker.result);
  assertEquals(RemoteLockResponse.Flag.OK,locker.result.flag);
}
