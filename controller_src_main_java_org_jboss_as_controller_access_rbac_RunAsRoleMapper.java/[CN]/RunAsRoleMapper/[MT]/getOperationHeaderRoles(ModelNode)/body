{
  Set<String> result=null;
  if (operation.hasDefined(ModelDescriptionConstants.OPERATION_HEADERS)) {
    ModelNode headers=operation.get(ModelDescriptionConstants.OPERATION_HEADERS);
    if (headers.hasDefined(ModelDescriptionConstants.ROLES)) {
      ModelNode rolesNode=headers.get(ModelDescriptionConstants.ROLES);
      if (rolesNode.getType() == ModelType.STRING) {
        result=Collections.singleton(getRoleFromText(rolesNode.asString()));
      }
 else {
        result=new HashSet<String>();
        for (        ModelNode role : rolesNode.asList()) {
          result.add(getRoleFromText(role.asString()));
        }
      }
    }
  }
  return result;
}
