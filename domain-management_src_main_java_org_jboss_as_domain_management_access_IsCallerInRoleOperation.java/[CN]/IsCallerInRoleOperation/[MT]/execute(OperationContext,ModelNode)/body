{
  String roleName=RoleMappingResourceDefinition.getRoleName(operation);
  if (context.getCurrentStage() == Stage.MODEL) {
    context.addStep(this,Stage.RUNTIME);
  }
 else {
    ModelNode result=context.getResult();
    Set<String> operationHeaderRoles=RunAsRoleMapper.getOperationHeaderRoles(operation);
    result.set(isCallerInRole(roleName,context.getCaller(),context.getCallEnvironment(),operationHeaderRoles));
  }
  context.stepCompleted();
}
