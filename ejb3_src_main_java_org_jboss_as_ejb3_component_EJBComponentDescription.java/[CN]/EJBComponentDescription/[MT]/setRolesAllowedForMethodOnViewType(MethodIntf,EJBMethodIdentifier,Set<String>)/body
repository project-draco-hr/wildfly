{
  if (ejbMethodIdentifier == null) {
    throw MESSAGES.ejbMethodIsNullForViewType(viewType);
  }
  if (roles == null) {
    throw MESSAGES.rolesIsNullOnViewTypeAndMethod(viewType,ejbMethodIdentifier);
  }
  for (  final ViewDescription view : this.getViews()) {
    if (view instanceof EJBViewDescription == false) {
      continue;
    }
    final EJBViewDescription ejbView=(EJBViewDescription)view;
    if (ejbView.getMethodIntf() != viewType) {
      continue;
    }
    Map<EJBMethodIdentifier,Set<String>> perViewMethodRoles=this.methodLevelRolesAllowed.get(view.getViewClassName());
    if (perViewMethodRoles == null) {
      perViewMethodRoles=new HashMap<EJBMethodIdentifier,Set<String>>();
      this.methodLevelRolesAllowed.put(view.getViewClassName(),perViewMethodRoles);
    }
    perViewMethodRoles.put(ejbMethodIdentifier,roles);
  }
}
