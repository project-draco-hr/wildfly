{
  for (  final ViewDescription view : this.getViews()) {
    if (view instanceof EJBViewDescription == false) {
      continue;
    }
    final EJBViewDescription ejbView=(EJBViewDescription)view;
    if (ejbView.getMethodIntf() != viewType) {
      continue;
    }
    Map<EJBMethodIdentifier,Set<String>> perViewMethodRoles=this.methodLevelRolesAllowed.get(view.getViewClassName());
    if (perViewMethodRoles == null) {
      perViewMethodRoles=new HashMap<EJBMethodIdentifier,Set<String>>();
      this.methodLevelRolesAllowed.put(view.getViewClassName(),perViewMethodRoles);
    }
    Set<String> perMethodRoles=perViewMethodRoles.get(ejbMethodIdentifier);
    if (perMethodRoles == null) {
      perMethodRoles=new HashSet<String>();
      perViewMethodRoles.put(ejbMethodIdentifier,perMethodRoles);
    }
    perMethodRoles.addAll(roles);
  }
}
