{
  for (  final ViewDescription view : this.getViews()) {
    if (view instanceof EJBViewDescription == false) {
      continue;
    }
    final EJBViewDescription ejbView=(EJBViewDescription)view;
    if (ejbView.getMethodIntf() != viewType) {
      continue;
    }
    Map<String,Collection<String>> perViewRoles=this.classLevelRolesAllowed.get(view.getViewClassName());
    if (perViewRoles == null) {
      perViewRoles=new HashMap<String,Collection<String>>();
      this.classLevelRolesAllowed.put(view.getViewClassName(),perViewRoles);
    }
    Collection<String> perClassRoles=perViewRoles.get(view.getViewClassName());
    if (perClassRoles == null) {
      perClassRoles=new HashSet<String>();
      perViewRoles.put(view.getViewClassName(),perClassRoles);
    }
    perClassRoles.addAll(roles);
  }
}
