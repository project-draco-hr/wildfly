{
  if (roles == null) {
    throw new IllegalArgumentException("Roles cannot be null while setting roles on view type: " + viewType);
  }
  for (  final ViewDescription view : this.getViews()) {
    if (view instanceof EJBViewDescription == false) {
      continue;
    }
    final EJBViewDescription ejbView=(EJBViewDescription)view;
    if (ejbView.getMethodIntf() != viewType) {
      continue;
    }
    Map<String,Set<String>> perViewRoles=this.classLevelRolesAllowed.get(view.getViewClassName());
    if (perViewRoles == null) {
      perViewRoles=new HashMap<String,Set<String>>();
      this.classLevelRolesAllowed.put(view.getViewClassName(),perViewRoles);
    }
    perViewRoles.put(view.getViewClassName(),roles);
  }
}
