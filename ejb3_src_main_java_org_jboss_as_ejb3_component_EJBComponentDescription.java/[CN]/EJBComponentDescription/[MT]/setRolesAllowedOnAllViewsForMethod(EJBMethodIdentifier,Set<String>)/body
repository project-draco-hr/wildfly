{
  if (ejbMethodIdentifier == null) {
    throw MESSAGES.ejbMethodIsNull();
  }
  if (roles == null) {
    throw MESSAGES.rolesIsNull(ejbMethodIdentifier);
  }
  for (  final ViewDescription view : this.getViews()) {
    Map<EJBMethodIdentifier,Set<String>> perViewMethodRoles=this.methodLevelRolesAllowed.get(view.getViewClassName());
    if (perViewMethodRoles == null) {
      perViewMethodRoles=new HashMap<EJBMethodIdentifier,Set<String>>();
      this.methodLevelRolesAllowed.put(view.getViewClassName(),perViewMethodRoles);
    }
    perViewMethodRoles.put(ejbMethodIdentifier,roles);
  }
}
