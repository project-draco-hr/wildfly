{
  Set<String> result=SUPERUSER;
  ModelNode headers=operation.get(ModelDescriptionConstants.OPERATION_HEADERS);
  if (headers.isDefined() && headers.hasDefined("roles")) {
    ModelNode rolesNode=headers.get("roles");
    Set<String> roleSet=new HashSet<String>();
    if (rolesNode.getType() == ModelType.STRING) {
      roleSet.add(getRoleFromText(rolesNode.asString()));
    }
 else {
      for (      ModelNode role : headers.get("roles").asList()) {
        roleSet.add(getRoleFromText(role.asString()));
      }
    }
    result=Collections.unmodifiableSet(roleSet);
  }
  return result;
}
