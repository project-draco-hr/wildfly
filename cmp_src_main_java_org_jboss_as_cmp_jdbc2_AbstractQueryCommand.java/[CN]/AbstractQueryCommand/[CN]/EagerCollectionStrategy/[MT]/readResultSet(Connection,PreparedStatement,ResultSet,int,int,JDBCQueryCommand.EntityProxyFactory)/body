{
  Collection result;
  try {
    if ((limit == 0 || count-- > 0) && rs.next()) {
      result=collectionFactory.newCollection();
      Object instance=resultReader.readRow(rs,factory);
      result.add(instance);
      while ((limit == 0 || count-- > 0) && rs.next()) {
        instance=resultReader.readRow(rs,factory);
        result.add(instance);
      }
    }
 else {
      result=Collections.EMPTY_SET;
    }
  }
 catch (  Exception e) {
    log.error("Finder failed: " + e.getMessage(),e);
    throw new FinderException(e.getMessage());
  }
 finally {
    JDBCUtil.safeClose(rs);
    JDBCUtil.safeClose(ps);
    JDBCUtil.safeClose(con);
  }
  return result;
}
