{
  if (output == null) {
    throw new IllegalArgumentException("Cannot write to null dataoutput");
  }
  if (clusters == null || clusters.length == 0) {
    return;
  }
  output.write(HEADER_COMPLETE_CLUSTER_TOPOLOGY);
  PackedInteger.writePackedInteger(output,clusters.length);
  for (  final GroupMembershipNotifier cluster : clusters) {
    output.writeUTF(cluster.getGroupName());
    final int memberCount=cluster.getClusterNodes().size();
    PackedInteger.writePackedInteger(output,memberCount);
    for (    final ClusterNode clusterMember : cluster.getClusterNodes()) {
      output.writeUTF(clusterMember.getIpAddress().getHostAddress());
      PackedInteger.writePackedInteger(output,4447);
    }
  }
}
