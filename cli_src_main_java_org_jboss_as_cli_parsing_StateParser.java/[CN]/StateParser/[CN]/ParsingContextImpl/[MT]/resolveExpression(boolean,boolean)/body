{
  final char firstChar=input.charAt(location);
  if (firstChar == '$') {
    final int inputLength=input.length();
    if (inputLength - 1 > location && input.charAt(location + 1) == '{') {
      if (systemProperty) {
        substituteSystemProperty(exceptionIfNotResolved);
      }
    }
 else {
      substituteVariable(exceptionIfNotResolved);
    }
  }
 else   if (firstChar == '`') {
    substituteCommand(exceptionIfNotResolved);
  }
}
