{
  int endIndex=location + 1;
  char c=input.charAt(endIndex);
  if (endIndex >= input.length() || !(Character.isJavaIdentifierStart(c) && c != '$')) {
    return;
  }
  while (++endIndex < input.length()) {
    c=input.charAt(endIndex);
    if (!(Character.isJavaIdentifierPart(c) && c != '$')) {
      break;
    }
  }
  final String name=input.substring(location + 1,endIndex);
  final String value=cmdCtx == null ? null : cmdCtx.getVariable(name);
  if (value == null) {
    if (exceptionIfNotResolved) {
      throw new UnresolvedVariableException(name,"Unrecognized variable " + name);
    }
  }
 else {
    StringBuilder buf=new StringBuilder(input.length() - name.length() + value.length());
    buf.append(input.substring(0,location)).append(value);
    if (endIndex < input.length()) {
      buf.append(input.substring(endIndex));
    }
    variableCorrection+=value.length() - name.length() - 1;
    input=buf.toString();
    ch=input.charAt(location);
  }
}
