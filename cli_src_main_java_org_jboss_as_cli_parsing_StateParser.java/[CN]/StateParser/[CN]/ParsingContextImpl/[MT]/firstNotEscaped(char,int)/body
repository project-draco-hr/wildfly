{
  final int index=input.indexOf(ch,start);
  if (index < 0) {
    return index;
  }
  if (input.charAt(index - 1) == '\\') {
    int i=index - 2;
    boolean escaped=true;
    while (i - start >= 0 && input.charAt(i) == '\\') {
      --i;
      escaped=!escaped;
    }
    if (escaped) {
      if (index + 1 < input.length() - 1) {
        return firstNotEscaped(ch,index + 1);
      }
      return -1;
    }
  }
  return index;
}
