{
  final InternalState required=this.requiredState;
  final InternalState state=this.internalState;
  if (required == InternalState.STOPPED && state == InternalState.PROCESS_STOPPING) {
    finishTransition(InternalState.PROCESS_STOPPING,InternalState.PROCESS_STOPPED);
  }
 else {
    this.internalState=InternalState.PROCESS_STOPPED;
    if (respawnCountUpdater.incrementAndGet(this) >= 10) {
      this.requiredState=InternalState.FAILED;
      return;
    }
    this.internalState=required == InternalState.SERVER_STARTED ? InternalState.PROCESS_ADDED : InternalState.PROCESS_STOPPED;
    ROOT_LOGGER.infof("respawning server: %s",serverName);
    transition();
  }
}
