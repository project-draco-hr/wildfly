{
  final EJBComponentDescription ejbComponentDescription=(EJBComponentDescription)componentConfiguration.getComponentDescription();
  final Method componentMethod=this.findComponentMethod(componentConfiguration,viewMethod);
  final EJBMethodIdentifier ejbMethodIdentifier=EJBMethodIdentifier.fromMethod(componentMethod);
  final Set<String> rolesAllowed=ejbComponentDescription.getRolesAllowed(viewClassName,ejbMethodIdentifier);
  final boolean methodMarkedForDenyAll=this.isMethodMarkedForDenyAll(ejbComponentDescription,viewClassName,ejbMethodIdentifier);
  final boolean methodMarkedForPermitAll=this.isMethodMarkedForPermitAll(ejbComponentDescription,viewClassName,ejbMethodIdentifier);
  if (methodMarkedForPermitAll) {
    if (methodMarkedForDenyAll) {
      throw MESSAGES.invalidSecurityAnnotation(componentMethod,viewClassName,"@PemitAll","@DenyAll");
    }
    if (!rolesAllowed.isEmpty()) {
      throw MESSAGES.invalidSecurityAnnotation(componentMethod,viewClassName,"@RolesAllowed","@PermitAll");
    }
    return true;
  }
  if (!rolesAllowed.isEmpty()) {
    return false;
  }
  if (methodMarkedForPermitAll) {
    return false;
  }
  final Class<?> declaringClass=componentMethod.getDeclaringClass();
  if (ejbComponentDescription.isPermitAllApplicableToClass(viewClassName,declaringClass.getName())) {
    return true;
  }
  return false;
}
