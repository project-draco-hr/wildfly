{
  FileOutputStream fos=null;
  BufferedOutputStream bos=null;
  try {
    backupConfigFile();
    configFile.createNewFile();
    fos=new FileOutputStream(configFile);
    bos=new BufferedOutputStream(fos);
    final XMLMapper mapper=XMLMapper.Factory.create();
    mapper.deparseDocument(new RootElementWriter(domainModel),XMLOutputFactory.newInstance().createXMLStreamWriter(bos));
    fos.close();
  }
 catch (  Exception e) {
    logger.errorf(e,"Failed persisting configuration file %s",configFile.getAbsolutePath());
  }
 finally {
    StreamUtils.safeClose(fos);
  }
}
