{
  log.info("Starting Domain Controller");
  final DomainController controller=new DomainControllerImpl(configurationPersister);
  final List<ModelNode> updates;
  try {
    updates=configurationPersister.load();
  }
 catch (  final Exception e) {
    log.error("failed to start domain controller",e);
    throw new StartException(e);
  }
  final AtomicInteger count=new AtomicInteger(1);
  final ResultHandler resultHandler=new ResultHandler(){
    @Override public void handleResultFragment(    final String[] location,    final ModelNode result){
    }
    @Override public void handleResultComplete(    final ModelNode compensatingOperation){
      if (count.decrementAndGet() == 0) {
      }
    }
    @Override public void handleFailed(    final ModelNode failureDescription){
      if (count.decrementAndGet() == 0) {
      }
    }
    @Override public void handleCancellation(){
      if (count.decrementAndGet() == 0) {
      }
    }
  }
;
  for (  ModelNode update : updates) {
    count.incrementAndGet();
    controller.execute(update,resultHandler);
  }
  if (count.decrementAndGet() == 0) {
  }
  this.controller=controller;
}
