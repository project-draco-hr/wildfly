{
synchronized (transactionAction) {
    final boolean failed=finalResultRef.get() != null;
    transactionAction.set(Boolean.valueOf(commit));
    transactionAction.notifyAll();
    if (commit && failed) {
      return false;
    }
    return true;
  }
}
