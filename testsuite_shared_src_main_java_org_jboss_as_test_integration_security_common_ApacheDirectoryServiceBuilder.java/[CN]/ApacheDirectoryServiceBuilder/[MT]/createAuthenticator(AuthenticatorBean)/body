{
  if (authenticatorBean.isDisabled()) {
    return null;
  }
  Authenticator authenticator=null;
  if (authenticatorBean instanceof DelegatingAuthenticatorBean) {
    authenticator=new DelegatingAuthenticator();
    ((DelegatingAuthenticator)authenticator).setDelegateHost(((DelegatingAuthenticatorBean)authenticatorBean).getDelegateHost());
    ((DelegatingAuthenticator)authenticator).setDelegatePort(((DelegatingAuthenticatorBean)authenticatorBean).getDelegatePort());
  }
 else   if (authenticatorBean instanceof AuthenticatorImplBean) {
    String fqcn=((AuthenticatorImplBean)authenticatorBean).getAuthenticatorClass();
    try {
      Class<?> authnImplClass=Class.forName(fqcn);
      authenticator=(Authenticator)authnImplClass.newInstance();
    }
 catch (    Exception e) {
      String errorMsg="Failed to instantiate the configured authenticator " + authenticatorBean.getAuthenticatorId();
      LOG.warn(errorMsg);
      throw new ConfigurationException(errorMsg,e);
    }
  }
  return authenticator;
}
