{
  if (connectionChecker != null)   return connectionChecker.isValidConnection(c);
  if (validConnectionCheckerClassName != null) {
    try {
      ClassLoader cl=Thread.currentThread().getContextClassLoader();
      Class<?> clazz=cl.loadClass(validConnectionCheckerClassName);
      connectionChecker=(ValidConnectionChecker)clazz.newInstance();
      Injection injection=new Injection();
      for (      Entry<Object,Object> prop : validConnectionCheckerProps.entrySet()) {
        injection.inject(connectionChecker,(String)prop.getKey(),(String)prop.getValue());
      }
      return connectionChecker.isValidConnection(c);
    }
 catch (    Exception e) {
      log.warn("Exception trying to create connection checker (disabling):",e);
      connectionChecker=new NullValidConnectionChecker();
    }
  }
  if (checkValidConnectionSQL != null) {
    connectionChecker=new CheckValidConnectionSQL(checkValidConnectionSQL);
    return connectionChecker.isValidConnection(c);
  }
  return null;
}
