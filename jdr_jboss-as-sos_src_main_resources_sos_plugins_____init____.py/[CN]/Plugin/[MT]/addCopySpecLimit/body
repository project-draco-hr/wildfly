def addCopySpecLimit(self, fname, sizelimit=None, sub=None):
    'Add a file or glob but limit it to sizelimit megabytes. If fname is\n        a single file the file will be tailed to meet sizelimit. If the first\n        file in a glob is too large it will be tailed to meet the sizelimit.\n        '
    if (not (fname and len(fname))):
        return False
    files = glob.glob(fname)
    files.sort()
    cursize = 0
    limit_reached = False
    sizelimit *= (1024 * 1024)
    flog = None
    for flog in files:
        cursize += os.stat(flog)[ST_SIZE]
        if (sizelimit and (cursize > sizelimit)):
            limit_reached = True
            break
        self.addCopySpec(flog, sub)
    if ((flog == files[0]) and limit_reached):
        flog_name = flog
        if sub:
            (old, new) = sub
            flog_name = flog.replace(old, new)
        self.addStringAsFile(tail(flog, sizelimit), (flog_name.replace(os.path.sep, '.') + '.tailed'))
