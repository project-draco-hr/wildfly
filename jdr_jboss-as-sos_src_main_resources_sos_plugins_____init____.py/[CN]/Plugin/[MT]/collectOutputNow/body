def collectOutputNow(self, exe, suggest_filename=None, root_symlink=False, timeout=300):
    'Execute a command and save the output to a file for inclusion in the\n        report.\n        '
    if self.cInfo['cmdlineopts'].profiler:
        start_time = time()
    (status, shout, runtime) = sosGetCommandOutput(exe, timeout=timeout)
    if suggest_filename:
        outfn = self.makeCommandFilename(suggest_filename)
    else:
        outfn = self.makeCommandFilename(exe)
    if (not ((status == 127) or (status == 32512))):
        outfn_strip = outfn[(len(self.cInfo['cmddir']) + 1):]
        self.archive.add_string(shout, outfn)
        if root_symlink:
            self.archive.add_link(outfn, root_symlink)
    else:
        self.soslog.debug(('could not run command: %s' % exe))
        outfn = None
        outfn_strip = None
    self.executedCommands.append({'exe': exe, 'file': outfn_strip, })
    self.cInfo['xmlreport'].add_command(cmdline=exe, exitcode=status, f_stdout=outfn_strip, runtime=runtime)
    if self.cInfo['cmdlineopts'].profiler:
        time_passed = (time() - start_time)
        self.proflog.debug(('output: %-75s time: %f' % (exe, time_passed)))
    return outfn
