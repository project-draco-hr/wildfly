{
  try {
    InitialContext ic=new InitialContext();
    dataSource=(DataSource)ic.lookup(metadata.getDataSourceName());
  }
 catch (  NamingException e) {
    throw new RuntimeException("Filed to lookup: " + metadata.getDataSourceName(),e);
  }
  this.entity=entity;
  tableName=SQLUtil.fixTableName(metadata.getDefaultTableName(),dataSource);
  log=Logger.getLogger(getClass().getName() + "." + tableName);
  this.schema=schema;
  this.tableId=tableId;
  final CmpConfig containerConf=entity.getManager().getCmpConfig();
  dontFlushCreated=containerConf.isInsertAfterEjbPostCreate();
  int minCapacity;
  int maxCapacity;
  minCapacity=1000;
  maxCapacity=10000;
  int partitionsTotal;
  final boolean invalidable;
  final Element batchCommitStrategy;
  partitionsTotal=10;
  batchCommitStrategy=null;
  invalidable=false;
  cache=Cache.NONE;
  if (batchCommitStrategy == null) {
    insertStrategy=NON_BATCH_UPDATE;
    deleteStrategy=NON_BATCH_UPDATE;
    updateStrategy=NON_BATCH_UPDATE;
  }
 else {
    log.debug("batch-commit-strategy enabled");
    insertStrategy=BATCH_UPDATE;
    deleteStrategy=BATCH_UPDATE;
    updateStrategy=BATCH_UPDATE;
  }
  start();
}
