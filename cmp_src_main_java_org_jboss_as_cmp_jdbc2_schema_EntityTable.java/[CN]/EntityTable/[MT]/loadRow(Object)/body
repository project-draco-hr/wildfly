{
  View view=getView();
  Row row=view.getRowByPk(id,false);
  if (row != null) {
    if (log.isTraceEnabled()) {
      log.trace("row is already loaded: pk=" + id);
    }
    return row;
  }
  JDBCCMPFieldBridge2[] pkFields=(JDBCCMPFieldBridge2[])entity.getPrimaryKeyFields();
  Connection con=null;
  PreparedStatement ps=null;
  ResultSet rs=null;
  try {
    if (log.isDebugEnabled()) {
      log.debug("executing sql: " + selectSql);
    }
    con=dataSource.getConnection();
    ps=con.prepareStatement(selectSql);
    int paramInd=1;
    for (int i=0; i < pkFields.length; ++i) {
      JDBCCMPFieldBridge2 pkField=pkFields[i];
      Object pkValue=pkField.getPrimaryKeyValue(id);
      paramInd=pkField.setArgumentParameters(ps,paramInd,pkValue);
    }
    rs=ps.executeQuery();
    if (!rs.next()) {
      throw CmpMessages.MESSAGES.rowNotFound(id);
    }
    return view.loadRow(rs,id,false);
  }
 catch (  SQLException e) {
    throw CmpMessages.MESSAGES.failedToLoadRow(tableName,id);
  }
 finally {
    JDBCUtil.safeClose(rs);
    JDBCUtil.safeClose(ps);
    JDBCUtil.safeClose(con);
  }
}
