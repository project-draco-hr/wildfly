{
  Row row=(Row)rowByPk.get(pk);
  if (row == null) {
    Object[] fields;
    Object[] relations=null;
    try {
      cache.lock(pk);
      fields=cache.getFields(pk);
      if (fields != null && relationsTotal > 0) {
        relations=cache.getRelations(pk);
        if (relations == null) {
          relations=new Object[relationsTotal];
        }
      }
    }
  finally {
      cache.unlock(pk);
    }
    if (fields != null) {
      row=createCleanRow(pk,fields,relations);
    }
  }
  if (row == null && required) {
    throw new IllegalStateException("row not found: pk=" + pk);
  }
  return row;
}
