{
  if (cacheUpdates != null) {
    Row cursor=cacheUpdates;
    while (cursor != null) {
      cache.lock(cursor.pk);
      try {
switch (cursor.state) {
case CLEAN:
          cache.put(tx,cursor.pk,cursor.fields,cursor.relations);
        break;
case DELETED:
      try {
        cache.remove(tx,cursor.pk);
      }
 catch (      Cache.RemoveException e) {
        log.trace(e.getMessage());
      }
    break;
default :
  throw new IllegalStateException("Unexpected row state: table=" + entity.getQualifiedTableName() + ", pk="+ cursor.pk+ ", state="+ cursor.state);
}
}
  finally {
cache.unlock(cursor.pk);
}
cursor=cursor.nextCacheUpdate;
}
}
}
