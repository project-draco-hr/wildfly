{
  dereference();
  if (state == CLEAN) {
    if (view.clean != null) {
      next=view.clean;
      view.clean.prev=this;
    }
    view.clean=this;
  }
 else   if (state == DIRTY) {
    if (view.dirty != null) {
      next=view.dirty;
      view.dirty.prev=this;
    }
    view.dirty=this;
  }
 else   if (state == CREATED) {
    if (view.created != null) {
      next=view.created;
      view.created.prev=this;
    }
    view.created=this;
  }
 else   if (state == DELETED) {
    if (view.deleted != null) {
      next=view.deleted;
      view.deleted.prev=this;
    }
    view.deleted=this;
  }
 else   if (state == DIRTY_RELATIONS) {
    if (view.dirtyRelations != null) {
      next=view.dirtyRelations;
      view.dirtyRelations.prev=this;
    }
    view.dirtyRelations=this;
  }
 else {
    throw new IllegalStateException("Can't update to state: " + state);
  }
  this.state=state;
}
