{
  if (rolesToCheck.length < 1)   throw new IllegalArgumentException("Empty roles. You have to supply at least one role.");
  boolean result=true;
  for (  String roleName : rolesToCheck) {
    boolean negative=roleName.substring(0,1).equals("!");
    if (negative)     roleName=roleName.substring(1);
    result=result && (!negative == this.context.isCallerInRole(roleName));
  }
  return result;
}
