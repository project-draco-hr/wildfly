{
  AccountImpl account=getAccount(id);
  if (credential instanceof DigestCredential) {
    return verifyCredential(account,new DigestCredentialImpl((DigestCredential)credential));
  }
 else   if (credential instanceof PasswordCredential) {
    final char[] password=((PasswordCredential)credential).getPassword();
    final char[] duplicate=Arrays.copyOf(password,password.length);
    return verifyCredential(account,duplicate);
  }
 else {
    return verifyCredential(account,credential);
  }
}
