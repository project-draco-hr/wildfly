{
  testSupport=DomainTestSuite.createSupport(ExtensionManagementTestCase.class.getSimpleName());
  domainMasterLifecycleUtil=testSupport.getDomainMasterLifecycleUtil();
  domainSlaveLifecycleUtil=testSupport.getDomainSlaveLifecycleUtil();
  ClassLoader tccl=Thread.currentThread().getContextClassLoader();
  InputStream moduleXml=tccl.getResourceAsStream("extension/module.xml");
  JavaArchive jar=ShrinkWrap.create(JavaArchive.class);
  URL url=tccl.getResource("extension/META-INF/services/org.jboss.as.controller.Extension");
  jar.addAsManifestResource(url,"services/org.jboss.as.controller.Extension");
  jar.addPackage(TestExtension.class.getPackage());
  StreamExporter exporter=jar.as(ZipExporter.class);
  Map<String,StreamExporter> content=Collections.singletonMap("test-extension.jar",exporter);
  testSupport.addTestModule(TestExtension.MODULE_NAME,moduleXml,content);
}
