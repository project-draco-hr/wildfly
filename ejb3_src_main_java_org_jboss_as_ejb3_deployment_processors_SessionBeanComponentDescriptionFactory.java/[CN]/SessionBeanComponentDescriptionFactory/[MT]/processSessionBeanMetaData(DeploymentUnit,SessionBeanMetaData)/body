{
  final EjbJarDescription ejbJarDescription=getEjbJarDescription(deploymentUnit);
  final CompositeIndex compositeIndex=deploymentUnit.getAttachment(org.jboss.as.server.deployment.Attachments.COMPOSITE_ANNOTATION_INDEX);
  final String beanName=sessionBean.getName();
  SessionType sessionType=sessionBean.getSessionType();
  if (sessionType == null && sessionBean instanceof GenericBeanMetaData) {
    final GenericBeanMetaData bean=(GenericBeanMetaData)sessionBean;
    if (bean.getEjbType() == EjbType.SESSION) {
      sessionType=determineSessionType(sessionBean.getEjbClass(),compositeIndex);
      if (sessionType == null) {
        throw EjbMessages.MESSAGES.sessionTypeNotSpecified(beanName);
      }
    }
 else {
      return;
    }
  }
 else   if (sessionType == null) {
    sessionType=determineSessionType(sessionBean.getEjbClass(),compositeIndex);
    if (sessionType == null) {
      throw EjbMessages.MESSAGES.sessionTypeNotSpecified(beanName);
    }
  }
  final String beanClassName=sessionBean.getEjbClass();
  final SessionBeanComponentDescription sessionBeanDescription;
switch (sessionType) {
case Stateless:
    sessionBeanDescription=new StatelessComponentDescription(beanName,beanClassName,ejbJarDescription,deploymentUnit.getServiceName(),sessionBean);
  break;
case Stateful:
sessionBeanDescription=new StatefulComponentDescription(beanName,beanClassName,ejbJarDescription,deploymentUnit.getServiceName(),sessionBean);
break;
case Singleton:
sessionBeanDescription=new SingletonComponentDescription(beanName,beanClassName,ejbJarDescription,deploymentUnit.getServiceName(),sessionBean);
break;
default :
throw new IllegalArgumentException("Unknown session bean type: " + sessionType);
}
addComponent(deploymentUnit,sessionBeanDescription);
}
