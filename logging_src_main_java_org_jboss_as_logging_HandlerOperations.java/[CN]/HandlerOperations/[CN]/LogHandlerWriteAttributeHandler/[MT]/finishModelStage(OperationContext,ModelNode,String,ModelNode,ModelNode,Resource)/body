{
  super.finishModelStage(context,operation,attributeName,newValue,oldValue,model);
  if (CommonAttributes.FILTER.getName().equals(attributeName)) {
    final String filterSpec=Filters.filterToFilterSpec(newValue);
    final ModelNode filterSpecValue=(filterSpec == null ? new ModelNode() : new ModelNode(filterSpec));
    model.getModel().get(CommonAttributes.FILTER_SPEC.getName()).set(filterSpecValue);
  }
  if (AbstractHandlerDefinition.NAMED_FORMATTER.getName().equals(attributeName)) {
    final ModelNode m=model.getModel();
    if (m.hasDefined(AbstractHandlerDefinition.FORMATTER.getName())) {
      m.get(AbstractHandlerDefinition.FORMATTER.getName()).clear();
    }
  }
 else   if (AbstractHandlerDefinition.FORMATTER.getName().equals(attributeName)) {
    final ModelNode m=model.getModel();
    if (m.hasDefined(AbstractHandlerDefinition.NAMED_FORMATTER.getName())) {
      m.get(AbstractHandlerDefinition.NAMED_FORMATTER.getName()).clear();
    }
  }
}
