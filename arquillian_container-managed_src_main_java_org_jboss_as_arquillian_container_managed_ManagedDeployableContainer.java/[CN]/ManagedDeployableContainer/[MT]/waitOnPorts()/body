{
  final Integer[] ports=this.getContainerConfiguration().getWaitForPorts();
  final int timeoutInSeconds=this.getContainerConfiguration().getWaitForPortsTimeoutInSeconds();
  if (ports != null && ports.length > 0) {
    for (int i=0; i < ports.length; i++) {
      final int port=ports[i];
      final long start=System.currentTimeMillis();
      while (!this.isPortAvailable(port)) {
        final int elapsedSeconds=(int)((System.currentTimeMillis() - start) / 1000);
        if (elapsedSeconds > timeoutInSeconds) {
          throw new PortAcquisitionTimeoutException(port,timeoutInSeconds);
        }
        try {
          Thread.sleep(500);
        }
 catch (        final InterruptedException e) {
          Thread.interrupted();
        }
        log.warning("Waiting on port " + port + " to become available for "+ (timeoutInSeconds - elapsedSeconds)+ "s");
      }
    }
  }
}
