{
  EJBLocalReferencesMetaData ejbLocalRefs=environment.getEnvironment().getEjbLocalReferences();
  List<BindingConfiguration> bindingDescriptions=new ArrayList<BindingConfiguration>();
  if (ejbLocalRefs != null) {
    for (    EJBLocalReferenceMetaData ejbRef : ejbLocalRefs) {
      String name=ejbRef.getEjbRefName();
      String ejbName=ejbRef.getLink();
      String lookup=ejbRef.getLookupName();
      String localInterface=ejbRef.getLocal();
      Class<?> localInterfaceType=null;
      if (!isEmpty(localInterface)) {
        try {
          localInterfaceType=classLoader.loadClass(localInterface);
        }
 catch (        ClassNotFoundException e) {
          throw new DeploymentUnitProcessingException("Could not load local interface type " + localInterface,e);
        }
      }
      if (!name.startsWith("java:")) {
        name=environment.getDefaultContext() + name;
      }
      LookupInjectionSource injectionSource=new LookupInjectionSource(name);
      localInterfaceType=processInjectionTargets(moduleDescription,applicationClasses,injectionSource,classLoader,deploymentReflectionIndex,ejbRef,localInterfaceType);
      if (localInterfaceType == null) {
        throw new DeploymentUnitProcessingException("Could not determine type of ejb-local-ref " + name + " for component "+ componentDescription);
      }
      final BindingConfiguration bindingConfiguration;
      EjbInjectionSource ejbInjectionSource=null;
      if (!isEmpty(lookup)) {
        if (lookup.startsWith("ejb:")) {
          bindingConfiguration=new BindingConfiguration(name,new EjbLookupInjectionSource(lookup));
        }
 else {
          bindingConfiguration=new BindingConfiguration(name,new LookupInjectionSource(lookup));
        }
      }
 else       if (!isEmpty(ejbName)) {
        final ServiceName beanServiceName=deploymentUnit.getServiceName().append("component").append(ejbName).append("VIEW").append(localInterfaceType.getName()).append(MethodIntf.LOCAL.toString());
        bindingConfiguration=new BindingConfiguration(name,ejbInjectionSource=new EjbInjectionSource(ejbName,localInterfaceType.getName()));
      }
 else {
        bindingConfiguration=new BindingConfiguration(name,ejbInjectionSource=new EjbInjectionSource(localInterfaceType.getName()));
      }
      if (ejbInjectionSource != null) {
        deploymentUnit.addToAttachmentList(EjbDeploymentAttachmentKeys.EJB_INJECTIONS,ejbInjectionSource);
      }
      bindingDescriptions.add(bindingConfiguration);
    }
  }
  return bindingDescriptions;
}
