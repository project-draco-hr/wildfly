{
  this.isPrimaryKeyParameter=false;
  this.parameterString=parameterString;
  if (parameterString == null || parameterString.length() == 0) {
    throw MESSAGES.parameterStringIsEmpty();
  }
  StringTokenizer tok=new StringTokenizer(parameterString,".");
  try {
    argNum=Integer.parseInt(tok.nextToken());
  }
 catch (  NumberFormatException e) {
    throw MESSAGES.parameterMustBeginWithNumber();
  }
  if (argNum > method.getParameterTypes().length) {
    throw CmpMessages.MESSAGES.invalidParameterInQueryMethod(argNum,method.getParameterTypes().length);
  }
  Class argType=method.getParameterTypes()[argNum];
  JDBCType type;
  if (EJBObject.class.isAssignableFrom(argType) || EJBLocalObject.class.isAssignableFrom(argType)) {
    if (!tok.hasMoreTokens()) {
      throw MESSAGES.fieldNameMustBeProvided();
    }
    String fieldName=tok.nextToken();
    field=getCMPField(manager,argType,fieldName);
    if (!field.isPrimaryKeyMember()) {
      throw MESSAGES.fieldMustBePrimaryKey();
    }
    type=field.getJDBCType();
  }
 else {
    type=manager.getJDBCTypeFactory().getJDBCType(argType);
  }
  if (type instanceof JDBCTypeSimple) {
    if (tok.hasMoreTokens()) {
      throw CmpMessages.MESSAGES.typePropertiesNotAllowed();
    }
    jdbcType=type.getJDBCTypes()[0];
    this.type=type;
  }
 else {
    if (!tok.hasMoreTokens()) {
      throw CmpMessages.MESSAGES.typePropertyRequired();
    }
    StringBuffer propertyName=new StringBuffer(parameterString.length());
    propertyName.append(tok.nextToken());
    while (tok.hasMoreTokens()) {
      propertyName.append('.').append(tok.nextToken());
    }
    property=((JDBCTypeComplex)type).getProperty(propertyName.toString());
    jdbcType=property.getJDBCType();
  }
}
