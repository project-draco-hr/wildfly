{
  try {
    CurrentSynchronizationCallback.set(CurrentSynchronizationCallback.CallbackType.BEFORE_COMPLETION);
synchronized (componentInstance.getThreadLock()) {
      try {
        if (!componentInstance.isRemoved() && !componentInstance.isDiscarded() && componentInstance.getPrimaryKey() != null) {
          componentInstance.store();
        }
      }
 catch (      Throwable t) {
        componentInstance.getLock().pushOwner(lockOwner);
        try {
          handleThrowableInTxSync(componentInstance,t);
        }
  finally {
          componentInstance.getLock().popOwner();
        }
      }
    }
  }
  finally {
    CurrentSynchronizationCallback.clear();
  }
}
