{
  if (digestMd5Supported()) {
    return OptionMap.create(Options.SASL_MECHANISMS,Sequence.of(DIGEST_MD5));
  }
  if (realm == null) {
    return OptionMap.create(Options.SASL_MECHANISMS,Sequence.of(ANONYMOUS));
  }
  return OptionMap.EMPTY;
}
