{
  if (digestMd5Supported()) {
    return OptionMap.create(SASL_MECHANISMS,Sequence.of(DIGEST_MD5));
  }
  if (realm == null) {
    return OptionMap.create(SASL_MECHANISMS,Sequence.of(ANONYMOUS),SASL_POLICY_NOANONYMOUS,Boolean.FALSE);
  }
  return OptionMap.EMPTY;
}
