{
  String processName=managed.getProcessName();
  if (processName.equals(ProcessManagerMaster.SERVER_MANAGER_PROCESS_NAME)) {
    try {
      if (useRealServerManager) {
        testServerManager=TestServerManagerProcess.createServerManager(managed,command,processInputStream.getInput(),processOutputStream.getOutput(),processOutputStream.getOutput());
      }
 else {
        mockServerManager=MockServerManagerProcess.create(managed,command);
      }
    }
 catch (    Exception e) {
      throw new RuntimeException(e);
    }
  }
 else   if (processName.startsWith("Server:")) {
    if (useRealServers) {
      testServerProcess=TestServerProcess.createServer(command.toArray(new String[command.size()]),processInputStream.getInput(),processOutputStream.getOutput(),processOutputStream.getOutput());
    }
 else {
      mockServerProcess=MockServerProcess.create(managed,processName,command,processInputStream.getInput());
    }
    System.err.println("Creating server");
  }
  factory.addProcessHandler(processName,this);
  return this;
}
