{
  this.console=console;
  console.setUseHistory(true);
  String userHome=SecurityActions.getSystemProperty("user.home");
  config=CliConfigImpl.parse(this,new File(userHome,"jboss-cli.xml"));
  File historyFile=new File(userHome,".jboss-cli-history");
  try {
    console.getHistory().setHistoryFile(historyFile);
  }
 catch (  IOException e) {
    System.err.println("Failed to setup the history file " + historyFile.getAbsolutePath() + ": "+ e.getLocalizedMessage());
  }
  this.history=new HistoryImpl();
  operationCandidatesProvider=new DefaultOperationCandidatesProvider();
  operationHandler=new OperationRequestHandler();
  cmdCompleter=new CommandCompleter(cmdRegistry,this);
  console.addCompletor(cmdCompleter);
  this.username=username;
  this.password=password;
  if (defaultControllerHost != null) {
    this.defaultControllerHost=defaultControllerHost;
  }
  if (defaultControllerPort != -1) {
    this.defaultControllerPort=defaultControllerPort;
  }
  initCommands();
}
