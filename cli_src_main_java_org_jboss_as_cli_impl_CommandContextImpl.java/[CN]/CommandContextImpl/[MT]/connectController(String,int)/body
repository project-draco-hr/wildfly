{
  if (host == null) {
    host=defaultControllerHost;
  }
  if (port < 0) {
    port=defaultControllerPort;
  }
  boolean retry;
  do {
    retry=false;
    try {
      ModelControllerClient newClient=null;
      CallbackHandler cbh=new AuthenticationCallbackHandler(username,password);
      long beforeConnect=System.currentTimeMillis();
      ModelControllerClient tempClient=ModelControllerClient.Factory.create(host,port,cbh,sslContext);
switch (initialConnection(tempClient)) {
case SUCCESS:
        newClient=tempClient;
      break;
case CONNECTION_FAILURE:
    throw new CommandLineException("The controller is not available at " + host + ":"+ port+ ", connect failed after "+ (System.currentTimeMillis() - beforeConnect)+ ")");
case AUTHENTICATION_FAILURE:
  throw new CommandLineException("Unable to authenticate against controller at " + host + ":"+ port);
case SSL_FAILURE:
retry=handleSSLFailure();
if (retry == false) {
throw new CommandLineException("Unable to negotiate SSL connection with controller at " + host + ":"+ port);
}
break;
}
initNewClient(newClient,host,port);
}
 catch (UnknownHostException e) {
throw new CommandLineException("Failed to resolve host '" + host + "': "+ e.getLocalizedMessage());
}
}
 while (retry);
}
