{
  if (lineBuffer != null) {
    return "> ";
  }
  StringBuilder buffer=new StringBuilder();
  if (promptConnectPart == null) {
    buffer.append('[');
    String controllerHost=getControllerHost();
    if (controllerHost != null) {
      if (domainMode) {
        buffer.append("domain@");
      }
 else {
        buffer.append("standalone@");
      }
      buffer.append(controllerHost).append(':').append(getControllerPort()).append(' ');
      promptConnectPart=buffer.toString();
    }
 else {
      buffer.append("disconnected ");
    }
  }
 else {
    buffer.append(promptConnectPart);
  }
  if (prefix.isEmpty()) {
    buffer.append('/');
  }
 else {
    buffer.append(prefix.getNodeType());
    final String nodeName=prefix.getNodeName();
    if (nodeName != null) {
      buffer.append('=').append(nodeName);
    }
  }
  if (isBatchMode()) {
    buffer.append(" #");
  }
  buffer.append("] ");
  return buffer.toString();
}
