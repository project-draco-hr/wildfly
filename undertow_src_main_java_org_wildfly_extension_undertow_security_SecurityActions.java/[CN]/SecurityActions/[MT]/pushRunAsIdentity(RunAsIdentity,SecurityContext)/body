{
  if (WildFlySecurityManager.isChecking()) {
    WildFlySecurityManager.doUnchecked(new PrivilegedAction<Void>(){
      @Override public Void run(){
        if (sc == null) {
          throw MESSAGES.noSecurityContext();
        }
        sc.setOutgoingRunAs(principal);
        return null;
      }
    }
);
  }
 else {
    if (sc == null) {
      throw MESSAGES.noSecurityContext();
    }
    sc.setOutgoingRunAs(principal);
  }
}
