{
  final Set<String> securityRoles=new HashSet<String>();
  final EjbJarMetaData ejbJarMD=unit.getAttachment(EjbDeploymentAttachmentKeys.EJB_JAR_METADATA);
  if (ejbJarMD != null && ejbJarMD.getAssemblyDescriptor() != null) {
    final SecurityRolesMetaData securityRolesMD=ejbJarMD.getAssemblyDescriptor().getSecurityRoles();
    if (securityRolesMD != null && securityRolesMD.size() > 0) {
      for (      final SecurityRoleMetaData securityRoleMD : securityRolesMD) {
        securityRoles.add(securityRoleMD.getRoleName());
      }
    }
  }
  return (securityRoles.size() > 0) ? Collections.unmodifiableSet(securityRoles) : Collections.<String>emptySet();
}
