{
  PrintStream originalOut=System.out;
  ByteArrayOutputStream scriptOut=new ByteArrayOutputStream();
  PrintStream printOut=new PrintStream(scriptOut);
  try {
    System.setOut(printOut);
    cliGuiCtx.getCommandLine().setEnabled(false);
    publish(new OutMessage(">>> Execute CLI script " + file,true));
    boolean failure=false;
    for (    String command : getCommandLines(file)) {
      publish(new OutMessage(command,true));
      try {
        cliGuiCtx.getCommmandContext().handle(command.trim());
      }
 catch (      Throwable t) {
        t.printStackTrace(printOut);
        failure=true;
      }
      if (scriptOut.size() > 0) {
        publish(new OutMessage(scriptOut.toString(),false));
        scriptOut.reset();
      }
      if (failure) {
        publish(new OutMessage(">> Command Failed:  " + command,true));
        break;
      }
    }
    publish(new OutMessage(">>> Script complete.",true));
  }
  finally {
    System.setOut(originalOut);
    cliGuiCtx.getCommandLine().setEnabled(true);
    cliGuiCtx.getCommmandContext().handle("cd /");
  }
  return null;
}
