{
  final List<ModelNode> updates=new ArrayList<ModelNode>();
  ModelNode op=new ModelNode();
  op.get(OP).set(COMPOSITE);
  op.get(OP_ADDR).setEmptyList();
  ModelNode add1=op.get(STEPS).add();
  add1.get(OP).set(ADD);
  add1.get(OP_ADDR).add(SUBSYSTEM,"security");
  add1.get(OP_ADDR).add(SECURITY_DOMAIN,getSecurityDomainName());
  ModelNode add2=op.get(STEPS).add();
  add2.get(OP).set(ADD);
  add2.get(OP_ADDR).add(SUBSYSTEM,"security");
  add2.get(OP_ADDR).add(SECURITY_DOMAIN,getSecurityDomainName());
  add2.get(OP_ADDR).add(AUTHENTICATION,Constants.CLASSIC);
  ModelNode loginModule=add2.get(Constants.LOGIN_MODULES).add();
  loginModule.get(CODE).set(CustomTestLoginModule.class.getName());
  loginModule.get(FLAG).set("required");
  updates.add(op);
  applyUpdates(managementClient.getControllerClient(),updates);
}
