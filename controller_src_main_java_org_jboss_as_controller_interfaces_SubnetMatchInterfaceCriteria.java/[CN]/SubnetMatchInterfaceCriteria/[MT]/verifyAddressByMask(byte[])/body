{
  if (addr.length != network.length) {
    return false;
  }
  int max=network.length * 8;
  int maskOffset=0;
  int bitMask=0xFF;
  while (maskOffset < mask && maskOffset < max) {
    if ((mask - maskOffset) < 8)     bitMask=0xFF << (8 - (mask - maskOffset));
    if ((addr[maskOffset / 8] & bitMask) != (network[maskOffset / 8] & bitMask))     return false;
    maskOffset+=8;
  }
  return true;
}
