{
  if (!location.startsWith(WebExtension.WEBBUNDLE_PREFIX))   return null;
  URI uri;
  try {
    uri=new URI(location);
  }
 catch (  URISyntaxException ex) {
    return null;
  }
  String query=uri.getQuery();
  String symbolicName=null;
  for (  String part : query.split("&")) {
    int valueIndex=part.indexOf("=") + 1;
    if (part.startsWith(Constants.BUNDLE_SYMBOLICNAME)) {
      symbolicName=part.substring(valueIndex);
    }
  }
  String contextPath=uri.getHost();
  if (contextPath.endsWith(".war"))   contextPath=contextPath.substring(0,contextPath.length() - 4);
  OSGiManifestBuilder builder=OSGiManifestBuilder.newInstance();
  builder.addBundleManifestVersion(2);
  builder.addBundleSymbolicName(symbolicName);
  builder.addManifestHeader(WebExtension.WEB_CONTEXT_PATH,contextPath);
  builder.addImportPackages(WebServlet.class,Servlet.class,HttpServlet.class);
  builder.addImportPackages(Bundle.class);
  builder.addBundleClasspath("WEB-INF/classes");
  Manifest manifest=builder.getManifest();
  return manifest;
}
