{
  Transaction tx=getTransaction();
  if (tx == null || !TxUtils.isActive(tx))   throw new TransactionRequiredException("EntityManager must be access within a transaction");
  if (!TxUtils.isActive(tx))   throw new TransactionRequiredException("Transaction must be active to access EntityManager");
}
