{
  context.removeService(ProtocolDefaultsService.SERVICE_NAME);
  String defaultStack=ModelNodes.asString(JGroupsSubsystemResourceDefinition.DEFAULT_STACK.resolveModelAttribute(context,model));
  if ((defaultStack != null) && !defaultStack.equals(ChannelFactoryService.DEFAULT)) {
    context.removeService(ChannelFactoryService.getServiceName(ChannelFactoryService.DEFAULT));
  }
  String defaultChannel=ModelNodes.asString(JGroupsSubsystemResourceDefinition.DEFAULT_CHANNEL.resolveModelAttribute(context,model));
  if ((defaultChannel != null) && !defaultChannel.equals(ChannelService.DEFAULT)) {
    context.removeService(ChannelService.getServiceName(ChannelService.DEFAULT));
    context.removeService(ConnectedChannelService.getServiceName(ChannelService.DEFAULT));
    context.removeService(ChannelService.getFactoryServiceName(ChannelService.DEFAULT));
    for (    GroupServiceInstaller installer : ServiceLoader.load(ClusteredGroupServiceInstaller.class,ClusteredGroupServiceInstaller.class.getClassLoader())) {
      for (      ServiceName name : installer.getServiceNames(ChannelService.DEFAULT)) {
        context.removeService(name);
      }
    }
  }
}
