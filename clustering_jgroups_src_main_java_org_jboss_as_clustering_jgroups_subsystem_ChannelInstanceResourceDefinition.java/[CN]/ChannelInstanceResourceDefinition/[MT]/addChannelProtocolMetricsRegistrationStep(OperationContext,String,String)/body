{
  PathAddress rootSubsystemAddress=PathAddress.pathAddress(JGroupsExtension.SUBSYSTEM_PATH);
  ModelNode registerProtocolsOp=Util.createOperation("some_operation_name",rootSubsystemAddress);
  if (stackName != null)   registerProtocolsOp.get(ModelKeys.STACK).set(new ModelNode(stackName));
  registerProtocolsOp.get(MetricKeys.CHANNEL).set(new ModelNode(channelName));
  context.addStep(registerProtocolsOp,new OperationStepHandler(){
    @Override public void execute(    OperationContext context,    ModelNode operation) throws OperationFailedException {
      String channelName=operation.get(MetricKeys.CHANNEL).asString();
      String stackName=null;
      if (operation.get(ModelKeys.STACK).isDefined()) {
        stackName=operation.get(ModelKeys.STACK).asString();
      }
      registerChannelProtocolMetrics(context,channelName,stackName);
      context.stepCompleted();
    }
  }
,OperationContext.Stage.RUNTIME);
}
