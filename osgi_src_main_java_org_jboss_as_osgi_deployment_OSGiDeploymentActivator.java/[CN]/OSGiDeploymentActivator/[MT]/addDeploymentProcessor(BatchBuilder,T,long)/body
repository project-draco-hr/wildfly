{
  final DeploymentUnitProcessorService<T> deploymentUnitProcessorService=new DeploymentUnitProcessorService<T>(deploymentUnitProcessor);
  ServiceName serviceName=OSGI_DEPLOYMENT_CHAIN_SERVICE_NAME.append(deploymentUnitProcessor.getClass().getName());
  BatchServiceBuilder<T> serviceBuilder=batchBuilder.addService(serviceName,deploymentUnitProcessorService);
  DeploymentChainProcessorInjector<T> injector=new DeploymentChainProcessorInjector<T>(deploymentUnitProcessorService,priority);
  return serviceBuilder.addDependency(OSGI_DEPLOYMENT_CHAIN_SERVICE_NAME,DeploymentChain.class,injector);
}
