{
  final DomainTestConnection connection=this.connection;
  if (connection == null) {
    throw new IllegalStateException();
  }
  final long deadline=System.currentTimeMillis() + timeUnit.toMillis(timeout);
  for (; ; ) {
    long remaining=deadline - System.currentTimeMillis();
    if (remaining <= 0) {
      return;
    }
    try {
      connection.connect();
      return;
    }
 catch (    IOException e) {
      remaining=deadline - System.currentTimeMillis();
      if (remaining <= 0) {
        throw e;
      }
    }
  }
}
