{
  AccessController.doPrivileged(new PrivilegedAction<Void>(){
    public Void run(){
      SecurityContext securityContext=SecurityContextAssociation.getSecurityContext();
      if (securityContext == null) {
        securityContext=createSecurityContext(subject,principal,credential,securityDomainContext.getAuthenticationManager().getSecurityDomain());
      }
 else {
        securityContext.getUtil().createSubjectInfo(principal,credential,subject);
      }
      setSecurityContextOnAssociation(securityContext);
      return null;
    }
  }
);
}
