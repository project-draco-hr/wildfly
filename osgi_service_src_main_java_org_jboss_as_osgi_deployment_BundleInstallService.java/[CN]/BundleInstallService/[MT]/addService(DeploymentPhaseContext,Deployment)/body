{
  final DeploymentUnit deploymentUnit=phaseContext.getDeploymentUnit();
  final BundleInstallService service=new BundleInstallService(deployment);
  final String contextName=deploymentUnit.getName();
  final ServiceName serviceName=getServiceName(contextName);
  final ServiceTarget serviceTarget=phaseContext.getServiceTarget();
  ServiceBuilder<BundleInstallService> builder=serviceTarget.addService(serviceName,service);
  builder.addDependency(ServiceNames.BUNDLE_MANAGER,BundleManagement.class,service.injectedBundleManager);
  builder.addDependency(BundleStartTracker.SERVICE_NAME,BundleStartTracker.class,service.injectedStartTracker);
  builder.addDependency(Services.deploymentUnitName(contextName));
  builder.addDependency(ServiceNames.FRAMEWORK_INIT);
  builder.install();
}
