{
  final DeploymentUnit depUnit=phaseContext.getDeploymentUnit();
  final BundleInstallService service=new BundleInstallService(deployment);
  final String contextName=depUnit.getName();
  final ServiceName serviceName=getServiceName(depUnit);
  final ServiceTarget serviceTarget=phaseContext.getServiceTarget();
  ServiceBuilder<Void> builder=serviceTarget.addService(serviceName,service);
  builder.addDependency(Services.BUNDLE_MANAGER,BundleManager.class,service.injectedBundleManager);
  builder.addDependency(deploymentUnitName(contextName));
  builder.addDependency(Services.FRAMEWORK_ACTIVE);
  builder.install();
  return serviceName;
}
