{
  final DeploymentUnit deploymentUnit=phaseContext.getDeploymentUnit();
  final BundleInstallService service=new BundleInstallService(deployment);
  final String contextName=deploymentUnit.getName();
  final ServiceName serviceName=getServiceName(contextName);
  final ServiceTarget serviceTarget=phaseContext.getServiceTarget();
  ServiceBuilder<BundleInstallService> builder=serviceTarget.addService(serviceName,service);
  builder.addDependency(BundleContextService.SERVICE_NAME,BundleContext.class,service.injectedBundleContext);
  builder.addDependency(FrameworkIntegration.SERVICE_NAME,FrameworkIntegration.class,service.injectedBundleManager);
  builder.addDependency(BundleStartupProcessor.SERVICE_NAME,BundleStartupProcessor.class,service.injectedStartTracker);
  builder.addDependency(Services.deploymentUnitName(contextName));
  builder.addDependency(PackageAdminService.SERVICE_NAME);
  builder.install();
}
