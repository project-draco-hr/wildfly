{
  String identityProviderAlias=pathAddress.subAddress(0,pathAddress.size() - 1).getLastElement().getValue();
  String domainName=pathAddress.getLastElement().getValue();
  TrustDomainService service=new TrustDomainService(domainName);
  ServiceBuilder<TrustDomainService> serviceBuilder=context.getServiceTarget().addService(TrustDomainService.createServiceName(identityProviderAlias,domainName),service);
  serviceBuilder.addDependency(IdentityProviderService.createServiceName(identityProviderAlias),IdentityProviderService.class,service.getIdentityProviderService());
  if (verificationHandler != null) {
    serviceBuilder.addListener(verificationHandler);
  }
  ServiceController<TrustDomainService> controller=serviceBuilder.setInitialMode(ServiceController.Mode.PASSIVE).install();
  if (newControllers != null) {
    newControllers.add(controller);
  }
}
