{
  File patchXml=new File(tmp,"patch.xml");
  patchXml.createNewFile();
  FileOutputStream fos=new FileOutputStream(patchXml);
  try {
    PrintWriter pw=new PrintWriter(fos);
    pw.println("Added modules:\n");
    for (    DistributionContentItem item : moduleAdds) {
      pw.println("name: " + newStructure.getModuleName(item) + "  slot: "+ newStructure.getModuleSlot(item));
    }
    pw.println("\nUpdated modules:\n");
    for (    Map.Entry<DistributionContentItem,HashedContentItem> entry : moduleUpdates.entrySet()) {
      DistributionContentItem item=entry.getKey();
      HashedContentItem oldItem=entry.getValue();
      pw.println("name: " + newStructure.getModuleName(item) + "  slot: "+ newStructure.getModuleSlot(item)+ "  old path: "+ oldItem.item.getPath()+ "  hash: "+ PatchUtils.bytesToHexString(oldItem.hash));
    }
    pw.println("\nRemoved modules:\n");
    for (    HashedContentItem item : moduleRemoves) {
      pw.print("name: " + newStructure.getModuleName(item.item) + "  slot: "+ newStructure.getModuleSlot(item.item));
      if (item.hash != null) {
        pw.print("  hash: " + PatchUtils.bytesToHexString(item.hash));
      }
      pw.println();
    }
    pw.println("\nAdded bundles:\n");
    for (    DistributionContentItem item : bundleAdds) {
      pw.println("name: " + newStructure.getBundleName(item));
    }
    System.out.println("\nUpdated bundles:\n");
    for (    DistributionContentItem item : bundleUpdates) {
      pw.println("name: " + newStructure.getBundleName(item));
    }
    pw.println("\nRemoved bundles:\n");
    for (    DistributionContentItem item : bundleRemoves) {
      pw.println("name: " + newStructure.getBundleName(item));
    }
    pw.println("\nAdded misc files:\n");
    for (    DistributionContentItem item : miscAdds) {
      pw.println("path: " + item.getPath());
    }
    pw.println("\nUpdated misc files:\n");
    for (    Map.Entry<DistributionContentItem,HashedContentItem> entry : miscUpdates.entrySet()) {
      HashedContentItem item=entry.getValue();
      pw.println("path: " + entry.getKey().getPath() + "  old path: "+ item.item.getPath()+ "  hash: "+ PatchUtils.bytesToHexString(item.hash));
    }
    pw.println("\nRemoved misc files:\n");
    for (    HashedContentItem item : miscRemoves) {
      String hash=item.hash == null ? "<directory>" : PatchUtils.bytesToHexString(item.hash);
      pw.println("path: " + item.item.getPath() + "  hash: "+ hash);
    }
    pw.println();
    pw.flush();
  }
  finally {
    PatchUtils.safeClose(fos);
  }
  FileReader reader=new FileReader(patchXml);
  try {
    BufferedReader br=new BufferedReader(reader);
    String line;
    while ((line=br.readLine()) != null) {
      System.out.println(line);
    }
  }
  finally {
    PatchUtils.safeClose(reader);
  }
}
