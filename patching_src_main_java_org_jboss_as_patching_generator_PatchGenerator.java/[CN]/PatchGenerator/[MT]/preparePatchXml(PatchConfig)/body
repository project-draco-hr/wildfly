{
  File patchXml=new File(tmp,"patch.xml");
  FileOutputStream fos=null;
  try {
    PatchBuilder pb=patchConfig.toPatchBuilder();
    for (    ContentModification cm : moduleAdds.values()) {
      pb.addContentModification(cm);
    }
    for (    ContentModification cm : moduleUpdates.values()) {
      pb.addContentModification(cm);
    }
    for (    ContentModification cm : moduleRemoves.values()) {
      pb.addContentModification(cm);
    }
    for (    ContentModification cm : bundleAdds.values()) {
      pb.addContentModification(cm);
    }
    for (    ContentModification cm : bundleUpdates.values()) {
      pb.addContentModification(cm);
    }
    for (    ContentModification cm : bundleRemoves.values()) {
      pb.addContentModification(cm);
    }
    for (    ContentModification cm : miscAdds.values()) {
      pb.addContentModification(cm);
    }
    for (    ContentModification cm : miscUpdates.values()) {
      pb.addContentModification(cm);
    }
    for (    ContentModification cm : miscRemoves.values()) {
      pb.addContentModification(cm);
    }
    patchXml.createNewFile();
    fos=new FileOutputStream(patchXml);
    PatchXml.marshal(fos,pb.build());
  }
  finally {
    IoUtils.safeClose(fos);
  }
  FileReader reader=new FileReader(patchXml);
  try {
    BufferedReader br=new BufferedReader(reader);
    String line;
    while ((line=br.readLine()) != null) {
      System.out.println(line);
    }
  }
  finally {
    IoUtils.safeClose(reader);
  }
}
