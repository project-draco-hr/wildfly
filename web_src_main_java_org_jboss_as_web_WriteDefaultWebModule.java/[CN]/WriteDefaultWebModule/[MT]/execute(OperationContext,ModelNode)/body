{
  final ModelNode virtualHost=context.readResourceForUpdate(PathAddress.EMPTY_ADDRESS).getModel();
  String war=operation.get("value").toString();
  if (virtualHost.hasDefined(Constants.ENABLE_WELCOME_ROOT) && Boolean.parseBoolean(virtualHost.get(Constants.ENABLE_WELCOME_ROOT).toString())) {
    throw new OperationFailedException(MESSAGES.noWelcomeWebappWithDefaultWebModule());
  }
 else {
    virtualHost.get(Constants.DEFAULT_WEB_MODULE).set(war);
  }
  if (context.isNormalServer()) {
    context.reloadRequired();
  }
  context.completeStep(new OperationContext.RollbackHandler(){
    @Override public void handleRollback(    OperationContext context,    ModelNode operation){
      if (context.isNormalServer()) {
        context.revertReloadRequired();
      }
    }
  }
);
}
