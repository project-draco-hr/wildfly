def __reduce__(self):
    items = [[k, self[k]] for k in self]
    tmp = (self.__map, self.__end)
    del self.__map, self.__end
    inst_dict = vars(self).copy()
    (self.__map, self.__end) = tmp
    if inst_dict:
        return (self.__class__, (items,), inst_dict)
    return (self.__class__, (items,))
