{
  validateSignature(input);
  expectHeader(input,ManagementProtocol.VERSION_FIELD);
  int version=input.readInt();
  expectHeader(input,ManagementProtocol.TYPE);
  byte type=input.readByte();
switch (type) {
case ManagementProtocol.TYPE_REQUEST:
    return new ManagementRequestHeader(version,input);
case ManagementProtocol.TYPE_RESPONSE:
  return new ManagementResponseHeader(version,input);
default :
throw new IOException("Invalid type: " + type);
}
}
