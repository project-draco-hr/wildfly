{
  byte param=input.readByte();
  if (param != DomainControllerProtocol.PARAM_OK) {
    final byte errorCode=input.readByte();
    final String message=input.readUTF();
    resultHandler.failed(new SlaveRegistrationException(SlaveRegistrationException.ErrorCode.parseCode(errorCode),message));
    return;
  }
  final ModelNode extensions=new ModelNode();
  extensions.readExternal(input);
  if (context.getRequestHeader().getVersion() != 1) {
    channelHandler.getAttachments().attach(TransactionalProtocolClient.SEND_SUBJECT,Boolean.TRUE);
  }
  context.executeAsync(new ManagementRequestContext.AsyncTask<Void>(){
    @Override public void execute(    ManagementRequestContext<Void> voidManagementRequestContext) throws Exception {
      final ModelNode subsystems=resolveSubsystemVersions(extensions);
      channelHandler.executeRequest(context.getOperationId(),new RegisterSubsystemsRequest(subsystems));
    }
  }
);
}
