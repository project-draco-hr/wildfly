{
  byte param=input.readByte();
  if (param != DomainControllerProtocol.PARAM_OK) {
    final byte errorCode=input.readByte();
    final String message=input.readUTF();
    resultHandler.failed(new SlaveRegistrationException(SlaveRegistrationException.ErrorCode.parseCode(errorCode),message));
    return;
  }
  final ModelNode domainModel=new ModelNode();
  domainModel.readExternal(input);
  context.executeAsync(new ManagementRequestContext.AsyncTask<Void>(){
    @Override public void execute(    ManagementRequestContext<Void> voidManagementRequestContext) throws Exception {
      if (applyDomainModel(domainModel)) {
        channelHandler.executeRequest(context.getOperationId(),new CompleteRegistrationRequest(DomainControllerProtocol.PARAM_OK));
      }
 else {
        channelHandler.executeRequest(context.getOperationId(),new CompleteRegistrationRequest(DomainControllerProtocol.PARAM_ERROR));
        resultHandler.failed(new SlaveRegistrationException(SlaveRegistrationException.ErrorCode.UNKNOWN,""));
      }
    }
  }
);
}
