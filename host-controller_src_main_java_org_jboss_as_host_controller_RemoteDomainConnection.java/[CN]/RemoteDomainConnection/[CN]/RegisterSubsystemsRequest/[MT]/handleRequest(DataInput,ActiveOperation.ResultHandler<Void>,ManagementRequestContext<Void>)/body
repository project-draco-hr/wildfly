{
  byte param=input.readByte();
  if (param != DomainControllerProtocol.PARAM_OK) {
    final byte errorCode=input.readByte();
    final String message=input.readUTF();
    resultHandler.failed(new SlaveRegistrationException(SlaveRegistrationException.ErrorCode.parseCode(errorCode),message));
    return;
  }
  final ModelNode domainModel=new ModelNode();
  domainModel.readExternal(input);
  context.executeAsync(new ManagementRequestContext.AsyncTask<Void>(){
    @Override public void execute(    ManagementRequestContext<Void> voidManagementRequestContext) throws Exception {
      final boolean success=applyDomainModel(domainModel);
      if (registerOnCompletion) {
        if (success) {
          channelHandler.executeRequest(context.getOperationId(),new CompleteRegistrationRequest(DomainControllerProtocol.PARAM_OK));
        }
 else {
          channelHandler.executeRequest(context.getOperationId(),new CompleteRegistrationRequest(DomainControllerProtocol.PARAM_ERROR));
          resultHandler.failed(new SlaveRegistrationException(SlaveRegistrationException.ErrorCode.UNKNOWN,""));
        }
      }
 else {
        if (success) {
          throw new UnsupportedOperationException("TODO");
        }
 else {
          resultHandler.failed(new SlaveRegistrationException(SlaveRegistrationException.ErrorCode.UNKNOWN,""));
        }
      }
    }
  }
);
}
