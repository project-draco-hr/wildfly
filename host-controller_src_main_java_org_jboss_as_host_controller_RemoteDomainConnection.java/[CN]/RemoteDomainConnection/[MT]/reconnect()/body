{
  channelHandler.getAttachments().removeAttachment(TransactionalProtocolClient.SEND_SUBJECT);
  return executorService.submit(new Callable<Connection>(){
    @Override public Connection call() throws Exception {
      final ReconnectPolicy reconnectPolicy=ReconnectPolicy.RECONNECT;
      int reconnectionCount=0;
      for (; ; ) {
        String host=null;
        int port=-1;
        reconnectPolicy.wait(reconnectionCount);
        for (        DiscoveryOption discoveryOption : discoveryOptions) {
          try {
            discoveryOption.discover();
            host=discoveryOption.getRemoteDomainControllerHost();
            port=discoveryOption.getRemoteDomainControllerPort();
            setUri(new URI("remote://" + NetworkUtils.formatPossibleIpv6Address(host) + ":"+ port));
            HostControllerLogger.ROOT_LOGGER.debugf("trying to reconnect to remote host-controller");
            return connectionManager.connect();
          }
 catch (          IOException e) {
            HostControllerLogger.ROOT_LOGGER.debugf(e,"failed to reconnect to the remote host-controller");
          }
catch (          IllegalStateException e) {
            HostControllerLogger.ROOT_LOGGER.debugf(e,"failed to reconnect to the remote host-controller");
          }
        }
        reconnectionCount++;
      }
    }
  }
);
}
