{
  final Channel channel=openChannel(connection,CHANNEL_SERVICE_TYPE,configuration.getOptionMap());
  if (setChannel(channel)) {
    channel.receiveMessage(channelHandler.getReceiver());
    channel.addCloseHandler(channelHandler);
    try {
      if (runningMode == RunningMode.ADMIN_ONLY) {
        channelHandler.executeRequest(new FetchDomainConfigurationRequest(),null).getResult().get();
      }
 else {
        channelHandler.executeRequest(new RegisterHostControllerRequest(),null).getResult().get();
      }
    }
 catch (    Exception e) {
      if (e.getCause() instanceof IOException) {
        throw (IOException)e.getCause();
      }
      throw new IOException(e);
    }
    registered();
  }
 else {
    channel.closeAsync();
  }
}
