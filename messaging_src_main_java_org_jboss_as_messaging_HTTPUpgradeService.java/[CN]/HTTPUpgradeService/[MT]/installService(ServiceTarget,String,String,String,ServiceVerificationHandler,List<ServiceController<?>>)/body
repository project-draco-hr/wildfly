{
  final HTTPUpgradeService service=new HTTPUpgradeService(hornetQServerName,acceptorName,httpListenerName);
  ServiceBuilder<HTTPUpgradeService> builder=serviceTarget.addService(UPGRADE_SERVICE_NAME.append(acceptorName),service).addDependency(HTTP_UPGRADE_REGISTRY.append(httpListenerName),ChannelUpgradeHandler.class,service.injectedRegistry).addDependency(HttpListenerRegistryService.SERVICE_NAME,ListenerRegistry.class,service.listenerRegistry).addDependency(HornetQActivationService.getHornetQActivationServiceName(MessagingServices.getHornetQServiceName(hornetQServerName)));
  if (verificationHandler != null) {
    builder.addListener(verificationHandler);
  }
  builder.setInitialMode(ServiceController.Mode.PASSIVE);
  ServiceController<HTTPUpgradeService> controller=builder.install();
  if (newControllers != null) {
    newControllers.add(controller);
  }
}
