{
  try {
    attribute.validateOperation(operation);
    InputStream is=getContentInputStream(context,operation);
    try {
      byte[] hash=contentRepository.addContent(is);
      context.getResult().set(hash);
    }
  finally {
      safeClose(is);
    }
  }
 catch (  IOException e) {
    throw ServerMessages.MESSAGES.caughtIOExceptionUploadingContent(e);
  }
  context.stepCompleted();
}
