{
  try {
    validator.validate(operation);
    InputStream is=getContentInputStream(context,operation);
    try {
      byte[] hash=contentRepository.addContent(is);
      context.getResult().set(hash);
    }
  finally {
      safeClose(is);
    }
  }
 catch (  IOException e) {
    throw ServerMessages.MESSAGES.caughtIOExceptionUploadingContent(e);
  }
  context.completeStep(OperationContext.RollbackHandler.NOOP_ROLLBACK_HANDLER);
}
