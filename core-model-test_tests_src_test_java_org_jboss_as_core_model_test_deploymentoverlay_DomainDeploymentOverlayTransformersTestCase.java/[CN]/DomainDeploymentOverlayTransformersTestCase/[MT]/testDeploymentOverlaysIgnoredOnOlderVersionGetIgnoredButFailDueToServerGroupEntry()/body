{
  if (modelVersion.getMajor() > 1 || modelVersion.getMinor() >= 4) {
    return;
  }
  KernelServicesBuilder builder=createKernelServicesBuilder(TestModelType.DOMAIN).setModelInitializer(StandardServerGroupInitializers.XML_MODEL_INITIALIZER,StandardServerGroupInitializers.XML_MODEL_WRITE_SANITIZER).createContentRepositoryContent("12345678901234567890").setXmlResource("domain.xml");
  StandardServerGroupInitializers.addServerGroupInitializers(builder.createLegacyKernelServicesBuilder(modelVersion,testControllerVersion)).setDontUseBootOperations();
  KernelServices mainServices=builder.build();
  Assert.assertTrue(mainServices.isSuccessfulBoot());
  KernelServices legacyServices=mainServices.getLegacyServices(modelVersion);
  Assert.assertTrue(legacyServices.isSuccessfulBoot());
  try {
    mainServices.applyMasterDomainModel(modelVersion,null);
    Assert.fail("Should have failed to apply model since server group still has a deployment overlay");
  }
 catch (  Exception e) {
    Assert.assertTrue(e.getMessage(),e.getMessage().contains("14738"));
  }
}
