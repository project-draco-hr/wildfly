{
  boolean success=false;
  final String queueName="queue.testUnsuccessfulAuthorization";
  final ClientSessionFactory sf=createClientSessionFactory(managementClient.getMgmtAddress(),5445);
  ClientSession session=null;
  try {
    session=sf.createSession("guest","guest",false,true,true,false,1);
    session.createQueue(queueName,queueName,true);
  }
 catch (  Exception e) {
    if ("User: guest doesn't have permission='CREATE_DURABLE_QUEUE' on address queue.testUnsuccessfulAuthorization".equals(e.getMessage())) {
      success=true;
    }
  }
 finally {
    if (session != null) {
      session.close();
    }
  }
  Assert.assertTrue(success);
}
