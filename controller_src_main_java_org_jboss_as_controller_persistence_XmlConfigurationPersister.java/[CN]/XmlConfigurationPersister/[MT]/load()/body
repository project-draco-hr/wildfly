{
  final XMLMapper mapper=XMLMapper.Factory.create();
  mapper.registerRootElement(rootElement,rootParser);
  final List<ModelNode> updates=new ArrayList<ModelNode>();
  try {
    final FileInputStream fis=new FileInputStream(fileName);
    try {
      BufferedInputStream input=new BufferedInputStream(fis);
      XMLStreamReader streamReader=XMLInputFactory.newInstance().createXMLStreamReader(input);
      mapper.parseDocument(updates,streamReader);
      streamReader.close();
      input.close();
      fis.close();
    }
  finally {
      safeClose(fis);
    }
  }
 catch (  Exception e) {
    throw new ConfigurationPersistenceException("Failed to parse configuration",e);
  }
  return updates;
}
