{
  final ServiceName lookupName=buildServiceName(name);
  final ServiceName floor=boundServices.floor(lookupName);
  if (floor != null && floor.isParentOf(lookupName)) {
    Object obj=lookup(floor);
    if (obj != null)     throw new RequireResolveException(convert(floor));
  }
  final List<ServiceName> children=listChildren(lookupName);
  final String[] lookupParts=lookupName.toArray();
  final Set<String> childContexts=new HashSet<String>();
  final List<NameClassPair> results=new ArrayList<NameClassPair>();
  for (  ServiceName child : children) {
    final String[] childParts=child.toArray();
    if (childParts.length > lookupParts.length + 1) {
      childContexts.add(childParts[lookupParts.length]);
    }
 else {
      final Object binding=lookup(child);
      results.add(new NameClassPair(childParts[childParts.length - 1],binding.getClass().getName()));
    }
  }
  for (  String contextName : childContexts) {
    results.add(new NameClassPair(contextName,Context.class.getName()));
  }
  return results;
}
