{
  JPAService jpaService=new JPAService();
  setDefaultDataSourceName(defaultDataSourceName);
  setDefaultExtendedPersistenceInheritance(defaultExtendedPersistenceInheritance);
  setDefaultVFS(defaultVFS);
  final Injector<TransactionManager> transactionManagerInjector=new Injector<TransactionManager>(){
    public void inject(    final TransactionManager value) throws InjectionException {
      TransactionUtil.setTransactionManager(value);
    }
    public void uninject(){
    }
  }
;
  final Injector<TransactionSynchronizationRegistry> transactionRegistryInjector=new Injector<TransactionSynchronizationRegistry>(){
    public void inject(    final TransactionSynchronizationRegistry value) throws InjectionException {
      TransactionUtil.setTransactionSynchronizationRegistry(value);
    }
    public void uninject(){
    }
  }
;
  return target.addService(SERVICE_NAME,jpaService).addListener(listeners).setInitialMode(ServiceController.Mode.ACTIVE).addDependency(TransactionManagerService.SERVICE_NAME,new CastingInjector<TransactionManager>(transactionManagerInjector,TransactionManager.class)).addDependency(TransactionSynchronizationRegistryService.SERVICE_NAME,new CastingInjector<TransactionSynchronizationRegistry>(transactionRegistryInjector,TransactionSynchronizationRegistry.class)).addDependency(JPAUserTransactionListenerService.SERVICE_NAME).install();
}
