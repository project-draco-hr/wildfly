{
  CanonicalPathHandler canonicalPathHandler=new CanonicalPathHandler();
  listener.setRootHandler(canonicalPathHandler);
  PathHandler pathHandler=new PathHandler();
  HttpHandler current=pathHandler;
  if (securePort > 0) {
    current=new SinglePortConfidentialityHandler(current,securePort);
  }
  canonicalPathHandler.setNext(current);
  ResourceHandler consoleHandler=null;
  try {
    consoleHandler=consoleMode.createConsoleHandler(consoleSlot);
  }
 catch (  ModuleLoadException e) {
    ROOT_LOGGER.consoleModuleNotFound(consoleSlot == null ? "main" : consoleSlot);
  }
  try {
    pathHandler.addPath(ErrorContextHandler.ERROR_CONTEXT,new BlockingHandler(new ErrorContextHandler(consoleSlot)));
  }
 catch (  ModuleLoadException e) {
    ROOT_LOGGER.error(consoleSlot == null ? "main" : consoleSlot);
  }
  ManagementRootConsoleRedirectHandler rootConsoleRedirectHandler=new ManagementRootConsoleRedirectHandler(consoleHandler);
  DomainApiCheckHandler domainApiHandler=new DomainApiCheckHandler(modelControllerClient,controlledProcessStateService);
  pathHandler.setDefaultHandler(rootConsoleRedirectHandler);
  if (consoleHandler != null) {
    pathHandler.addPath(consoleHandler.getContext(),new BlockingHandler(consoleHandler));
  }
  pathHandler.addPath(DomainApiCheckHandler.PATH,secureDomainAccess(domainApiHandler,securityRealm));
}
