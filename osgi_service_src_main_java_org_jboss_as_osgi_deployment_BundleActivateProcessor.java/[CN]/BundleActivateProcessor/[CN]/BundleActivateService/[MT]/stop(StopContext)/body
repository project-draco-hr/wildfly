{
  if (bundle.getState() == Bundle.STARTING || bundle.getState() == Bundle.ACTIVE) {
    try {
      BundleManager bundleManager=depUnit.getAttachment(OSGiConstants.BUNDLE_MANAGER_KEY);
      bundleManager.stopBundle(bundle,Bundle.STOP_TRANSIENT);
      depUnit.putAttachment(Attachments.BUNDLE_STATE_KEY,BundleState.RESOLVED);
    }
 catch (    BundleException ex) {
      LOGGER.debugf(ex,"Cannot stop bundle: %s",bundle);
    }
  }
}
