{
  final BatchBuilder builder=updateContext.getBatchBuilder();
  final DataSourcesService dsService=new DataSourcesService(datasources);
  BatchServiceBuilder<?> serviceBuilder=builder.addService(ConnectorServices.DATASOURCES_SERVICE,dsService);
  serviceBuilder.setInitialMode(Mode.ACTIVE);
  if (datasources == null)   return;
  if (datasources.getDataSource().size() > 0 || datasources.getXaDataSource().size() > 0) {
    serviceBuilder=builder.addServiceValueIfNotExist(JDBCRARDeployService.NAME,new JDBCRARDeployService()).addDependency(ConnectorServices.RESOURCEADAPTERS_SERVICE).addDependency(ConnectorServices.CONNECTOR_CONFIG_SERVICE).addDependency(ConnectorServices.IRONJACAMAR_MDR).addDependency(DeploymentUnitProcessor.SERVICE_NAME_BASE.append(NestedJarInlineProcessor.class.getName())).addDependency(DeploymentUnitProcessor.SERVICE_NAME_BASE.append(ManifestAttachmentProcessor.class.getName())).addDependency(DeploymentUnitProcessor.SERVICE_NAME_BASE.append(AnnotationIndexProcessor.class.getName())).addDependency(DeploymentUnitProcessor.SERVICE_NAME_BASE.append(RarConfigProcessor.class.getName())).addDependency(DeploymentUnitProcessor.SERVICE_NAME_BASE.append(ModuleDependencyProcessor.class.getName())).addDependency(DeploymentUnitProcessor.SERVICE_NAME_BASE.append(ModuleConfigProcessor.class.getName())).addDependency(DeploymentUnitProcessor.SERVICE_NAME_BASE.append(DeploymentModuleLoaderProcessor.class.getName())).addDependency(DeploymentUnitProcessor.SERVICE_NAME_BASE.append(ModuleDeploymentProcessor.class.getName())).addDependency(DeploymentUnitProcessor.SERVICE_NAME_BASE.append(ModuleContextProcessor.class.getName())).addDependency(DeploymentUnitProcessor.SERVICE_NAME_BASE.append(RaDeploymentParsingProcessor.class.getName())).addDependency(DeploymentUnitProcessor.SERVICE_NAME_BASE.append(IronJacamarDeploymentParsingProcessor.class.getName())).addDependency(DeploymentUnitProcessor.SERVICE_NAME_BASE.append(ParsedRaDeploymentProcessor.class.getName())).addDependency(DeploymentUnitProcessor.SERVICE_NAME_BASE.append(RaXmlDeploymentProcessor.class.getName())).addDependency(DeploymentUnitProcessor.SERVICE_NAME_BASE.append(DsDependencyProcessor.class.getName())).addDependency(DeploymentUnitProcessor.SERVICE_NAME_BASE.append(DsDeploymentProcessor.class.getName())).setInitialMode(Mode.ACTIVE);
  }
}
