char[] target
int pos
int state
int last
boolean wrap
