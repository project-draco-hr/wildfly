{
  try {
    final FileOutputStream os=new FileOutputStream(zipFile);
    try {
      final ZipOutputStream zos=new ZipOutputStream(new BufferedOutputStream(os));
      try {
        for (        final File file : sourceDir.listFiles()) {
          if (file.isDirectory()) {
            addDirectoryToZip(file,file.getName(),zos);
          }
 else {
            addFileToZip(file,null,zos);
          }
        }
      }
  finally {
        IoUtils.safeClose(zos);
      }
    }
  finally {
      IoUtils.safeClose(os);
    }
  }
 catch (  IOException e) {
    throw new RuntimeException("Failed creating patch file " + zipFile,e);
  }
  System.out.println("\nPrepared " + zipFile.getName() + " at "+ zipFile.getAbsolutePath());
}
