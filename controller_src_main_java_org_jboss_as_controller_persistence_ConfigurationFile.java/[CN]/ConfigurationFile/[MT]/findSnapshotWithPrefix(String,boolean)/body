{
  List<String> names=new ArrayList<String>();
  if (snapshotsDirectory.exists() && snapshotsDirectory.isDirectory()) {
    for (    String curr : snapshotsDirectory.list()) {
      if (curr.startsWith(prefix)) {
        names.add(curr);
      }
    }
  }
  if (names.size() == 0 && errorIfNoFiles) {
    throw new IllegalArgumentException("No files beginning with '" + prefix + "' found in "+ snapshotsDirectory.getAbsolutePath());
  }
  if (names.size() > 1) {
    throw new IllegalArgumentException("Ambiguous name '" + prefix + "' in "+ snapshotsDirectory.getAbsolutePath()+ ": "+ names.toString());
  }
  return names.size() > 0 ? new File(snapshotsDirectory,names.get(0)) : null;
}
