{
  String mainName=null;
  if (name == null) {
    mainName=rawName;
  }
 else   if (name.equals(LAST) || name.equals(INITIAL) || name.equals(BOOT)) {
    mainName=findMainFileFromBackupSuffix(historyRoot,name);
  }
 else   if (VERSION_PATTERN.matcher(name).matches()) {
    mainName=findMainFileFromBackupSuffix(currentHistory,name);
  }
  if (mainName == null) {
    mainName=findMainFileFromSnapshotPrefix(name);
  }
  if (mainName == null) {
    final File directoryFile=new File(configurationDir,name);
    if (directoryFile.exists()) {
      mainName=stripPrefixSuffix(name);
    }
 else     if (!persistOriginal) {
      final File absoluteFile=new File(name);
      if (absoluteFile.exists()) {
        return absoluteFile;
      }
    }
  }
  if (mainName != null) {
    return new File(configurationDir,new File(mainName).getName());
  }
  throw ControllerLogger.ROOT_LOGGER.mainFileNotFound(name != null ? name : rawName,configurationDir);
}
