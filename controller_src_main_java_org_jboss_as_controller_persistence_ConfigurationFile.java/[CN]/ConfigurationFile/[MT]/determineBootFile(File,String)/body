{
  if (name.equals(LAST) || name.equals(INITIAL) || name.equals(BOOT)) {
    return addSuffixToFile(new File(historyRoot,mainFile.getName()),name);
  }
 else   if (VERSION_PATTERN.matcher(name).matches()) {
    File versioned=getVersionedFile(mainFile,name);
    if (versioned.exists()) {
      return versioned;
    }
  }
  final File snapshot=findSnapshotWithPrefix(name,false);
  if (snapshot != null) {
    return snapshot;
  }
  final File directoryFile=new File(configurationDir,name);
  if (directoryFile.exists()) {
    return directoryFile;
  }
  if (!persistOriginal) {
    File absoluteFile=new File(name);
    if (absoluteFile.exists()) {
      return absoluteFile;
    }
  }
  throw ControllerLogger.ROOT_LOGGER.fileNotFound(directoryFile.getAbsolutePath());
}
