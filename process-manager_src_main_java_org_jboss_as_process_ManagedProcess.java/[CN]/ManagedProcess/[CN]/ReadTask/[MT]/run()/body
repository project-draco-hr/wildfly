{
  final InputStream source=this.source;
  final String processName=ManagedProcess.this.processName;
  try {
    final BufferedReader reader=new BufferedReader(new InputStreamReader(new BufferedInputStream(source)));
    final OutputStreamWriter writer=new OutputStreamWriter(target);
    String s;
    while ((s=reader.readLine()) != null) {
synchronized (target) {
        writer.write('[');
        writer.write(processName);
        writer.write("] ");
        writer.write(s);
        writer.write('\n');
        writer.flush();
      }
    }
    source.close();
  }
 catch (  IOException e) {
    log.error("Stream processing failed for process '%s': %s",processName,e);
  }
 finally {
    StreamUtils.safeClose(source);
  }
}
