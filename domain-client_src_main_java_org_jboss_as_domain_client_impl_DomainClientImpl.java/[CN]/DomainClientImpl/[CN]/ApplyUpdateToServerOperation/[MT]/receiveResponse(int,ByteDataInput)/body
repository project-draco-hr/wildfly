{
  try {
    byte resultCode=input.readByte();
    if (resultCode == (byte)Protocol.PARAM_APPLY_UPDATE_RESULT_EXCEPTION) {
      final Throwable exception=unmarshal(input,Throwable.class);
      return UpdateResultHandlerResponse.createFailureResponse(exception);
    }
 else     if (resultCode == (byte)Protocol.PARAM_APPLY_SERVER_MODEL_UPDATE_CANCELLED) {
      return UpdateResultHandlerResponse.createCancellationResponse();
    }
 else     if (resultCode == (byte)Protocol.PARAM_APPLY_SERVER_MODEL_UPDATE_TIMED_OUT) {
      return UpdateResultHandlerResponse.createTimeoutResponse();
    }
 else     if (resultCode == (byte)Protocol.PARAM_APPLY_SERVER_MODEL_UPDATE_RESULT_RETURN) {
      @SuppressWarnings("unchecked") final R result=(R)unmarshal(input,Object.class);
      return UpdateResultHandlerResponse.createSuccessResponse(result);
    }
 else {
      throw new IOException("Invalid byte token.  Expecting '" + Protocol.PARAM_APPLY_SERVER_MODEL_UPDATE_RESULT_RETURN + "' or '"+ Protocol.PARAM_APPLY_UPDATE_RESULT_EXCEPTION+ "' received '"+ resultCode+ "'");
    }
  }
 catch (  Exception e) {
    throw new RuntimeException("Failed to read update responses",e);
  }
}
