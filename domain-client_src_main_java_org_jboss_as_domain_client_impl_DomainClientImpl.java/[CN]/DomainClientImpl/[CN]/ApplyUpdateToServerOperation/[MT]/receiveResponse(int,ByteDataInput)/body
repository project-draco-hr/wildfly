{
  try {
    byte resultCode=input.readByte();
    if (resultCode == (byte)Protocol.PARAM_APPLY_UPDATE_RESULT_EXCEPTION) {
      final Throwable exception=unmarshal(input,Throwable.class);
      if (resultHandler != null) {
        resultHandler.handleFailure(exception,param);
      }
    }
 else     if (resultCode == (byte)Protocol.PARAM_APPLY_SERVER_MODEL_UPDATE_CANCELLED) {
      if (resultHandler != null) {
        resultHandler.handleCancellation(param);
      }
    }
 else     if (resultCode == (byte)Protocol.PARAM_APPLY_SERVER_MODEL_UPDATE_TIMED_OUT) {
      if (resultHandler != null) {
        resultHandler.handleTimeout(param);
      }
    }
 else     if (resultCode == (byte)Protocol.PARAM_APPLY_SERVER_MODEL_UPDATE_RESULT_RETURN) {
      @SuppressWarnings("unchecked") final R result=(R)unmarshal(input,Object.class);
      if (resultHandler != null) {
        resultHandler.handleSuccess(result,param);
      }
    }
 else {
      throw new IOException("Invalid byte token.  Expecting '" + Protocol.PARAM_APPLY_SERVER_MODEL_UPDATE_RESULT_RETURN + "' or '"+ Protocol.PARAM_APPLY_UPDATE_RESULT_EXCEPTION+ "' received '"+ resultCode+ "'");
    }
  }
 catch (  Exception e) {
    throw new RuntimeException("Failed to read update responses",e);
  }
  return null;
}
