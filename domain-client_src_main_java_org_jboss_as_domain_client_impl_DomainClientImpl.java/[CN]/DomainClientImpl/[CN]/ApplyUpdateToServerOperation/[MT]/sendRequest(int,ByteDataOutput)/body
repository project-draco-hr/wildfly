{
  try {
    final Marshaller marshaller=getMarshaller();
    marshaller.start(output);
    output.writeByte(Protocol.PARAM_HOST_NAME);
    output.writeUTF(server.getHostName());
    output.writeByte(Protocol.PARAM_SERVER_GROUP_NAME);
    output.writeUTF(server.getServerGroupName());
    output.writeByte(Protocol.PARAM_SERVER_NAME);
    output.writeUTF(server.getServerName());
    marshaller.writeByte(Protocol.PARAM_SERVER_MODEL_UPDATE);
    marshaller.writeObject(update);
    marshaller.finish();
  }
 catch (  Exception e) {
    throw new RuntimeException("Failed to write updates to domain controller",e);
  }
}
