{
  final Marshaller marshaller=getMarshaller();
  marshaller.start(createByteOutput(output));
  try {
    marshaller.writeByte(DomainClientProtocol.PARAM_HOST_NAME);
    marshaller.writeUTF(server.getHostName());
    marshaller.writeByte(DomainClientProtocol.PARAM_SERVER_GROUP_NAME);
    marshaller.writeUTF(server.getServerGroupName());
    marshaller.writeByte(DomainClientProtocol.PARAM_SERVER_NAME);
    marshaller.writeUTF(server.getServerName());
    marshaller.writeByte(DomainClientProtocol.PARAM_SERVER_MODEL_UPDATE);
    marshaller.writeObject(update);
    marshaller.finish();
  }
  finally {
    safeFinish(marshaller);
  }
}
