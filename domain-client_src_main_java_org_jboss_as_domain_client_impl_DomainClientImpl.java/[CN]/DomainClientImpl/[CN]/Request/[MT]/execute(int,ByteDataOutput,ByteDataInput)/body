{
  try {
    output.writeByte(Protocol.REQUEST_OPERATION);
    output.writeByte(getRequestCode());
    output.writeByte(Protocol.REQUEST_START);
    sendRequest(protocolVersion,output);
    output.writeByte(Protocol.REQUEST_END);
    output.flush();
    expectHeader(input,Protocol.RESPONSE_START);
    byte responseCode=input.readByte();
    if (responseCode != getResponseCode()) {
      throw new RuntimeException("Invalid response code.  Expecting '" + getResponseCode() + "' received '"+ responseCode+ "'");
    }
    final T result=receiveResponse(protocolVersion,input);
    expectHeader(input,Protocol.RESPONSE_END);
    return result;
  }
 catch (  IOException e) {
    throw new RuntimeException("Failed to execute remote domain controller operation",e);
  }
}
