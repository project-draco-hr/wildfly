{
  try {
    output.writeByte(Protocol.PARAM_APPLY_UPDATES_RESULT_COUNT);
    output.writeInt(updates.size());
    for (    AbstractDomainModelUpdate<?> update : updates) {
      output.writeByte(Protocol.PARAM_DOMAIN_MODEL_UPDATE);
      marshal(output,update);
    }
  }
 catch (  Exception e) {
    throw new RuntimeException("Failed to write updates to domain controller",e);
  }
}
