{
  List<org.jgroups.conf.ProtocolConfiguration> protocolConfigs=new ArrayList<org.jgroups.conf.ProtocolConfiguration>(stackConfig.getProtocols().size() + 1);
  protocolConfigs.add(this.createProtocol(stackConfig.getTransport()));
  for (  ProtocolConfiguration protocolConfig : stackConfig.getProtocols()) {
    protocolConfigs.add(this.createProtocol(protocolConfig));
  }
  ProtocolStack stack=new ProtocolStack();
  List<Protocol> protocols=new ArrayList<Protocol>(protocolConfigs.size());
  Protocol protocol=new Configurator(stack).setupProtocolStack(protocolConfigs);
  while (protocol != null) {
    protocols.add(protocol);
    protocol=protocol.getDownProtocol();
  }
  Collections.reverse(protocols);
  stack.addProtocols(protocols);
  return stack;
}
