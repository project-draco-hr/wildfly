{
  final ServiceName containerServiceName=EmbeddedCacheManagerService.getServiceName(containerName);
  final ServiceName configServiceName=EmbeddedCacheManagerConfigurationService.getServiceName(containerName);
  final InjectedValue<EmbeddedCacheManagerConfiguration> config=new InjectedValue<>();
  final Service<EmbeddedCacheManager> service=new EmbeddedCacheManagerService(config);
  ServiceBuilder<EmbeddedCacheManager> builder=target.addService(containerServiceName,service).addDependency(configServiceName,EmbeddedCacheManagerConfiguration.class,config).addAliases(aliases).setInitialMode(initialMode);
  if (transport != null) {
    builder.addDependency(ChannelService.getServiceName(containerName));
  }
  return builder.install();
}
