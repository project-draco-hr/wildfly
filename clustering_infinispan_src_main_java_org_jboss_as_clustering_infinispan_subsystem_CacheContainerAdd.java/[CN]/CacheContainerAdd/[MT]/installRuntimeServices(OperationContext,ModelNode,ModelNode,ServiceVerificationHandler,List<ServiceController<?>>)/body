{
  model=Resource.Tools.readModel(context.readResource(PathAddress.EMPTY_ADDRESS));
  final PathAddress address=PathAddress.pathAddress(operation.get(OP_ADDR));
  final String name=address.getLastElement().getValue();
  final ServiceTarget target=context.getServiceTarget();
  ModelNode resolvedValue=null;
  final String defaultCache=((resolvedValue=CommonAttributes.DEFAULT_CACHE.resolveModelAttribute(context,model)).isDefined()) ? resolvedValue.asString() : null;
  final String jndiNameString=((resolvedValue=CommonAttributes.JNDI_NAME.resolveModelAttribute(context,model)).isDefined()) ? resolvedValue.asString() : null;
  final String listenerExecutor=((resolvedValue=CommonAttributes.LISTENER_EXECUTOR.resolveModelAttribute(context,model)).isDefined()) ? resolvedValue.asString() : null;
  final String evictionExecutor=((resolvedValue=CommonAttributes.EVICTION_EXECUTOR.resolveModelAttribute(context,model)).isDefined()) ? resolvedValue.asString() : null;
  final String replicationQueueExecutor=((resolvedValue=CommonAttributes.REPLICATION_QUEUE_EXECUTOR.resolveModelAttribute(context,model)).isDefined()) ? resolvedValue.asString() : null;
  final ServiceController.Mode initialMode=StartMode.valueOf(CommonAttributes.START.resolveModelAttribute(context,model).asString()).getMode();
  ServiceName[] aliases=null;
  if (model.hasDefined(ModelKeys.ALIASES)) {
    List<ModelNode> list=operation.get(ModelKeys.ALIASES).asList();
    aliases=new ServiceName[list.size()];
    for (int i=0; i < list.size(); i++) {
      aliases[i]=EmbeddedCacheManagerService.getServiceName(list.get(i).asString());
    }
  }
  boolean hasTransport=model.hasDefined(ModelKeys.TRANSPORT) && model.get(ModelKeys.TRANSPORT).hasDefined(ModelKeys.TRANSPORT_NAME);
  String stack=null;
  String cluster=null;
  long lockTimeout=0;
  String transportExecutor=null;
  Transport transportConfig=null;
  if (hasTransport) {
    ModelNode transport=model.get(ModelKeys.TRANSPORT,ModelKeys.TRANSPORT_NAME);
    stack=((resolvedValue=CommonAttributes.STACK.resolveModelAttribute(context,transport)).isDefined()) ? resolvedValue.asString() : null;
    cluster=((resolvedValue=CommonAttributes.CLUSTER.resolveModelAttribute(context,transport)).isDefined()) ? resolvedValue.asString() : name;
    lockTimeout=CommonAttributes.LOCK_TIMEOUT.resolveModelAttribute(context,transport).asLong();
    transportExecutor=((resolvedValue=CommonAttributes.EXECUTOR.resolveModelAttribute(context,transport)).isDefined()) ? resolvedValue.asString() : null;
    transportConfig=new Transport();
    transportConfig.setLockTimeout(lockTimeout);
    ServiceController<Channel> csController=installChannelService(target,name,cluster,stack,verificationHandler);
    if (newControllers != null) {
      newControllers.add(csController);
    }
  }
  ServiceController<EmbeddedCacheManagerConfiguration> ccsController=installContainerConfigurationService(target,name,defaultCache,transportConfig,transportExecutor,listenerExecutor,evictionExecutor,replicationQueueExecutor,verificationHandler);
  if (newControllers != null) {
    newControllers.add(ccsController);
  }
  ServiceController<EmbeddedCacheManager> ccController=installContainerService(target,name,aliases,initialMode,verificationHandler);
  if (newControllers != null) {
    newControllers.add(ccController);
  }
  ServiceController<ManagedReferenceFactory> jsController=installJndiService(target,name,jndiNameString,verificationHandler);
  if (newControllers != null) {
    newControllers.add(jsController);
  }
  log.debugf("%s cache container installed",name);
}
