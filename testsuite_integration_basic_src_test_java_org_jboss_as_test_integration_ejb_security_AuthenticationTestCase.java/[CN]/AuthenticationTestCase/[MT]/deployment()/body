{
  final Package currentPackage=AuthenticationTestCase.class.getPackage();
  final WebArchive war=ShrinkWrap.create(WebArchive.class,"ejb3security.war").addPackage(WhoAmIBean.class.getPackage()).addPackage(EntryBean.class.getPackage()).addClass(WhoAmI.class).addClass(Util.class).addClass(Entry.class).addClasses(WhoAmIServlet.class,AuthenticationTestCase.class).addClasses(AbstractSecurityDomainSetup.class,EjbSecurityDomainSetup.class).addClass(TestSuiteEnvironment.class).addAsResource(currentPackage,"users.properties","users.properties").addAsResource(currentPackage,"roles.properties","roles.properties").addAsWebInfResource(currentPackage,"web.xml","web.xml").addAsWebInfResource(currentPackage,"jboss-web.xml","jboss-web.xml").addAsWebInfResource(currentPackage,"jboss-ejb3.xml","jboss-ejb3.xml").addAsManifestResource(new StringAsset("Manifest-Version: 1.0\nDependencies: org.jboss.as.controller-client,org.jboss.dmr\n"),"MANIFEST.MF").addAsManifestResource(createPermissionsXmlAsset(new AuthPermission("modifyPrincipals"),new RuntimePermission("org.jboss.security.getSecurityContext"),new RuntimePermission("org.jboss.security.SecurityContextFactory.createSecurityContext"),new RuntimePermission("org.jboss.security.SecurityContextFactory.createUtil"),new RuntimePermission("org.jboss.security.plugins.JBossSecurityContext.setSubjectInfo"),new RuntimePermission("org.jboss.security.setSecurityContext"),new RuntimePermission("modifyThread"),new SocketPermission(SERVER_HOST_PORT,"connect,resolve"),new PropertyPermission("management.address","read"),new PropertyPermission("node0","read"),new PropertyPermission("jboss.http.port","read")),"permissions.xml");
  war.addPackage(CommonCriteria.class.getPackage());
  return war;
}
