{
  String[] strs=null;
  String jbossFile=getJBossFile(deploymentFile);
  File jbossDescriptor=getResourceFile("deployment/" + jbossFile);
  assertTrue(jbossDescriptor.exists());
  ByteArrayOutputStream baos=new ByteArrayOutputStream();
  JarOutputStream jos=new JarOutputStream(baos);
  JarUtils.addJarEntry(jos,"!/" + jbossFile,new FileInputStream(jbossDescriptor));
  DeploymentMetaData metaData=new DeploymentMetaData(deploymentFile);
  strs=jbossFile.split("/");
  metaData.addEntry(deploymentFile,strs[strs.length - 1]);
  String metaStr=metaData.toXMLString();
  JarUtils.addJarEntry(jos,DeploymentMetaData.ENTRY_NAME,new ByteArrayInputStream(metaStr.getBytes()));
  jos.flush();
  jos.close();
  return new ByteArrayInputStream(baos.toByteArray());
}
