{
  OutputStream outputStream=null;
  ByteDataOutput output=null;
  try {
    outputStream=connection.writeMessage();
    output=new SimpleByteDataOutput(outputStream);
    output.writeByte(ManagementProtocol.REQUEST_OPERATION);
    output.writeByte(getRequestCode());
    output.writeByte(ManagementProtocol.REQUEST_START);
    sendRequest(protocolVersion,output);
    output.writeByte(ManagementProtocol.REQUEST_END);
  }
 catch (  ManagementException e) {
    throw e;
  }
catch (  Throwable t) {
    throw new ManagementException("Failed to send management request",t);
  }
 finally {
    safeClose(output);
    safeClose(outputStream);
  }
}
