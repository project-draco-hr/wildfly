{
  Bundle bundleA=context.installBundle(V200_JAR,deployer.getDeployment(V200_JAR));
  Bundle bundleB=context.installBundle(BUNDLE_V200_WAB,deployer.getDeployment(BUNDLE_V200_WAB));
  try {
    bundleB.start();
    String result=performCall("bundle-v200","simple",null);
    Assert.assertEquals("Revision deployment.v200.jar:main",result);
    result=performCall("bundle-v200","message.txt",null);
    Assert.assertEquals("Resource V2.0.0",result);
    bundleA.update(deployer.getDeployment(V201_JAR));
    result=performCall("bundle-v200","simple",null);
    Assert.assertEquals("Revision deployment.v200.jar:main",result);
    result=performCall("bundle-v200","message.txt",null);
    Assert.assertEquals("Resource V2.0.0",result);
    bundleB.uninstall();
    bundleB=context.installBundle(BUNDLE_V200_WAB,deployer.getDeployment(BUNDLE_V200_WAB));
    bundleB.start();
    result=performCall("bundle-v200","simple",null);
    Assert.assertEquals("Revision deployment.v200-rev1.jar:main",result);
    result=performCall("bundle-v200","message.txt",null);
    Assert.assertEquals("Resource V2.0.0",result);
  }
  finally {
    bundleB.uninstall();
    bundleA.uninstall();
  }
}
