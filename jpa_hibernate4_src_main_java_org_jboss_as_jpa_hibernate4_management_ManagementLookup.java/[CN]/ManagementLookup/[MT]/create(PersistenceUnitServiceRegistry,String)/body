{
  Statistics stats=null;
  PersistenceUnitService persistenceUnitService=registry.getPersistenceUnitService(persistenceUnitName);
  if (persistenceUnitService != null) {
    final EntityManagerFactory entityManagerFactory=persistenceUnitService.getEntityManagerFactory();
    HibernateEntityManagerFactory entityManagerFactoryImpl=(HibernateEntityManagerFactory)entityManagerFactory;
    SessionFactory sessionFactory=entityManagerFactoryImpl.getSessionFactory();
    if (sessionFactory != null) {
      stats=sessionFactory.getStatistics();
      return new ManagementLookup(stats,entityManagerFactory);
    }
  }
  return null;
}
