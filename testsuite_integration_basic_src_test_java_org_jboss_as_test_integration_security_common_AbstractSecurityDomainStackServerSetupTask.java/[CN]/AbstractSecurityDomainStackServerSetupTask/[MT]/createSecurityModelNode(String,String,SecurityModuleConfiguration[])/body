{
  if (securityConfigurations == null || securityConfigurations.length == 0) {
    if (LOGGER.isInfoEnabled()) {
      LOGGER.info("No security configuration for " + securityComponent + " module.");
    }
    return null;
  }
  final ModelNode securityComponentNode=new ModelNode();
  securityComponentNode.get(OP).set(ADD);
  securityComponentNode.get(OP_ADDR).add(SUBSYSTEM,SUBSYSTEM_SECURITY);
  securityComponentNode.get(OP_ADDR).add(SECURITY_DOMAIN,getSecurityDomainName());
  securityComponentNode.get(OP_ADDR).add(securityComponent,Constants.CLASSIC);
  for (  final SecurityModuleConfiguration config : securityConfigurations) {
    final ModelNode securityModuleNode=securityComponentNode.get(subnodeName).add();
    final String code=config.getName();
    final String flag=StringUtils.defaultIfEmpty(config.getFlag(),Constants.REQUIRED);
    securityModuleNode.get(ModelDescriptionConstants.CODE).set(code);
    securityModuleNode.get(FLAG).set(flag);
    if (LOGGER.isInfoEnabled()) {
      LOGGER.info("Adding " + securityComponent + " module [code="+ code+ ", flag="+ flag+ "]");
    }
    Map<String,String> configOptions=config.getOptions();
    if (configOptions == null) {
      LOGGER.info("No module options provided.");
      configOptions=Collections.emptyMap();
    }
    final ModelNode moduleOptionsNode=securityModuleNode.get(MODULE_OPTIONS);
    for (    final Map.Entry<String,String> entry : configOptions.entrySet()) {
      final String optionName=entry.getKey();
      final String optionValue=entry.getValue();
      moduleOptionsNode.add(optionName,optionValue);
      if (LOGGER.isInfoEnabled()) {
        LOGGER.info("Adding module option [" + optionName + "="+ optionValue+ "]");
      }
    }
    securityComponentNode.get(OPERATION_HEADERS).get(ALLOW_RESOURCE_SERVICE_RESTART).set(true);
  }
  return securityComponentNode;
}
