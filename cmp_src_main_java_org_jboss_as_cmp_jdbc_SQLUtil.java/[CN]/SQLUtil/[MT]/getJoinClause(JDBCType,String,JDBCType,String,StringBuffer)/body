{
  if (parent.length() > 0) {
    parent+='.';
  }
  if (child.length() > 0) {
    child+='.';
  }
  String[] pkColumnNames=pkType.getColumnNames();
  String[] fkColumnNames=fkType.getColumnNames();
  if (pkColumnNames.length != fkColumnNames.length) {
    throw new IllegalArgumentException("PK and FK have different number of columns");
  }
  buf.append(parent).append(pkColumnNames[0]).append('=').append(child).append(fkColumnNames[0]);
  int i=1;
  while (i < pkColumnNames.length) {
    buf.append(AND).append(parent).append(pkColumnNames[i]).append('=').append(child).append(fkColumnNames[i++]);
  }
  return buf;
}
