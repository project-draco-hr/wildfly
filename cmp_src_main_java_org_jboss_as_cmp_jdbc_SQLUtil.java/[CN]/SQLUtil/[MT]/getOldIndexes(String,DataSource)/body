{
  tableName=unquote(tableName,dataSource);
  Connection con=null;
  ResultSet rs=null;
  ArrayList indexNames=new ArrayList();
  ArrayList columnNames=new ArrayList();
  ArrayList ascDesc=new ArrayList();
  try {
    con=dataSource.getConnection();
    DatabaseMetaData dmd=con.getMetaData();
    String catalog=con.getCatalog();
    String schema=null;
    if (dmd.storesLowerCaseIdentifiers())     tableName=tableName.toLowerCase();
 else     if (dmd.storesUpperCaseIdentifiers())     tableName=tableName.toUpperCase();
    int dotIndex;
    if ((dotIndex=tableName.indexOf('.')) != -1) {
      schema=tableName.substring(0,dotIndex);
      tableName=tableName.substring(dotIndex + 1);
    }
    rs=dmd.getIndexInfo(catalog,schema,tableName,false,false);
    while (rs.next()) {
      indexNames.add(rs.getString("INDEX_NAME"));
      columnNames.add(rs.getString("COLUMN_NAME"));
      ascDesc.add(rs.getString("ASC_OR_DESC"));
    }
    return new OldIndexes(indexNames,columnNames,ascDesc);
  }
 catch (  SQLException e) {
    throw MESSAGES.errorGettingColumnNames(e);
  }
 finally {
    JDBCUtil.safeClose(rs);
    JDBCUtil.safeClose(con);
  }
}
