{
  char firstChar=tableName.charAt(0);
  if (firstChar == '"' || firstChar == '\'') {
    return tableName;
  }
  String strSchema="";
  int iIndex;
  if ((iIndex=tableName.indexOf('.')) != -1) {
    strSchema=tableName.substring(0,iIndex);
    tableName=tableName.substring(iIndex + 1);
  }
  if (rwords != null) {
    for (int i=0; i < rwords.size(); i++) {
      if (((String)rwords.elementAt(i)).equalsIgnoreCase(tableName)) {
        tableName="X" + tableName;
        break;
      }
    }
  }
  Connection con=null;
  try {
    con=dataSource.getConnection();
    DatabaseMetaData dmd=con.getMetaData();
    int maxLength=dmd.getMaxTableNameLength();
    if (maxLength > 0 && tableName.length() > maxLength) {
      CRC32 crc=new CRC32();
      crc.update(tableName.getBytes());
      String nameCRC=Long.toString(crc.getValue(),36);
      tableName=tableName.substring(0,maxLength - nameCRC.length() - 2);
      tableName+="_" + nameCRC;
    }
    if (dmd.storesLowerCaseIdentifiers()) {
      tableName=tableName.toLowerCase();
    }
 else     if (dmd.storesUpperCaseIdentifiers()) {
      tableName=tableName.toUpperCase();
    }
    if (strSchema.length() > 0) {
      tableName=strSchema + "." + tableName;
    }
    return tableName;
  }
 catch (  SQLException e) {
    throw MESSAGES.errorFixingTableName(e);
  }
 finally {
    JDBCUtil.safeClose(con);
  }
}
