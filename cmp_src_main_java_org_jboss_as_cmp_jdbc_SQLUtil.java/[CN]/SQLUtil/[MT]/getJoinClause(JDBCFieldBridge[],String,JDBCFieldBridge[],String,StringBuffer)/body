{
  if (pkFields.length != fkFields.length) {
    throw CmpMessages.MESSAGES.errorCreatingJoin(pkFields.length,fkFields.length);
  }
  boolean and=false;
  for (int i=0; i < pkFields.length; ++i) {
    JDBCType pkType=getJDBCType(pkFields[i]);
    JDBCType fkType=getJDBCType(fkFields[i]);
    if (and)     buf.append(AND);
 else     and=true;
    getJoinClause(pkType,parent,fkType,child,buf);
  }
  return buf;
}
