{
  Connection con=null;
  ResultSet rs=null;
  ArrayList columnNames=new ArrayList();
  ArrayList typeNames=new ArrayList();
  ArrayList columnSizes=new ArrayList();
  try {
    con=dataSource.getConnection();
    DatabaseMetaData dmd=con.getMetaData();
    String catalog=con.getCatalog();
    String schema=null;
    String quote=dmd.getIdentifierQuoteString();
    if (tableName.startsWith(quote)) {
      if (tableName.endsWith(quote) == false) {
        throw MESSAGES.mismatchedQuoteTableName(tableName);
      }
      int quoteLength=quote.length();
      tableName=tableName.substring(quoteLength,tableName.length() - quoteLength);
      if (dmd.storesLowerCaseQuotedIdentifiers())       tableName=tableName.toLowerCase(Locale.ENGLISH);
 else       if (dmd.storesUpperCaseQuotedIdentifiers())       tableName=tableName.toUpperCase(Locale.ENGLISH);
    }
 else {
      if (dmd.storesLowerCaseIdentifiers())       tableName=tableName.toLowerCase(Locale.ENGLISH);
 else       if (dmd.storesUpperCaseIdentifiers())       tableName=tableName.toUpperCase(Locale.ENGLISH);
    }
    int dotIndex;
    if ((dotIndex=tableName.indexOf('.')) != -1) {
      schema=tableName.substring(0,dotIndex);
      tableName=tableName.substring(dotIndex + 1);
    }
    rs=dmd.getColumns(catalog,schema,tableName,null);
    while (rs.next()) {
      String columnName=rs.getString("COLUMN_NAME");
      columnNames.add(columnName == null ? null : columnName.toUpperCase(Locale.ENGLISH));
      typeNames.add(rs.getString("TYPE_NAME"));
      columnSizes.add(new Integer(rs.getInt("COLUMN_SIZE")));
    }
    return new OldColumns(columnNames,typeNames,columnSizes);
  }
 catch (  SQLException e) {
    throw MESSAGES.errorGettingColumnNames(e);
  }
 finally {
    JDBCUtil.safeClose(rs);
    JDBCUtil.safeClose(con);
  }
}
