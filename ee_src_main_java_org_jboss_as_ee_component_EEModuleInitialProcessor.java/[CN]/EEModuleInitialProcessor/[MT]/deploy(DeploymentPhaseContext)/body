{
  final DeploymentUnit deploymentUnit=phaseContext.getDeploymentUnit();
  final DeploymentUnit parent=deploymentUnit.getParent();
  String deploymentUnitName=deploymentUnit.getName();
  final String moduleName;
  if (deploymentUnitName.endsWith(".war") || deploymentUnitName.endsWith(".jar") || deploymentUnitName.endsWith(".ear")|| deploymentUnitName.endsWith(".rar")) {
    moduleName=deploymentUnitName.substring(0,deploymentUnitName.length() - 4);
  }
 else {
    moduleName=deploymentUnitName;
  }
  final String appName;
  if (parent == null) {
    appName=moduleName;
  }
 else {
    final String parentName=parent.getName();
    if (parentName.endsWith(".ear")) {
      appName=parentName.substring(0,parentName.length() - 4);
    }
 else {
      appName=parentName;
    }
  }
  deploymentUnit.putAttachment(Attachments.EE_MODULE_DESCRIPTION,new EEModuleDescription(appName,moduleName));
  final EEApplicationClasses classes;
  if (parent == null) {
    classes=new EEApplicationClasses();
  }
 else {
    EEApplicationClasses parentClasses=parent.getAttachment(Attachments.EE_APPLICATION_CLASSES_DESCRIPTION);
    classes=new EEApplicationClasses(parentClasses);
  }
  deploymentUnit.putAttachment(Attachments.EE_APPLICATION_CLASSES_DESCRIPTION,classes);
}
