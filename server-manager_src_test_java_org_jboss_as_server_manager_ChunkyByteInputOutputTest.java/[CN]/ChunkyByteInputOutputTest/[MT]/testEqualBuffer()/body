{
  final byte[] content="1234567890".getBytes();
  final ByteArrayOutputStream byteArrayOutputStream=new ByteArrayOutputStream();
  final ByteOutput byteOutput=new ChunkyByteOutput(Marshalling.createByteOutput(byteArrayOutputStream),10);
  byteOutput.write(content);
  byteOutput.flush();
  final byte[] chunked=byteArrayOutputStream.toByteArray();
  final ByteArrayInputStream byteArrayInputStream=new ByteArrayInputStream(chunked);
  final ByteInput byteInput=new ChunkyByteInput(Marshalling.createByteInput(byteArrayInputStream));
  byte[] result=new byte[content.length];
  byteInput.read(result);
  byteInput.close();
  Assert.assertArrayEquals(content,result);
  Assert.assertEquals(-1,byteInput.read());
}
