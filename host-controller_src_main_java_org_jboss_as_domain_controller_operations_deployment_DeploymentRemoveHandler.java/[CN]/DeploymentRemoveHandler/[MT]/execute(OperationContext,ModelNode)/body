{
  checkCanRemove(context,operation);
  final Resource resource=context.readResource(PathAddress.EMPTY_ADDRESS);
  final List<byte[]> deploymentHashes=DeploymentUtils.getDeploymentHash(resource);
  context.removeResource(PathAddress.EMPTY_ADDRESS);
  context.addStep(new OperationStepHandler(){
    public void execute(    OperationContext context,    ModelNode operation) throws OperationFailedException {
      if (context.completeStep() != ResultAction.ROLLBACK) {
        removeContent(deploymentHashes);
      }
    }
  }
,OperationContext.Stage.RUNTIME);
  context.stepCompleted();
}
