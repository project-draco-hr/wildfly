{
  String msg=urlValidator.validate(operation);
  if (msg != null) {
    throw new IllegalStateException(msg);
  }
  String urlSpec=operation.get(URL).asString();
  try {
    URL url=new URL(urlSpec);
    return url.openStream();
  }
 catch (  MalformedURLException e) {
    throw new RuntimeException(urlSpec + " is not a valid URL",e);
  }
catch (  IOException e) {
    throw new RuntimeException("Error obtaining input stream from URL " + urlSpec,e);
  }
}
