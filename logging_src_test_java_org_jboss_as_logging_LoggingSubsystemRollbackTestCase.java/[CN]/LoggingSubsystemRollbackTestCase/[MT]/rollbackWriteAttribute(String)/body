{
  final KernelServices kernelServices=boot();
  final ModelNode validSubsystemModel=getSubsystemModel(kernelServices);
  final PathAddress consoleHandler=createConsoleHandlerAddress(profileName,"CONSOLE");
  ModelNode op=Operations.createWriteAttributeOperation(consoleHandler.toModelNode(),CommonAttributes.TARGET,"System.err");
  ModelNode result=kernelServices.executeOperation(op);
  Assert.assertFalse("The write operation should have failed, but was successful: " + result,Operations.successful(result));
  ModelNode currentModel=getSubsystemModel(kernelServices);
  compare(profileName,validSubsystemModel,currentModel);
  final LogContext logContext=(profileName == null ? LogContext.getLogContext() : LoggingProfileContextSelector.getInstance().get(profileName));
  ConfigurationPersistence config=ConfigurationPersistence.getConfigurationPersistence(logContext);
  compare(profileName,currentModel,config);
  final PathAddress rootLoggerAddress=createRootLoggerAddress(profileName);
  op=Operations.createWriteAttributeOperation(rootLoggerAddress.toModelNode(),CommonAttributes.LEVEL,"TRACE");
  result=kernelServices.executeOperation(op);
  Assert.assertFalse("The write operation should have failed, but was successful: " + result,Operations.successful(result));
  currentModel=getSubsystemModel(kernelServices);
  compare(profileName,validSubsystemModel,currentModel);
  config=ConfigurationPersistence.getConfigurationPersistence(logContext);
  compare(profileName,currentModel,config);
}
