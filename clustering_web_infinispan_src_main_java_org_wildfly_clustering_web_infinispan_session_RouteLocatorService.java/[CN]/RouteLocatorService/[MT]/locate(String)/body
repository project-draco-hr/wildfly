{
  Registry<String,Void> registry=this.registry.getOptionalValue();
  if (registry == null) {
    return this.provider.getValue().getKey();
  }
  Map.Entry<String,Void> entry=null;
  Address location=this.locatePrimaryOwner(sessionId);
  if (location != null) {
    NodeFactory<Address> nodeFactory=this.nodeFactory.getOptionalValue();
    if (nodeFactory != null) {
      Node node=nodeFactory.createNode(location);
      entry=registry.getEntry(node);
    }
  }
  if (entry == null) {
    entry=registry.getLocalEntry();
  }
  return (entry != null) ? entry.getKey() : null;
}
