{
  final DeploymentUnit deploymentUnit=phaseContext.getDeploymentUnit();
  final EEApplicationClasses applicationClassesDescription=deploymentUnit.getAttachment(Attachments.EE_APPLICATION_CLASSES_DESCRIPTION);
  final EEModuleDescription moduleDescription=deploymentUnit.getAttachment(org.jboss.as.ee.component.Attachments.EE_MODULE_DESCRIPTION);
  final String beanName=sessionBean.getName();
  final ComponentDescription bean=moduleDescription.getComponentByName(beanName);
  if (!(bean instanceof SessionBeanComponentDescription)) {
    return;
  }
  SessionBeanComponentDescription sessionBeanDescription=(SessionBeanComponentDescription)bean;
  if (appclient) {
    if (sessionBeanDescription == null) {
      for (      final ComponentDescription component : deploymentUnit.getAttachmentList(Attachments.ADDITIONAL_RESOLVABLE_COMPONENTS)) {
        if (component.getComponentName().equals(beanName)) {
          sessionBeanDescription=(SessionBeanComponentDescription)component;
          break;
        }
      }
    }
  }
  if (sessionBeanDescription == null) {
    throw new DeploymentUnitProcessingException("Could not find session bean with name " + beanName);
  }
  sessionBeanDescription.setDeploymentDescriptorEnvironment(new DeploymentDescriptorEnvironment("java:comp/env/",sessionBean));
  sessionBeanDescription.setMappedName(sessionBean.getMappedName());
  final BusinessLocalsMetaData businessLocals=sessionBean.getBusinessLocals();
  if (businessLocals != null && !businessLocals.isEmpty()) {
    sessionBeanDescription.addLocalBusinessInterfaceViews(businessLocals);
  }
  final String local=sessionBean.getLocal();
  if (local != null) {
    sessionBeanDescription.addEjbLocalObjectView(local);
  }
  final String remote=sessionBean.getRemote();
  if (remote != null) {
    sessionBeanDescription.addEjbObjectView(remote);
  }
  final BusinessRemotesMetaData businessRemotes=sessionBean.getBusinessRemotes();
  if (businessRemotes != null && !businessRemotes.isEmpty()) {
    sessionBeanDescription.addRemoteBusinessInterfaceViews(businessRemotes);
  }
  if (sessionBean instanceof SessionBean31MetaData) {
    this.processSessionBean31((SessionBean31MetaData)sessionBean,sessionBeanDescription);
  }
}
