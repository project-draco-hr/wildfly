{
  DirectServerManagerCommunicationHandler serverHandler;
synchronized (serverConnections) {
    serverHandler=serverConnections.get(serverName);
    if (serverHandler != null) {
      if (serverHandler.isClosed()) {
        serverConnections.remove(serverName);
      }
 else {
        return serverHandler;
      }
    }
  }
  long end=System.currentTimeMillis() + 10000;
  while (serverHandler == null && System.currentTimeMillis() < end) {
    serverHandler=serverListener.getManagerHandler(serverName);
    Thread.sleep(100);
  }
  if (serverHandler == null)   throw new IllegalStateException("No server connected with name " + serverName);
synchronized (serverConnections) {
    serverConnections.put(serverName,serverHandler);
  }
  return serverHandler;
}
