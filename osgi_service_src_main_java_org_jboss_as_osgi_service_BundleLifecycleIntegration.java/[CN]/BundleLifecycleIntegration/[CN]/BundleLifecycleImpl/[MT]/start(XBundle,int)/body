{
  Deployment deployment=bundle.adapt(Deployment.class);
  DeploymentUnit depUnit=deployment.getAttachment(DeploymentUnit.class);
  if (depUnit == null) {
    defaultService.start(bundle,options);
    return;
  }
  List<String> deferredModules=DeploymentUtils.getDeferredModules(depUnit);
  if (!deferredModules.contains(depUnit.getName())) {
    defaultService.start(bundle,options);
    return;
  }
  ServiceController<Phase> phaseService=getDeferredPhaseService(depUnit);
  if (phaseService.getMode() != Mode.NEVER) {
    defaultService.start(bundle,options);
    return;
  }
  activateDeferredPhase(bundle,options,depUnit,phaseService);
}
