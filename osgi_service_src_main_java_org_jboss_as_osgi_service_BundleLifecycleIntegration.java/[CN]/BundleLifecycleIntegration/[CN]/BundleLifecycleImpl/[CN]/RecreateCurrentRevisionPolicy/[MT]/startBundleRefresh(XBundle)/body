{
  this.bundle=bundle;
  XBundleRevision brev=bundle.getBundleRevision();
  Deployment deployment=bundle.adapt(Deployment.class);
  try {
    InputStream inputStream=deployment.getRoot().getStreamURL().openStream();
    rootFile=AbstractVFS.toVirtualFile(inputStream);
  }
 catch (  IOException ex) {
    throw FrameworkMessages.MESSAGES.cannotObtainVirtualFile(ex);
  }
  bundle.putAttachment(BUNDLE_REFRESHING_KEY,Boolean.TRUE);
  undeployRevision(brev);
}
