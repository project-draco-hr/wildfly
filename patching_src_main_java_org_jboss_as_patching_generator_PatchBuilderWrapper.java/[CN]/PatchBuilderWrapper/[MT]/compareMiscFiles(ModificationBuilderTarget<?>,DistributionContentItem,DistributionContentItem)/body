{
  if (o == null && n == null) {
    return;
  }
 else   if (o != null && n == null) {
    builder.removeFile(o.getName(),o.getParent().getPathAsList(),o.getMetadataHash(),!o.isLeaf());
  }
 else   if (o == null && n != null) {
    boolean directory=!n.isLeaf();
    if (directory) {
      for (      final DistributionContentItem child : n.getChildren()) {
        compareMiscFiles(builder,null,child);
      }
    }
 else {
      builder.addFile(n.getName(),n.getParent().getPathAsList(),n.getMetadataHash(),directory);
    }
  }
 else {
    if (!n.equals(o)) {
      throw new IllegalStateException();
    }
    if (n.isLeaf() != o.isLeaf()) {
      throw new IllegalStateException();
    }
    if (n.isLeaf() && !Arrays.equals(o.getComparisonHash(),n.getComparisonHash())) {
      builder.modifyFile(n.getName(),n.getParent().getPathAsList(),o.getMetadataHash(),n.getMetadataHash(),!n.isLeaf());
    }
 else {
      final Collection<DistributionContentItem> nc=n.getChildren();
      final Map<String,DistributionContentItem> children=new HashMap<String,DistributionContentItem>();
      for (      final DistributionContentItem child : nc) {
        children.put(child.getName(),child);
      }
      for (      final DistributionContentItem child : o.getChildren()) {
        final DistributionContentItem item=children.remove(child.getName());
        compareMiscFiles(builder,child,item);
      }
      for (      final DistributionContentItem child : children.values()) {
        compareMiscFiles(builder,null,child);
      }
    }
  }
}
