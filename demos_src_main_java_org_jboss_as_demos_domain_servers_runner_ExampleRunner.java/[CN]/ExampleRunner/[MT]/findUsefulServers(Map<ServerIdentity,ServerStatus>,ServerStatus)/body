{
  ServerIdentity a=null;
  ServerIdentity b=null;
  for (  Map.Entry<ServerIdentity,ServerStatus> server : statuses.entrySet()) {
    ServerStatus status=server.getValue();
    if (status == requiredStatus) {
      ServerIdentity id=server.getKey();
      if (a == null) {
        a=id;
      }
 else       if (b == null) {
        if ("other-server-group".equals(a.getServerGroupName())) {
          b=id;
        }
 else {
          b=a;
          a=id;
        }
      }
 else       if (a.getHostName().equals(id.getHostName())) {
        if (b.getHostName().equals(id.getHostName())) {
          if ("other-server-group".equals(id.getServerGroupName())) {
            b=id;
          }
        }
 else         if ("other-server-group".equals(id.getServerGroupName())) {
          a=id;
        }
      }
 else       if ("other-server-group".equals(id.getServerGroupName())) {
        b=a;
        a=id;
      }
 else {
        b=id;
      }
    }
  }
  if (a == null) {
    throw new IllegalStateException("No started servers are available");
  }
 else {
    List<ServerIdentity> result=new ArrayList<ServerIdentity>();
    result.add(a);
    if (b != null) {
      result.add(b);
    }
    return result;
  }
}
