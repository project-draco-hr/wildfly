{
  this.serviceRegistry=serviceRegistry;
  final ServiceName createServiceName=descriptor.getCreateServiceName();
  final ServiceController<?> controller=serviceRegistry.getRequiredService(createServiceName);
  component=(Component)controller.getValue();
  stateful=component instanceof StatefulSessionComponent;
  final Map<String,ServiceName> viewServices=new HashMap<String,ServiceName>();
  for (  ViewDescription view : descriptor.getComponentDescription().getViews()) {
    viewServices.put(view.getViewClassName(),view.getServiceName());
  }
  if (stateful && viewServices.size() == 1) {
    final ServiceController<?> serviceController=serviceRegistry.getRequiredService(viewServices.values().iterator().next());
    final ComponentView view=(ComponentView)serviceController.getValue();
    instance=view.createInstance();
  }
  this.viewServices=viewServices;
}
