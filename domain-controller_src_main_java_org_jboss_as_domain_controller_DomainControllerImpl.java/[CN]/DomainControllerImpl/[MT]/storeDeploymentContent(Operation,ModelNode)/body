{
  PathAddress address=PathAddress.pathAddress(opNode.get(OP_ADDR));
  if (address.size() == 0) {
    String opName=opNode.get(OP).asString();
    if (DeploymentFullReplaceHandler.OPERATION_NAME.equals(opName) && opNode.hasDefined(INPUT_STREAM_INDEX)) {
      byte[] hash=DeploymentUploadUtil.storeDeploymentContent(operation,opNode,contentRepository);
      opNode.remove(INPUT_STREAM_INDEX);
      opNode.get(HASH).set(hash);
    }
 else     if (COMPOSITE.equals(opName) && opNode.hasDefined(STEPS)) {
      for (      ModelNode childOp : opNode.get(STEPS).asList()) {
        storeDeploymentContent(operation,childOp);
      }
    }
  }
 else   if (address.size() == 1 && DEPLOYMENT.equals(address.getElement(0).getKey()) && ADD.equals(opNode.get(OP).asString()) && opNode.hasDefined(INPUT_STREAM_INDEX)) {
    byte[] hash=DeploymentUploadUtil.storeDeploymentContent(operation,opNode,contentRepository);
    opNode.remove(INPUT_STREAM_INDEX);
    opNode.get(HASH).set(hash);
  }
}
