{
  final Map<ServerIdentity,List<AbstractServerModelUpdate<?>>> result=new HashMap<ServerIdentity,List<AbstractServerModelUpdate<?>>>();
  for (int i=0; i < domainResults.size(); i++) {
    final DomainUpdateApplierResponse domainResult=domainResults.get(i);
    final AbstractDomainModelUpdate<?> domainUpdate=domainUpdates.get(i);
    final AbstractServerModelUpdate<?> serverUpdate=serverByDomain.get(domainUpdate);
    for (    final ServerIdentity server : domainResult.getServers()) {
      List<AbstractServerModelUpdate<?>> serverList=result.get(server);
      if (serverList == null) {
        serverList=new ArrayList<AbstractServerModelUpdate<?>>();
        result.put(server,serverList);
      }
      serverList.add(serverUpdate);
    }
  }
  return result;
}
