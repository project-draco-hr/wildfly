{
  OperationRouting routing=determineRouting(operation);
  if (routing.isRouteToMaster()) {
    return masterDomainControllerClient.execute(operation,handler);
  }
 else   if (routing.isLocalOnly()) {
    return localDomainModel.execute(operation,handler);
  }
  ControllerTransaction transaction=new ControllerTransaction();
  Map<String,ModelNode> hostResults=pushToHosts(operation,routing,transaction);
  for (  ModelNode hostResult : hostResults.values()) {
    if (hostResult.hasDefined(OUTCOME) && "failed".equals(hostResult.get(OUTCOME).asString())) {
      transaction.setRollbackOnly();
      break;
    }
  }
  if (transaction.isRollbackOnly()) {
    transaction.commit();
    throw new UnsupportedOperationException("implement reporting of domain-level failure");
  }
 else {
    transaction.commit();
    handler.handleResultComplete();
    return new BasicOperationResult();
  }
}
