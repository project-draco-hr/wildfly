{
  registerAttributeVaultSensitivityFixedResource();
  VaultExpressionSensitivityConfig.INSTANCE.setConfiguredRequiresAccessPermission(false);
  VaultExpressionSensitivityConfig.INSTANCE.setConfiguredRequiresReadPermission(false);
  VaultExpressionSensitivityConfig.INSTANCE.setConfiguredRequiresWritePermission(true);
  try {
    ModelNode op=createReadResourceDescriptionOperation(PathAddress.EMPTY_ADDRESS,StandardRole.MAINTAINER,true);
    ModelNode result=executeForResult(op);
    ResourceAccessControl accessControl=getResourceAccessControl(getChildDescription(result,ONE_A),ONE_A_ADDR);
    Map<String,ModelNode> defaultAttributes=checkAttributeAccessControlNames(accessControl.defaultControl,ATTR_NONE,ATTR_VAULT);
    checkAttributePermissions(defaultAttributes,ATTR_NONE,true,true,null,null);
    checkAttributePermissions(defaultAttributes,ATTR_VAULT,true,true,null,null);
    Map<String,ModelNode> exceptionAttributes=checkAttributeAccessControlNames(accessControl.exceptions.get(ONE_A_ADDR),ATTR_NONE,ATTR_VAULT);
    checkAttributePermissions(exceptionAttributes,ATTR_NONE,true,true,null,null);
    checkAttributePermissions(exceptionAttributes,ATTR_VAULT,true,false,null,null);
    Map<String,Boolean> defaultOps=checkOperationAccessControlNames(accessControl.defaultControl,ADD,REMOVE);
    Assert.assertEquals(true,defaultOps.get(ADD));
    Assert.assertEquals(true,defaultOps.get(REMOVE));
    Map<String,Boolean> exceptionOps=checkOperationAccessControlNames(accessControl.exceptions.get(ONE_A_ADDR),ADD,REMOVE);
    Assert.assertEquals(true,exceptionOps.get(ADD));
    Assert.assertEquals(false,exceptionOps.get(REMOVE));
  }
  finally {
    VaultExpressionSensitivityConfig.INSTANCE.setConfiguredRequiresAccessPermission(null);
    VaultExpressionSensitivityConfig.INSTANCE.setConfiguredRequiresReadPermission(null);
    VaultExpressionSensitivityConfig.INSTANCE.setConfiguredRequiresWritePermission(null);
  }
}
