{
  ROOT_LOGGER.activatingSubsystem();
  ServiceTarget target=context.getServiceTarget();
  newControllers.add(target.addService(ProtocolDefaultsService.SERVICE_NAME,new ProtocolDefaultsService()).setInitialMode(ServiceController.Mode.ON_DEMAND).install());
  final String stack=CommonAttributes.DEFAULT_STACK.resolveModelAttribute(context,model).asString();
  InjectedValue<ChannelFactory> factory=new InjectedValue<ChannelFactory>();
  ValueService<ChannelFactory> service=new ValueService<ChannelFactory>(factory);
  newControllers.add(target.addService(ChannelFactoryService.getServiceName(null),service).addDependency(ChannelFactoryService.getServiceName(stack),ChannelFactory.class,factory).setInitialMode(ServiceController.Mode.ON_DEMAND).install());
}
