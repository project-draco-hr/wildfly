{
  deployer.deploy(BUNDLE_D_WAB);
  try {
    Bundle bundle=context.getBundle(BUNDLE_D_WAB);
    String result=performCall("/bundle-d/servlet?input=Hello");
    Assert.assertEquals("Simple Servlet called with input=Hello",result);
    result=performCall("/bundle-d/message.txt");
    Assert.assertEquals("Hello from Resource",result);
    bundle.stop();
    Assert.assertEquals("RESOLVED",Bundle.RESOLVED,bundle.getState());
    try {
      performCall("/bundle-d/servlet?input=Hello");
      Assert.fail("IOException expected");
    }
 catch (    IOException ex) {
    }
    try {
      performCall("/bundle-d/message.txt");
      Assert.fail("IOException expected");
    }
 catch (    IOException ex) {
    }
    bundle.start();
    Assert.assertEquals("ACTIVE",Bundle.ACTIVE,bundle.getState());
    result=performCall("/bundle-d/servlet?input=Hello");
    Assert.assertEquals("Simple Servlet called with input=Hello",result);
    result=performCall("/bundle-d/message.txt");
    Assert.assertEquals("Hello from Resource",result);
  }
  finally {
    deployer.undeploy(BUNDLE_D_WAB);
  }
}
