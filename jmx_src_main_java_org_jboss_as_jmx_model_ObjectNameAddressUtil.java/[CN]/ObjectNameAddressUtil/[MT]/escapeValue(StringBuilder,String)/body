{
  final boolean containsAsterix=value.contains("*");
  final boolean containsBackslash=value.contains("\\");
  final boolean containsColon=value.contains(":");
  final boolean containsEquals=value.contains("=");
  final boolean containsNewLine=value.contains("\n");
  final boolean containsQuestionMark=value.contains("?");
  final boolean containsQuote=value.contains("\"");
  final boolean containsComma=value.contains(",");
  boolean quoted=containsAsterix || containsBackslash || containsColon|| containsEquals|| containsNewLine|| containsQuestionMark|| containsQuote|| containsComma;
  if (quoted) {
    String replaced=value;
    sb.append("\"");
    replaced=checkAndReplace(containsAsterix,replaced,"*","\\*");
    replaced=checkAndReplace(containsBackslash,replaced,"\\","\\\\");
    replaced=checkAndReplace(containsNewLine,replaced,"\n","\\n");
    replaced=checkAndReplace(containsQuestionMark,replaced,"?","\\?");
    replaced=checkAndReplace(containsQuote,replaced,"\"","\\\"");
    sb.append(replaced);
    sb.append("\"");
  }
 else {
    sb.append(value);
  }
}
