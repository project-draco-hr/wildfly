{
  DomainClient masterClient=domainMasterLifecycleUtil.getDomainClient();
  DomainClient slaveClient=domainSlaveLifecycleUtil.getDomainClient();
  final String propOne="jboss.domain.test.property.one";
  final String propTwo="jboss.domain.test.property.two";
  final String propThree="jboss.domain.test.property.three";
  final ModelNode rootOneAddr=getPropertyAddress(ROOT_PROP_ADDRESS,propOne);
  final ModelNode rootTwoAddr=getPropertyAddress(ROOT_PROP_ADDRESS,propTwo);
  final ModelNode mainServerOne=getPropertyAddress(MAIN_RUNNING_SERVER_PROP_ADDRESS,propOne);
  final ModelNode mainServerTwo=getPropertyAddress(MAIN_RUNNING_SERVER_PROP_ADDRESS,propTwo);
  final ModelNode otherServerOne=getPropertyAddress(OTHER_RUNNING_SERVER_PROP_ADDRESS,propOne);
  final ModelNode otherServerTwo=getPropertyAddress(OTHER_RUNNING_SERVER_PROP_ADDRESS,propTwo);
  ModelNode response=masterClient.execute(getReadAttributeOperation(rootOneAddr,VALUE));
  ModelNode returnVal=validateResponse(response);
  Assert.assertEquals("ONE",returnVal.asString());
  response=masterClient.execute(getReadAttributeOperation(rootTwoAddr,VALUE));
  returnVal=validateResponse(response);
  Assert.assertEquals(ModelType.EXPRESSION,returnVal.getType());
  Assert.assertEquals("${jboss.domain.test.property.one}",returnVal.asString());
  response=masterClient.execute(getReadAttributeOperation(mainServerOne,VALUE));
  returnVal=validateResponse(response);
  Assert.assertEquals("ONE",returnVal.asString());
  response=masterClient.execute(getReadAttributeOperation(mainServerTwo,VALUE));
  returnVal=validateResponse(response);
  Assert.assertEquals(ModelType.EXPRESSION,returnVal.getType());
  Assert.assertEquals("${jboss.domain.test.property.one}",returnVal.asString());
  response=slaveClient.execute(getReadAttributeOperation(otherServerOne,VALUE));
  returnVal=validateResponse(response);
  Assert.assertEquals("ONE",returnVal.asString());
  response=slaveClient.execute(getReadAttributeOperation(otherServerTwo,VALUE));
  returnVal=validateResponse(response);
  Assert.assertEquals(ModelType.EXPRESSION,returnVal.getType());
  Assert.assertEquals("${jboss.domain.test.property.one}",returnVal.asString());
  response=masterClient.execute(getResolveExpressionOperation(propTwo,MAIN_RUNNING_SERVER_ADDRESS));
  returnVal=validateResponse(response);
  Assert.assertEquals("ONE",returnVal.asString());
  response=slaveClient.execute(getResolveExpressionOperation(propTwo,OTHER_RUNNING_SERVER_ADDRESS));
  returnVal=validateResponse(response);
  Assert.assertEquals("ONE",returnVal.asString());
  ModelNode addOp=new ModelNode();
  addOp.get(OP).set(ADD);
  addOp.get(OP_ADDR).add(SYSTEM_PROPERTY,propThree);
  addOp.get(VALUE).set("${jboss.domain.test.property.one}");
  response=masterClient.execute(addOp);
  validateResponse(response);
  final ModelNode rootThreeAddr=getPropertyAddress(ROOT_PROP_ADDRESS,propThree);
  final ModelNode mainServerThree=getPropertyAddress(MAIN_RUNNING_SERVER_PROP_ADDRESS,propThree);
  final ModelNode otherServerThree=getPropertyAddress(OTHER_RUNNING_SERVER_PROP_ADDRESS,propThree);
  response=masterClient.execute(getReadAttributeOperation(rootThreeAddr,VALUE));
  returnVal=validateResponse(response);
  Assert.assertEquals(ModelType.EXPRESSION,returnVal.getType());
  Assert.assertEquals("${jboss.domain.test.property.one}",returnVal.asString());
  response=masterClient.execute(getReadAttributeOperation(mainServerThree,VALUE));
  returnVal=validateResponse(response);
  Assert.assertEquals(ModelType.EXPRESSION,returnVal.getType());
  Assert.assertEquals("${jboss.domain.test.property.one}",returnVal.asString());
  response=slaveClient.execute(getReadAttributeOperation(otherServerThree,VALUE));
  returnVal=validateResponse(response);
  Assert.assertEquals(ModelType.EXPRESSION,returnVal.getType());
  Assert.assertEquals("${jboss.domain.test.property.one}",returnVal.asString());
  response=masterClient.execute(getResolveExpressionOperation(propThree,MAIN_RUNNING_SERVER_ADDRESS));
  returnVal=validateResponse(response);
  Assert.assertEquals("ONE",returnVal.asString());
  response=slaveClient.execute(getResolveExpressionOperation(propThree,OTHER_RUNNING_SERVER_ADDRESS));
  returnVal=validateResponse(response);
  Assert.assertEquals("ONE",returnVal.asString());
}
